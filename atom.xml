<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Jsonz1993</title>
  
  <subtitle>å‰ç«¯/JavaScript/ç§Ÿç§Ÿè½¦</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://jsonz1993.github.io/"/>
  <updated>2019-03-13T03:30:36.872Z</updated>
  <id>https://jsonz1993.github.io/</id>
  
  <author>
    <name>Jsonz</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>quicklinkå­¦ä¹ ä»¥åŠç»“åˆReact</title>
    <link href="https://jsonz1993.github.io/2019/02/quicklink/"/>
    <id>https://jsonz1993.github.io/2019/02/quicklink/</id>
    <published>2019-02-26T19:49:46.000Z</published>
    <updated>2019-03-13T03:30:36.872Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h1><p>è°·æ­Œå›¢é˜Ÿåœ¨å‡ ä¸ªæœˆå‰å¼€æºäº†ä¸€ä¸ªé¡¹ç›®ï¼Œå«<a href="https://github.com/GoogleChromeLabs/quicklink" target="_blank" rel="noopener"><code>quicklink</code></a>ã€‚å®˜æ–¹ç»™å‡ºçš„ä»‹ç»æ˜¯</p><blockquote><p>Faster subsequent page-loads by prefetching in-viewport links during idle time</p></blockquote><p>è¿™é‡Œç®€å•çš„ä»‹ç»ä¸€ä¸‹è¿™ä¸ªé¡¹ç›®ï¼Œå¹¶ä¸”è¯´æ˜ä¸€ä¸‹ä¸ºä»€ä¹ˆæˆ‘éœ€è¦forkè¿™ä¸ªé¡¹ç›®~</p><p>quicklinkçš„æºç å¾ˆç®€æ´ï¼Œä½œç”¨å¯ä»¥ç”¨ä¸€å¥è¯æ€»ç»“: <strong>åˆ©ç”¨ç©ºé—²æ—¶é—´æ¥ç¼“å­˜ç•Œé¢ä¸Šçœ‹åˆ°çš„é“¾æ¥ï¼ŒåŠ å¿«è¿™äº›é“¾æ¥çš„è®¿é—®é€Ÿåº¦ã€‚</strong></p><p><strong>æ‰€ä»¥quicklinkçš„ä½œç”¨æ˜¯åœ¨ä¸‹ä¸€ä¸ªé“¾æ¥å¿«é€Ÿæ‰“å¼€ï¼Œè€Œä¸æ˜¯å½“å‰é“¾æ¥ï¼Œè¿™ä¸€ç‚¹å’Œå¾ˆå¤šå…¶ä»–ä¼˜åŒ–éƒ½ä¸ä¸€æ ·ã€‚</strong></p><p>åŸç†å¾ˆç®€å•:</p><ul><li>è·å–é¡µé¢ä¸Šæ‰€æœ‰çš„Aæ ‡ç­¾ï¼ˆæ³¨æ„ï¼Œè¿™é‡Œçš„aæ ‡ç­¾æŒ‡çš„æ˜¯è°ƒç”¨å‡½æ•°çš„æ—¶å€™documentä¸‹çš„aæ ‡ç­¾ï¼‰</li><li>ç­‰å¾…æµè§ˆå™¨ç©ºé—² (requestIdleCallback æˆ–è€…ç”¨ setTimeout åšå…¼å®¹)</li><li>åˆ©ç”¨ IntersectionObserver åšç›‘æ§ï¼Œå½“ç›‘æ§çš„domè¿›å…¥è§†å›¾ï¼Œå°±å¼€å§‹é¢„åŠ è½½</li><li>ä¸è·å–è§†å›¾å†…çš„URL(<code>&lt;link rel=&quot;prefetch&quot;&gt;</code> or <code>XHR</code> or <code>fetch</code>)ï¼Œä»¥è·å¾—å¿«é€Ÿè®¿é—®è¯¥é“¾æ¥çš„æ•ˆæœ</li></ul><p>ä»£ç çœŸçš„å¾ˆç®€æ´ï¼Œå¾ˆæ£’ï¼Œè¿™è¾¹æ²¡å¿…è¦å†è´´å‡ºæ¥ï¼Œæœ‰å…´è¶£çš„ç›´æ¥github forkä¸€ä¸ªå»çœ‹æˆ–ä¿®æ”¹ï¼Œé™¤å»æ³¨é‡Šä»£ç é‡åŠ èµ·æ¥ä¸åˆ°200è¡Œ</p><h1 id="forked"><a href="#forked" class="headerlink" title="forked"></a>forked</h1><p>æˆ‘forkè¯¥é¡¹ç›®ä¹‹åä¿®æ”¹äº†ä¸€äº›ä¸œè¥¿ </p><h2 id="é»˜è®¤æ·»åŠ äº†polyfillï¼Œç›´æ¥æ‰“åˆ°åŒ…é‡Œ"><a href="#é»˜è®¤æ·»åŠ äº†polyfillï¼Œç›´æ¥æ‰“åˆ°åŒ…é‡Œ" class="headerlink" title="é»˜è®¤æ·»åŠ äº†polyfillï¼Œç›´æ¥æ‰“åˆ°åŒ…é‡Œ"></a>é»˜è®¤æ·»åŠ äº†polyfillï¼Œç›´æ¥æ‰“åˆ°åŒ…é‡Œ</h2><p>ä¸ºä»€ä¹ˆè¦åŠ polyfillå‘¢ï¼Ÿ å› ä¸º<code>IntersectionObserver</code> è™½ç„¶å¥½ç”¨ï¼Œä½†æ˜¯pcç«¯<code>IE11</code>éƒ½ä¸æ”¯æŒï¼Œç§»åŠ¨ç«¯ä¹Ÿè¦åˆ°äº†<code>IOS12 safari</code>æ‰æ”¯æŒâ€¦æ”¯æŒé¢å¤ªçª„äº†è€Œä¸”ä¸ç”¨polyfillçš„è¯ï¼Œç›´æ¥æŠ¥é”™â€¦.æ‰€ä»¥æƒè¡¡ä¹‹ä¸‹ï¼Œå¹²è„†ç›´æ¥å…¨é‡å¼•ç”¨<code>IntersectionObserver</code>çš„polyfillï¼Œgzipæƒ…å†µä¸‹æ•´ä¸ªåŒ…åŠ èµ·æ¥æ‰<code>3.5k</code> å€¼äº†ã€‚</p><h2 id="æ·»åŠ äº†quicklinkå…¨å±€é…ç½®"><a href="#æ·»åŠ äº†quicklinkå…¨å±€é…ç½®" class="headerlink" title="æ·»åŠ äº†quicklinkå…¨å±€é…ç½®"></a>æ·»åŠ äº†quicklinkå…¨å±€é…ç½®</h2><p>åœ¨åŒ…é‡Œå†™äº† <code>quicklinkOptions</code> å¯¹è±¡ï¼Œè¿™æ ·æ¯æ¬¡è°ƒç”¨ <code>quicklink</code> çš„æ—¶å€™å°±å¯ä»¥å…¬ç”¨ä¸€äº›é…ç½®ï¼Œè€Œä¸éœ€è¦æ¯æ¬¡è°ƒç”¨éƒ½å¡ä¸€æ ·çš„é…ç½®è¿›å»,è‡³äºä¸ºä»€ä¹ˆæåˆ°æ¯æ¬¡è°ƒç”¨â€¦åé¢ä¼šè§£é‡Šåˆ°</p><h2 id="æ·»åŠ äº†manualPreFetchæ–¹æ³•ï¼š-æ‰‹åŠ¨ç»‘å®šæŸäº›domç›‘å¬"><a href="#æ·»åŠ äº†manualPreFetchæ–¹æ³•ï¼š-æ‰‹åŠ¨ç»‘å®šæŸäº›domç›‘å¬" class="headerlink" title="æ·»åŠ äº†manualPreFetchæ–¹æ³•ï¼š æ‰‹åŠ¨ç»‘å®šæŸäº›domç›‘å¬"></a>æ·»åŠ äº†manualPreFetchæ–¹æ³•ï¼š æ‰‹åŠ¨ç»‘å®šæŸäº›domç›‘å¬</h2><p><code>manualPreFetch</code> æ–¹æ³•ï¼Œå°±æ˜¯æ‰‹åŠ¨çš„æ„æ€ï¼Œæ”¯æŒä¼ å…¥è¿™äº›å‚æ•°<code>{dom, isForce, link, priority}</code>ã€‚<br>ä¸ºä»€ä¹ˆéœ€è¦åŠ å¤šä¸ªæ–¹æ³•å‘¢ï¼Ÿ å› ä¸ºæˆ‘å‘ç° quicklink åªæ”¯æŒæ‰«<code>&lt;a&gt;</code>æ ‡ç­¾å»è·å–linkï¼Œä½†æ˜¯å¾ˆå¤šæƒ…å†µå¯èƒ½æˆ‘ä»¬ä¸æ˜¯ç”¨aæ ‡ç­¾ï¼Œè€Œæ˜¯ç±»ä¼¼å†™ä¸€ä¸ª<code>button</code>ï¼Œç‚¹å‡»ä¹‹åjsæ§åˆ¶è·³è½¬ã€‚ è™½ç„¶è¯´æˆ‘ä»¬å¯ä»¥åœ¨ä»£ç å±‚ç”¨buttonåŒ…aé“¾æ¥ç­‰æ–¹å¼å»å®ç°ï¼Œä½†æ˜¯è¿™æ ·å°±å¤ªå±€é™äº†ï¼Œæ‰€ä»¥æ‰åŠ äº†ä¸ªæ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// html</span></span><br><span class="line">&lt;button id=<span class="string">"btn"</span>&gt;è·³è½¬åˆ°xxx&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">manualPreFetch(&#123;</span></span><br><span class="line"><span class="regexp">  dom: document.getElementById('btn'),</span></span><br><span class="line"><span class="regexp">  link: 'www.easyrentcars.com',</span></span><br><span class="line"><span class="regexp">&#125;);</span></span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•å’Œ <code>quicklink</code> ä¸€æ ·ï¼Œä¹Ÿæ˜¯ç›‘å¬domæ»šåˆ°å½“å‰ä½ç½®æ‰ä¼šå‘èµ·é¢„åŠ è½½ã€‚è¿™é‡Œä¼šè¯»å–ä¸€éƒ¨åˆ†çš„<code>quicklinkOptions</code>ï¼Œè¿™å°±æ˜¯æˆ‘åŠ å¤šä¸ªå…¨å±€é…ç½®çš„åŸå› äº†ï¼Œä¸éœ€è¦æ¯æ¬¡è°ƒç”¨çš„æ—¶å€™éƒ½å†™ä¸€å †</p><h2 id="å¢åŠ äº†manualRemovePreFetchæ–¹æ³•ï¼š-æ‰‹åŠ¨åˆ é™¤ç›‘å¬é¢„åŠ è½½"><a href="#å¢åŠ äº†manualRemovePreFetchæ–¹æ³•ï¼š-æ‰‹åŠ¨åˆ é™¤ç›‘å¬é¢„åŠ è½½" class="headerlink" title="å¢åŠ äº†manualRemovePreFetchæ–¹æ³•ï¼š æ‰‹åŠ¨åˆ é™¤ç›‘å¬é¢„åŠ è½½"></a>å¢åŠ äº†manualRemovePreFetchæ–¹æ³•ï¼š æ‰‹åŠ¨åˆ é™¤ç›‘å¬é¢„åŠ è½½</h2><p>æ·»åŠ ä¸ªç§»é™¤çš„æ–¹æ³•ï¼Œåªæ˜¯ç®€å•çš„ç§»é™¤æ‰è¦ç›‘å¬çš„domï¼Œè™½ç„¶å¯¹æ€§èƒ½ä¸ä¼šé€ æˆå½±å“â€¦ä½†æ˜¯å°±æ˜¯æœ‰ç‚¹å¼ºè¿«ç—‡é¸­ğŸ¦†</p><h2 id="React-demo"><a href="#React-demo" class="headerlink" title="React demo"></a>React demo</h2><p><code>quicklink</code>æ˜¯åœ¨æ‰§è¡Œçš„æ—¶å€™ç”¨ <code>(el || document).getQuesySelectorAll(&#39;a&#39;)</code> å»è·å–é¡µé¢ä¸Šçš„<code>&lt;a&gt;</code>ï¼Œæ‰€ä»¥å¯¹äºReactå°±æ¯”è¾ƒå°´å°¬äº†ï¼Œæ¸²æŸ“æ˜¯å¼‚æ­¥çš„ï¼Œå¦‚æœè°ƒç”¨æ—©çš„è¯ï¼Œè‚¯å®šæ˜¯æ‹¿ä¸åˆ°ï¼Œé‚£ä»€ä¹ˆæ—¶å€™è°ƒç”¨è¿™ä¸ªæ‰æ˜¯æœ€ä½³æ—¶æœº?</p><p><strong>æ¯”è¾ƒé€šç”¨çš„æ˜¯<code>componentDidMount</code> æˆ–è€…æ˜¯<code>UseEffect</code>ã€‚ä¸è¿‡ä¸ªäººæ¯”è¾ƒå»ºè®®é…åˆ<code>manualPreFetch</code>ã€<code>manualRemovePreFetch</code>å¯¹ä¸€äº›æ¯”è¾ƒé‡è¦çš„åŠ å°±å¥½äº†ï¼Œå› ä¸ºå¾ˆå¤šéƒ½æ˜¯å¼‚æ­¥ä¹‹åå†æ¸²æŸ“ï¼Œå¯èƒ½ <code>componentDidMount</code>çš„æ—¶å€™ï¼Œä½ éœ€è¦é¢„åŠ è½½çš„é“¾æ¥è¿˜æ²¡å‡ºç°ã€‚</strong></p><p>è¿™é‡Œç®€å•ç»™å‡ºä¸¤ä¸ªå…³äºReactçš„é€šç”¨demoã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useEffect, useRef &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> quicklink, &#123; manualPreFetch, manualRemovePreFetch&#125; <span class="keyword">from</span> <span class="string">'@jsonz/quicklink'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// class ç±»å‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QuicklinkComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.refRoot = React.createRef();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="comment">// didMount ç›‘å¬ç»„ä»¶å†…æ‰€æœ‰çš„aé“¾æ¥</span></span><br><span class="line">    quicklink(&#123;</span><br><span class="line">      el: <span class="keyword">this</span>.refRoot.current,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentWillUnmount() &#123;</span><br><span class="line">    <span class="comment">// willunmount ç§»é™¤æ‰€æœ‰çš„aé“¾æ¥ç›‘å¬</span></span><br><span class="line">    batchManualRemove(<span class="keyword">this</span>.refRoot.current);</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&#123;this.refRoot&#125;</span>&gt;</span>&#123;this.props.children&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// hook ç±»å‹</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">QuicklinkDemo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> refRoot = useRef(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span>=&gt;</span> &#123;</span><br><span class="line">    quicklink(&#123;</span><br><span class="line">      el: refRoot.current,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span>=&gt;</span> &#123;</span><br><span class="line">      batchManualRemove(refRoot.current);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&#123;refRoot&#125;</span>&gt;</span>&#123;this.props.children&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="3-1-è‡´å¤­æŠ˜çš„å°ql"><a href="#3-1-è‡´å¤­æŠ˜çš„å°ql" class="headerlink" title="3.1 è‡´å¤­æŠ˜çš„å°ql"></a>3.1 è‡´å¤­æŠ˜çš„å°ql</h1><p>æœ¬æ¥å·²ç»åŠ åœ¨é¡¹ç›®ä¸Šï¼Œæ‰“ç®—æ‹¿ä¸€ä¸ªé¡¹ç›®/é¡µé¢æ¥è¯•ç‚¹ï¼Œä¸è¿‡æœ€åè¢«è¯´æœæš‚æ—¶ä¸ç”¨ï¼ŒåŸå› æœ‰ä¸‰</p><ol><li>quicklink å¯èƒ½ä¼šå¯¹åç«¯é€ æˆä¸å°çš„å‹åŠ›ï¼Œæ¯”å¦‚ä½ çš„ç½‘ç«™ä¸€æ‰“å¼€ï¼Œæ»‘åˆ°æœ€åº•éƒ¨ï¼Œé‚£ä¸­é—´å¯èƒ½å°±ä¼šé¢„åŠ è½½20ä¸ªé“¾æ¥â€¦.ç„¶è€Œç”¨æˆ·å¯èƒ½ä¸€ä¸ªéƒ½ä¸æ‰“å¼€å°±å…³é—­ï¼Œé‚£å°±ç™½ç™½ç»™æœåŠ¡å™¨æ·»åŠ 20ä¸ªè¯·æ±‚ï¼Œå¯¹äºé‡æ¯”è¾ƒå¤§çš„ç½‘ç«™ï¼Œå¯èƒ½ä¼šå¾ˆå‘çˆ¹ã€‚æ€»ç»“æ¥è¯´å°±æ˜¯å‘½ä¸­ç‡å¤ªä½ï¼Œä¸è¿‡å¯ä»¥æ”¹æˆåšé’ˆå¯¹æ€§çš„é¢„åŠ è½½ï¼Œæ¯”å¦‚ä¸‹å•é¡µé¢„åŠ è½½æ”¯ä»˜é¡µçš„ã€‚</li><li>åªèƒ½é¢„åŠ è½½documentï¼Œå¯¹äºé¡µé¢ä¸Šå å¤§å¤´çš„jså¼•ç”¨ç­‰é™æ€èµ„æºæ²¡æœ‰èµ·ä½œç”¨ã€‚æ•ˆæœå¯èƒ½å¯¹äºå®ç”¨ç«™ç‚¹ä¸æ˜æ˜¾ï¼Œå¯¹æ–‡ç« ç±»ä¼šå¥½å¾ˆå¤šã€‚</li><li>é’ˆå¯¹å‰é¢ä¸¤ç§æƒ…å†µï¼Œå¥½åƒpwaèƒ½åšçš„ä¼šæ›´å¤šï¼Ÿ æ‰€ä»¥å¦‚æœæ˜¯è¿‡æ¸¡æ–¹æ¡ˆæˆ–æ–‡å­—ç±»(document)èµ„æºå æ¯”æ¯”è¾ƒå¤šçš„ç”¨quicklinkæ¯”è¾ƒå¥½ã€‚</li></ol><p>ä½†æ˜¯é¡¹ç›®ä¸Šçš„pwaæ¯”è¾ƒæ®‹ç–¾ï¼Œä¹‹å‰åšçš„åŒäº‹åšäº†ä¸€ç‰ˆä¹‹åå°±ç¦»èŒäº†â€¦ä¸€ç›´æ²¡äººå»ç»´æŠ¤ï¼Œæ‰€ä»¥pwaè¦è¢«æä¸Šæ—¥ç¨‹ï¼Ÿ</p><blockquote><p>è¡¥ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ç›´æ¥åœ¨quicklinkå†…æ‰“polyfillä¸æ˜¯å¾ˆå¥½ï¼Œå› ä¸ºå¦‚æœé¡¹ç›®ä¸Šä¹Ÿå¼•ç”¨è¿™ä¸ªPolyfillå°±ä¼šé‡å¤äº†ã€‚</p></blockquote><p>å‘Šè¾</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ä»‹ç»&quot;&gt;&lt;a href=&quot;#ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;ä»‹ç»&quot;&gt;&lt;/a&gt;ä»‹ç»&lt;/h1&gt;&lt;p&gt;è°·æ­Œå›¢é˜Ÿåœ¨å‡ ä¸ªæœˆå‰å¼€æºäº†ä¸€ä¸ªé¡¹ç›®ï¼Œå«&lt;a href=&quot;https://github.com/GoogleChromeLabs/quickli
      
    
    </summary>
    
      <category term="technology" scheme="https://jsonz1993.github.io/categories/technology/"/>
    
    
      <category term="work" scheme="https://jsonz1993.github.io/tags/work/"/>
    
      <category term="github" scheme="https://jsonz1993.github.io/tags/github/"/>
    
      <category term="JavaScript" scheme="https://jsonz1993.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>åˆ©ç”¨ASTè§£å†³é¡¹ç›®webpack aliasæ³›æ»¥é—®é¢˜</title>
    <link href="https://jsonz1993.github.io/2019/01/AST-practice/"/>
    <id>https://jsonz1993.github.io/2019/01/AST-practice/</id>
    <published>2019-01-24T11:57:58.000Z</published>
    <updated>2019-03-13T03:30:36.868Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://github.com/jsonz1993/wheel/tree/master/ast-webpack-alias" target="_blank" rel="noopener">æ–‡ç« ä»£ç çš„æºç ä»“åº“</a></p><h1 id="AST-ç®€å•ä»‹ç»"><a href="#AST-ç®€å•ä»‹ç»" class="headerlink" title="AST ç®€å•ä»‹ç»"></a>AST ç®€å•ä»‹ç»</h1><p>AST(Abstract Syntax Tree)æ—¢æŠ½è±¡è¯­æ³•æ ‘ï¼Œæˆ–ç§°è¯­æ³•æ ‘ï¼Œç®€å•æ¥è¯´å°±æ˜¯ä»£ç è¯­æ³•ç»“æ„çš„ä¸€ç§æŠ½è±¡è¡¨ç¤ºã€‚æ¯”å¦‚ <code>var answer = 6 * 7;</code> ä¼šè¢«è§£æä¸ºè¿™ä¹ˆä¸€æ£µæ ‘<br><img src="./ast_wiki.png" style="width: 320px; border: none; display: inline-block;"><img src="./ast_esprima.png" style="width: 200px; border: none; display: inline-block;"></p><p>é‚£ä¹ˆä»£ç æ€æ ·æ‰èƒ½è§£ææˆè¿™ä¸€æ£µ ASTï¼Œ ASTåœ¨å‰ç«¯é¢†åŸŸä¸€èˆ¬åˆå¯ä»¥å¹²å˜›ï¼Ÿ</p><h1 id="ç¼–è¯‘å™¨"><a href="#ç¼–è¯‘å™¨" class="headerlink" title="ç¼–è¯‘å™¨"></a>ç¼–è¯‘å™¨</h1><p><strong>astæ˜¯ç”±ç¼–è¯‘å™¨è§£æç”Ÿæˆçš„</strong>ï¼Œç®€å•çš„ç¼–è¯‘å™¨å¯ä»¥ç”±ä»¥ä¸‹å‡ éƒ¨åˆ†ç»„æˆ:</p><ul><li>tokenizer åˆ†è¯å™¨ æŠŠä»£ç æˆ–æ–‡æœ¬æŒ‰ç±»å‹åˆ†å¼€ï¼Œè¿”å›: <code>tokens</code></li><li>parser è¯­æ³•å‰–æå™¨ å¯¹åˆ†è¯åçš„æ–‡æœ¬æŒ‰ç…§è¯­æ³•åˆ†æè½¬æ¢æˆ æŠ½è±¡è¯­æ³•æ ‘ è¿”å›ï¼šast</li><li>transformer è¯­æ³•è½¬æ¢å™¨ æŠŠè¯­æ³•å‰–æåçš„æŠ½è±¡è¯­æ³•æ ‘è½¬æ¢æˆæˆ‘ä»¬æƒ³è¦çš„: newAst</li><li>codeGenerator ä»£ç ç”Ÿæˆå™¨ æŠŠAST è½¬æ¢ä¸º ç›®æ ‡ä»£ç </li></ul><p>æˆ‘ä»¬å‰ç«¯æ„å»ºä¸­å¾ˆå¸¸ç”¨çš„babelå°±æ˜¯è¿™ç§åŸç†</p><blockquote><p>babel åˆå§‹é˜¶æ®µå¹¶æ²¡æœ‰åšä»»ä½•äº‹ï¼ŒåŸºæœ¬ä¸Šç­‰äº const babel = code=&gt; code; å…ˆ tokenizerï¼Œ parser è§£æä»£ç ï¼Œå† transformer çš„æ—¶å€™ï¼Œå®Œå…¨ä¸æ”¹åŠ¨åŸæ¥çš„ ast</p></blockquote><p><strong>å¯¹ç¼–è¯‘å™¨åŸç†æœ‰å…´è¶£çš„ï¼Œå¯ä»¥çœ‹æˆ‘ä»¥å‰å†™çš„å°demoï¼Œ500è¡Œç®€å•æ˜“æ‡‚ <a href="https://github.com/jsonz1993/wheel/blob/master/min-compiler/README.md" target="_blank" rel="noopener">min-compiler</a>ï¼Œçœ‹å®Œä¼šæœ‰ä¸ªæ•´ä½“æ¦‚å¿µã€‚</strong></p><p>è€Œç”Ÿæˆçš„ASTæˆ‘ä»¬å¯ä»¥ç”¨æ¥åšä»€ä¹ˆï¼Ÿ<br>ASTä½ éƒ½æ‹¿åˆ°äº†ï¼Œå‰©ä¸‹çš„äº‹æƒ…å°±æ˜¯å¯¹è¿™æ£µæ ‘åšä½ æƒ³è¦çš„æ“ä½œï¼Œæ¯”å¦‚ä»£ç è½¬æ¢(babel)ï¼Œä»£ç å‹ç¼©ç­‰ã€‚</p><p>è¿™é‡Œæˆ‘ç”¨ä»–æ¥å¤„ç†webpackçš„aliasæ³›æ»¥é—®é¢˜ã€‚</p><h1 id="webpack-aliasé—®é¢˜"><a href="#webpack-aliasé—®é¢˜" class="headerlink" title="webpack aliasé—®é¢˜"></a>webpack aliasé—®é¢˜</h1><p>webpack alias åœ¨å¾ˆå¤šæƒ…å†µä¸‹å¯ä»¥æä¾›ä¾¿åˆ©ï¼Œä½†æ˜¯å¦‚æœé¡¹ç›®å‚åŠ çš„äººå¤ªå¤šï¼Œåˆæ²¡æœ‰ä»€ä¹ˆçº¦æŸï¼Œå¤§å®¶è´ªå›¾æ–¹ä¾¿ä»€ä¹ˆéƒ½åŠ åˆ°aliasâ€¦.å°±ä¼šå˜æˆè¿™æ ·å­<br><img src="./old_alias.png"></p><ul><li>å¾ˆå¤šä½ ä¸çŸ¥é“ä»–åˆ°åº•æ˜¯node_modulesé‡Œé¢çš„åŒ…è¿˜æ˜¯è‡ªå·±å°è£…è¿‡çš„</li><li>å¾ˆå¤šå†™äºŒçº§è·¯å¾„å°±å¯ä»¥è·å–åˆ°çš„ï¼Œæ²¡å¿…è¦å¤šåŠ ä¸ªalias</li><li>ç°åœ¨æ¯”è¾ƒæ¨å´‡ä¸æ˜¯å¾ˆè¿œçš„è·¯å¾„éƒ½å†™æˆç›¸å¯¹è·¯å¾„ï¼Œç¼–è¾‘å™¨å¯ä»¥ç›´æ¥è·³è¿‡å»æ–¹ä¾¿ï¼ˆè™½ç„¶è¿™ä¸ªå¯ä»¥é€šè¿‡jsconfigæ¥è§£å†³ï¼Œä½†æ˜¯å¤ªå¤šçœ‹ç€ä¹Ÿå¾ˆçƒ¦)<br>æ‰€ä»¥æˆ‘å†³å®šæŠŠé¡¹ç›®é‡Œçš„aliasä»23ä¸ªç¼©å‡ä¸º7ä¸ªã€‚</li></ul><h1 id="åˆ©ç”¨-estools-è§£å†³webpack-Alias"><a href="#åˆ©ç”¨-estools-è§£å†³webpack-Alias" class="headerlink" title="åˆ©ç”¨ estools è§£å†³webpack Alias"></a>åˆ©ç”¨ <a href="https://github.com/estools" target="_blank" rel="noopener">estools</a> è§£å†³webpack Alias</h1><p>æˆ‘ä»¬å…ˆæ¥æ•´ç†ä¸€ä¸‹æ€è·¯</p><ul><li>å…ˆç”¨è§£æå™¨æŠŠä»£ç è§£ææˆ AST</li><li>å†æ‰¾å‡ºæˆ‘ä»¬éœ€è¦å»é™¤çš„aliasï¼ŒæŠŠä»–æ”¹ä¸ºå…¶ä»–å€¼ï¼Œç”Ÿæˆæ–°çš„AST</li><li>æŠŠæ–°çš„ASTè½¬ä¸ºä»£ç ï¼Œé‡æ–°å†™å…¥æ–‡ä»¶</li></ul><p>æˆ‘ä»¬è¿™é‡Œçš„æŠŠaliasæ”¹ä¸ºå…¶ä»–å€¼ï¼ŒæŒ‡çš„æ˜¯è¿™ç§æƒ…å†µ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ç›®å½•ç»“æ„:</span><br><span class="line">- src</span><br><span class="line">  - components</span><br><span class="line">    - btn</span><br><span class="line"></span><br><span class="line">alias: &#123;</span><br><span class="line">  btn: path.resolve(basepath, &apos;src/components/btn&apos;),</span><br><span class="line">  btn: path.resolve(basepath, &apos;src/components&apos;),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">åŸæ¥çš„å¼•å…¥ import Btn from &apos;btn&apos;;</span><br><span class="line">æ”¹ä¸º import Btn from &apos;components/btn&apos;;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬ç”¨ <a href="https://github.com/jquery/esprima" target="_blank" rel="noopener">esprima</a> æ¥åšä»£ç åˆ†æç”Ÿæˆastï¼Œç”¨ <a href="https://github.com/estools/estraverse" target="_blank" rel="noopener">estraverse</a> æ¥è½¬æ¢ä»£ç ï¼Œç”¨ <a href="https://github.com/estools/escodegen" target="_blank" rel="noopener">escodegen</a> ç”Ÿæˆä»£ç ã€‚ç›´æ¥ä¸Šä»£ç </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> aliasConfig = &#123; <span class="comment">/* webpack alias é…ç½®*/</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">translateAlias</span>(<span class="params">filePath</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è§£æast</span></span><br><span class="line">  <span class="keyword">const</span> codeStr = fs.readFileSync(filePath).toString();</span><br><span class="line">  <span class="keyword">const</span> ast = esprima.parseModule(codeStr);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è½¬æ¢ast</span></span><br><span class="line">  estraverse.traverse(ast, &#123;</span><br><span class="line">    <span class="comment">// å¯¹äºæ¯ä¸ªnodeèŠ‚ç‚¹éƒ½ä¼šè¿›å…¥è¿™ä¸ªå‡½æ•°</span></span><br><span class="line">    enter(node, parent) &#123;</span><br><span class="line">      <span class="comment">// åˆ¤æ–­æ˜¯å¦æ˜¯æˆ‘ä»¬çš„ç›®æ ‡æ–‡ä»¶</span></span><br><span class="line">      <span class="keyword">const</span> isAliasDec = isRequireDeclaration(node, parent);</span><br><span class="line">      <span class="keyword">if</span> (isAliasDec) &#123;</span><br><span class="line">        <span class="comment">// æ›¿æ¢æ‰alias =&gt; newAlias</span></span><br><span class="line">        <span class="keyword">const</span> newVal = getModulePath(node.value, filePath);</span><br><span class="line">        node.value = newVal;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// é‡æ–°ç”Ÿæˆä»£ç </span></span><br><span class="line">  <span class="keyword">const</span> newCodeStr = escodegen.generate(ast);</span><br><span class="line">  fs.writeFileSync(filePath, newCodeStr, &#123;&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å·¥å…·å‡½æ•°: åˆ¤æ–­æ˜¯å¦æ˜¯ require</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isRequireDeclaration</span>(<span class="params">node, parent</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; type, value &#125; = node;</span><br><span class="line">  <span class="keyword">const</span> &#123; callee &#125; = parent || &#123;&#125;;</span><br><span class="line">  <span class="comment">// ç±»å‹ä¸€è‡´ &amp;&amp; è¯¥keyåœ¨aliasKeyä¸­ &amp;&amp; æ˜¯ requireå¼•å…¥çš„</span></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    type === <span class="string">'Literal'</span> &amp;&amp;</span><br><span class="line">    aliasKey.includes(value) &amp;&amp;</span><br><span class="line">    !allowAliasKey.includes(value) &amp;&amp;</span><br><span class="line">    isRequest(callee)</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å·¥å…·å‡½æ•°ï¼šè·å–è·¯å¾„</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getModulePath</span>(<span class="params">aliasKey, filePath</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> firstDir = <span class="regexp">/\w*/</span>.exec(aliasKey)[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> modulePath = aliasKey.replace(firstDir, aliasConfig[firstDir]);</span><br><span class="line">  <span class="keyword">const</span> aliasPath = aliasKey.replace(firstDir, aliasMap[firstDir]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!aliasConfig[firstDir] || !aliasMap[firstDir] || allowAliasKey.includes(firstDir)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è·å–å¼•å…¥çš„æ¨¡å—ä¸å½“å‰æ¨¡å—ç›¸å¯¹è·¯å¾„ï¼Œåˆ¤æ–­æ˜¯å¦å¤ªé•¿ï¼Œæ˜¯å°±è¿”å›aliasï¼Œå¦åˆ™å°±è¿”å›ç›¸å¯¹è·¯å¾„å°±å®Œäº‹äº†</span></span><br><span class="line">  <span class="keyword">const</span> relativePath = path.relative(filePath, modulePath);</span><br><span class="line">  <span class="keyword">const</span> relativeTime = relativePath.split(<span class="string">'../'</span>).length - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> (relativeTime &lt; MAX_RELATIVE)? relativePath: aliasPath;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">translateAlias(filePath);</span><br></pre></td></tr></table></figure><p><img src="./estool.png" alt="estool_ast"><br>è¯•è·‘äº†ä¸€ä¸‹ï¼Œå‘ç°è¯´è™½ç„¶ä»£ç å¼•ç”¨ç¡®å®æœ‰è¢«æ›¿æ¢äº†ï¼Œä½†æ˜¯ä»£ç é‡Œé¢çš„æ‰€æœ‰ç©ºè¡Œå’Œæ³¨é‡Šéƒ½ä¸¢äº†ï¼Œè€Œä¸”ä¸€äº›è§„èŒƒæ ¼å¼ä¹Ÿå’ŒåŸæ¥ä¸ä¸€æ ·ã€‚<br>è¿™æ˜¾ç„¶æ˜¯ä¸è¡Œçš„ï¼Œå…ˆä¸è¯´æ ¼å¼çš„é—®é¢˜ï¼Œä¸€ä¸ªæ–‡ä»¶è¿æ¢è¡Œå’Œæ³¨é‡Šéƒ½æ²¡æœ‰ï¼Œé‚£ä»–å°±æ˜¯æ²¡æœ‰çµé­‚çš„js~</p><p>çœ‹äº†ä¸‹è¿™æ˜¯å› ä¸º <code>esprima</code> åœ¨è§£æçš„æ—¶å€™ï¼Œé‡åˆ°ç©ºè¡Œå’Œæ³¨é‡Šä¼šç›´æ¥è·³è¿‡ä¸è§£æç”ŸæˆASTï¼Œæ‰€ä»¥ä¼šå¯¼è‡´åé¢ç”Ÿæˆçš„ä»£ç æ²¡æœ‰ç©ºè¡Œå’Œæ³¨é‡Šã€‚</p><h1 id="babelè§£å†³ç©ºè¡Œå’Œæ³¨é‡Šç­‰é—®é¢˜ã€prettierä¿æŒä»£ç é£æ ¼ä¸€è‡´"><a href="#babelè§£å†³ç©ºè¡Œå’Œæ³¨é‡Šç­‰é—®é¢˜ã€prettierä¿æŒä»£ç é£æ ¼ä¸€è‡´" class="headerlink" title="babelè§£å†³ç©ºè¡Œå’Œæ³¨é‡Šç­‰é—®é¢˜ã€prettierä¿æŒä»£ç é£æ ¼ä¸€è‡´"></a>babelè§£å†³ç©ºè¡Œå’Œæ³¨é‡Šç­‰é—®é¢˜ã€prettierä¿æŒä»£ç é£æ ¼ä¸€è‡´</h1><p>æˆ‘ä»¬å¹³æ—¶é¡¹ç›®ä¸Šç”¨çš„æœ€å¤šçš„è½¬æ¢ä»£ç çš„å·¥å…·å°±æ˜¯babelï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠ <code>esTool</code> é‚£ä¸€å¥—æ¢æˆ <code>babel</code>ç”Ÿæ€ï¼Œç”¨babelæ¥å¸®æˆ‘ä»¬åšè¿™äº›è½¬æ¢ã€‚</p><p>åŸç†å’Œæ€è·¯åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œç”¨ <code>babylon</code> è§£æï¼Œ<code>babel-traverse</code> è½¬æ¢ï¼Œå†ç”¨<code>babel-generator</code>ç”Ÿæˆä»£ç ã€‚<br>ç”Ÿæˆä¹‹åï¼Œå…ˆä¸å†™è¿›å»ï¼Œè€Œæ˜¯ç”¨ <code>prettier</code> æ ¼å¼åŒ–ä¸€éå†é‡å†™åˆ°æœ¬åœ°ï¼Œä»¥ä¿æŒå’ŒåŸæ¥çš„é£æ ¼ä¸€è‡´ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">translateAlias</span>(<span class="params">filePath</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`å¼€å§‹å¤„ç†ç¬¬<span class="subst">$&#123;i++&#125;</span>ä¸ª: <span class="subst">$&#123;filePath&#125;</span>`</span>)</span><br><span class="line">  <span class="keyword">const</span> code = fs.readFileSync(filePath).toString();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è·å–ast</span></span><br><span class="line">  <span class="keyword">const</span> ast = babylon.parse(code, &#123;</span><br><span class="line">    sourceType: <span class="string">'module'</span>,</span><br><span class="line">    plugins: [<span class="string">'jsx'</span>, <span class="string">'objectRestSpread'</span>]</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  traverse(ast, &#123;</span><br><span class="line">    enter(path) &#123;</span><br><span class="line">      <span class="comment">// è½¬æ¢ CommonJs çš„æƒ…å†µ</span></span><br><span class="line">      translateRequireModulePath(path, filePath);</span><br><span class="line">      <span class="comment">// è½¬æ¢ ESM çš„æƒ…å†µ</span></span><br><span class="line">      translateImportModulePath(path, filePath);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> newCode = generate(ast, &#123;&#125;);</span><br><span class="line">  <span class="comment">// é‡æ–°ç”¨é¡¹ç›®çš„prettieré…ç½®æ ¼å¼åŒ–å¤šä¸€æ¬¡å†å†™å…¥</span></span><br><span class="line">  <span class="keyword">const</span> prettierCode = prettier.format(newCode.code, prettierConfig);</span><br><span class="line">  fs.writeFileSync(filePath, prettierCode);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`å¤„ç†ç»“æŸ<span class="subst">$&#123;filePath&#125;</span>`</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="./babel.png" alt="./babel.png"></p><p>åˆ°æ­¤å‡å°‘webpack-aliasçš„åŠŸèƒ½å¤„ç†å®Œæˆï¼Œæœ€åæ€»ç»“ä¸€ä¸‹</p><ol><li>ç”¨<code>glob</code>è¯»å–æ‰€æœ‰è¦è½¬çš„jsæ–‡ä»¶</li><li>ç”¨ <code>babylon</code> å°†jsæ–‡ä»¶è§£ææˆAST</li><li>ç”¨ <code>babel-traverse</code> å¤„ç†ASTï¼Œåˆ¤æ–­å¦‚æœæ˜¯ <code>require(&#39;xxx&#39;)</code>æˆ–è€…<code>import xxx from &#39;xxx&#39;</code> æ›¿æ¢æ‰è¿™äº›è·¯å¾„</li><li>ç”¨ <code>babel-generator</code> å°†æ–°ç”Ÿæˆçš„ASTè½¬åŒ–ä¸ºä»£ç </li><li>ç”¨ <code>prettier</code> æ ¼å¼åŒ–æ–°ç”Ÿæˆçš„ä»£ç ï¼Œä¿æŒä¸åŸé¡¹ç›®é£æ ¼ä¸€è‡´</li><li>é‡æ–°å†™å…¥æœ¬åœ°æ–‡ä»¶</li></ol><h1 id="å‘Šè¾ï¼"><a href="#å‘Šè¾ï¼" class="headerlink" title="å‘Šè¾ï¼"></a>å‘Šè¾ï¼</h1><p><img src="./kaiji.jpg" alt="./kaiji.jpg"><br>æœ€åå†™çš„æ—¶å€™å‚è€ƒåˆ°çš„é“¾æ¥ï¼Œå¤§éƒ¨åˆ†æ˜¯ç±»åº“çš„æ–‡æ¡£<br><a href="https://github.com/jsonz1993" target="_blank" rel="noopener">è¿·ä½ ç¼–è¯‘å™¨</a><br><a href="https://github.com/estools/escodegen" target="_blank" rel="noopener">estoolsä»£ç ç”Ÿæˆescodegen</a><br><a href="https://github.com/estools/estraverse" target="_blank" rel="noopener">estoolsä»£ç è½¬æ¢estraverse</a><br><a href="https://github.com/jquery/esprima" target="_blank" rel="noopener">ä»£ç è§£æesprima</a><br><a href="https://github.com/jamiebuilds/babel-handbook/blob/master/translations/zh-Hans/plugin-handbook.md#toc-introduction" target="_blank" rel="noopener">babel plugin book</a><br><a href="https://www.npmjs.com/package/babel-generator" target="_blank" rel="noopener">babel-generator</a><br><a href="https://www.npmjs.com/package/babel-traverse" target="_blank" rel="noopener">babel-traverse</a><br><a href="https://www.npmjs.com/package/babylon" target="_blank" rel="noopener">babylon</a><br><a href="http://esprima.org/demo/parse.html" target="_blank" rel="noopener">åœ¨çº¿astç”Ÿæˆ</a><br><a href="http://forivall.com/astexplorer/" target="_blank" rel="noopener">åœ¨çº¿astç”Ÿæˆ</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://github.com/jsonz1993/wheel/tree/master/ast-webpack-alias&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æ–‡ç« ä»£ç çš„æºç ä»“åº“&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;AST-ç®€
      
    
    </summary>
    
      <category term="technology" scheme="https://jsonz1993.github.io/categories/technology/"/>
    
    
      <category term="github" scheme="https://jsonz1993.github.io/tags/github/"/>
    
  </entry>
  
  <entry>
    <title>æ­£åˆ™è¡¨è¾¾å¼â€”â€”åˆšæ‰æ˜æ˜æ˜¯å¥½çš„</title>
    <link href="https://jsonz1993.github.io/2018/11/regexp-global/"/>
    <id>https://jsonz1993.github.io/2018/11/regexp-global/</id>
    <published>2018-11-22T22:31:21.000Z</published>
    <updated>2019-03-13T03:30:36.868Z</updated>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©æµ‹è¯•æä¸€ä¸ªjiraç»™æˆ‘ï¼Œè¯´æœ‰ä¸€ä¸ªå¾ˆè¯¡å¼‚çš„bugï¼Œè¡¨å•éªŒè¯æœ‰æ—¶å€™ä¼šæˆåŠŸï¼Œæœ‰æ—¶å€™ä¼šå¤±è´¥ã€‚</p><video src="./a.mp4" controls="true"></video><p>è€Œä¸”å¾ˆæœ‰è§„å¾‹æ€§çš„ï¼Œä¸¤ä¸‹æˆåŠŸï¼Œæ¥ç€å¤±è´¥ï¼Œå†ä¸¤ä¸‹æˆåŠŸï¼Œå†å¤±è´¥â€¦çœ‹ä»£ç ä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜ï¼Œ<code>\S</code>åŒ¹é…ä»»ä½•éç©ºå­—ç¬¦ï¼Œ<code>g</code>å…¨å±€æŸ¥æ‰¾ï¼Œè¿™ä¹ˆç®€å•çš„ä¸€ä¸ªæ­£åˆ™æ€ä¹ˆå¯èƒ½ä¼šå‡ºé”™ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> r = <span class="regexp">/\S/g</span>;</span><br><span class="line">$input.addEventListener(<span class="string">'blur'</span>, (e)=&gt; &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line"><span class="keyword">const</span> result = r.test(e.currentTarget.value);</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>ç„¶åç›´æ¥æ‹¿åˆ°æ§åˆ¶å°å»æµ‹è¯•ï¼Œå‘ç°ä¹Ÿæœ‰ç±»ä¼¼çš„é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœæ¯æ¬¡éƒ½ç›´æ¥è°ƒç”¨æ­£åˆ™è¡¨è¾¾å¼çš„testæ–¹æ³•ï¼Œåˆä¸ä¼šæœ‰é—®é¢˜ã€‚æ‰€ä»¥ä¸€å¼€å§‹æ€€ç–‘æ˜¯æŠŠæ­£åˆ™å¯¹è±¡å­˜èµ·æ¥å¯¼è‡´çš„ã€‚<img src="./a.png" width="150"></p><p>åé¢åœ¨ <a href="https://stackoverflow.com/questions/13586786/regexp-test-returns-different-result-for-same-str-depending-on-how-where-i" target="_blank" rel="noopener">stackoverflow</a>å’Œ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/RegExp/test#%E5%BD%93%E8%AE%BE%E7%BD%AE%E5%85%A8%E5%B1%80%E6%A0%87%E5%BF%97%E7%9A%84%E6%AD%A3%E5%88%99%E4%BD%BF%E7%94%A8test()" target="_blank" rel="noopener">MDN</a>ä¸Šæ‰¾åˆ°çœŸæ­£çš„åŸå› ã€‚</p><blockquote><p>å½“è®¾ç½®å…¨å±€æ ‡å¿—çš„æ­£åˆ™ä½¿ç”¨test()<br>å¦‚æœæ­£åˆ™è¡¨è¾¾å¼è®¾ç½®äº†å…¨å±€æ ‡å¿—ï¼Œtest() çš„æ‰§è¡Œä¼šæ”¹å˜æ­£åˆ™è¡¨è¾¾å¼   lastIndexå±æ€§ã€‚è¿ç»­çš„æ‰§è¡Œtest()æ–¹æ³•ï¼Œåç»­çš„æ‰§è¡Œå°†ä¼šä» lastIndex å¤„å¼€å§‹åŒ¹é…å­—ç¬¦ä¸²ï¼Œ(exec() åŒæ ·æ”¹å˜æ­£åˆ™æœ¬èº«çš„ lastIndexå±æ€§å€¼).</p></blockquote><p>è¿™æ„æ€å°±å¾ˆæ˜æ˜¾äº†ï¼Œæˆ‘ä»¬æ¯ä¸€æ¬¡æœç´¢åŒ¹é…ä¸­ä¹‹åï¼Œä¸‹æ¬¡å°±ä»ä»–çš„ä¸‹ä¸€ä½å¼€å§‹æ‰§è¡Œæœç´¢ã€‚<br><img src="./b.png"></p><p>æ‰€ä»¥æœ€åçœ‹ä¸šåŠ¡åœºæ™¯ï¼Œå®Œå…¨ä¸éœ€è¦åŠ è¿™ä¸ª<code>g</code>ï¼Œç›´æ¥å»æ‰å°±ç®—fixäº†ã€‚å½“ç„¶å¦‚æœä½ å¤´å¾ˆé“â€¦ä¸€å®šè¦åŠ gçš„è¯ï¼Œé‚£ä¹Ÿå¯ä»¥æ¯æ¬¡æ‰§è¡Œå®Œé‡ç½® lastIndexã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> r = <span class="regexp">/\S/g</span>;</span><br><span class="line">$input.addEventListener(<span class="string">'blur'</span>, (e)=&gt; &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">const</span> result = r.test(e.currentTarget.value);</span><br><span class="line">  <span class="keyword">if</span> (result) r.lastIndex = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p><em>last è°¢è°¢å¤§é’Šå­å’Œå¤å°‘ä¸¤ä½åŒäº‹</em></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ä»Šå¤©æµ‹è¯•æä¸€ä¸ªjiraç»™æˆ‘ï¼Œè¯´æœ‰ä¸€ä¸ªå¾ˆè¯¡å¼‚çš„bugï¼Œè¡¨å•éªŒè¯æœ‰æ—¶å€™ä¼šæˆåŠŸï¼Œæœ‰æ—¶å€™ä¼šå¤±è´¥ã€‚&lt;/p&gt;
&lt;video src=&quot;./a.mp4&quot; controls=&quot;true&quot;&gt;&lt;/video&gt;

&lt;p&gt;è€Œä¸”å¾ˆæœ‰è§„å¾‹æ€§çš„ï¼Œä¸¤ä¸‹æˆåŠŸï¼Œæ¥ç€å¤±è´¥ï¼Œå†ä¸¤ä¸‹æˆåŠŸï¼Œå†å¤±è´¥â€¦çœ‹ä»£ç ä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜
      
    
    </summary>
    
      <category term="technology" scheme="https://jsonz1993.github.io/categories/technology/"/>
    
    
      <category term="work" scheme="https://jsonz1993.github.io/tags/work/"/>
    
      <category term="JavaScript" scheme="https://jsonz1993.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>Reactæºç ç³»åˆ—</title>
    <link href="https://jsonz1993.github.io/2018/11/react-source/"/>
    <id>https://jsonz1993.github.io/2018/11/react-source/</id>
    <published>2018-11-10T16:39:52.000Z</published>
    <updated>2019-03-13T03:30:36.868Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://github.com/jsonz1993/react-source-learn" target="_blank" rel="noopener">react16 æºç é˜…è¯»å­¦ä¹ è®°å½•</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://github.com/jsonz1993/react-source-learn&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;react16 æºç é˜…è¯»å­¦ä¹ è®°å½•&lt;/a&gt;&lt;/p&gt;

      
    
    </summary>
    
      <category term="technology" scheme="https://jsonz1993.github.io/categories/technology/"/>
    
    
      <category term="github" scheme="https://jsonz1993.github.io/tags/github/"/>
    
      <category term="React" scheme="https://jsonz1993.github.io/tags/React/"/>
    
  </entry>
  
  <entry>
    <title>å‡½æ•°å¼ç¼–ç¨‹</title>
    <link href="https://jsonz1993.github.io/2018/09/fp/"/>
    <id>https://jsonz1993.github.io/2018/09/fp/</id>
    <published>2018-09-11T10:32:12.000Z</published>
    <updated>2019-03-13T03:30:36.848Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://ppt.baomitu.com/d/b063f5fc" target="_blank" rel="noopener">æœ¬æ–‡pptè¯·ç¬‘çº³</a></p><h1 id="å‡½æ•°å¼ç¼–ç¨‹"><a href="#å‡½æ•°å¼ç¼–ç¨‹" class="headerlink" title="å‡½æ•°å¼ç¼–ç¨‹"></a>å‡½æ•°å¼ç¼–ç¨‹</h1><p>ç»´åŸºç™¾ç§‘å¯¹å‡½æ•°å¼ç¼–ç¨‹çš„å®šä¹‰ï¼šå‡½æ•°å¼ç¼–ç¨‹ï¼ˆè‹±è¯­ï¼šfunctional programmingï¼‰æˆ–ç§°å‡½æ•°ç¨‹åºè®¾è®¡ï¼Œæ˜¯ä¸€ç§ç¼–ç¨‹å…¸èŒƒï¼Œå®ƒå°†è®¡ç®—æœºè¿ç®—è§†ä¸ºæ•°å­¦ä¸Šçš„å‡½æ•°è®¡ç®—ï¼Œå¹¶ä¸”é¿å…ä½¿ç”¨ç¨‹åºçŠ¶æ€ä»¥åŠæ˜“å˜å¯¹è±¡ã€‚è¿™é‡Œçš„å‡½æ•°æŒ‡çš„æ˜¯æ•°å­¦ä¸Šçš„å‡½æ•°ï¼Œæ—¢è‡ªå˜é‡ï¼ˆæ•°æ®ï¼‰çš„æ˜ å°„ã€‚</p><p>ä¸<code>å‘½ä»¤å¼ç¼–ç¨‹</code>å¯¹æ¯”ï¼Œ<code>å‡½æ•°å¼ç¼–ç¨‹</code>æ›´åŠ å¼ºè°ƒ<strong>ç¨‹åºæ‰§è¡Œçš„ç»“æœ</strong>è€Œé<strong>æ‰§è¡Œçš„è¿‡ç¨‹</strong>ï¼Œå€¡å¯¼åˆ©ç”¨è‹¥å¹²ç®€å•çš„æ‰§è¡Œå•å…ƒ(å°å‡½æ•°)è®©è®¡ç®—ç»“æœä¸æ–­æ¸è¿›ï¼Œé€å±‚æ¨å¯¼å¤æ‚çš„è¿ç®—ï¼Œè€Œä¸æ˜¯è®¾è®¡ä¸€ä¸ªå¤æ‚çš„æ‰§è¡Œè¿‡ç¨‹ã€‚</p><p>æˆ‘çš„ç†è§£æ˜¯ï¼Œä»¥çº¯å‡½æ•°ï¼ˆ é¿å…ä½¿ç”¨ç¨‹åºçŠ¶æ€ä»¥åŠå¼‚å˜å¯¹è±¡ï¼‰ä¸ºå•å…ƒï¼Œå»æŠ½è±¡ã€æ‹†åˆ†æ¨¡å—åŠŸèƒ½çš„ç¼–ç¨‹æ€æƒ³ã€‚å…¶å®å‡½æ•°å¼ç¼–ç¨‹æˆ‘ä»¬å¹³æ—¶ä¸é™Œç”Ÿï¼Œæ¯”å¦‚react, redux éƒ½å¤šå¤šå°‘å°‘æœ‰ä¸€äº›ç›¸å…³ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å¾—å‡ºå‡ ä¸ªå‡½æ•°å¼ç¼–ç¨‹çš„è¦ç‚¹ï¼š</p><ol><li>é¿å…ä½¿ç”¨ç¨‹åºçŠ¶æ€ä»¥åŠå¼‚å˜å¯¹è±¡ï¼Œæ•°æ®æ˜ å°„=&gt; çº¯å‡½æ•°</li><li>å¼ºè°ƒæ‰§è¡Œç»“æœè€Œéè¿‡ç¨‹=&gt; å£°æ˜å¼</li></ol><h1 id="çº¯å‡½æ•°"><a href="#çº¯å‡½æ•°" class="headerlink" title="çº¯å‡½æ•°"></a>çº¯å‡½æ•°</h1><p>çº¯å‡½æ•°ï¼šè¾“å‡ºç»“æœåªç”±è¾“å…¥å†³å®šï¼Œå¹¶ä¸”ä¸äº§ç”Ÿå‰¯ä½œç”¨(effects)ã€‚ </p><ol><li>é¿å…ä½¿ç”¨ thisï¼Œwindow ç­‰å¤–éƒ¨å˜é‡</li><li>æ²¡æœ‰äº§ç”Ÿå‰¯ä½œç”¨(Effects)ï¼Œæ—¢æŠŠEffectsæŠ½ç¦»å‡ºæ¥</li></ol><blockquote><p>Effectsæœ‰å“ªäº›å‘¢ï¼Ÿ<br>æ¯”å¦‚ æ”¹åŠ¨å¤–éƒ¨æ•°æ®ï¼Œå‘èµ·ajaxè¯·æ±‚ï¼Œæ”¹åŠ¨domç­‰ç­‰ã€‚<br>å†™è¿‡dvaçš„å°±çŸ¥é“ï¼Œdvaçš„modelæœ‰ä¸€ä¸ªeffectsï¼Œå°±æ˜¯ç”¨æ¥æ”¾è¿™äº›å‰¯ä½œç”¨çš„ä»£ç ã€‚</p></blockquote><p>æˆ‘ä»¬æŠŠEffectsåˆ†ç¦»å‡ºæ¥ä¹‹åï¼Œå‰©ä¸‹çš„å°±æ˜¯çº¯å‡½æ•°ï¼Œçº¯å‡½æ•°å¯ä»¥å¾ˆç®€å•çš„è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œæ‰€ä»¥æ˜¯ä¸å®¹æ˜“å‡ºbugçš„ï¼Œå› ä¸ºå¾€å¾€æœ‰bugçš„éƒ½æ˜¯ä¸å¯é¢„è§çš„éƒ¨åˆ†ã€‚</p><p>ä¸¾ä¸ªä¾‹å­<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr=[<span class="string">'bilibili'</span>, <span class="string">'hello'</span>, <span class="string">'jsonz'</span>];</span><br><span class="line">arr.slice(<span class="number">1</span>, <span class="number">3</span>); <span class="comment">// æ²¡å‰¯ä½œç”¨</span></span><br><span class="line">arr.splice(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// æœ‰å‰¯ä½œç”¨ï¼Œä¿®æ”¹åˆ°åŸæ¥çš„arræ•°ç»„ å¯èƒ½ä¼šé€ æˆæ„æƒ³ä¸åˆ°çš„bug</span></span><br></pre></td></tr></table></figure></p><p>è™½ç„¶æ‰§è¡Œä¹‹åï¼Œéƒ½èƒ½å¾—åˆ° <code>Hello Jsonz</code>ã€‚ ä½†æ˜¯ splice ä¼šæ”¹åŠ¨åˆ°åŸæ¥çš„æ•°ç»„ï¼Œæ‰€ä»¥ä¸ç®—çº¯å‡½æ•°ã€‚</p><p>å·¥ä½œä¸­å…¶å®å¾ˆå¤šå·¥å…·ç±»çš„functionéƒ½æ˜¯çº¯å‡½æ•°ï¼Œreduxçš„Reducerä¹Ÿæ˜¯æ ‡å‡†çš„çº¯å‡½æ•°ã€‚</p><p>redux reducers<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">set</span>(<span class="params">state, &#123; payload &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    ...state,</span><br><span class="line">    ...payload,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>çº¯å‡½æ•°çš„å¥½å¤„æ˜¯ï¼Œä½ ä¸éœ€è¦æ‹…å¿ƒæŸä¸ªå€¼åœ¨æŸå¤„å‘é€æ„æƒ³ä¸åˆ°çš„æ”¹å˜å¯¼è‡´å‡ºbugï¼›çº¯å‡½æ•°é‡Œä¸äº§ç”Ÿå‰¯ä½œç”¨ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šæ‹…å¿ƒæ”¹åŠ¨åˆ°å…¶ä»–åœ°æ–¹ï¼Œä»£ç æ›´å¥ç¡•ï¼›å¯ä»¥æ›´ä¼˜é›…çš„ç»„åˆå¤ç”¨ï¼Œæ–¹ä¾¿ç§»æ¤åˆ°å…¶ä»–ç¯å¢ƒ(web workers)ï¼›æ–¹ä¾¿çš„å†™å•å…ƒæµ‹è¯•ã€‚</p><h1 id="å£°æ˜å¼"><a href="#å£°æ˜å¼" class="headerlink" title="å£°æ˜å¼"></a>å£°æ˜å¼</h1><p>åœ¨è¯´å£°æ˜å¼ä¹‹å‰ï¼Œè¦å…ˆæ™®åŠä¸€ä¸‹ä¸ä¹‹å¯¹åº”çš„å‘½ä»¤å¼ï¼ˆæŒ‡ä»¤å¼ï¼‰ã€‚<br>æˆ‘ä»¬å¹³æ—¶å†™çš„ä»£ç åŸºæœ¬éƒ½æ˜¯å‘½ä»¤å¼ï¼Œæ—¢æˆ‘ä»¬é€šè¿‡ä¸€æ¡ä¸€æ¡çš„å‘½ä»¤å»æ‰§è¡Œä¸€äº›æ“ä½œï¼Œå…¶ä¸­ä¼šæ¶‰åŠåˆ°å¾ˆå¤šç»†èŠ‚çš„ä¸œè¥¿ã€‚<br>æ—¢å…³æ³¨æ‰§è¡Œè¿‡ç¨‹ï¼Œç”¨å„ç§æ§åˆ¶è¯­å¥<code>if...else...</code>ä¸<code>for</code>å¾ªç¯ç­‰ã€‚</p><p><strong>å‘½ä»¤å¼ç¼–ç¨‹ï¼šå‘½ä»¤â€œæœºå™¨â€å¦‚ä½•å»åšäº‹æƒ…(how)ï¼Œè¿™æ ·ä¸ç®¡ä½ æƒ³è¦çš„æ˜¯ä»€ä¹ˆ(what)ï¼Œå®ƒéƒ½ä¼šæŒ‰ç…§ä½ çš„å‘½ä»¤å®ç°ã€‚</strong><br><strong>å£°æ˜å¼ç¼–ç¨‹ï¼šå‘Šè¯‰â€œæœºå™¨â€ä½ æƒ³è¦çš„æ˜¯ä»€ä¹ˆ(what)ï¼Œè®©æœºå™¨æƒ³å‡ºå¦‚ä½•å»åš(how)ã€‚</strong></p><blockquote><p>SQLè¯­å¥æ˜¯å…¸å‹å£°æ˜å¼ï¼ŒSQLå­˜å‚¨è¿‡ç¨‹å’Œå­˜å‚¨å‡½æ•°åˆ™æ˜¯å‘½ä»¤å¼ç¼–ç¨‹ã€‚</p></blockquote><figure class="highlight javascript"><figcaption><span>reacté‡Œé¢çš„ä¸¤ç§ç¼–ç¨‹æ–¹å¼</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‡½æ•°å¼ç¼–ç¨‹</span></span><br><span class="line"><span class="keyword">const</span> data= [&#123;<span class="attr">name</span>: <span class="string">'jsonz'</span>, <span class="attr">age</span>: <span class="number">2</span>&#125;, &#123; <span class="attr">name</span>: <span class="string">'balala'</span>, <span class="attr">age</span>: <span class="number">3</span>&#125;, &#123; <span class="attr">name</span>: <span class="string">'å°é­”ä»™'</span>, <span class="attr">age</span>: <span class="number">30</span>&#125;];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> dom = data.filter(<span class="function"><span class="params">item</span>=&gt;</span> age&lt;<span class="number">10</span>)</span><br><span class="line">  .map(<span class="function"><span class="params">item</span>=&gt;</span> &lt;span&gt;&#123;item.name&#125; - &#123;item.age&#125;&lt;span&gt;); <span class="comment">// è¿™é‡Œåé¢çš„spanæ˜¯é—­åˆçš„&lt;/span&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘½ä»¤å¼ç¼–ç¨‹</span></span><br><span class="line"><span class="keyword">const</span> data= [&#123;<span class="attr">name</span>: <span class="string">'jsonz'</span>, <span class="attr">age</span>: <span class="number">2</span>&#125;, &#123; <span class="attr">name</span>: <span class="string">'balala'</span>, <span class="attr">age</span>: <span class="number">3</span>&#125;, &#123; <span class="attr">name</span>: <span class="string">'å°é­”ä»™'</span>, <span class="attr">age</span>: <span class="number">30</span>&#125;];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> newData = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i= <span class="number">0</span>; i&lt; data.length; i++) &#123;</span><br><span class="line">  <span class="keyword">if</span> (data[i].age &lt; <span class="number">10</span>) &#123;</span><br><span class="line">    newData.push(data);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> dom2 = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i= <span class="number">0</span>; i&lt; newData.length; i++) &#123;</span><br><span class="line">  dom2.push(<span class="string">`&lt;span&gt;<span class="subst">$&#123;item.name&#125;</span>-<span class="subst">$&#123;item.age&#125;</span>&lt;span&gt;`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹å‡ºå£°æ˜å¼çš„ä»£ç æ›´åŠ ç®€æ´æ¸…æ™°ä¼˜é›…ã€‚</p><figure class="highlight javascript"><figcaption><span>å£°æ˜å¼ä»£ç å¤ç”¨</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŒå€</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">double</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> results = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i&lt; arr.length; i++) &#123;</span><br><span class="line">    results.push(arr[i] * <span class="number">2</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> results;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// +1</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addOne</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> results = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i&lt; arr.length; i++) &#123;</span><br><span class="line">    results.push(arr[i] +<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> results;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜å¼: å»é‡å¤ä»£ç ï¼Œç®€æ´</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">double</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> arr.map(<span class="function"><span class="params">item</span>=&gt;</span> item*<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addOne</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> arr.map(<span class="function"><span class="params">item</span>=&gt;</span> item+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜å¼ç©¶æç‰ˆï¼š å€ŸåŠ© Ramda</span></span><br><span class="line"><span class="keyword">const</span> m= _.curry(<span class="function">(<span class="params">fn, arr</span>) =&gt;</span> arr.map(<span class="function"><span class="params">item</span>=&gt;</span> fn(item)));</span><br><span class="line"><span class="keyword">const</span> double = m(<span class="function"><span class="params">item</span>=&gt;</span> item*<span class="number">2</span>);</span><br><span class="line"><span class="keyword">const</span> addOne = m(<span class="function"><span class="params">item</span>=&gt;</span> item+<span class="number">1</span>);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºä¸€äº›å‡½æ•°å¼æœ€ç®€å•çš„æ€è·¯ï¼š<br>æŠŠå¾ªç¯å’Œåˆ¤æ–­ç­‰æ§åˆ¶è¯­å¥å°½å¯èƒ½æ¢æˆ<code>ç­›é€‰ filter</code>ã€<code>æ˜ å°„ map</code>ã€<code>åŒ–çº¦ reduce</code>ã€‚</p><figure class="highlight javascript"><figcaption><span>cookieè·å–</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// å‘½ä»¤å¼</span></span><br><span class="line"><span class="comment">// è·å–cookie</span></span><br><span class="line"><span class="keyword">var</span> _cookie = <span class="built_in">document</span>.cookie;</span><br><span class="line"><span class="comment">// cookie çš„å½¢å¼æ˜¯å­—ç¬¦ä¸² "key1=value1; key2=value2; "; æŠŠä»–è½¬å˜æˆæ•°ç»„å½¢å¼ ["key1=value1", "key2=value2"]ã€‚ ç”¨ "; "ä½œä¸ºåˆ†éš”ç¬¦</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> _cookieArray = _cookie.split(<span class="string">'; '</span>);</span><br><span class="line"><span class="comment">// å¾ªç¯æŠŠæ•°ç»„é‡Œé¢çš„ key1=value1å˜æˆå¯¹è±¡objçš„keyå’Œvalue æ–¹ä¾¿è·å–</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i= <span class="number">0</span>; i&lt; _cookieArray.length; i++) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å–å‡ºcookieæ•°ç»„é‡Œé¢çš„å•ä¸ª:  key1=value1</span></span><br><span class="line">    <span class="keyword">var</span> cookieItem = _cookieArray[i];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŠŠè¿™ä¸ªå­—ç¬¦ä¸²key1= value1 å˜æ¢æˆæ•°ç»„ [key1, value1]ï¼Œç”¨ "=" åšä¸ºåˆ†å‰²ç¬¦</span></span><br><span class="line">    <span class="keyword">var</span> cookieItemArray = cookieItem.split(<span class="string">'='</span>); <span class="comment">// [key1, value1]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŠŠåˆ†å‰²å¥½çš„æ•°ç»„ï¼Œèµ‹å€¼ç»™obj  </span></span><br><span class="line">    <span class="keyword">var</span> key = cookieItemArray[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">var</span> value = cookieItemArray[<span class="number">1</span>];</span><br><span class="line">    obj[key] = value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°å¼</span></span><br><span class="line"><span class="built_in">document</span>.cookie.split(<span class="string">'; '</span>)</span><br><span class="line">    .map(<span class="function"><span class="params">item</span>=&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> [key, value] = item.split(<span class="string">'='</span>);</span><br><span class="line">        <span class="keyword">return</span> &#123;key, value&#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">    .reduce(<span class="function">(<span class="params">acc, cur</span>)=&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; key, value &#125; = cur;</span><br><span class="line">        acc[key] = value;</span><br><span class="line">        <span class="keyword">return</span> acc;</span><br><span class="line">    &#125;, &#123;&#125;);</span><br></pre></td></tr></table></figure><h1 id="ç»¼åˆ-çº¯å‡½æ•°-å£°æ˜å¼"><a href="#ç»¼åˆ-çº¯å‡½æ•°-å£°æ˜å¼" class="headerlink" title="ç»¼åˆ çº¯å‡½æ•° + å£°æ˜å¼"></a>ç»¼åˆ çº¯å‡½æ•° + å£°æ˜å¼</h1><p>è¯¥éƒ¨åˆ†æºä»£ç å¯ä»¥çœ‹è¿™ä¸ªä»“åº“ ( â˜‰_â˜‰)â‰¡â˜oâ”€â”€â”€â”€â˜…Â°<a href="https://github.com/jsonz1993/wheel/tree/master/fq-demo" target="_blank" rel="noopener">ä»“åº“åœ°å€</a></p><figure class="highlight javascript"><figcaption><span>æ±‚å®Œç¾æ•°</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  å®Œå…¨æ•°ï¼ˆPerfect numberï¼‰ï¼Œåˆç§°å®Œç¾æ•°æˆ–å®Œå¤‡æ•°ï¼Œæ˜¯ä¸€äº›ç‰¹æ®Šçš„è‡ªç„¶æ•°ã€‚ å®ƒæ‰€æœ‰çš„çœŸå› å­ï¼ˆå³é™¤äº†è‡ªèº«ä»¥å¤–çš„çº¦æ•°ï¼‰çš„å’Œï¼ˆå³å› å­å‡½æ•°ï¼‰ï¼Œæ°å¥½ç­‰äºå®ƒæœ¬èº«</span></span><br><span class="line"><span class="comment">// æ¯”å¦‚ 6 = 1 + 2 + 3 æ˜¯å®Œç¾æ•°; 8 != 1 + 2 + 4 ä¸æ˜¯å®Œç¾æ•°</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">let</span> num = <span class="number">6</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">isPerfect</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> aliquotSum() === num;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">isFactor</span>(<span class="params">potential</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num % potential === <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getFactors</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> arr = [];</span><br><span class="line"></span><br><span class="line">    arr.push(<span class="number">1</span>); </span><br><span class="line">    arr.push(num);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i= <span class="number">2</span>; i&lt; num; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (isFactor(i)) arr.push(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">aliquotSum</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">const</span> factors = getFactors(num);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i= <span class="number">0</span>; i&lt; factors.length; i++) &#123;</span><br><span class="line">      sum += factors[i];</span><br><span class="line">    &#125;</span><br><span class="line">    sum -= num;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> result = isPerfect();</span><br><span class="line">  <span class="built_in">console</span>.log(result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘å‡½æ•°å¼é æ‹¢</span></span><br><span class="line"><span class="comment">// 1. å°† num å˜ä¸ºä¼ å‚ è€Œä¸æ˜¯å¤–éƒ¨çŠ¶æ€</span></span><br><span class="line"><span class="comment">// 2. ä½¿å¾—æ‰€æœ‰æ–¹æ³•éƒ½å˜ä¸ºçº¯å‡½æ•°</span></span><br><span class="line"><span class="comment">// 3. çœŸå› å­ç›¸åŠ æ”¹ä¸ºå‡½æ•°å¼å†™æ³•</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">isPerfect</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> aliquotSum(num) === num;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">isFactor</span>(<span class="params">num, potential</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num % potential === <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getFactors</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="built_in">Array</span>(num), (item, i)=&gt; i)</span><br><span class="line">      .filter(<span class="function"><span class="params">v</span>=&gt;</span> isFactor(num, v));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">aliquotSum</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">const</span> factors = getFactors(num);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i= <span class="number">0</span>; i&lt; factors.length; i++) &#123;</span><br><span class="line">      sum += factors[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> result = isPerfect(<span class="number">6</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç©¶æç‰ˆ</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">const</span> aliquotSum = <span class="function"><span class="params">num</span>=&gt;</span> <span class="built_in">Array</span>.from(<span class="built_in">Array</span>(num), (item, i)=&gt; i)</span><br><span class="line">    .filter(<span class="function"><span class="params">item</span>=&gt;</span> num % item === <span class="number">0</span>)</span><br><span class="line">    .reduce(<span class="function">(<span class="params">cur, next</span>)=&gt;</span> cur += next);</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">isPerfect</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> aliquotSum(num) === num;</span><br><span class="line">  &#125;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">const</span> result = isPerfect(<span class="number">6</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢éƒ½æ˜¯æ¯”è¾ƒå°çš„å·¥å…·demoï¼ŒåŸºæœ¬ä¸Šä¸åŒ…å«Effectsï¼Œä½†æ˜¯å®é™…ä¸Šé¡¹ç›®å……æ–¥ä¸€å †ä¸šåŠ¡é€»è¾‘(Effects)ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¼šå€ŸåŠ©ä¸€äº›å·¥å…·/åº“æ¥å®ç°,æ¯”å¦‚ <code>ramda.js</code>å’Œ<code>rx.js</code>ã€‚</p><blockquote><p><code>rxJs</code> å®˜ç½‘çš„æè¿°æ˜¯ Reactive Extensions Library for JavaScriptç®€å•æ¥è¯´RxJSå°±æ˜¯è¾…åŠ©æˆ‘ä»¬å†™å‡ºå‡½æ•°å¼å“åº”å¼ä»£ç çš„ä¸€ç§å·¥å…·ã€‚</p></blockquote><p>æˆ‘ä»¬ç°åœ¨æ¥å®ç°ä¸€ä¸ªåŠŸèƒ½ï¼Œé¡µé¢ä¸Šæœ‰ä¸€ä¸ªæŒ‰é’®ï¼Œç‚¹å‡»ä¹‹åè¾“å‡ºè®¡æ•°<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ™®é€šç‰ˆæœ¬</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">const</span> button = <span class="built_in">document</span>.querySelector(<span class="string">'#button'</span>);</span><br><span class="line">  button.addEventListener(<span class="string">'click'</span>, ()=&gt; &#123;</span><br><span class="line">    count += <span class="number">1</span>; <span class="comment">// ç”¨åˆ°å¤–éƒ¨å˜é‡</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`clicked!<span class="subst">$&#123;count&#125;</span> times`</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// RxJsç‰ˆæœ¬</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">const</span> &#123; fromEvent, <span class="attr">operators</span>: &#123; scan, &#125; &#125; = rxjs;</span><br><span class="line"> <span class="keyword">const</span> button = <span class="built_in">document</span>.querySelector(<span class="string">'#button'</span>);</span><br><span class="line"></span><br><span class="line"> fromEvent(button, <span class="string">'click'</span>)</span><br><span class="line">  .pipe(</span><br><span class="line">    <span class="comment">// scan éšç€æ—¶é—´çš„æ¨ç§»è¿›è¡Œå½’å¹¶ã€‚</span></span><br><span class="line">    scan(<span class="function">(<span class="params">count</span>)=&gt;</span> count+ <span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">  )</span><br><span class="line">  .subscribe(<span class="function"><span class="params">count</span>=&gt;</span> <span class="built_in">console</span>.log(<span class="string">`clicked! <span class="subst">$&#123;count&#125;</span> times`</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>èŠ‚æµå’Œç´¯åŠ ç‚¹å‡»åæ ‡<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">const</span> button = <span class="built_in">document</span>.querySelector(<span class="string">'#button'</span>);</span><br><span class="line">  <span class="keyword">const</span> rate = <span class="number">1000</span>;</span><br><span class="line">  <span class="keyword">let</span> lastClick = <span class="built_in">Date</span>.now() - rate;</span><br><span class="line">  button.addEventListener(<span class="string">'click'</span>, (e)=&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Date</span>.now() - lastClick &gt;= rate) &#123;</span><br><span class="line">      count += e.clientX;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">`clicked!<span class="subst">$&#123;count&#125;</span> times`</span>);</span><br><span class="line">      lastClick = <span class="built_in">Date</span>.now();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">const</span> &#123; fromEvent, <span class="attr">operators</span>: &#123; scan, throttleTime, map &#125; &#125; = rxjs;</span><br><span class="line"> <span class="keyword">const</span> button = <span class="built_in">document</span>.querySelector(<span class="string">'#button'</span>);</span><br><span class="line"></span><br><span class="line"> fromEvent(button, <span class="string">'click'</span>)</span><br><span class="line">  .pipe(</span><br><span class="line">    throttleTime(<span class="number">1000</span>),</span><br><span class="line">    map(<span class="function"><span class="params">e</span>=&gt;</span> e.clientX),</span><br><span class="line">    scan(<span class="function">(<span class="params">count, clientX</span>)=&gt;</span> count+ clientX, <span class="number">0</span>)</span><br><span class="line">  )</span><br><span class="line">  .subscribe(<span class="function"><span class="params">count</span>=&gt;</span> <span class="built_in">console</span>.log(<span class="string">`clicked! <span class="subst">$&#123;count&#125;</span> times`</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨<code>Ramda.js</code>æ¥å®ç°ä¸€ä¸ªé¡µé¢ï¼Œè·å–æŸä¸ªå…³é”®å­—å›¾ç‰‡ï¼Œå¹¶å±•ç¤ºå‡ºæ¥ã€‚<code>Ramda</code>ä¸»è¦å¸®å¿™å®ç°ä¸€äº› <code>curry</code>, <code>compose</code> ç­‰åŠŸèƒ½</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">requirejs.config(&#123;</span><br><span class="line">  paths: &#123;</span><br><span class="line">    ramda: <span class="string">'https://cdnjs.cloudflare.com/ajax/libs/ramda/0.13.0/ramda.min'</span>,</span><br><span class="line">    jquery: <span class="string">'https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">require</span>([</span><br><span class="line">    <span class="string">'ramda'</span>,</span><br><span class="line">    <span class="string">'jquery'</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">_, $</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æˆ‘ä»¬æŠŠä¸çº¯çš„EffectsæŠ½å‡ºæ¥</span></span><br><span class="line">    <span class="keyword">const</span> Impure = &#123;</span><br><span class="line">      getJSON: _.curry(<span class="function">(<span class="params">callback, url</span>)=&gt;</span> $.getJSON(url, callback)),</span><br><span class="line"></span><br><span class="line">      setHtml: _.curry(<span class="function">(<span class="params">sel, html</span>)=&gt;</span> $(sel).html(html)),</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¼ å…¥url ç”Ÿæˆ img dom</span></span><br><span class="line">    <span class="keyword">const</span> img = <span class="function"><span class="keyword">function</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> $(<span class="string">'&lt;img /&gt;'</span>, &#123; <span class="attr">src</span>: url &#125;);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–ä¼ å…¥å‚æ•°çš„ media å±æ€§ï¼Œä»¥åŠè·å– mediaå±æ€§ä¸Šçš„ mã€‚ ç­‰ä»·äº arg.media.m</span></span><br><span class="line">    <span class="keyword">const</span> mediaUrl = _.compose(_.prop(<span class="string">'m'</span>), _.prop(<span class="string">'media'</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–ä¼ å…¥å‚æ•°çš„ item å±æ€§ï¼Œä»¥åŠå¯¹æ¯ä¸ªitemæ‰§è¡Œ mediaUrl å‡½æ•°</span></span><br><span class="line">    <span class="keyword">const</span> srcs = _.compose(_.map(mediaUrl), _.prop(<span class="string">'items'</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŠŠimgå’Œsrcså‡½æ•°æ•´åˆèµ·æ¥</span></span><br><span class="line">    <span class="keyword">const</span> images = _.compose(_.map(img), srcs);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> url = <span class="function"><span class="params">term</span>=&gt;</span> <span class="string">`https://api.flickr.com/services/feeds/photos_public.gne</span></span><br><span class="line"><span class="string">    ?tags=<span class="subst">$&#123;term&#125;</span>&amp;format=json&amp;jsoncallback=?`</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŠŠimgesè·å–åˆ°çš„å‚æ•°ä¼ ç»™ Impure.setHtml('body');</span></span><br><span class="line">    <span class="keyword">const</span> renderImages = _.compose(Impure.setHtml(<span class="string">'body'</span>), images);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŠŠæ‰€æœ‰å°å‡½æ•°æ•´åˆæˆä¸€ä¸ªå¤§çš„å‡½æ•°ï¼Œæˆ‘ä»¬åªéœ€è¦ç»™è¿™ä¸ªappå–‚æ•°æ®å³å¯</span></span><br><span class="line">    <span class="keyword">const</span> app = _.compose(Impure.getJSON(renderImages), url);</span><br><span class="line"></span><br><span class="line">    app(<span class="string">'cat'</span>);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¼˜åŒ–<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// old</span></span><br><span class="line">    <span class="keyword">const</span> mediaUrl = _.compose(_.prop(<span class="string">'m'</span>), _.prop(<span class="string">'media'</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> srcs = _.compose(_.map(mediaUrl), _.prop(<span class="string">'items'</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> images = _.compose(_.map(img), srcs);</span><br><span class="line">    </span><br><span class="line"><span class="comment">// new</span></span><br><span class="line">    <span class="keyword">const</span> mediaUrl = _.compose(_.prop(<span class="string">'m'</span>), _.prop(<span class="string">'media'</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> images = _.compose(_.map(img), _.map(mediaUrl), _.prop(<span class="string">'items'</span>));</span><br></pre></td></tr></table></figure></p><p>å†ä¼˜åŒ–<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> images = _.compose(_.map(_.compose(img, mediaUrl)), _.prop(<span class="string">'items'</span>));</span><br></pre></td></tr></table></figure></p><!-- ä¸¥æ ¼æ„ä¹‰ä¸Šçš„å‡½æ•°å¼ç¼–ç¨‹æ„å‘³ç€ä¸ä½¿ç”¨å¯å˜çš„å˜é‡ï¼Œèµ‹å€¼ï¼Œå¾ªç¯å’Œå…¶ä»–å‘½ä»¤å¼æ§åˆ¶ç»“æ„è¿›è¡Œç¼–ç¨‹ã€‚ç”±äºå‘½ä»¤å¼ç¼–ç¨‹è¯­è¨€ä¹Ÿå¯ä»¥é€šè¿‡ç±»ä¼¼å‡½æ•°æŒ‡é’ˆçš„æ–¹å¼æ¥å®ç°é«˜é˜¶å‡½æ•°ï¼Œå‡½æ•°å¼çš„æœ€ä¸»è¦çš„å¥½å¤„ä¸»è¦æ˜¯ä¸å¯å˜æ€§å¸¦æ¥çš„ã€‚æ²¡æœ‰å¯å˜çš„çŠ¶æ€ï¼Œå‡½æ•°å°±æ˜¯å¼•ç”¨é€æ˜ï¼ˆReferential transparencyï¼‰çš„å’Œæ²¡æœ‰å‰¯ä½œç”¨ã€‚å‡½æ•°å¼ç¼–ç¨‹æ˜¯ç»™è½¯ä»¶å¼€å‘è€…æä¾›çš„å¦ä¸€å¥—å·¥å…·ç®±ï¼Œä¸ºæˆ‘ä»¬æä¾›äº†å¦å¤–ä¸€ç§æŠ½è±¡å’Œæ€è€ƒçš„æ–¹å¼ã€‚  --><h1 id="å‡½æ•°å¼å’Œé¢å‘å¯¹è±¡å¯¹æ¯”"><a href="#å‡½æ•°å¼å’Œé¢å‘å¯¹è±¡å¯¹æ¯”" class="headerlink" title="å‡½æ•°å¼å’Œé¢å‘å¯¹è±¡å¯¹æ¯”"></a>å‡½æ•°å¼å’Œé¢å‘å¯¹è±¡å¯¹æ¯”</h1><p>é¢å‘å¯¹è±¡ç¼–ç¨‹æ€æƒ³ï¼Œ<code>å°è£…</code> <code>ç»§æ‰¿</code> <code>å¤šæ€</code>ã€‚</p><p>æŠŠçŠ¶æ€çš„æ”¹å˜å°è£…èµ·æ¥ï¼Œè®©ä»£ç æ›´åŠ æ¸…æ™°ï¼Œé€šè¿‡ç±»ä¸ç»§æ‰¿å»å¤„ç†å…³è”å…³ç³»ã€‚ä½†æ˜¯ä¼šå……æ»¡å…¬ç”¨å˜é‡ï¼Œ<code>this</code>ï¼Œ<code>bind</code>ç­‰ã€‚</p><p>é¢å‘å¯¹è±¡ç›®å‰æ›´åŠ å¹¿æ³›ï¼Œè€Œä¸”æ›´å®¹æ˜“è¢«æ¥å—ï¼Œå†™èµ·æ¥æ›´å®¹æ˜“ï¼Œä½†å¯èƒ½ä¼šæœ‰æ›´å¤šå†—ä½™çš„ä»£ç ï¼Œæ†ç»‘äº†å¾ˆå¤šçŠ¶æ€ï¼Œå…¸å‹çš„é—®é¢˜æ˜¯ <strong>ä½ åªéœ€è¦ä¸€ä¸ªé¦™è•‰ï¼Œä½†æ˜¯å´å¾—åˆ°ä¸€ä¸ªæ‹¿ç€é¦™è•‰çš„å¤§çŒ©çŒ©ä»¥åŠæ•´ä¸ªä¸›æ—ã€‚</strong></p><hr><p>å‡½æ•°å¼ç¼–ç¨‹æ€æƒ³ï¼Œå°½é‡å‡å°‘ä¸ç¡®å®šå› ç´ ï¼Œæ¥è®©ä»£ç æ›´åŠ æ¸…æ™°å¥ç¡•ã€‚</p><p>æ¯ä¸ªå‡½æ•°éƒ½ä¸è¦å»ä¿®æ”¹åŸæœ‰çš„æ•°æ®ï¼Œè€Œæ˜¯é€šè¿‡äº§ç”Ÿæ–°çš„æ•°æ®æ¥åšä¸ºè¿ç®—ç»“æœï¼Œ<em>è¿™ä¹Ÿæ„å‘³ç€å‡½æ•°å¼æ¯”è¾ƒè€—èµ„æºï¼Œæ‰€ä»¥åœ¨è®¡ç®—æœºçŸ³å™¨æ—¶ä»£å¹¶ä¸æµè¡Œ</em>ã€‚</p><p>ç®€å•æ¥è¯´å°±æ˜¯å¾ˆå¤šå°çš„çº¯å‡½æ•°ï¼Œä¸€ä¸ªå°å‡½æ•°åªåšä¸€äº›äº‹æƒ…ï¼Œç„¶åç”¨è¿™äº›å°å‡½æ•°æ¥ç»„ç»‡æˆæ›´å¤§çš„å‡½æ•°ï¼Œå‡½æ•°çš„å‚æ•°ä¸è¿”å›å€¼ä¹Ÿå¤§éƒ¨åˆ†éƒ½æ˜¯å‡½æ•°ã€‚<br>æœ€åèƒ½å¾—åˆ°ä¸€ä¸ªè¶…çº§ç‰›é€¼çš„å‡½æ•°ï¼Œæˆ‘ä»¬åªè¦æŠŠæ•°æ®ç»™ä»–ï¼Œå°±å¯ä»¥äº†ã€‚</p><p>å‡½æ•°å¼ç®€æ´ï¼Œæ¸…æ™°å¯å¤ç”¨æ€§é«˜ï¼Œå‡ºé”™å‡ ç‡æ›´å°ã€‚ä½†æ˜¯ä¸€å¼€å§‹æ€ç»´å¾ˆéš¾ä»é¢å‘å¯¹è±¡æˆ–å‘½ä»¤å¼è½¬æ¢è¿‡æ¥ï¼Œå¾€å¾€ä¹Ÿéœ€è¦å€ŸåŠ©ä¸€äº›å·¥å…·åº“æ¥ç¼–å†™ã€‚</p><h1 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h1><p>è¿™é‡Œåªæäº†å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€äº›æ€æƒ³ï¼Œä½†æ˜¯çœŸæ­£å‡½æ•°å¼å¼€å‘è¿˜åŒ…å«å¾ˆå¤šå…¶ä»–è¦å­¦çš„ã€‚æ¯”å¦‚æˆ‘ä»¬ç”¨åˆ°çš„<code>æŸ¯é‡ŒåŒ–curry</code>è¿˜æœ‰<code>ä»£ç ç»„åˆcompose</code>ç­‰ï¼Œå…‰<code>RxJs</code>æä¾›çš„apiå°±æœ‰179ä¸ªä¹‹å¤šâ€¦</p><p>å†è€…ä¸çŸ¥é“æ˜¯ä¸æ˜¯å¯¹å‡½æ•°å¼çš„ç†è§£ä¸å¤Ÿé€å½»ï¼Œæœ‰è¯•è¿‡æŸä¸ªéœ€æ±‚ç”¨å‡½æ•°å¼çš„æ€æƒ³å»å†™ï¼Œä½†æ˜¯æœ‰ç‚¹å¥½åƒç¡¬æ°çš„æ ·å­ï¼Œå†™çš„æœ‰ç‚¹ä¸ä¼¦ä¸ç±»â€¦.æ‰€ä»¥ç°åœ¨åªæ˜¯å¸æ”¶ä¸€äº›å‡½æ•°å¼çš„æ€æƒ³ï¼ˆæ¯”å¦‚çº¯å‡½æ•°å‡å°‘ä¸ç¡®å®šæ€§ï¼‰ï¼Œä½†æ˜¯å¹³æ—¶å·¥ä½œä¸ä¼šå¾ˆåˆ»æ„å…¨éƒ¨éƒ½ç”¨å‡½æ•°å¼å»å†™ã€‚åªæ˜¯å½“æˆä¸€ä¸ªå¯ä»¥æ‰©å±•çš„çŸ¥è¯†é¢ï¼Œåé¢å¦‚æœå‡½æ•°å¼çœŸçš„åœ¨å‰ç«¯æµè¡Œèµ·æ¥ï¼Œå†ä¸Šæ‰‹ä¹Ÿä¸è¿Ÿã€‚</p><p>é¡ºè·¯æ„Ÿæ…¨JSçš„çµæ´»æ€§ï¼Œæ—¢æœ‰ES6é¢å‘å¯¹è±¡çš„ç‰¹æ€§<code>class</code>ä¹Ÿæœ‰ES5çš„ <code>filter</code>ã€<code>map</code>ã€<code>reduce</code>ï¼Œä»¥åŠES.Nextçš„è£…é¥°å™¨(Decorator)ç­‰å‡½æ•°å¼ç¼–ç¨‹çš„ç‰¹æ€§ã€‚</p><p>æœ€åå†ç»™å‡ºå‚è€ƒçš„ä»¥åŠå­¦ä¹ è¿‡ç¨‹çœ‹åˆ°çš„ä¸€äº›ä¸é”™çš„ä¹¦ç±å’Œæ–‡ç« :</p><p><a href="https://www.gitbook.com/book/llh911001/mostly-adequate-guide-chinese" target="_blank" rel="noopener">JS å‡½æ•°å¼ç¼–ç¨‹æŒ‡å—</a><br><a href="https://www.amazon.cn/dp/B07CXZ9D8N/ref=sr_1_1?ie=UTF8&amp;qid=1535945880&amp;sr=8-1&amp;keywords=%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BARxjs" target="_blank" rel="noopener">æ·±å…¥æµ…å‡ºRxjs</a><br><a href="https://www.amazon.cn/dp/B014SCOQA0/ref=sr_1_1?ie=UTF8&amp;qid=1535945728&amp;sr=8-1&amp;keywords=%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%E6%80%9D%E7%BB%B4" target="_blank" rel="noopener">å‡½æ•°å¼ç¼–ç¨‹æ€ç»´</a><br><a href="https://juejin.im/post/5950b0c56fb9a06bca0b7c04" target="_blank" rel="noopener">å‘½ä»¤å¼ã€å£°æ˜å¼ã€é¢å‘å¯¹è±¡ã€å‡½æ•°å¼ã€æ§åˆ¶åè½¬ä¹‹åå±±è®ºå‰‘ï¼ˆä¸Šï¼‰</a><br><a href="https://github.com/ReactiveX/rxjs" target="_blank" rel="noopener">RxJs å“åº”å¼ä»£ç åº“</a><br><a href="https://github.com/ramda/ramda" target="_blank" rel="noopener">Ramda å‡½æ•°å¼å·¥å…·åº“</a><br><a href="https://www.haskell.org/" target="_blank" rel="noopener">Haskell çº¯å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€</a><br><a href="https://www.zhihu.com/question/28292740" target="_blank" rel="noopener">ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹æ€ç»´</a><br><a href="http://pinggod.com/2016/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%E6%9C%AF%E8%AF%AD%E8%A7%A3%E6%9E%90/" target="_blank" rel="noopener">å‡½æ•°å¼ç¼–ç¨‹æœ¯è¯­è§£æ</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://ppt.baomitu.com/d/b063f5fc&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æœ¬æ–‡pptè¯·ç¬‘çº³&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;å‡½æ•°å¼ç¼–ç¨‹&quot;&gt;&lt;a href=&quot;#å‡½æ•°å¼ç¼–ç¨‹&quot; class=&quot;heade
      
    
    </summary>
    
      <category term="technology" scheme="https://jsonz1993.github.io/categories/technology/"/>
    
    
      <category term="learn" scheme="https://jsonz1993.github.io/tags/learn/"/>
    
      <category term="JavaScript" scheme="https://jsonz1993.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>ä¸€é“èµ‹å€¼é¢è¯•é¢˜å¼•å‘çš„æ€è€ƒ</title>
    <link href="https://jsonz1993.github.io/2018/07/circular-reference/"/>
    <id>https://jsonz1993.github.io/2018/07/circular-reference/</id>
    <published>2018-07-30T17:00:14.000Z</published>
    <updated>2019-03-13T03:30:36.840Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬ç¯‡ä¸»è¦è¯´ä¸€äº›åŸºç¡€çŸ¥è¯†ç‚¹ï¼Œå…³äºå¤šé¡¹èµ‹å€¼é¡ºåºï¼Œå¯¹è±¡å¼•ç”¨ç­‰ï¼ŒæœŸé—´æ’å…¥ä¸€ç‚¹es6åªæ˜¯ä»¥åŠè§£å†³é—®é¢˜çš„æ€è·¯ã€‚</p><p>å¼€å¤´å…ˆæ¥åšä¸€é“é¢è¯•é¢˜</p><h2 id="part1"><a href="#part1" class="headerlink" title="part1"></a>part1</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a=&#123;<span class="attr">n</span>:<span class="number">1</span>&#125;;</span><br><span class="line"><span class="keyword">var</span> b=a;</span><br><span class="line">a.x=a=&#123;<span class="attr">n</span>:<span class="number">2</span>&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(a.x);</span><br><span class="line"><span class="built_in">console</span>.log(b.x);</span><br></pre></td></tr></table></figure><p>æœ€åè¾“å‡ºçš„æ˜¯ä»€ä¹ˆï¼Ÿ å…ˆä¸è¯´ç­”æ¡ˆï¼Œæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹</p><p>L2(ç¬¬äºŒè¡Œ) æˆ‘ä»¬æŠŠaèµ‹å€¼ç»™bï¼Œ ç”±äºaæ˜¯å¯¹è±¡ç±»å‹ï¼Œè¿™å°±æ„å‘³ç€bå’ŒaæŒ‡å‘åŒä¸€ä¸ªå†…å­˜åœ°å€</p><p>L3 <code>a.x = a = { n: 2}</code></p><p>è¿™é‡Œæˆ‘ä»¬æœ‰ä¸ªç–‘æƒ‘ï¼Œè¿™å¥è¯­å¥æ‰§è¡Œé¡ºåºæ˜¯ <code>a = {n: 2} &amp;&amp; a.x = {n:2}</code> è¿˜æ˜¯ <code>a.x = {n:2} &amp;&amp; a= {n:2}</code> è¿˜æ˜¯è¿™ç§ <code>a = {n: 2} &amp;&amp; a.x = a</code></p><p>æˆ‘ä»¬è¿™é‡Œå¯ä»¥å€ŸåŠ© <code>Object.defineProperty</code> æˆ– ES6çš„ <code>Proxy</code>æ¥éªŒè¯å¤šé¡¹èµ‹å€¼çš„é¡ºåºæ˜¯æ€æ ·çš„</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</span><br><span class="line">  <span class="keyword">set</span>(target, key, value, r) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(key, value)</span><br><span class="line">    <span class="keyword">if</span> (key === <span class="string">'a'</span>) <span class="built_in">Reflect</span>.set(target, key, <span class="string">'isA'</span>, r);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">Reflect</span>.set(target, key, value, r);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">obj.b = obj.a= &#123;<span class="attr">n</span>: <span class="number">1</span>&#125;;</span><br><span class="line"><span class="comment">// è¾“å‡º:</span></span><br><span class="line"><span class="comment">// "a" &#123;n: 1&#125;</span></span><br><span class="line"><span class="comment">// "b" &#123;n: 1&#125;</span></span><br><span class="line"></span><br><span class="line">obj.a; <span class="comment">// isA</span></span><br><span class="line">obj.b; <span class="comment">// &#123;n: 1&#125;</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—å‡º èµ‹å€¼çš„é¡ºåºæ˜¯ä»å³è¾¹å¼€å§‹åˆ°å·¦è¾¹çš„ã€‚è€Œä¸”æ˜¯ç›´æ¥ <code>a = {n: 1}, a.x = {n:1 }</code>ï¼Œè€Œä¸æ˜¯ <code>a.x = a</code> è¿™æ ·å»èµ‹å€¼</p><p>ç°åœ¨æˆ‘ä»¬å†å€ŸåŠ© Proxy æ¥åˆ†æä¸€å¼€å§‹part1è¿™é“é¢˜ï¼Œç”¨obj.a, obj.b æ¥ä»£æ›¿åŸé¢˜ç›®çš„ aå’Œbã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</span><br><span class="line">  <span class="keyword">get</span>: function (target, key, receiver) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`getting <span class="subst">$&#123;key&#125;</span>!`</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Reflect</span>.get(target, key, receiver);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">set</span>: function (target, key, value, receiver) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`setting <span class="subst">$&#123;key&#125;</span>!`</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Reflect</span>.set(target, key, value, receiver);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">obj.a = &#123;<span class="attr">n</span>: <span class="number">1</span> &#125;;<span class="comment">// getting a;</span></span><br><span class="line">obj.b = obj.a; <span class="comment">// getting a; setting b;</span></span><br><span class="line">obj.a.x = obj.a = &#123;<span class="attr">n</span>:<span class="number">2</span> &#125;; <span class="comment">// getting a; setting a;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° <code>obj.a.x = obj.a = {n: 2}</code>è¿™æ®µè¯­å¥æ‰§è¡Œæ—¶ï¼Œä¼šå…ˆè¾“å‡ºä¸€ä¸ª <strong>getting a</strong> å†è¾“å‡º <strong>setting a</strong>ã€‚<br>è¿™å°±æ„å‘³ç€åœ¨å¯¹ <code>obj.a.x</code> èµ‹å€¼æ—¶ï¼Œç¨‹åºæ˜¯å…ˆè·å– <code>obj.a</code>æŒ‡å‘çš„å¯¹è±¡çš„å†…å­˜åœ°å€ï¼Œæ­¤æ—¶è§¦å‘äº† <strong>getting a</strong>ï¼Œç„¶åå†å¯¹å³è¾¹ <code>obj.a</code> è¿›è¡Œèµ‹å€¼ï¼Œè§¦å‘äº† <strong>setting a</strong>ï¼Œ èµ‹å€¼å®Œæœ€åä¸€æ­¥æ‰æ˜¯å¯¹ <code>obj.a.x</code>èµ‹å€¼ <code>{n:2 }</code>ã€‚</p><p><strong>é‡ç‚¹: åœ¨å¯¹obj.a.xèµ‹å€¼çš„æ—¶åˆ»å·²ç»è·å–äº†obj.aè¯¥å¯¹è±¡æŒ‡å‘çš„å†…å­˜åœ°å€ï¼Œæ‰€ä»¥åé¢aå°±ç®—æŒ‡å‘å…¶ä»–åœ°å€ï¼Œä¹Ÿå’Œè¿™é‡Œçš„obj.a.xæ— å…³ã€‚æ­¤æ—¶æŒ‡å‘è¯¥åœ°å€çš„è¿˜æœ‰obj.b</strong></p><p>æˆ‘ä»¬å†ç”¨ä¸‰å¼ å›¾æ¥æ‹ä¸€æ‹æ•´ç†çš„æ€è·¯</p><p>æ‰§è¡Œ <code>obj.a = {n: 1}; obj.b = obj.a</code>åobjå¯¹åº”çš„å¼•ç”¨æ˜¯è¿™æ ·çš„</p><p><image src="./init.png" width="600"><br><br><br></image></p><p>æ‰§è¡Œ <code>obj.a.x = xxx</code> æ—¶</p><p><image src="./obj.a.x.png" width="600"><br><br><br></image></p><p>æ‰§è¡Œ<code>obj.a.x = obj.a = {n:2}</code> å</p><p><image src="./result.png" width="600"><br><br><br></image></p><p>è‡³æ­¤ï¼Œè¿™é“é¢è¯•é¢˜ç›¸ä¿¡å¤§å®¶éƒ½æœ‰ç­”æ¡ˆäº†ï¼Œå¯ä»¥è‡ªå·±å»æ§åˆ¶å°éªŒè¯ä¸€ä¸‹ã€‚ å‡å¦‚è¿™æ—¶å€™å†æ‰§è¡Œ <code>obj.a.n = 3</code>ï¼Œ æ‰“å°<code>obj.b</code>ä¼šè¾“å‡ºä»€ä¹ˆå‘¢ï¼Ÿ</p><h2 id="part2"><a href="#part2" class="headerlink" title="part2"></a>part2</h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹å¦ä¸€é“é¢˜ï¼Œå…³äºå¯¹è±¡å¾ªç¯å¼•ç”¨çš„</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123; <span class="attr">n</span>: <span class="number">1</span>&#125;</span><br><span class="line">a.b = a;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„aæ˜æ˜¾æ˜¯å¾ªç¯å¼•ç”¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦æ€æ ·æ‰èƒ½åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯å¾ªç¯å¼•ç”¨å‘¢ï¼Ÿ</p><p>å…¶å®è¿™é“é¢˜æˆ‘ä¸€å¼€å§‹é™¤äº†é€’å½’åˆ¤æ–­å¤–æ²¡æœ‰å¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆï¼Œåé¢æ˜¯ç¾¤é‡Œä¸€ä¸ªå«<code>è¯è´¹</code>çš„å¤§ä½¬è¯´(è¿™é“é¢˜ä¹Ÿæ˜¯ä»–å‡ºçš„)ç›´æ¥ç”¨ <code>JSON.stringify</code>ï¼Œå¾®ä¿¡å°æ¸¸æˆçš„æºç é‡Œé¢å°±æ˜¯è¿™ä¹ˆå»åˆ¤æ–­ã€‚</p><p><code>JSON.stringify</code> å¦‚æœé‡åˆ°å‚æ•°é‡Œæœ‰å¾ªç¯å¼•ç”¨çš„ï¼Œå°±ä¼šæŠ›å‡ºä¸€ä¸ªå¾ªç¯è°ƒç”¨çš„é”™è¯¯ <strong>Uncaught TypeError: Converting circular structure to JSON</strong> </p><p>é‚£å¦‚æœä¸ç”¨JSON.stringifyæˆ–è€…æƒ³è¦è‡ªå·±å®ç°ä¸€ä¸ªå»æ£€æµ‹å¾ªç¯è°ƒç”¨ï¼Œè¯¥æ€ä¹ˆå†™å‘¢ï¼Ÿï¼ˆé¢è¯•å®˜å’Œéƒ¨é—¨å‰ç«¯leaderæœ€å–œæ¬¢è¿™ä¹ˆé—®ï¼‰</p><p>ä¸€èˆ¬é‡åˆ°è¿™ç§ï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯å»æ‰¾è¿™ä¸ªæ–¹æ³•çš„ polyfillï¼Œ <a href="https://github.com/bestiejs/json3" target="_blank" rel="noopener">json3</a>ã€‚æˆ‘æ‰¾çš„æ˜¯ json3çš„ polyfill é‡Œé¢å¤§æ¦‚æ˜¯éå†å¯¹è±¡å­˜åˆ°stackæ•°ç»„ï¼Œå†åœ¨è§£æçš„æ—¶å€™å»åˆ¤æ–­æ˜¯å¦æœ‰å¾ªç¯å¼•ç”¨çš„æƒ…å†µã€‚ <a href="https://github.com/bestiejs/json3/blob/master/lib/json3.js#L482" target="_blank" rel="noopener">json3.js#L482</a></p><p>ç…§ç€ä»–çš„æ€è·¯å¤§æ¦‚å†™äº†ä¸€ä¸ªï¼Œå…¶å®å°±æ˜¯å‰é¢è¯´åˆ°çš„ç®€å•é€’å½’åˆ¤æ–­<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> stack = [];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> len;</span><br><span class="line">    <span class="keyword">for</span> (len = stack.length; len--;) &#123;</span><br><span class="line">        <span class="keyword">if</span> (stack[len] === obj) <span class="keyword">throw</span> <span class="built_in">TypeError</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    stack.push(obj);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> k <span class="keyword">in</span> obj) &#123;</span><br><span class="line">        <span class="keyword">const</span> value = obj[k]</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> value === <span class="string">'object'</span>) fn(value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç¬¬ä¸€æ¬¡è®²å…³äºè¯­è¨€çŸ¥è¯†ç‚¹çš„ï¼Œå¦‚æœå‘ç°æœ‰é”™è¯¯çš„åœ°æ–¹ æ¬¢è¿æŒ‡å‡º~<br>æœ€åè°¢è°¢æƒ é¡¾ï¼Œè¯·ç¬‘çº³</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æœ¬ç¯‡ä¸»è¦è¯´ä¸€äº›åŸºç¡€çŸ¥è¯†ç‚¹ï¼Œå…³äºå¤šé¡¹èµ‹å€¼é¡ºåºï¼Œå¯¹è±¡å¼•ç”¨ç­‰ï¼ŒæœŸé—´æ’å…¥ä¸€ç‚¹es6åªæ˜¯ä»¥åŠè§£å†³é—®é¢˜çš„æ€è·¯ã€‚&lt;/p&gt;
&lt;p&gt;å¼€å¤´å…ˆæ¥åšä¸€é“é¢è¯•é¢˜&lt;/p&gt;
&lt;h2 id=&quot;part1&quot;&gt;&lt;a href=&quot;#part1&quot; class=&quot;headerlink&quot; title=&quot;part1&quot;&gt;
      
    
    </summary>
    
      <category term="technology" scheme="https://jsonz1993.github.io/categories/technology/"/>
    
    
      <category term="learn" scheme="https://jsonz1993.github.io/tags/learn/"/>
    
      <category term="JavaScript" scheme="https://jsonz1993.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>è§†é¢‘è½¬å­—ç¬¦ç”»</title>
    <link href="https://jsonz1993.github.io/2018/07/video-to-chat/"/>
    <id>https://jsonz1993.github.io/2018/07/video-to-chat/</id>
    <published>2018-07-30T10:36:35.000Z</published>
    <updated>2019-03-13T03:30:36.844Z</updated>
    
    <content type="html"><![CDATA[<p>å…ˆçœ‹ä¸€ä¸‹æ•ˆæœï¼ŒåŸè§†é¢‘æ˜¯è¿™æ ·çš„</p><video src="../2018-07-27/b_1.mp4" width="300" controls></video><p>æˆ‘ä»¬è¦å®ç°çš„æ•ˆæœæ˜¯è¿™æ ·å­çš„ï¼Œä¹‹æ‰€ä»¥æ‰¾è¿™ä¸ªè§†é¢‘æ˜¯å› ä¸ºâ€¦è¿™ä¸ªè§†é¢‘å’ŒèƒŒæ™¯çš„å¯¹æ¯”åº¦æ¯”è¾ƒé«˜åšå‡ºæ¥æ¯”è¾ƒæœ‰è¾¨è¯†åº¦ï¼Œæ²¡æœ‰å…¶ä»–çš„æ„æ€ ( *ãƒ»Ï‰ãƒ»)âœ„â•°ã²â•¯</p><video src="../2018-07-27/b.mp4" width="300" controls></video><h2 id="èµ·å› "><a href="#èµ·å› " class="headerlink" title="èµ·å› "></a>èµ·å› </h2><p><img src="./wechat.png" width="300"><br>æŸå¤©ä¸€ä¸ªåŸºå‹åœ¨ç¾¤é‡Œé—®æˆ‘ï¼Œåœ¨æŠ–éŸ³çœ‹åˆ°ä¸€ç§è§†é¢‘ï¼Œé—®æˆ‘æ˜¯ä¸æ˜¯èƒ½å®ç°ã€‚æˆ‘è¯´å¯ä»¥çš„~<br>äºæ˜¯å½“å¤©æ™šä¸ŠèŠ±äº†ä¸€ä¸ªå¤šå°æ—¶æŠ˜è…¾äº†ä¸€ä¸ªç²—ç³™ç‰ˆæœ¬â€¦ </p><p>å…ˆæŠŠè§†é¢‘ä¸¢åˆ°éƒ¨é—¨æŠ€æœ¯ç¾¤é—®æœ‰æ²¡æœ‰å…³é”®å­—ï¼Œç»™äº†ä¸€ä¸ªkeyword <strong>å›¾ç‰‡è½¬å­—ç¬¦ä¸²</strong> äºæ˜¯ç…§ç€è¿™ä¸ªæ€è·¯å»gayhubæ‰¾èµ„æºæ‹¼ä¹é«˜ï¼</p><h2 id="æ•´ä½“æ€è·¯"><a href="#æ•´ä½“æ€è·¯" class="headerlink" title="æ•´ä½“æ€è·¯"></a>æ•´ä½“æ€è·¯</h2><ul><li>ç¬¬ä¸€æ­¥æˆ‘ä»¬é€šè¿‡ <code>input[type=&quot;file&quot;]</code> è·å–æ–‡ä»¶</li><li>æ‹¿åˆ°æ–‡ä»¶ä¹‹åï¼Œç”¨ <code>URL.createObjectURL</code>æ¥è·å–è§†é¢‘çš„è·¯å¾„</li><li>é€šè¿‡ <code>ctx.drawImage</code> æˆ‘ä»¬å¯ä»¥æŠŠæŸä¸ª video å½“å‰çš„å›¾åƒæ¸²æŸ“åˆ° canvasé‡Œé¢</li><li><code>ctx.getImageData</code> å¯ä»¥è·å–å½“å‰canvas é‡Œé¢å›¾ç‰‡çš„è‰²å€¼ï¼Œåˆ©ç”¨å…¬å¼è®¡ç®—å‡ºç°åº¦</li><li>æ ¹æ®ç°åº¦çš„æ·±æµ…å»åŒ¹é…è¦æ˜¾ç¤ºçš„å­—ç¬¦ï¼Œæ·±è‰²åŒ¹é…æ¯”è¾ƒå¯†é›†çš„å­—ç¬¦ï¼Œæœ€æµ…çš„ç›´æ¥ç”¨ç©ºæ ¼ä»£æ›¿ï¼Œç„¶åç”¨ <code>ctx.fillText</code>é‡ç»˜è¿›å»</li><li>è®¾ç½® <code>video.currentTime</code> æ¥è·å¾—è§†é¢‘çš„æŸä¸€æ—¶åˆ»å›¾åƒï¼Œé‡å¤ä¸Šè¿°é‡ç»˜è¿‡ç¨‹<!-- ç°åº¦è¶…è¿‡æŸä¸ªå€¼ç”¨#ï¼Œä½äºæŸä¸ªå€¼ç”¨ Â· ä»£æ›¿ --></li></ul><p>æ—¢ç„¶å¤§æ¦‚çš„æ€è·¯å·²ç»ç†æ¸…ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å…·ä½“çš„ç¼–ç ï¼ŒæŠŠæƒ³æ³•å†™å‡ºæ¥çš„è¿‡ç¨‹</p><h2 id="å…·ä½“ç¼–ç å®ç°"><a href="#å…·ä½“ç¼–ç å®ç°" class="headerlink" title="å…·ä½“ç¼–ç å®ç°"></a>å…·ä½“ç¼–ç å®ç°</h2><h3 id="è·å–è§†é¢‘æ–‡ä»¶"><a href="#è·å–è§†é¢‘æ–‡ä»¶" class="headerlink" title="è·å–è§†é¢‘æ–‡ä»¶"></a>è·å–è§†é¢‘æ–‡ä»¶</h3><p>é¦–å…ˆæˆ‘ä»¬å…ˆç¡®å®šä¸‹htmléœ€è¦å“ªäº›å…ƒç´ </p><ol><li>ä¸€ä¸ª input[type=â€fileâ€] ç”¨æ¥ç»™ç”¨æˆ·ä¸Šä¼ çš„</li><li>ä¸€ä¸ª video ç”¨æ¥æ‰¿è½½ä¸Šä¼ çš„video</li><li>ä¸€ä¸ª canvas ç”¨æ¥å±•ç¤ºæœ€ç»ˆçš„ç»“æœ</li></ol><p>å¤§æ¦‚æ˜¯é•¿è¿™æ ·ï¼š<br><figure class="highlight html"><figcaption><span>index.html</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">id</span>=<span class="string">"inputFile"</span> <span class="attr">accept</span>=<span class="string">".mp4"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"canvasShow"</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">id</span>=<span class="string">"video"</span>&gt;</span><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>æ¥ä¸‹æ¥jsæ–‡ä»¶ï¼Œæˆ‘ä»¬è¦å…ˆå¯¹ input ç»‘å®šä¸ªç›‘å¬äº‹ä»¶ï¼Œæ‹¿åˆ°æ–‡ä»¶urlä¹‹åè®¾ç½®ç»™video<br>è¿™é‡Œè¦æ³¨æ„ä¸¤ç‚¹ï¼Œä¸€ä¸ªæ˜¯ <code>url</code>ç”¨å®Œä¸ç”¨çš„è¯ï¼Œç”¨ <code>URL.revokeObjectURL</code> é‡Šæ”¾èµ„æºï¼› ä¸€ä¸ªæ˜¯æˆ‘ä»¬è¿™é‡Œç”¨äº† <code>await</code> åœ¨domVide.onCanplayä¹‹å‰ä¸åšä»»ä½•æ“ä½œï¼Œé˜²æ­¢è§†é¢‘æ²¡æœ‰åŠ è½½å®Œå°±æ“ä½œï¼Œæœ‰é»‘å±é£é™©ã€‚</p><p>å¦‚æœå¯¹ es6ã€es7ã€es8ä¸ç†Ÿæ‚‰çš„å°ä¼™ä¼´è¦å»è¡¥ä¸€ä¸‹äº†~ ç°åœ¨åŸºæœ¬ä¸ä¼šè¿™äº›åŸºæœ¬è¯­æ³•éƒ½çœ‹ä¸æ‡‚demo= =<br>é™„ä¸Š<a href="http://es6.ruanyifeng.com" target="_blank" rel="noopener">é˜®ä¸€å³°è€å¸ˆçš„ES6æ•™ç¨‹</a>ï¼Œåˆæƒ³èµ·é¢è¯•è¢«é—®ES7æœ‰ä»€ä¹ˆæ–°ç‰¹æ€§ ç®€ç›´æ˜¯*äº†ç‹—<br><figure class="highlight javascript"><figcaption><span>index.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">domInput.addEventListener(<span class="string">'change'</span>, <span class="keyword">async</span>(&#123;<span class="attr">target</span>: &#123;files &#125;&#125;)=&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> file = files[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">const</span> url = URL.createObjectURL(file);</span><br><span class="line">  domVideo.src = urlrl;</span><br><span class="line">  <span class="keyword">await</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">res</span>=&gt;</span> domVideo.addEventListener(<span class="string">'canplay'</span>, res));</span><br><span class="line">  <span class="comment">// next ====&gt;  handleVideoInit()</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><h3 id="å°†è§†é¢‘æ¸²æŸ“åˆ°canvas"><a href="#å°†è§†é¢‘æ¸²æŸ“åˆ°canvas" class="headerlink" title="å°†è§†é¢‘æ¸²æŸ“åˆ°canvas"></a>å°†è§†é¢‘æ¸²æŸ“åˆ°canvas</h3><p>æ‹¿åˆ°è§†é¢‘ä¹‹åï¼Œæˆ‘ä»¬è¦æŠŠå½“å‰è¿™ä¸€ä¸ªæ—¶åˆ»çš„å›¾åƒæ¸²æŸ“åˆ°canvasé‡Œé¢<br>å…ˆç”¨<code>ctx.drawImage(video, 0, 0, width, height)</code> æŠŠvideo domå½“å‰å±æ¸²æŸ“è¿›canvas<br>å†ç”¨<code>ctx.getImageData(0, 0, width, height)</code> è·å–å›¾ç‰‡çš„è‰²å€¼æ¥åšå¤„ç†<br>å¯ä»¥é€šè¿‡è°ƒæ•´ <code>img2Text</code> æ¥é€‰æ‹©æ¸²æŸ“å‡ºæ¥çš„å›¾ç‰‡æ˜¯æƒ³è¦æ€æ ·çš„(ç”±å“ªäº›å­—ç¬¦ç»„æˆç­‰ç­‰)<br>æ¯”å¦‚æŠŠ textListæ”¹ä¸º [â€˜Aaâ€™, â€˜Bvâ€™, â€˜Ccâ€™, â€˜Ddâ€™, â€˜#â€™, â€˜&amp;â€™, â€˜@â€™, â€˜$â€™, â€˜*â€™, â€˜?â€™, â€˜;â€™, â€˜^â€™, â€˜Â·â€™, â€˜Â·â€™, â€˜Â·â€™, â€˜Â·â€™]ï¼Œè¾¨è¯†åº¦ä¼šé«˜ä¸€ç‚¹</p><figure class="highlight javascript"><figcaption><span>index.js handleVideoInit</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">domVide =&gt; videoå…ƒç´ </span></span><br><span class="line"><span class="comment">size =&gt; å­˜æ”¾videoç­‰å…ƒç´ çš„é•¿å®½</span></span><br><span class="line"><span class="comment">canvasVideo =&gt; å­˜æ”¾videoå½“å‰çš„å›¾åƒçš„canvas</span></span><br><span class="line"><span class="comment">canvasShow =&gt; å­˜æ”¾æœ€åå±•ç¤ºæ•ˆæœçš„canvas</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> size = &#123;<span class="attr">w</span>: <span class="number">0</span>, <span class="attr">h</span>: <span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">const</span> canvasVideo = <span class="built_in">document</span>.createElement(<span class="string">'canvas'</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleVideoInit</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  domVideo.currentTime = <span class="number">0</span>;</span><br><span class="line">  size.w = domVideo.width = canvasVideo.width = canvasShow.width = domVideo.videoWidth * <span class="number">.5</span>;</span><br><span class="line">  size.h = domVideo.height = canvasVideo.height = canvasShow.height = domVideo.videoHeight * <span class="number">.5</span>;</span><br><span class="line">  video2Img();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">video2Img</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; w, h &#125; = size;</span><br><span class="line">  ctxVideo.drawImage(domVideo, <span class="number">0</span>, <span class="number">0</span>, w, h);</span><br><span class="line">  <span class="keyword">const</span> &#123; data &#125; = ctxVideo.getImageData(<span class="number">0</span>, <span class="number">0</span>, w, h);</span><br><span class="line">  ctxShow.clearRect(<span class="number">0</span>, <span class="number">0</span>, w, h);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> _h= <span class="number">0</span>; _h&lt; h; _h+= <span class="number">8</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> _w= <span class="number">0</span>; _w&lt; w; _w+= <span class="number">8</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> index = (_w + w * _h) * <span class="number">4</span>;</span><br><span class="line">      <span class="keyword">const</span> r = data[index + <span class="number">0</span>];</span><br><span class="line">      <span class="keyword">const</span> g = data[index + <span class="number">1</span>];</span><br><span class="line">      <span class="keyword">const</span> b = data[index + <span class="number">2</span>];</span><br><span class="line">      <span class="keyword">const</span> gray = <span class="number">.299</span> * r + <span class="number">.587</span> * g + <span class="number">.114</span> * b;</span><br><span class="line">      ctxShow.fillText(img2Text(gray), _w, _h + <span class="number">8</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">img2Text</span>(<span class="params">g</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> i = g % <span class="number">16</span> === <span class="number">0</span> ? <span class="built_in">parseInt</span>(g / <span class="number">16</span>) - <span class="number">1</span> : <span class="built_in">parseInt</span>(g/ <span class="number">16</span>);</span><br><span class="line">    <span class="keyword">return</span> [<span class="string">'#'</span>, <span class="string">'&amp;'</span>, <span class="string">'@'</span>, <span class="string">'%'</span>, <span class="string">'$'</span>, <span class="string">'w'</span>, <span class="string">'*'</span>, <span class="string">'+'</span>, <span class="string">'o'</span>, <span class="string">'?'</span>, <span class="string">'!'</span>, <span class="string">';'</span>, <span class="string">'^'</span>, <span class="string">','</span>, <span class="string">'.'</span>, <span class="string">' '</span>][i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ°è¿™ä¸€æ­¥ï¼Œå…¶å®å·²ç»å®ç°äº†æŠŠä¸€å¼ å›¾ç‰‡å˜ä¸ºå­—ç¬¦å¡«å……å›¾äº†,å‰©ä¸‹çš„å·¥ä½œæ— éå°±æ˜¯æŠŠè§†é¢‘å˜æˆä¸€å¼ å¼ çš„å›¾ç‰‡ï¼Œç„¶åé‡å¤æ‰§è¡Œè¿™äº›é€»è¾‘</p><h3 id="æŒç»­è°ƒç”¨æ¸²æŸ“å­—ç¬¦è§†é¢‘"><a href="#æŒç»­è°ƒç”¨æ¸²æŸ“å­—ç¬¦è§†é¢‘" class="headerlink" title="æŒç»­è°ƒç”¨æ¸²æŸ“å­—ç¬¦è§†é¢‘"></a>æŒç»­è°ƒç”¨æ¸²æŸ“å­—ç¬¦è§†é¢‘</h3><p>æˆ‘ä»¬æ”¹ä¸€ä¸‹  video2Img å‡½æ•°ï¼Œå°†å…¶å®ç°ä¸ºèƒ½æŒç»­è°ƒç”¨çš„å½¢å¼ï¼Œ å†æ·»åŠ ä¸€ä¸ªå‡½æ•° <code>clear</code> ç”¨æ¥æ¸…ç†åƒåœ¾</p><p>è¿™é‡Œç”¨åˆ°çš„æ˜¯ <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/requestAnimationFrame" target="_blank" rel="noopener">window.requestAnimationFrame</a> å»æŒç»­è°ƒç”¨<br><figure class="highlight javascript"><figcaption><span>index.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">video2Img</span>(<span class="params">&#123;</span></span></span><br><span class="line"><span class="function"><span class="params">  timePoint= <span class="number">0</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">  curT= Date.now(</span>),</span></span><br><span class="line"><span class="function">  <span class="title">prevT</span>= <span class="title">Date</span>.<span class="title">now</span>(<span class="params"></span>),</span></span><br><span class="line"><span class="function">  <span class="title">prevInterval</span>,</span></span><br><span class="line"><span class="function">&#125;) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; w, h &#125; = size;</span><br><span class="line">  ctxVideo.drawImage(domVideo, <span class="number">0</span>, <span class="number">0</span>, w, h);</span><br><span class="line">  drawOnce();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> _interval = <span class="built_in">Math</span>.max((curT - prevT), <span class="number">16</span>) / <span class="number">1000</span>;</span><br><span class="line">  <span class="keyword">if</span> (curT - prevT !== <span class="number">0</span>) _interval -= prevInterval;</span><br><span class="line">  <span class="keyword">await</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">res</span>=&gt;</span> setTimeout(res, _interval*<span class="number">1000</span>));</span><br><span class="line">  <span class="keyword">const</span> nextTimePoint = _interval + timePoint;</span><br><span class="line">  <span class="keyword">if</span> (nextTimePoint &gt; domVideo.duration) <span class="keyword">return</span> clear();</span><br><span class="line"></span><br><span class="line">  tId = <span class="built_in">window</span>.requestAnimationFrame(<span class="function"><span class="params">()</span>=&gt;</span> video2Img(&#123;</span><br><span class="line">    timePoint: nextTimePoint,</span><br><span class="line">    prevT: curT,</span><br><span class="line">    curT: <span class="built_in">Date</span>.now(),</span><br><span class="line">    prevInterval: _interval,</span><br><span class="line">  &#125;));  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">drawOnce</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; data &#125; = ctxVideo.getImageData(<span class="number">0</span>, <span class="number">0</span>, w, h);</span><br><span class="line">  ctxShow.clearRect(<span class="number">0</span>, <span class="number">0</span>, w, h);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> _h= <span class="number">0</span>; _h&lt; h; _h+= <span class="number">8</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> _w= <span class="number">0</span>; _w&lt; w; _w+= <span class="number">8</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> index = (_w + w * _h) * <span class="number">4</span>;</span><br><span class="line">      <span class="keyword">const</span> r = data[index + <span class="number">0</span>];</span><br><span class="line">      <span class="keyword">const</span> g = data[index + <span class="number">1</span>];</span><br><span class="line">      <span class="keyword">const</span> b = data[index + <span class="number">2</span>];</span><br><span class="line">      <span class="keyword">const</span> gray = <span class="number">.299</span> * r + <span class="number">.587</span> * g + <span class="number">.114</span> * b;</span><br><span class="line">      ctxShow.fillText(img2Text(gray), _w, _h + <span class="number">8</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cleart</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123;w, h&#125; = size;</span><br><span class="line">  lastUrl &amp;&amp; URL.revokeObjectURL(lastUrl);</span><br><span class="line">  tId &amp;&amp; <span class="built_in">window</span>.cancelAnimationFrame(tId);</span><br><span class="line">  ctxShow.clearRect(<span class="number">0</span>, <span class="number">0</span>, w, h);</span><br><span class="line">  ctxVideo.clearRect(<span class="number">0</span>, <span class="number">0</span>, w, h);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="æºç ä¸demo"><a href="#æºç ä¸demo" class="headerlink" title="æºç ä¸demo"></a>æºç ä¸demo</h2><p>è‡³æ­¤ï¼ŒåŠŸèƒ½åŸºæœ¬éƒ½å®ç°äº†ï¼Œä¸‹é¢æä¾›åœ¨çº¿çš„å‘†æ¯›å’Œgithubä»“åº“åœ°å€~</p><h3 id="åœ¨çº¿å‘†æ¯›"><a href="#åœ¨çº¿å‘†æ¯›" class="headerlink" title="åœ¨çº¿å‘†æ¯›"></a><a href="/demo/video2char/index.html">åœ¨çº¿å‘†æ¯›</a></h3><h3 id="github-æºç "><a href="#github-æºç " class="headerlink" title="github æºç "></a><a href="https://github.com/jsonz1993/wheel/tree/master/video2char" target="_blank" rel="noopener">github æºç </a></h3><p>videoè½¬å›¾ç‰‡å¿˜äº†æ˜¯åœ¨githubçœ‹å“ªä¸ªé¡¹ç›®çš„ï¼Œ<code>ctx.drawImage(video, 0, 0, width, height)</code>è¿™ä¸ªæ˜¯çœ‹å®Œæ‰çŸ¥é“çš„ã€‚</p><p>å›¾ç‰‡è½¬å­—ç¬¦åŸºæœ¬æ˜¯çœ‹è¿™ä¸ªå¤§å“¥çš„<a href="https://github.com/Leo-0/img2Char" target="_blank" rel="noopener">github</a></p><p>åœ¨æ‰¾æ–¹æ¡ˆçš„æ—¶å€™çœ‹åˆ°çš„ä¸€ä¸ªåƒç´ å›¾å®ç°ï¼ŒæŒºæœ‰è¶£çš„ï¼Œä»¥å‰å®ç°é©¬èµ›å…‹æ˜¯æ‹¿å‘¨å›´åƒç´ å€¼å–å¹³å‡å»åšï¼Œè¿™ä¸ªå“¥ä»¬æ˜¯ç›´æ¥æ”¾å¤§æˆªå›¾ æ›´ç®€å•ç²—æš´<a href="https://segmentfault.com/a/1190000007977592" target="_blank" rel="noopener">ä¼ é€é—¨</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å…ˆçœ‹ä¸€ä¸‹æ•ˆæœï¼ŒåŸè§†é¢‘æ˜¯è¿™æ ·çš„&lt;/p&gt;
&lt;video src=&quot;../2018-07-27/b_1.mp4&quot; width=&quot;300&quot; controls&gt;&lt;/video&gt;

&lt;p&gt;æˆ‘ä»¬è¦å®ç°çš„æ•ˆæœæ˜¯è¿™æ ·å­çš„ï¼Œä¹‹æ‰€ä»¥æ‰¾è¿™ä¸ªè§†é¢‘æ˜¯å› ä¸ºâ€¦è¿™ä¸ªè§†é¢‘å’ŒèƒŒæ™¯çš„å¯¹æ¯”åº¦æ¯”è¾ƒé«˜åšå‡ºæ¥æ¯”è¾ƒæœ‰è¾¨è¯†åº¦
      
    
    </summary>
    
      <category term="technology" scheme="https://jsonz1993.github.io/categories/technology/"/>
    
    
      <category term="learn" scheme="https://jsonz1993.github.io/tags/learn/"/>
    
      <category term="github" scheme="https://jsonz1993.github.io/tags/github/"/>
    
      <category term="JavaScript" scheme="https://jsonz1993.github.io/tags/JavaScript/"/>
    
      <category term="Canvas" scheme="https://jsonz1993.github.io/tags/Canvas/"/>
    
      <category term="HTML" scheme="https://jsonz1993.github.io/tags/HTML/"/>
    
  </entry>
  
  <entry>
    <title>2018-07-27 å°è®°</title>
    <link href="https://jsonz1993.github.io/2018/07/2018-07-27/"/>
    <id>https://jsonz1993.github.io/2018/07/2018-07-27/</id>
    <published>2018-07-27T17:10:46.000Z</published>
    <updated>2019-03-13T03:30:36.824Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸Šä¸€ç¯‡æ–‡å·²ç»æ˜¯ä¸€ä¸ªæœˆå‰çš„ï¼Œè¿˜æ˜¯æ”¹ä¸äº†æ‡’çš„ä¹ æƒ¯</p><p>ä¹ æƒ¯æ€§å¯¹æœ€è¿‘åšä¸€äº›æ€»ç»“ï¼Œå…³äºé¢è¯•ï¼Œå…³äºå·¥ä½œä¸Šï¼Œå…³äºæœ€è¿‘å­¦ä¹ çš„ä¸œè¥¿ã€‚</p><h2 id="å…³äºé¢è¯•"><a href="#å…³äºé¢è¯•" class="headerlink" title="å…³äºé¢è¯•"></a>å…³äºé¢è¯•</h2><p>è®°å¾—ä»å››æœˆå°¾å°±ä¸€æ®µæ—¶é—´å»é¢ä¸€æ¬¡ï¼Œç°åœ¨å·²ç»ç¡®å®šç»§ç»­ç•™åœ¨ç§Ÿç§Ÿè½¦ã€‚é¡ºè·¯æ£é¼“ä¸€äº›ä¸œè¥¿ï¼Œè€ƒè€ƒä¸“å‡æœ¬ã€‚</p><p>è‡ªè”æä¹‹åé¢äº†å››å®¶</p><ul><li>cvte</li><li>é˜¿é‡Œå¤–åŒ…</li><li>YY</li><li>è½¦ä¸»æ— å¿§</li></ul><h3 id="cvte"><a href="#cvte" class="headerlink" title="cvte"></a>cvte</h3><p>cvte æˆ‘éƒ½å¿˜äº†æœ‰æŠ•ä»–å…¬å¸ç®€å†ï¼Œä¸€å¤©æ™šä¸Šçœ‹ä¹¦ï¼Œçªç„¶å°±æ¥äº†ä¸ªç”µè¯è¯´æ˜¯xxxxçš„xxxï¼Œæ¥è¿›è¡Œç”µè¯é¢è¯•ã€‚<br>ç„¶åå°±ç¨€é‡Œç³Šæ¶‚èŠäº†åŠä¸ªå¤šå°æ—¶ï¼Œä¹‹åå°±è¯´ç­‰hrç”µè¯ã€‚</p><p>hrç”µè¯èŠäº†ä¸‹åŠ ç­æƒ…å†µï¼Œä¼ä¸šæ–‡åŒ–ï¼Œç¦åˆ©ç­‰ä¸œè¥¿ã€‚</p><p>å…¶å®ä¹‹å‰å°±ä¸€ç›´å¬è¯´cvteå¾ˆå°é—­ï¼Œåˆå¾ˆä¼ ç»Ÿï¼ŒåŠ ç­è´¼ç–¯ç‹‚ï¼Œä¼ä¸šæ–‡åŒ–åˆå¾ˆé‚£å•¥ï¼Œæ‰€ä»¥æ‰“å¿ƒé‡Œä¸ä¼šå»é‚£é‡Œ</p><p>æ‰€ä»¥hré¢çš„æ—¶å€™ï¼Œä¹Ÿæ²¡æœ‰æ€ä¹ˆå›ç­”ï¼Œä½†æ˜¯æœ‰ä¸€ç‚¹æ˜¯cvteå±…ç„¶æ˜¯æ²¡æœ‰è–ªèµ„ä¿å¯†çš„ï¼Œæ‰€ä»¥æˆ‘å°±é¡ºè·¯é—®äº†hrçš„è–ªèµ„çœ‹æ˜¯ä¸æ˜¯çœŸçš„åƒä»–è¯´çš„ä¸€æ · è–ªèµ„å…è®¸è®¨è®ºã€‚ç»“æœä¼°è®¡å› ä¸ºè¿™ä¸ªå¾—ç½ªäº†hr= =æ²¡æœ‰è¿‡hré¢</p><h3 id="é˜¿é‡Œå¤–åŒ…"><a href="#é˜¿é‡Œå¤–åŒ…" class="headerlink" title="é˜¿é‡Œå¤–åŒ…"></a>é˜¿é‡Œå¤–åŒ…</h3><p>é˜¿é‡Œå¤–åŒ…å…¶å®æ˜¯æœ€æ„å¤–çš„ä¸€å®¶<br>æ˜¯æ­¦æ±‰ä¸€å®¶å…¬å¸è”ç³»ä¸Šçš„ï¼Œè”ç³»ä¹‹åæƒ³ç€å»è¯•ä¸€ä¸‹é˜¿é‡Œçš„é¢è¯•åˆ°åº•æ˜¯æ€æ ·çš„ æ‰€ä»¥å°±ç­”åº”äº†<br>hréå¸¸çš„å¥½ï¼Œé¢è¯•å‰å†ä¸‰å®å˜±ï¼Œä¹ŸæŠŠé¢è¯•å®˜çœ‹å®Œç®€å†çš„åé¦ˆå‘Šè¯‰äº†æˆ‘<br>è¿˜è®©åŒäº‹æå‰é¢æˆ‘ä¸€è½®ï¼Œé¢å®Œè¯´ æ²¡ä»€ä¹ˆé—®é¢˜</p><p>é¢è¯•å½“å¤©èŠäº†ä¸‹é¡¹ç›®ç»éªŒè¿˜æœ‰åŸºç¡€çŸ¥è¯†å’Œä¸€äº›é—®é¢˜çš„æ’æŸ¥æ€è·¯</p><p>æœ¬ä»¥ä¸ºç­”çš„æŒºä¸é”™çš„ï¼Œå’Œé¢è¯•å®˜ä¹ŸèŠå¾—å¾ˆæ„‰å¿«ã€‚åé¢é¢è¯•å®˜è¯´å»æ‰¾è€å¤§æ¥é¢ï¼Œè®©æˆ‘éªšç­‰ç‰‡åˆ»</p><p>è¿‡æ®µæ—¶é—´åè¯´è€å¤§åœ¨å¼€ä¼šï¼Œè®©æˆ‘å›å»ç­‰é€šçŸ¥â€¦ç°åœ¨æƒ³èµ·æ‰çŸ¥é“åŸæ¥è€å¤§åœ¨å¼€ä¼šæ˜¯ä¸€ä¸ªæ‹’ç»äººçš„å¥—è·¯ å›¾æ ·å›¾æ£®ç ´</p><p>å»é˜¿é‡Œé¢æƒ³èµ·äº†ä¸€å¹´å‰å»é¢ucï¼Œé‚£æ—¶å€™ä¹Ÿé¢å¾—å¾ˆå¼€å¿ƒï¼Œåé¢å¾—çŸ¥æ˜¯åº”è˜å¤–åŒ…å²—å°±æ²¡æ€ä¹ˆæƒ³ç»§ç»­ä¸‹å»â€¦</p><p>ä½†æ˜¯é˜¿é‡Œçš„é¢è¯•å®˜ç»™æˆ‘çš„æ„Ÿè§‰æ²¡æœ‰åƒä¸€äº›å°å…¬å¸çš„äººä¸€æ ·ï¼Œç»™äººçš„æ„Ÿè§‰æ˜¯å¾ˆäº²åˆ‡çš„ã€‚å’Œæˆ‘è¯´å¦‚æœæƒ³è¿›æŸä¸ªå¤§å…¬å¸ï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯å‚ä¸è¯¥å…¬å¸çš„å¼€æºé¡¹ç›®ï¼Œè¿™æ˜¯æ”¶è·æœ€å¤§çš„ä¸€ä¸ªç‚¹ã€‚</p><p>è™½ç„¶è¿‡äº†ä¸ä¼šå»ï¼Œä½†æ˜¯æ€»ä½“æ¥è¯´è¿˜æ˜¯å¾ˆæ„å¤–ã€‚</p><h3 id="è½¦ä¸»æ— å¿§"><a href="#è½¦ä¸»æ— å¿§" class="headerlink" title="è½¦ä¸»æ— å¿§"></a>è½¦ä¸»æ— å¿§</h3><p>è½¦ä¸»æ— å¿§è¿™ä¸ªå°±æ¯”è¾ƒå°´å°¬äº†ï¼Œæ˜¯åœ¨å…¬å¸åŒä¸€æ ‹â€¦é¢è¯•å¤§æ¦‚çš„æ„Ÿè§‰å°±æ˜¯æŒºå®¹æ˜“çš„ï¼Œé¢è¯•å®˜é—®çš„é—®é¢˜éƒ½æ˜¯é’ˆå¯¹é¡¹ç›®ç»éªŒï¼Œæ‰€ä»¥åŸºæœ¬æ²¡æœ‰é€ å‡åˆ’æ°´å°±æ²¡ä»€ä¹ˆé—®é¢˜ã€‚<br>é¢ä¸‰å››è½®ï¼ŒæŠ€æœ¯é¢é¢å‰ç«¯Leaderï¼ŒæŠ€æœ¯äºŒé¢é¢éƒ¨é—¨è´Ÿè´£äººï¼Œç„¶åå°±æ˜¯ctoé¢ï¼Œé¢å®Œhrå’Œæˆ‘è¯´ä¸èƒ½ç»™æˆ‘æœŸæœ›è–ªèµ„<br>ä¸‰å¹´æœ€å¤šåªèƒ½ç»™xxkâ€¦è¯´ä¸€å¼€å§‹ä»¥ä¸ºæˆ‘æ˜¯æœ‰ä¸‰å¹´åŠç»éªŒï¼Œæ‰€ä»¥å¯ä»¥ç»™å››å¹´çš„è–ªèµ„<br>åé¢æ¥äº†offerè€ƒè™‘ä¸‹å®Œå…¨ä¸å€¼å¾—è·³å°±æ”¾å¼ƒ</p><p>ä½†æ˜¯è½¦ä¸»æ— å¿§æœ‰ä¸ªé¢˜å¤–è¯ï¼Œå’ŒhrèŠå¤©èŠå¾ˆä¹…ï¼Œhrè¯´ ä¹‹å‰ç§Ÿç§Ÿè½¦æœ‰é«˜çº§å‰ç«¯æ¥é¢è¯•ç»™å‡ºçš„è¯„ä»·æ˜¯å¾ˆæ°´ï¼Œæ‰€ä»¥å¯¹æˆ‘åŸæœ¬çš„ä¸æŠ±ä»€ä¹ˆå¸Œæœ›ã€‚ä½†æ˜¯æŠ€æœ¯é¢ç»™çš„è¯„ä»·æ˜¯å¾ˆä¸é”™ï¼Œæ‰€ä»¥æœ‰ç‚¹æƒŠè®¶ç§Ÿç§Ÿè½¦å†…éƒ¨çš„æ°´å¹³å·®å¼‚å¤§ã€‚</p><h3 id="YY-UED"><a href="#YY-UED" class="headerlink" title="YY UED"></a>YY UED</h3><p>é¢YYæ˜¯æœ€è¿‘æœ€å¼€å¿ƒï¼Œæ”¶è·æœ€å¤§çš„ä¸€æ¬¡é¢è¯•ã€‚<br>UEDå½“æ—¶é¢è¯•çš„æ—¶å€™åªæœ‰å››ä¸ªå‰ç«¯ï¼Œæˆ‘æ€»å…±é¢äº†äº”è½®ï¼ŸåŸºæœ¬ä¸Šå°±æ˜¯éƒ¨é—¨è½®ç€äººæ¥è™æˆ‘= =</p><p>ä¸€é¢å’ŒleaderèŠèŠå¤©ï¼Œè¯´ä¸€äº›åœºæ™¯çš„è§£å†³æ–¹æ¡ˆ</p><p>ç„¶åå°±æ˜¯ç¬”è¯•é¢˜ï¼Œåšå®Œä¹‹åå°±æ˜¯é¢ä¸‰é¢ã€‚</p><p>ä¸‰é¢å’Œéƒ¨é—¨ä¸€ä¸ªæŠ€æœ¯å¤§ç‰›èŠèŠå¤©ï¼ŒèŠæ¡†æ¶å±…å¤šï¼Œä¸€ä¸ªvueçš„äºº å¯¹reactäº†è§£æ¯”æˆ‘æ·±å¾ˆå¤šï¼Œè¿™æ˜¯æŒºä½©æœçš„<br>ä»–æœ‰ä¸ªè¯„åˆ†æ ‡å‡†ï¼Œå¤§æ¦‚å°±æ˜¯æƒ³æ‹›vue 6åˆ†ä»¥ä¸Šï¼Œä»¥å†™å†™demoçœ‹çœ‹apiä¸º1åˆ†ï¼›èƒ½ä¿è¯é¡¹ç›®æ­£å¸¸ä¸Šçº¿5åˆ†ï¼›ç†Ÿæ‚‰æ•´ä¸ªæ¡†æ¶ç»“æ„åŸç†ï¼Œé‡åˆ°é—®é¢˜èƒ½å‡†ç¡®çŸ¥é“æ˜¯åœ¨å“ªä¸ªç¯èŠ‚å‡ºé—®é¢˜ï¼Œå¯¹æ•´ä¸ªç”Ÿå‘½å‘¨æœŸåŠè¿è½¬å¾ˆç†Ÿæ‚‰ä¸º6åˆ†ï¼›å¯¹æ•´ä¸ªvueç”Ÿæ€éƒ½å¾ˆäº†è§£ï¼Œç²¾å‡†åˆ°æ¯æ¬¡è¿­ä»£æ”¹åŠ¨çš„æºç éƒ¨åˆ†ï¼Œè¿˜æœ‰vuexç­‰ç”Ÿæ€ä¹Ÿå¾ˆå…³æ³¨ä¸º10åˆ†ã€‚<br>å¤§ç‰›è¯´æˆ‘æ˜¯é¢è¿‡çš„åŒç­‰å·¥ä½œå¹´é™çš„ä¸­ä¸Šæ°´å¹³ï¼Œè¿™å¥è¯è®©æˆ‘å¼€å¿ƒäº†å¥½ä¹…å¥½ä¹…â€¦.å“ˆå“ˆå“ˆå“ˆ<br>ç»™å‡ºçš„è¯„ä»·æ˜¯å„æ–¹é¢éƒ½å¾ˆå‡è¡¡ï¼Œæ²¡ä»€ä¹ˆæ˜ç¡®çš„ç¼ºç‚¹ï¼Œä½†æ˜¯è¿™ä¹Ÿæ„å‘³ç€æ²¡æœ‰ä¸€ä¸ªèƒ½æ‹¿å‡ºæ¥è®²çš„æœ‰æ·±å…¥ç ”ç©¶çš„æ–¹å‘ã€‚<br>æœ€åè®©æˆ‘å›å»ç­‰é€šçŸ¥</p><p>å‡ å¤©åhræ‰“ç”µè¯è¯´è¿‡å»é¢è¯•ï¼Œå¼€å¿ƒã€‚<br>å››é¢æ˜¯éƒ¨é—¨å¦ä¸€ä¸ªå‰ç«¯é¢è¯•ï¼ŒèŠäº†ä¸€äº›åŸºç¡€çŸ¥è¯†å§ï¼Œè¿˜æœ‰ä¸€äº›åœºæ™¯å’Œæ¦‚å¿µæ€§çš„é—®é¢˜ã€‚<br>å…·ä½“é—®ä»€ä¹ˆå¿˜äº†ï¼Œåªè®°å¾—èŠçš„ä¹ŸæŒºæ„‰å¿«çš„ã€‚é¢å®Œä¹‹åæ˜¯leaderä¸‹æ¥é—²èŠä¸€ä¸‹ï¼Œé—®è¿˜æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œæ²¡æœ‰å°±é¢hräº†</p><p>hré¢æ˜¯åœ¨yyé¢è¯•æœ€ç´¯çš„ä¸€ä¸ªï¼Œå…¨ç¨‹hræ‹¿ç€å°æœ¬æœ¬ï¼Œè¾¹é—®è¾¹è®°ã€‚å¯èƒ½æ˜¯å‰é¢å’ŒæŠ€æœ¯å°ä¼™ä¼´èŠå¾—æ¯”è¾ƒopenï¼Œåˆ°hrè¿™è¾¹çªç„¶å˜å¾—è°¨æ…äº†ï¼Œæ‰€ä»¥é¢å®Œhrä¹‹å æ•´ä¸ªäººéƒ½å¥½ç´¯ã€‚ä¹Ÿæ˜¯å¾ˆä¼ ç»Ÿçš„é—®äº†ä»¥å‰çš„å…¬å¸ï¼Œä¸ºä»€ä¹ˆè·³æ§½å•Šä¹‹ç±»çš„ã€‚ æœ‰ä¸€äº›ä¸ä¸€æ ·çš„å°±æ˜¯é—®æˆ‘æ€ä¹ˆä¿è¯æœ‰æŒç»­çš„äº§å‡ºå’Œèƒ½ä¿æŒé«˜æ•ˆé•¿æœŸå­¦ä¹ ï¼Œå› ä¸ºUEDæ˜¯éœ€è¦ä¸æ–­çš„æ¢ç´¢å‰ç»æŠ€æœ¯çš„ï¼Œè¿˜æœ‰å°±æ˜¯é—®æˆ‘æœ‰æ²¡æœ‰blogï¼Œå¤šå°‘äººè®¢é˜…â€¦emmmm æˆ‘è¯´æˆ‘çš„åšå®¢æ²¡äººè®¢é˜…æ²¡äººçœ‹ï¼Œè‡ªå·±å†™ç€ç© ğŸ¤¦â€</p><p>è¿‡äº†å‡ å¤©åhræ‰“ç”µè¯èŠofferï¼Œæ€»ä½“æ¥è¯´æ¯”ç°åœ¨çš„é«˜äº†ä¸å°‘ï¼Œç®—æ˜¯å¾ˆæ»¡æ„çš„ä¸€ä¸ªofferäº†ã€‚</p><p>æœ¬æ¥é“äº†å¿ƒè¦è¿‡å»é‚£è¾¹æµªï¼Œæ¯•ç«Ÿéƒ¨é—¨çš„åŒäº‹åŸºæœ¬éƒ½è§äº†ä¸€é å“ˆå“ˆå“ˆå“ˆï¼Œç„¶åofferåˆæ¯”è¾ƒå¿ƒæ°´ã€‚</p><p>åé¢å› ä¸ºä¸ªäººåŸå› é€‰æ‹©ç»§ç»­ç•™åœ¨ç§Ÿç§Ÿè½¦ï¼Œä½†æ˜¯å¦‚æœåœ¨ä»¥åæœ‰æœºä¼šï¼Œè¿˜æ˜¯ä¼šä¼˜å…ˆè€ƒè™‘yyçš„ã€‚</p><h2 id="å…³äºå·¥ä½œ"><a href="#å…³äºå·¥ä½œ" class="headerlink" title="å…³äºå·¥ä½œ"></a>å…³äºå·¥ä½œ</h2><h3 id="é¡¹ç›®æ‹†åŒ…"><a href="#é¡¹ç›®æ‹†åŒ…" class="headerlink" title="é¡¹ç›®æ‹†åŒ…"></a>é¡¹ç›®æ‹†åŒ…</h3><p>æ—¢ç„¶é€‰æ‹©ç•™åœ¨ç§Ÿç§Ÿè½¦ï¼Œè‚¯å®šå°±ä¸èƒ½åƒä¹‹å‰åŠå¹´åˆ’åˆ’æ°´å°±è¿‡å»</p><p>æœ€è¿‘å·¥ä½œä¸Šä¸»è¦è´Ÿè´£çš„æ˜¯ï¼Œæƒ³ç€æŠŠéƒ¨é—¨çš„é¡¹ç›®åšä¸ªæ‹†åŒ…</p><p>åŸæœ¬å°é¡¹ç›®æ…¢æ…¢è¿­ä»£æˆå¾ˆå¤§çš„é¡¹ç›®ï¼Œä¸€æ¬¡æ‰“åŒ…è¦èŠ±åŠä¸ªå°æ—¶â€¦.åŠ ä¸Šç°åœ¨ç›®å½•çš„é—®é¢˜ï¼Œæ¯å¤©è¿‡æ¥éƒ½è¦æ‰“ä¸€ä¸ªå…¨é‡åŒ…ã€‚</p><p>æ‰€ä»¥ç°åœ¨çš„è®¡åˆ’æ˜¯ï¼Œå¯¹é¡¹ç›®æ¨¡å—è¿›è¡Œæ‹†åŒ…ï¼Œä¸€ä¸ªæ¨¡å—ç‹¬ç«‹æˆä¸€ä¸ªé¡¹ç›®ï¼Œæœ‰è‡ªå·±çš„node_modelsï¼Œä½†æ˜¯å…±ç”¨ä¸€ä¸ªgitã€‚</p><p>è¿™ä¸ªå…¶å®ä»åŠå¹´å‰å°±æœ‰äººæå‡ºæ¥ï¼Œä½†æ˜¯å¤ªéš¾æäº† æ‰€ä»¥ä¸€ç›´æ²¡äººå»æ¨</p><p>é¦–å…ˆè¦è€ƒè™‘çš„æ˜¯éƒ¨é—¨ä¸å¯èƒ½åœæ‰æ—¥å¸¸è¿­ä»£ï¼Œæ¥ç­‰ä½ æ‹†åŒ…ã€‚è€Œä¸”ä½ çš„éœ€æ±‚ä¹Ÿä¸ä¼šå› ä¸ºè¿™ä¸ªæŠ€æœ¯éœ€æ±‚è€Œå‡å°‘ï¼Œæ‰€ä»¥è¦åœ¨å¹³æ—¶åšéœ€æ±‚çš„é—´éš™åšè¿™ä»¶äº‹æƒ…ã€‚</p><p>å°½å¯èƒ½æŠŠè·¯å¾„æ›¿æ¢ï¼Œæ–‡ä»¶è¿ç§»ç­‰åšæˆè„šæœ¬å»è·‘ï¼Œä¸ç„¶åšä¸ä¸‹å»ã€‚<br>è€Œä¸”æ‹†åŒ…ä¹‹åï¼Œè¦è€ƒè™‘åç«¯çš„æ¨¡æ¿è·¯å¾„é—®é¢˜è¿˜æœ‰éƒ¨ç½²çš„é—®é¢˜ï¼ŒåŠ ä¸Šä¸€äº›å‰ç«¯ pwa,ampçš„æ„å»ºè€ƒè™‘<br>çœŸæ˜¯ä¸ªå¤§å·¥ç¨‹â€¦</p><p>æœ€è¿‘çš„æˆæœæ˜¯æœ¬åœ°èƒ½è·‘èµ·æ¥ï¼Œä½†æ˜¯è¿˜ç¼ºä¸€ä¸ª æœ¬åœ°æœåŠ¡ï¼ŒåŠ ä¸Šè¿˜æ²¡æœ‰å’Œåç«¯ï¼Œéƒ¨ç½²é‚£å—æ²Ÿé€šã€‚</p><p>ä»»é‡é“è¿œ</p><h3 id="ä¸‹åŠå¹´çš„æŒ‡æ ‡"><a href="#ä¸‹åŠå¹´çš„æŒ‡æ ‡" class="headerlink" title="ä¸‹åŠå¹´çš„æŒ‡æ ‡"></a>ä¸‹åŠå¹´çš„æŒ‡æ ‡</h3><p>ä¸‹åŠå¹´ï¼Œè€å¤§ç»™å®šçš„æŠ€æœ¯æŒ‡æ ‡æ˜¯Reactå’ŒWebpackä¸¤é¡¹</p><p>å…¶å®åŸæœ¬ç»™çš„æ˜¯Httpå’Œæµè§ˆå™¨å†…æ ¸ï¼Œä½†æ˜¯æˆ‘è§‰å¾—è¯´ç°åœ¨æˆ‘å»äº†è§£é‚£ä¸¤å—æ²¡ä»€ä¹ˆå¤§çš„æ”¶è·ã€‚</p><p>åŠ ä¸Šåœ¨yyé¢è¯•ä¹‹åï¼Œé¢è¯•å®˜ä¸€ç›´ç»™çš„è¯„ä»·æ˜¯æ²¡æœ‰ä¸€ä¸ªå¾ˆæ·±å…¥çš„ç‚¹ï¼Œæ‰€ä»¥å°±é€‰äº†Reactå»åšæ·±å…¥çš„æ–¹å‘ã€‚</p><p>Reactæ¢ç´¢ä¹‹ä½™äº†è§£Webpackå’Œ PWAéƒ¨åˆ†</p><h3 id="å…³äºwebpack"><a href="#å…³äºwebpack" class="headerlink" title="å…³äºwebpack"></a>å…³äºwebpack</h3><p>å‰å‡ å¤©æœ‰ä¸ªéœ€æ±‚æ˜¯é¡¹ç›®ä¸Šç”¨åˆ°çš„cookieéƒ½è¦è®°å½•åˆ°æŸä¸ªæ–‡æ¡£é‡Œé¢ï¼Œä¸€å¼€å§‹æƒ³ç€å†™ä¸€ä¸ªwebpackæ’ä»¶å»åšè¿™ä»¶äº‹æƒ…ã€‚ é¡¹ç›®çš„webpackæ˜¯3.xï¼Œå®˜æ–¹çš„æ–‡æ¡£å…¨éƒ½å‡çº§åˆ°4.xï¼Œä¸€å¼€å§‹æœ‰ç‚¹è›‹ç–¼ï¼Œä¹Ÿæ²¡æœ‰ä¸€ä¸ªæ¯”è¾ƒé€‚åˆå…¥é—¨çš„demoï¼Œè¦ä¸å°±æ˜¯å¤ªç®€å•ï¼Œè¦ä¸å°±æ˜¯å¾ˆå¤æ‚çš„ã€‚</p><p>åé¢ç»ˆäºå¤§æ¦‚è·‘äº†èµ·æ¥ï¼Œä½†æ˜¯è·‘èµ·æ¥ä¹‹åï¼Œå‘ç°å’Œé¢„æƒ³çš„ä¸ä¸€è‡´ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>æ–‡æ¡£éœ€è¦è®°å½•çš„æ˜¯ key value description, ä¸¾ä¸ªä¾‹å­<br>cookie.set(â€˜nameâ€™, â€˜jsonzâ€™, â€˜ç”¨æˆ·åâ€™);</p><p>æˆ‘çš„æ–¹æ¡ˆæ˜¯åœ¨webpackç¼–è¯‘çš„æ—¶å€™æ‹¿åˆ°babelè½¬ä¹‰å’Œä»£ç å‹ç¼©ä¼˜åŒ–ä¹‹å‰çš„å†…å®¹ï¼Œå› ä¸ºé¡¹ç›®ä¸Šæ¶‰åŠåˆ°cookieçš„æ“ä½œéƒ½ä¼šç”¨ä¸€ä¸ª <code>cookie-js</code> çš„ç±»åº“ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨è¿™ä¸ªåšä¸ºåˆ‡å…¥ç‚¹ã€‚</p><p>å¤§æ¦‚çš„æ€è·¯æ˜¯ï¼š webpackç”Ÿå‘½å‘¨æœŸé‡Œé¢å»æ‹¿åˆ°æºæ–‡ä»¶ï¼Œç„¶åç”¨ä¸€ä¸ªè¯­æ³•åˆ†ææ ‘ï¼Œè§£ææˆASTï¼Œå†æ ¹æ®ç±»å‹å»ç­›é€‰å‡º cookie-js å‡½æ•°è°ƒç”¨ä¼ å…¥çš„å‚æ•°</p><p>æœ¬æ¥è§‰å¾—å¤©è¡£æ— ç¼ï¼Œä½†æ˜¯ç†æƒ³å¾ˆå¤©çœŸï¼Œå®é™…é¡¹ç›®ä¸Šäº”èŠ±å…«é—¨ï¼Œæ¯”å¦‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Cookie <span class="keyword">from</span> <span class="string">'Cookie-js'</span>;</span><br><span class="line"><span class="keyword">const</span> cookie = <span class="built_in">require</span>(<span class="string">'Cookie-js'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> key = IS_DEV? <span class="string">'_name'</span>: <span class="string">'name'</span>;</span><br><span class="line"><span class="keyword">const</span> value = <span class="built_in">JSON</span>.parse(Cookie.get(<span class="string">'obj'</span>)).name;</span><br><span class="line">Cookie.set(key, value, <span class="string">'åå­—'</span>);</span><br><span class="line"></span><br><span class="line">cookie.set(<span class="string">'user'</span>, &#123;</span><br><span class="line">  name: <span class="string">'jsonz'</span>,</span><br><span class="line">  age: <span class="number">25</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>æ‰€ä»¥å…¶å®å¦‚æœçœŸçš„è¦ç”¨è„šæœ¬è®°å½•ï¼Œåªèƒ½åœ¨è¿è¡Œç¯å¢ƒä¸‹è®°å½•ï¼Œæ‰€ä»¥æ”¾å¼ƒè¿™ä¸ªæ–¹æ¡ˆâ€¦.</p><h2 id="å…³äºæ£é¼“"><a href="#å…³äºæ£é¼“" class="headerlink" title="å…³äºæ£é¼“"></a>å…³äºæ£é¼“</h2><h3 id="å°ç¨‹åº"><a href="#å°ç¨‹åº" class="headerlink" title="å°ç¨‹åº"></a>å°ç¨‹åº</h3><p>å‰æ®µæ—¶é—´æ˜¯è‡ªå·±æ£é¼“äº†ä¸€ä¸ªå°ç¨‹åºï¼Œç”¨æ¥ç»™æ¯å¤©åšè®¡åˆ’çš„ã€‚å¤§æ¦‚é•¿è¿™æ ·<br><img src="./wechat.jpeg" alt="wechat å°ç¨‹åº"></p><p>æŠ€æœ¯æ ˆ:<br>å‰ç«¯: ç”¨çš„æ˜¯ç¾å›¢çš„ mpvueï¼Œæš‚æ—¶å‘ç°å…¶å®å’Œå†™vueå¾ˆå¤šä¸ä¸€æ ·ï¼Œå› ä¸ºæœ‰å¾ˆå¤šå¯èƒ½æ˜¯å°ç¨‹åºçš„å±€é™é—®é¢˜ï¼Œä¹Ÿå¯èƒ½æ˜¯è½¬æ¢é—®é¢˜ï¼Œnå¤šè«åå…¶å¦™çš„bugè€Œä¸”è¿˜æ— æ³•æ­£é¢å¹²ã€‚</p><p>åç«¯:<br>Node: åšä¸»è¦æœåŠ¡ç«¯è¯­è¨€ï¼Œç”¨çš„é˜¿é‡ŒEgg.jsæ¡†æ¶<br>MySQL: ä¸ºä»€ä¹ˆé€‰æ‹©MySQLè€Œä¸æ˜¯å‰ç«¯(node)æƒ¯ç”¨çš„mongodbå‘¢ï¼Ÿ ä¸»è¦åŸå› æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯mongoä½“éªŒè¿‡äº†ï¼›ä¸€ä¸ªæ˜¯ç°åœ¨ä¸šç•Œå…¶å®mySqlè¿˜æ˜¯å ç»å¤§å¤šæ•°ï¼Œè€Œä¸”æ¯”è¾ƒæˆç†Ÿï¼Œæƒ³ä½“éªŒä¸€æ³¢å…³ç³»å‹æ•°æ®åº“ã€‚</p><p>æœåŠ¡å™¨ï¼š<br>Nginx: æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œå¯¹äºä¸€ä¸ªæ²¡æœ‰æŠ˜è…¾è¿‡çš„äººæ¥è¯´è¿˜æ˜¯æŒºå¼€å¿ƒçš„<br>Centos</p><p>çœ‹èµ·æ¥æ˜¯æŒºç®€å•çš„ï¼Œä½†æ˜¯å¯¹äºä¸ªäººå­¦ä¹ æ¥è¯´æ˜¯ä¸ªæŒºå¥½çš„é¡¹ç›®ã€‚ç‰¹åˆ«æ˜¯ä¸€ä¸ªå®Œå…¨æ²¡æœ‰çœŸæ­£æ£é¼“è¿‡åç«¯ï¼ŒæœåŠ¡ç«¯çš„äººæ¥è¯´ï¼ŒçœŸçš„å¾ˆhappyï¼Œæ¯”å•çº¯å†™å‰ç«¯è¦è€ƒè™‘çš„äº‹æƒ…å¤šå¾ˆå¤šã€‚</p><p>ä½†æ˜¯æœ€è¿‘å› ä¸ºå·¥ä½œçš„äº‹æƒ…ï¼Œæš‚æ—¶æç½®ä¸€è¾¹ï¼Œç›®å‰è¿˜æ˜¯ 0.0.1 å¯ä»¥ç”¨æœ€ç®€å•çš„è®¡åˆ’çš„åŠŸèƒ½ã€‚åé¢æ‹†åŒ…å®Œæˆä¹‹åå°±å›æ¥åŠ åŠŸèƒ½å†å‘å¸ƒ</p><h3 id="å›¾ç‰‡è½¬å­—ç¬¦"><a href="#å›¾ç‰‡è½¬å­—ç¬¦" class="headerlink" title="å›¾ç‰‡è½¬å­—ç¬¦"></a>å›¾ç‰‡è½¬å­—ç¬¦</h3><p>å‰å‡ å¤©æœ‰é«˜ä¸­å¥½æœ‹å‹åœ¨ç¾¤é‡Œå‘ä¸€ä¸ªè§†é¢‘ï¼Œé—®æˆ‘ä»¬è¯´çœŸçš„æ˜¯å¯ä»¥è¿™æ ·çš„å—ï¼Ÿ</p><video src="./a.mp4" controls></video><br>åŸè§†é¢‘æ˜¯æ­»è‚¥å®…éƒ½çŸ¥é“çš„æä¹å‡€åœŸï¼Œç„¶åæˆ‘è§‰å¾—å¾ˆæœ‰è¶£ï¼Œå°±é—®å…¬å¸ç¾¤è¿™ç§æ€ä¹ˆå®ç°ï¼Œå¤§æ¦‚æ˜¯å›¾ç‰‡è½¬å­—ç¬¦ä¸²<br><br>äºæ˜¯å°±å»æœäº†ä¸€ä¸‹ canvas è½¬å­—ç¬¦ä¸²ï¼Œå†æ‰¾äº†ä¸‹æ€ä¹ˆæŠŠè§†é¢‘è½¬å›¾ç‰‡ ğŸ¤¦â€æ²¡é”™ï¼Œæˆ‘å°±æ˜¯å¤§è‡ªç„¶çš„æ¬è¿å·¥<br><br>æœ€åå®ç°å‡ºæ¥å¤§æ¦‚æ˜¯è¿™æ ·å­<br><video src="./b.mp4" width="300" controls></video><p>å¤§æ¦‚çš„å®ç°æ€è·¯æ˜¯ é€šè¿‡videoå’ŒcanvasæŠŠè§†é¢‘é€å¸§ä¸¢åˆ°canvasé‡Œé¢ï¼Œå†ç”¨canvasè¯»å‡ºæ¯ä¸ªåƒç´ çš„ç°åº¦å»åŒ¹é…ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åç”¨è¿™äº›å­—ç¬¦ä¸²é‡å†™ä¸€ä¸ªcanvaså‡ºæ¥ã€‚</p><p>åé¢æœ‰æ—¶é—´å†æŠŠè¿™ä¸ªæ•´ç†æˆä¸€ç¯‡æ–‡ç« å‡ºæ¥</p><h2 id="å…³äºå­¦ä¹ "><a href="#å…³äºå­¦ä¹ " class="headerlink" title="å…³äºå­¦ä¹ "></a>å…³äºå­¦ä¹ </h2><p>æœ€è¿‘æ˜¯æœ‰ç‚¹æ‡’æƒ°äº†ï¼Œä¸“å‡æœ¬ä¸€ç›´çœ‹ç¦»æ•£æ•°å­¦ï¼ŒåŸæœ¬é¢„è®¡7æœˆä»½è¦çœ‹å®Œé¡ºè·¯åšä¸€å¥—é¢˜ï¼Œç°åœ¨æ€•æ˜¯è¦å»¶è¿Ÿä¸€ä¸ªæ˜ŸæœŸæœ€å°‘ã€‚<br>çœ‹å®Œè¿˜æœ‰ä¸‡æ¶çš„ç½‘ç»œåŸç†å’Œæ•°æ®åº“åŸç†â€¦</p><p>åŠ æ²¹ğŸ’ª</p><p>æœ€åé™„ä¸Šå‘¨æœ«å›¢å»ºçš„å›¾<br><img src="./c.jpg" width="400"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ä¸Šä¸€ç¯‡æ–‡å·²ç»æ˜¯ä¸€ä¸ªæœˆå‰çš„ï¼Œè¿˜æ˜¯æ”¹ä¸äº†æ‡’çš„ä¹ æƒ¯&lt;/p&gt;
&lt;p&gt;ä¹ æƒ¯æ€§å¯¹æœ€è¿‘åšä¸€äº›æ€»ç»“ï¼Œå…³äºé¢è¯•ï¼Œå…³äºå·¥ä½œä¸Šï¼Œå…³äºæœ€è¿‘å­¦ä¹ çš„ä¸œè¥¿ã€‚&lt;/p&gt;
&lt;h2 id=&quot;å…³äºé¢è¯•&quot;&gt;&lt;a href=&quot;#å…³äºé¢è¯•&quot; class=&quot;headerlink&quot; title=&quot;å…³äºé¢è¯•&quot;&gt;&lt;/a&gt;å…³äºé¢
      
    
    </summary>
    
      <category term="blog" scheme="https://jsonz1993.github.io/categories/blog/"/>
    
    
      <category term="blog" scheme="https://jsonz1993.github.io/tags/blog/"/>
    
  </entry>
  
  <entry>
    <title>window.printâ€”â€”å…³äºæµè§ˆå™¨æ‰“å°</title>
    <link href="https://jsonz1993.github.io/2018/06/window-print%E2%80%94%E2%80%94%E5%85%B3%E4%BA%8E%E6%B5%8F%E8%A7%88%E5%99%A8%E6%89%93%E5%8D%B0/"/>
    <id>https://jsonz1993.github.io/2018/06/window-printâ€”â€”å…³äºæµè§ˆå™¨æ‰“å°/</id>
    <published>2018-06-28T15:26:14.000Z</published>
    <updated>2019-03-13T03:30:36.820Z</updated>
    
    <content type="html"><![CDATA[<p>è¿‘æ—¥æœ‰ä¸ªéœ€æ±‚æ˜¯åšé¡µé¢æ‰“å°çš„ï¼Œè¶è¿™ä¸ªæœºä¼šè¡¥ä¸€ä¸‹æ¯”è¾ƒå†·é—¨çš„æµè§ˆå™¨æ‰“å°çŸ¥è¯†ã€‚æœ¬æ–‡ä¸»è¦è®¨è®º Chromeã€Safariã€Firefoxæµè§ˆå™¨çš„æƒ…å†µã€‚</p><h2 id="æ‰“å°æ¥å£"><a href="#æ‰“å°æ¥å£" class="headerlink" title="æ‰“å°æ¥å£"></a>æ‰“å°æ¥å£</h2><p>é¦–å…ˆæµè§ˆå™¨æ‰“å°æ˜¯ä¸€ä¸ªå¾ˆæˆç†Ÿçš„åº”ç”¨~ è‡³å°‘æ˜¯å¾ˆæ—©å°±å·²ç»æœ‰åº”ç”¨çš„åŠŸèƒ½ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰ä»€ä¹ˆå…¼å®¹é—®é¢˜</p><p>æœ€ç®€å•çš„æ‰“å°å°±æ˜¯ç›´æ¥è°ƒç”¨ <code>window.print()</code>ï¼Œå½“ç„¶ç”¨ <code>document.execCommand(&#39;print&#39;)</code> ä¹Ÿå¯ä»¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœã€‚</p><p>è¿™æ—¶å€™åœ¨Safariå’ŒChromeéƒ½ä¼šå¼¹èµ·æ‰“å°é¢„è§ˆçš„çª—å£,FireFoxæ²¡æœ‰é¢„è§ˆè€Œæ˜¯ç›´æ¥è®©ä½ é€‰æ‹©æ‰“å°æœºï¼ŒOSxä¸‹å¯ä»¥é€šè¿‡é¢„è§ˆPDFæ¥é¢„è§ˆ~</p><p>ä¸€èˆ¬è¿™ç§ç›´æ¥åœ¨ç½‘é¡µä¸Šè°ƒç”¨ print çš„æ–¹æ³•æ˜¯æ²¡åŠæ³•æ»¡è¶³æˆ‘ä»¬çš„ä¸šåŠ¡éœ€æ±‚ï¼Œæ¯”å¦‚è¯´ï¼š</p><ul><li>è°ƒæ•´å¸ƒå±€å’Œå­—ä½“å¤§å°æ¥é€‚åº”A4çº¸</li><li>æ‰“å°çš„æ—¶å€™ç”¨ä¸åŒçš„æ ·å¼é£æ ¼</li><li>ä½¿ç”¨æ›´é«˜æ¸…çš„å›¾ç‰‡æ¥æ‰“å°</li><li>æŸä¸€äº›ä¸ç›¸å…³çš„ä¸œè¥¿ä¸å‡ºç°åœ¨æ‰“å°ä¸­ç­‰ç­‰ç­‰ç­‰</li></ul><p>é‚£ä¹ˆæœ‰å“ªäº›æ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ”¹å–„æ‰“å°çš„ç”¨æˆ·ä½“éªŒå‘¢ï¼Ÿ</p><h2 id="ä½¿ç”¨-print-style-sheet-æ‰“å°æ ·å¼è¡¨"><a href="#ä½¿ç”¨-print-style-sheet-æ‰“å°æ ·å¼è¡¨" class="headerlink" title="ä½¿ç”¨ print style sheet (æ‰“å°æ ·å¼è¡¨)"></a>ä½¿ç”¨ print style sheet (æ‰“å°æ ·å¼è¡¨)</h2><p>æˆ‘ä»¬å¯ä»¥åœ¨ link ä¸ŠåŠ ä¸Šä¸€ä¸ª media=â€printâ€ æ¥æ ‡è¯†è¿™æ˜¯æ‰“å°æœºæ‰ä¼šåº”ç”¨çš„æ ·å¼è¡¨, å¦‚:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"/example.css"</span> <span class="attr">media</span>=<span class="string">"print"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·æ‰“å°çš„æ—¶å€™ï¼Œå°±ä¼šé»˜è®¤å°†è¯¥æ ·å¼è¡¨åº”ç”¨åˆ°æ–‡æ¡£ä¸­</p><h2 id="ä½¿ç”¨åª’ä»‹æŸ¥è¯¢"><a href="#ä½¿ç”¨åª’ä»‹æŸ¥è¯¢" class="headerlink" title="ä½¿ç”¨åª’ä»‹æŸ¥è¯¢"></a>ä½¿ç”¨åª’ä»‹æŸ¥è¯¢</h2><p>å…¼å®¹æ€§: IE9+ å…¶ä»–ä¸»æµæµè§ˆå™¨éƒ½æ”¯æŒ<br>å½“æˆ‘ä»¬è¦ä¿®æ”¹çš„æ ·å¼æ²¡æœ‰é‚£ä¹ˆå¤šçš„æ—¶å€™ï¼Œå…¶å®å®Œå…¨ä¸éœ€è¦é‡æ–°å†™ä¸ªæ ·å¼è¡¨ï¼Œåªè¦å†™ä¸Šä¸€ä¸ªåª’ä»‹æŸ¥è¯¢ä¹Ÿå¯ä»¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœï¼Œå¦‚:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">h1</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="keyword">media</span> print &#123;</span><br><span class="line">  <span class="selector-tag">h1</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="äº‹ä»¶ç›‘å¬"><a href="#äº‹ä»¶ç›‘å¬" class="headerlink" title="äº‹ä»¶ç›‘å¬"></a>äº‹ä»¶ç›‘å¬</h2><h3 id="beforeprint-amp-amp-afterprint"><a href="#beforeprint-amp-amp-afterprint" class="headerlink" title="beforeprint &amp;&amp; afterprint"></a>beforeprint &amp;&amp; afterprint</h3><p>æœ‰ä¸¤ä¸ªäº‹ä»¶å¯ä»¥ç›‘å¬åˆ°åˆ°æ‰“å°äº‹ä»¶ï¼Œä¸€ä¸ªæ˜¯<code>beforeprint</code>,ä¸€ä¸ªæ˜¯<code>afterprint</code>ï¼Œåˆ†åˆ«è¡¨ç¤ºæ‰“å°äº‹ä»¶è§¦å‘å‰åã€‚<br>è¿™ä¸ªäº‹ä»¶åœ¨ IE6 å°±å·²ç»æ”¯æŒäº†ï¼Œä¸è¿‡ä¸€ç‚¹éƒ½ä¸æƒŠè®¶~ æ¯•ç«ŸIEå¾ˆæ—©å°±æ”¯æŒå¾ˆå¤šæ¥å£è°ƒç”¨ï¼Œä¹‹å‰å¥½åƒåšè¿‡IEæ‰“å¼€Excelçš„éœ€æ±‚~<br>å…¼å®¹å¤§æ¦‚æ˜¯ Firefoxã€IEå…¨æ”¯æŒ, Chrome63+æ”¯æŒ, Safariæš‚ä¸æ”¯æŒï¼Œç®—æ˜¯ä¸€åŠä¸€åŠå§ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'beforeprint'</span>, ()=&gt; &#123;</span><br><span class="line">  <span class="built_in">document</span>.body.innerHTML = <span class="string">'æ­£åœ¨æ‰“å°...'</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'afterprint'</span>, ()=&gt; &#123;</span><br><span class="line">  <span class="built_in">document</span>.body.innerHTML = <span class="string">'æ‰“å°å®Œæˆ...'</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><h3 id="window-matchMedia-æµ‹è¯•åª’ä½“æŸ¥è¯¢æ¥å£"><a href="#window-matchMedia-æµ‹è¯•åª’ä½“æŸ¥è¯¢æ¥å£" class="headerlink" title="window.matchMedia æµ‹è¯•åª’ä½“æŸ¥è¯¢æ¥å£"></a>window.matchMedia æµ‹è¯•åª’ä½“æŸ¥è¯¢æ¥å£</h3><p>å¦‚æœä½ æƒ³è¦å…¼å®¹Safariæˆ–è®¸å¯ä»¥è¯•ä¸€ä¸‹ <code>window.matchMedia</code><br>å…¼å®¹æ˜¯ IE10+ï¼Œå…¶ä»–ä¸»æµæµè§ˆå™¨å®Œå…¨æ²¡é—®é¢˜ã€‚</p><p>è¿™ä¸ªçš„ç”¨æ³•ç¨å¾®æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ªMediaQueryListå¯¹è±¡ï¼Œå†é€šè¿‡ä»–ç›‘å¬å˜åŒ–ï¼Œå¦‚:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> printMedia = <span class="built_in">window</span>.matchMedia(<span class="string">'print'</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printChange</span>(<span class="params">&#123; matches, &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">document</span>.body.innerHTML = matches? <span class="string">'æ­£åœ¨æ‰“å°...'</span>: <span class="string">'æ‰“å°å®Œæˆ/å–æ¶ˆ'</span>;</span><br><span class="line">&#125;</span><br><span class="line">printMedia.addListener(printChange);</span><br></pre></td></tr></table></figure></p><h2 id="æ›´åŠ ä¸ªæ€§åŒ–å®šåˆ¶æ‰“å°åŒºåŸŸ-æ‰“å°å†…å®¹"><a href="#æ›´åŠ ä¸ªæ€§åŒ–å®šåˆ¶æ‰“å°åŒºåŸŸ-æ‰“å°å†…å®¹" class="headerlink" title="æ›´åŠ ä¸ªæ€§åŒ–å®šåˆ¶æ‰“å°åŒºåŸŸ/æ‰“å°å†…å®¹"></a>æ›´åŠ ä¸ªæ€§åŒ–å®šåˆ¶æ‰“å°åŒºåŸŸ/æ‰“å°å†…å®¹</h2><p>å¦‚æœé¡¹ç›®ä¸Šç”¨çš„æ˜¯jqç­‰ï¼Œæˆ–è€…æƒ³ç®€å•ç²—æš´çš„æ‰“å°æŸä¸ªåŒºåŸŸåˆä¸æƒ³é‡æ–°å†™æ ·å¼è¡¨å•Šï¼Œä»€ä¹ˆçš„ã€‚<br>æœ€å‚»ç“œç‰ˆçš„æ–¹å¼å°±æ˜¯ç›´æ¥ç”¨jqæ’ä»¶ <a href="https://github.com/DoersGuild/jQuery.print" target="_blank" rel="noopener">jQuery.print</a></p><p>ä¹Ÿå¯ä»¥è‡ªå·±å†™ä¸€ä¸ªå»å¤„ç†ï¼Œå¤§æ¦‚çš„æ€è·¯æ˜¯åˆ›å»ºä¸€ä¸ªiframeï¼ŒæŠŠè¦æ‰“å°çš„domå’Œæ ·å¼è¡¨éƒ½ä¸¢è¿›å»ï¼Œå†è°ƒç”¨iframeçš„æ‰“å°äº‹ä»¶ã€‚ è¿™é‡Œå†™ä¸€ä¸ªç®€å•çš„ <a href="https://github.com/jsonz1993/wheel/blob/master/print-partial/index.js" target="_blank" rel="noopener">demo</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printPartial</span>(<span class="params">dom, &#123; title= document.title,&#125;= &#123;&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!dom) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">let</span> copyDom = <span class="built_in">document</span>.createElement(<span class="string">'span'</span>);</span><br><span class="line">  <span class="keyword">const</span> styleDom = <span class="built_in">document</span>.querySelectorAll(<span class="string">'style, link, meta'</span>);</span><br><span class="line">  <span class="keyword">const</span> titleDom = <span class="built_in">document</span>.createElement(<span class="string">'title'</span>);</span><br><span class="line">  titleDom.innerText = title;</span><br><span class="line"></span><br><span class="line">  copyDom.appendChild(titleDom);</span><br><span class="line">  <span class="built_in">Array</span>.from(styleDom).forEach(<span class="function"><span class="params">item</span>=&gt;</span> &#123;</span><br><span class="line">    copyDom.appendChild(item.cloneNode(<span class="literal">true</span>));</span><br><span class="line">  &#125;);</span><br><span class="line">  copyDom.appendChild(dom.cloneNode(<span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> htmlTemp = copyDom.innerHTML;</span><br><span class="line">  copyDom = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> iframeDom = <span class="built_in">document</span>.createElement(<span class="string">'iframe'</span>);</span><br><span class="line">  <span class="keyword">const</span> attrObj = &#123;</span><br><span class="line">    height: <span class="number">0</span>,</span><br><span class="line">    width: <span class="number">0</span>,</span><br><span class="line">    border: <span class="number">0</span>,</span><br><span class="line">    wmode: <span class="string">'Opaque'</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> styleObj = &#123;</span><br><span class="line">    position: <span class="string">'absolute'</span>,</span><br><span class="line">    top: <span class="string">'-999px'</span>,</span><br><span class="line">    left: <span class="string">'-999px'</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="built_in">Object</span>.entries(attrObj).forEach(<span class="function">(<span class="params">[key, value]</span>)=&gt;</span> iframeDom.setAttribute(key, value));</span><br><span class="line">  <span class="built_in">Object</span>.entries(styleObj).forEach(<span class="function">(<span class="params">[key, value]</span>)=&gt;</span> iframeDom.style[key] = value);</span><br><span class="line">  <span class="built_in">document</span>.body.insertBefore(iframeDom, <span class="built_in">document</span>.body.children[<span class="number">0</span>]);</span><br><span class="line">  <span class="keyword">const</span> iframeWin = iframeDom.contentWindow;</span><br><span class="line">  <span class="keyword">const</span> iframeDocs = iframeWin.document;</span><br><span class="line">  iframeDocs.write(<span class="string">`&lt;!doctype html&gt;`</span>);</span><br><span class="line">  iframeDocs.write(htmlTemp);</span><br><span class="line">  iframeWin.focus();</span><br><span class="line">  iframeWin.print();</span><br><span class="line">  <span class="built_in">document</span>.body.removeChild(iframeDom);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">printPartial(<span class="built_in">document</span>.querySelector(<span class="string">'#description'</span>));</span><br></pre></td></tr></table></figure><p>æœ€åä¸€äº›æ³¨æ„çš„äº‹æƒ…</p><ul><li>æ‰“å°ä¼šæ‰“å°documentä¸‹æ‰€æœ‰å¯è§å…ƒç´ ï¼Œ åŒ…æ‹¬ <code>&lt;header&gt;</code> é‡Œé¢çš„</li><li>èƒŒæ™¯éƒ½ä¸ä¼šè¢«æ‰“å°å‡ºæ¥ï¼ŒåŒ…æ‹¬èƒŒæ™¯è‰²å•ŠèƒŒæ™¯å›¾ç‰‡å•Šç­‰ç­‰</li><li>å¦‚æœå›¾ç‰‡æ˜¯æ‡’åŠ è½½çš„ï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œä¸ç„¶æ‰“å°çš„æ—¶å€™ä¼šç›´æ¥ç©ºç™½</li></ul><p>å‚è€ƒ:<br><a href="https://blog.csdn.net/fengshuiyue/article/details/57483057" target="_blank" rel="noopener">https://blog.csdn.net/fengshuiyue/article/details/57483057</a><br><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/print" target="_blank" rel="noopener">Mozilla print</a><br><a href="https://developer.mozilla.org/en-US/docs/Web/Guide/Printing#Using_a_print_style_sheet" target="_blank" rel="noopener">Mozilla Using_a_print_style_sheet</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;è¿‘æ—¥æœ‰ä¸ªéœ€æ±‚æ˜¯åšé¡µé¢æ‰“å°çš„ï¼Œè¶è¿™ä¸ªæœºä¼šè¡¥ä¸€ä¸‹æ¯”è¾ƒå†·é—¨çš„æµè§ˆå™¨æ‰“å°çŸ¥è¯†ã€‚æœ¬æ–‡ä¸»è¦è®¨è®º Chromeã€Safariã€Firefoxæµè§ˆå™¨çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;h2 id=&quot;æ‰“å°æ¥å£&quot;&gt;&lt;a href=&quot;#æ‰“å°æ¥å£&quot; class=&quot;headerlink&quot; title=&quot;æ‰“å°æ¥å£&quot;&gt;
      
    
    </summary>
    
      <category term="technology" scheme="https://jsonz1993.github.io/categories/technology/"/>
    
    
      <category term="work" scheme="https://jsonz1993.github.io/tags/work/"/>
    
      <category term="github" scheme="https://jsonz1993.github.io/tags/github/"/>
    
  </entry>
  
  <entry>
    <title>HTTPå¸¸ç”¨çŸ¥è¯†ç‚¹æ€»ç»“</title>
    <link href="https://jsonz1993.github.io/2018/05/http-mini-book/"/>
    <id>https://jsonz1993.github.io/2018/05/http-mini-book/</id>
    <published>2018-05-23T12:17:42.000Z</published>
    <updated>2019-03-13T03:30:36.820Z</updated>
    
    <content type="html"><![CDATA[<p>åŒæ ·æ˜¯å› ä¸ºé¢è¯•çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°è‡ªå·±å¯¹httpçš„ä¸€äº›æ¦‚å¿µå’ŒçŸ¥è¯†ç‚¹å’Œé›¶ç¢ï¼Œå€Ÿæ­¤æœºä¼šçœ‹äº†ã€ŠHTTPå°ä¹¦ã€‹ï¼Œé¡ºæ‰‹å†™äº†ç¯‡è®°å½•æ€»ç»“ä¸€äº›å¸¸è§çš„httpçŸ¥è¯†ç‚¹ã€‚</p><h1 id="http-ç®€ä»‹"><a href="#http-ç®€ä»‹" class="headerlink" title="http ç®€ä»‹"></a>http ç®€ä»‹</h1><p>è¯·æ±‚:<br>å®¢æˆ·ç«¯è½¯ä»¶æ‰“å¼€åˆ°æœåŠ¡å™¨çš„è¿æ¥ï¼Œå‘èµ·è¯·æ±‚å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GET /hello.htm HTTP/1.1</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.181 Safari/537.36</span><br><span class="line">Host: example.com</span><br><span class="line">Accept-Language: en-us</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br></pre></td></tr></table></figure></p><p>å“åº”:<br>æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚æ¶ˆæ¯åæ ¹æ®èµ„æºå®šä½ç¬¦åœ¨æœåŠ¡å™¨æ‰¾åˆ°è¯¥èµ„æºï¼Œå¹¶å“åº”ç»™å®¢æˆ·ç«¯:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">X-Powered-By: Express</span><br><span class="line">Content-Type: text/html; charset=utf-8</span><br><span class="line">Content-Length: 22</span><br><span class="line">ETag: W/&quot;16-dDTk/xb5lvRNBfrz6lE//HVBox8&quot;</span><br><span class="line">Date: Tue, 22 May 2018 03:04:08 GMT</span><br><span class="line">Connection: keep-alive</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;Hello, Jsonz!&lt;/h1&gt;</span><br></pre></td></tr></table></figure></p><h2 id="è¯·æ±‚æ¶ˆæ¯"><a href="#è¯·æ±‚æ¶ˆæ¯" class="headerlink" title="è¯·æ±‚æ¶ˆæ¯"></a>è¯·æ±‚æ¶ˆæ¯</h2><p>è¯·æ±‚ä¿¡æ¯ä¸€èˆ¬ç”±è¯·æ±‚è¡Œã€å¤´éƒ¨å­—æ®µåŒºã€CRLFä¸æ¶ˆæ¯ä¸»ä½“ï¼ˆå¯é€‰ï¼‰ç»„æˆ</p><h3 id="è¯·æ±‚è¡Œ"><a href="#è¯·æ±‚è¡Œ" class="headerlink" title="è¯·æ±‚è¡Œ"></a>è¯·æ±‚è¡Œ</h3><p>è¯·æ±‚æ¶ˆæ¯çš„ç¬¬ä¸€è¡Œç§°ä¸ºè¯·æ±‚è¡Œï¼Œä¸€èˆ¬åŒ…æ‹¬ <code>è¯·æ±‚æ–¹æ³•</code>ï¼Œ <code>è¯·æ±‚èµ„æºæ ‡è¯†ç¬¦</code> è¿˜æœ‰è¯·æ±‚çš„<code>åè®®ç‰ˆæœ¬</code></p><blockquote><p>Request-List = Method SPACE Request-URI SPACE HTTP-Version CRLF</p></blockquote><p>è¯·æ±‚æ–¹æ³•æ¯”è¾ƒå¸¸ç”¨çš„æœ‰ <code>GET</code>, <code>POST</code>ã€‚ è¿™é‡Œç”¨çš„æ˜¯<code>GET</code> å‘èµ·ä¸€ä¸ªè¯·æ±‚è·å–èµ„æº</p><ul><li>GET è¯·æ±‚ä¸€ä¸ªåˆ¶å®šåç§°çš„èµ„æº</li><li>POST åˆ›å»ºä¸€ä¸ªæ–°çš„å­èµ„æºï¼Œæˆ–è€…æ›´æ–°ä¸€ä¸ªå­˜åœ¨çš„èµ„æº</li><li>PUT æŒ‡å®šçš„URLä¸å­˜åœ¨åˆ™åˆ›å»ºï¼Œå­˜åœ¨åˆ™ä¿®æ”¹</li><li>DELETE åˆ é™¤æŒ‡å®šèµ„æº</li><li>OPTIONS è¿”å›æœåŠ¡å™¨æ”¯æŒçš„æ–¹æ³•</li><li>CONNECTã€TRACE</li></ul><blockquote><p>å¯¹äº POST å’Œ PUTçš„é€‰æ‹©ï¼Œä½œè€…ç»™å‡ºçš„ä¾‹å­æ˜¯åˆ›å»ºè®¢å•<br>PUT /other/1 åˆ›å»ºå•å·ä¸º1çš„è®¢å•ï¼Œå¦‚æœå­˜åœ¨å°±æ›´æ–°ä»–ï¼Œè®¢å•å·ç”±å®¢æˆ·ç«¯æä¾›<br>POST /other åˆ›å»ºè®¢å•ï¼Œè®¢å•å·ç”±æœåŠ¡ç«¯æä¾›<br>POST /other/1 æ›´æ–°è®¢å•ï¼Œå¦‚æœä¸å­˜åœ¨åº”è¯¥æŠ›é”™<br>é‡å¤æ‰§è¡ŒPUTè¯·æ±‚ä¸ä¼šå½±å“æœåŠ¡å™¨çŠ¶æ€ï¼Œè€ŒPOSTåˆ™ä¼šå¯¼è‡´åˆ›å»ºä¸¤ä¸ªè®¢å•</p></blockquote><p>ä½†æ˜¯å·¥ä½œä¸­ï¼Œå‡ ä¹åªç”¨è¿‡GETå’ŒPOSTï¼Œå¯¹äºåˆ›å»ºè®¢å•çš„ä¾‹å­ä¸­ï¼ŒPUTå’ŒPOSTçš„åŒºåˆ«æˆ‘çš„ç†è§£æ¯”è¾ƒæµ…æ˜¾ï¼Œä¸€ä¸ªæ˜¯å®¢æˆ·ç«¯/æœåŠ¡ç«¯æä¾›è®¢å•å·ï¼Œä¸€ä¸ªæ˜¯è¯­ä¹‰åŒ–ã€‚</p><h3 id="å¤´éƒ¨å­—æ®µ"><a href="#å¤´éƒ¨å­—æ®µ" class="headerlink" title="å¤´éƒ¨å­—æ®µ"></a>å¤´éƒ¨å­—æ®µ</h3><p>ä»ç¬¬äºŒè¡Œåˆ°ç©ºè¡Œä¹‹é—´éƒ½å±äºå¤´éƒ¨å­—æ®µåŒºï¼Œç”¨æ¥ä¼ é€’æ›´å¤šè¯¦ç»†çš„ä¿¡æ¯ï¼Œè¿™ä¸ªæ¡ˆä¾‹é‡Œé¢æ˜¯<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.181 Safari/537.36</span><br><span class="line">Host: example.com</span><br><span class="line">Accept-Language: en-us</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br></pre></td></tr></table></figure></p><p>æ¯”å¦‚è¯´è¿™é‡Œ:<br><code>User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.181 Safari/537.36</code> æˆ‘ä»¬å¯ä»¥çŸ¥é“å®¢æˆ·ç«¯ç”¨çš„æ˜¯ Mac OSxç³»ç»Ÿï¼ŒChrome v66.0.xç‰ˆæœ¬çš„æµè§ˆå™¨<br><code>Accept-Language: en-us</code> è¯­è¨€æ˜¯è‹±è¯­<br><code>Accept-Encoding: gzip, deflate</code> æ”¯æŒçš„å‹ç¼©ç¼–ç ä¸ºgzipå’Œdeflate</p><h3 id="ç©ºè¡Œ-CRLF"><a href="#ç©ºè¡Œ-CRLF" class="headerlink" title="ç©ºè¡Œ(CRLF)"></a>ç©ºè¡Œ(CRLF)</h3><p>ç©ºè¡Œä¹Ÿå«CRLFï¼Œæ˜¯éš”å¼€è¯·æ±‚å¤´ä¸è¯·æ±‚ä¸»ä½“çš„</p><h3 id="æ¶ˆæ¯ä¸»ä½“"><a href="#æ¶ˆæ¯ä¸»ä½“" class="headerlink" title="æ¶ˆæ¯ä¸»ä½“"></a>æ¶ˆæ¯ä¸»ä½“</h3><p>å‘é€ç»™æœåŠ¡ç«¯çš„æ¶ˆæ¯ï¼Œæ¯”å¦‚ç”¨POSTæ–¹æ³•æäº¤è¡¨å•æ—¶ï¼Œè¡¨å•çš„å†…å®¹å°±æ˜¯å­˜åœ¨æ¶ˆæ¯ä¸»ä½“é‡Œé¢ã€‚å¦‚æœæ˜¯ç”¨GETæ–¹æ³•å°±ä¼šä¸¢åˆ°è¯·æ±‚URLé‡Œ</p><h2 id="å“åº”ä¿¡æ¯"><a href="#å“åº”ä¿¡æ¯" class="headerlink" title="å“åº”ä¿¡æ¯"></a>å“åº”ä¿¡æ¯</h2><p>å“åº”ä¿¡æ¯å’Œè¯·æ±‚ä¿¡æ¯çš„ç»„æˆç»“æ„ç›¸ä¼¼ï¼Œç”±çŠ¶æ€è¡Œã€å¤´éƒ¨å­—æ®µè¡Œã€ç©ºè¡Œï¼ˆCRLFï¼‰å’Œæ¶ˆæ¯ä¸»ä½“æ„æˆã€‚</p><h3 id="çŠ¶æ€è¡Œ"><a href="#çŠ¶æ€è¡Œ" class="headerlink" title="çŠ¶æ€è¡Œ"></a>çŠ¶æ€è¡Œ</h3><p><code>HTTP/1.1 200 OK</code></p><p>è¯·æ±‚è¡Œä¸€èˆ¬ç”± <code>åè®®ç‰ˆæœ¬å·</code>ã€<code>çŠ¶æ€ç </code>ä¸<code>çŠ¶æ€ç æè¿°</code>ç»„æˆã€‚</p><p>åè®®ç‰ˆæœ¬å·æœ‰: 0.9ã€1.0ã€1.1ã€2.0ç­‰ï¼Œç›®å‰æ¯”è¾ƒæµè¡Œçš„æ˜¯2.0ä¸1.1</p><p>çŠ¶æ€ç æœ‰ä»¥ä¸‹å‡ ç§ç±»å‹ï¼ŒçŠ¶æ€ç å’Œå‰ç«¯å¼€å‘ä¼šæ¯”è¾ƒç›¸å…³ä¸€ç‚¹ï¼Œæ›´å…·ä½“çš„ä»‹ç»åé¢ä¼šè¯¦ç»†è¯´</p><ul><li>1xx ä¿¡æ¯æç¤º</li><li>2xx æˆåŠŸ</li><li>3xx é‡å®šå‘</li><li>4xx å®¢æˆ·ç«¯é”™è¯¯</li><li>5xx æœåŠ¡ç«¯é”™è¯¯</li></ul><h3 id="å¤´éƒ¨å­—æ®µ-1"><a href="#å¤´éƒ¨å­—æ®µ-1" class="headerlink" title="å¤´éƒ¨å­—æ®µ"></a>å¤´éƒ¨å­—æ®µ</h3><p>çŠ¶æ€è¡Œä¸ç©ºè¡Œä¹‹é—´å°±æ˜¯å“åº”å¤´éƒ¨å­—æ®µäº†ï¼Œ å“åº”å¤´æ¯”è¯·æ±‚å¤´åŠŸèƒ½ç›¸å¯¹æ¥è¯´å¤šä¸€ç‚¹ï¼Œæ¯”å¦‚åé¢ä¼šè¯´åˆ°çš„<code>Set-Cookie</code>ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">X-Powered-By: Express</span><br><span class="line">Content-Type: text/html; charset=utf-8</span><br><span class="line">Content-Length: 22</span><br><span class="line">ETag: W/&quot;16-dDTk/xb5lvRNBfrz6lE//HVBox8&quot;</span><br><span class="line">Date: Tue, 22 May 2018 03:04:08 GMT</span><br><span class="line">Connection: keep-alive</span><br></pre></td></tr></table></figure></p><p>å“åº”å¤´åŒ…æ‹¬ä¸€äº›æœåŠ¡æœ¬èº«çš„ä¿¡æ¯ä»¥åŠå“åº”å†…å®¹ä½“çš„ä¿¡æ¯ï¼Œæ¯”å¦‚è¿™é‡Œçš„<br><code>Date: Tue, 22 May 2018 03:04:08 GMT</code> æ˜¯å“åº”çš„æ—¶é—´<br><code>Content-Length: 22</code>æ˜¯è¿”å›çš„æ¶ˆæ¯ä½“é•¿åº¦ã€‚</p><h3 id="ç©ºè¡Œ-CRLF-1"><a href="#ç©ºè¡Œ-CRLF-1" class="headerlink" title="ç©ºè¡Œ(CRLF)"></a>ç©ºè¡Œ(CRLF)</h3><p>å’Œè¯·æ±‚çš„CRLFæ˜¯ä¸€æ ·çš„ï¼Œç”¨æ¥éš”å¼€å“åº”å¤´å’Œå“åº”å†…å®¹ä¸»ä½“</p><h3 id="å“åº”æ¶ˆæ¯ä¸»ä½“"><a href="#å“åº”æ¶ˆæ¯ä¸»ä½“" class="headerlink" title="å“åº”æ¶ˆæ¯ä¸»ä½“"></a>å“åº”æ¶ˆæ¯ä¸»ä½“</h3><p>åœ¨æˆ‘ä»¬è¿™ä¸ªä¾‹å­é‡Œé¢æ˜¯ä¸€å¥å¾ˆç®€å•çš„ <code>&lt;h1&gt;Hello, Jsonz!&lt;/h1&gt;</code>ï¼Œè¿™é‡Œå“åº”ä¸»ä½“æœ‰å¾ˆå¤šç§æ ¼å¼ï¼Œå¦‚æœæ˜¯gifçš„è¯ä¼šè¿”å›gifçš„äºŒè¿›åˆ¶å­—èŠ‚é›†åˆ</p><h1 id="è¯·æ±‚"><a href="#è¯·æ±‚" class="headerlink" title="è¯·æ±‚"></a>è¯·æ±‚</h1><p>è¯·æ±‚çš„ç»“æ„ç»„æˆRequest:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Request-Line CRLF</span><br><span class="line">*Request-HEAD CRLF</span><br><span class="line">CRLF</span><br><span class="line">[ message-body ]</span><br></pre></td></tr></table></figure></p><blockquote><p>Request-Line =&gt; Request-List = Method SPACE Request-URI SPACE HTTP-Version CRLF<br>è¿™é‡Œæˆ‘ä»¬ä¸»è¦Request-Methodséƒ¨åˆ†</p></blockquote><h2 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h2><p>GET æ–¹æ³•ä¸€èˆ¬æ˜¯ç”¨æ¥è·å–URLæŒ‡å®šçš„èµ„æº</p><h3 id="å¯ä»¥é…åˆ-Range-æ¥è·å–å±€éƒ¨èµ„æºã€‚"><a href="#å¯ä»¥é…åˆ-Range-æ¥è·å–å±€éƒ¨èµ„æºã€‚" class="headerlink" title="å¯ä»¥é…åˆ Range æ¥è·å–å±€éƒ¨èµ„æºã€‚"></a>å¯ä»¥é…åˆ <code>Range</code> æ¥è·å–å±€éƒ¨èµ„æºã€‚</h3><p>å‘èµ·è¯·æ±‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET /index.txt HTTP/1.1</span><br><span class="line">Range: bytes=0-4</span><br></pre></td></tr></table></figure></p><p>æœåŠ¡ç«¯å“åº”<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 206 Partial Content</span><br><span class="line">Content-Type: text/html</span><br><span class="line">Content-Range: bytes 0-5/12</span><br><span class="line">Content-Length: 5</span><br><span class="line">hello</span><br></pre></td></tr></table></figure></p><p>åœ¨ä¸€äº›è§†é¢‘çš„åœºæ™¯ï¼Œæ¯”å¦‚ç”¨æˆ·ç‚¹å‡»åˆ°æŸä¸ªè¿›åº¦ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä»è¯¥è¿›åº¦å»è¯·æ±‚ï¼Œè€Œä¸æ˜¯æ•´ä¸€ä¸ªè§†é¢‘éƒ½è¯·æ±‚ä¸‹æ¥ã€‚<br>å“åº”å¤´çš„<code>Content-Range: bytes 0-5/12</code>æŒ‡çš„æ˜¯å½“å‰è¿”å›0-5ï¼Œæ€»é•¿ä¸º12ã€‚</p><h3 id="é…åˆ-ETag-åšç¼“å­˜"><a href="#é…åˆ-ETag-åšç¼“å­˜" class="headerlink" title="é…åˆ ETag åšç¼“å­˜"></a>é…åˆ ETag åšç¼“å­˜</h3><p>æœåŠ¡ç«¯åœ¨å“åº”å¤´é‡Œé¢ä¼šç»™ä¸€ä¸ª<code>ETag</code>æ ‡è¯†ï¼Œè¿™ä¸ªæ ‡è¯†æˆ‘ä»¬åœ¨å¼€å¤´çš„æ—¶å€™æœ‰è¯´äº†æ˜¯æ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥è¿™ä¹ˆåšï¼Œåœ¨GETè¯·æ±‚æ—¶ä½¿ç”¨æ¡ä»¶è·å–å¤´éƒ¨å­—æ®µï¼Œå¦‚æœæœåŠ¡ç«¯å‘ç°è¿™ä¸ªå­—æ®µä¸æ–‡ä»¶çš„ETagæ ‡è¯†åŒ¹é…ï¼Œåˆ™å¯ä»¥åšç¼“å­˜ï¼Œå¦åˆ™å‘é€æ–°çš„æ–‡æ¡£è¿‡æ¥ã€‚</p><p>å‘èµ·è¯·æ±‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET /hello.htm HTTP/1.1</span><br><span class="line">If-None-Match:  W/&quot;16-dDTk/xb5lvRNBfrz6lE//HVBox8&quot;</span><br></pre></td></tr></table></figure></p><p>æœåŠ¡ç«¯å“åº”<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 304 Not Modified</span><br><span class="line">X-Powered-By: Express</span><br><span class="line">ETag: W/&quot;16-dDTk/xb5lvRNBfrz6lE//HVBox8&quot;</span><br><span class="line">Date: Tue, 22 May 2018 12:08:23 GMT</span><br><span class="line">Connection: keep-alive</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œæˆ‘ä»¬çš„ETagä¸æ–‡ä»¶åŒ¹é…ä¸Šäº†ï¼Œæ‰€ä»¥æœåŠ¡ç«¯ç›´æ¥å“åº” 304 çŠ¶æ€ç (Not Modified);</p><h2 id="HEAD"><a href="#HEAD" class="headerlink" title="HEAD"></a>HEAD</h2><p>HEADæ–¹æ³•å’ŒGETæ–¹æ³•çš„åŒºåˆ«æ˜¯ HEADæ–¹æ³•è¯·æ±‚ï¼Œå“åº”çš„æ—¶å€™å°±åªä¼šå‘é€å“åº”æ¶ˆæ¯çš„å¤´éƒ¨å­—æ®µï¼Œä¸ä¼šæŠŠå“åº”æ¶ˆæ¯ä¸»ä½“è¿”å›</p><p>é‚£ä¹ˆHEADçš„åœºæ™¯ä¸€èˆ¬åœ¨ä»€ä¹ˆåœ°æ–¹å‘¢ï¼Ÿ ä¸€èˆ¬å¯ç”¨äºå‘èµ·ä¸€ä¸ªè¯·æ±‚æ¥è·å–æœåŠ¡ç«¯çš„èµ„æºå¤§å°ï¼Œå†åˆ†æ®µè·å–ã€‚</p><h2 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h2><p>æˆ‘ä»¬å¹³æ—¶å¤§éƒ¨åˆ†åœºæ™¯ç”¨çš„éƒ½æ˜¯POSTæ–¹æ³•ï¼Œå› ä¸ºPOSTæ–¹æ³•ä¸ä¼šæŠŠå‚æ•°éƒ½ä¸¢åœ¨URLä¸Šï¼Œå¯¹è¯·æ±‚çš„æ•°æ®å¤§å°æ²¡æœ‰é™åˆ¶ï¼Œè¯·æ±‚ä¹Ÿä¸ä¼šç¼“å­˜ã€‚</p><h2 id="OPTIONS"><a href="#OPTIONS" class="headerlink" title="OPTIONS"></a>OPTIONS</h2><p>OPTIONSæ–¹æ³•ä¸»è¦æ˜¯ç”¨æ¥æŸ¥è¯¢URLæŒ‡å®šçš„èµ„æºæ‰€æ”¯æŒçš„æ–¹æ³•åˆ—è¡¨</p><p>å‘èµ·è¯·æ±‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OPTIONS /hello.htm HTTP/1.1</span><br></pre></td></tr></table></figure></p><p>æœåŠ¡ç«¯å“åº”<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">X-Powered-By: Express</span><br><span class="line">Allow: GET,HEAD</span><br><span class="line">Content-Type: text/html; charset=utf-8</span><br><span class="line">Content-Length: 8</span><br><span class="line">ETag: W/&quot;8-ZRAf8oNBS3Bjb/SU2GYZCmbtmXg&quot;</span><br><span class="line">Date: Tue, 22 May 2018 12:20:42 GMT</span><br><span class="line">Connection: keep-alive</span><br><span class="line"></span><br><span class="line">GET,HEAD%</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œåˆ—å‡ºäº†è¿™ä¸ªèµ„æºæ”¯æŒ GETä¸HEADæ–¹æ³•</p><h2 id="PUT"><a href="#PUT" class="headerlink" title="PUT"></a>PUT</h2><p>PUTæ–¹æ³•ä¸Šé¢è®²äº†æ˜¯ å¯¹URLæŒ‡å®šçš„èµ„æºè¿›è¡Œåˆ›å»ºï¼Œå¦‚æœå­˜åœ¨å°±ä¿®æ”¹ä»–ã€‚</p><p>ç†è®ºä¸Šè¿™ç§éœ€æ±‚ç›´æ¥ç”¨POSTæ–¹æ³•å°±å®Œå…¨å¤Ÿç”¨äº†ï¼Œæ¯”å¦‚åˆ›å»ºè®¢å•<code>POST /order/create</code><br>æ›´æ–°è®¢å• <code>POST /order/orderId</code></p><p>ä½†æ˜¯è¿™é‡Œå¦‚æœæ”¹æˆPUTåˆ›å»ºçš„è¯ï¼Œå¯ä»¥ç›´æ¥è¿™æ · <code>PUT /order</code> æ›´ç¬¦åˆRestful APIè§„èŒƒï¼Œå¦‚æœæ¢æˆå‰ç«¯çš„å±‚é¢æ¥è¯´ï¼Œå°±åƒ<code>div</code>ä¸<code>header, nav, section, aside, footer</code>è¿™äº›æ›´æœ‰è¯­ä¹‰åŒ–çš„æ ‡ç­¾ã€‚</p><h2 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h2><p>åˆ é™¤æŸä¸ªèµ„æºï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„</p><h2 id="CONNECT"><a href="#CONNECT" class="headerlink" title="CONNECT"></a>CONNECT</h2><blockquote><p>åœ¨å½“å‰å·²ç»å»ºç«‹HTTPè¿æ¥çš„æƒ…å†µä¸‹ï¼ŒCONNECT æ–¹æ³•ç”¨æ¥å‘ŠçŸ¥ä»£ç†æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯æƒ³è¦å’ŒæœåŠ¡å™¨ä¹‹é—´å»ºç«‹SSLè¿æ¥ã€‚</p></blockquote><blockquote><p>å®¢æˆ·ç«¯ä½¿ç”¨å¦‚ä¸‹æ¶ˆæ¯ï¼Œé€šçŸ¥ä»£ç†æœåŠ¡å™¨ï¼Œå»åšä¸€ä¸ªè¿æ¥åˆ°æŒ‡å®šçš„æœåŠ¡å™¨åœ°å€å’Œç«¯å£:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CONNECT example.com 443 HTTP/1.1</span><br></pre></td></tr></table></figure></p></blockquote><blockquote><p>ä»£ç†æœåŠ¡å™¨éšåæå–CONNECT æ–¹æ³•æŒ‡å®šçš„åœ°å€å’Œç«¯å£ï¼ˆè¿™é‡Œæ˜¯ example.com 443 ï¼‰ï¼Œå»ºç«‹å’Œæ­¤æœåŠ¡å™¨çš„SSLè¿æ¥ï¼ŒæˆåŠŸåéšåé€šçŸ¥å®¢æˆ·ç«¯ï¼Œéœ€è¦çš„è¿æ¥å»ºç«‹å®Œæ¯•ï¼š</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 OK</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨CONNECTå‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡ç«¯ä¸ä¼šå»è§£æå­—æ®µç­‰æ“ä½œï¼Œè€Œæ˜¯å®Œå®Œå…¨å…¨å•çº¯çš„åšè½¬å‘ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºé€æ˜ä»£ç†ã€‚</p><h2 id="TRACE"><a href="#TRACE" class="headerlink" title="TRACE"></a>TRACE</h2><p>æŸ¥è¯¢åˆ°ç›®æ ‡èµ„æºç»è¿‡çš„ä¸­é—´èŠ‚ç‚¹ã€‚</p><h1 id="å“åº”"><a href="#å“åº”" class="headerlink" title="å“åº”"></a>å“åº”</h1><p>å“åº”ç»“æ„ç»„æˆResponse:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Response-Line</span><br><span class="line">*(header CRLF) </span><br><span class="line">CRLF</span><br><span class="line">[ message-body ]</span><br></pre></td></tr></table></figure></p><blockquote><p>Response-Line =&gt; HTTP-Version SPACE Status-Code SPACE Reason-Phrease CRLF<br>è¿™é‡Œæˆ‘ä»¬ä¸»è¦Status-Codeéƒ¨åˆ†</p></blockquote><h2 id="1xx"><a href="#1xx" class="headerlink" title="1xx"></a>1xx</h2><h3 id="100-Continue"><a href="#100-Continue" class="headerlink" title="100 Continue"></a>100 Continue</h3><p>æœåŠ¡å™¨å·²ç»æ¥æ”¶åˆ°è¯·æ±‚å¤´ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯åº”ç»§ç»­å‘é€è¯·æ±‚ä¸»ä½“ï¼ˆåœ¨éœ€è¦å‘é€èº«ä½“çš„è¯·æ±‚çš„æƒ…å†µä¸‹ï¼šä¾‹å¦‚ï¼ŒPOSTè¯·æ±‚ï¼‰ï¼Œæˆ–è€…å¦‚æœè¯·æ±‚å·²ç»å®Œæˆï¼Œå¿½ç•¥è¿™ä¸ªå“åº”ã€‚</p><p>æ¯”å¦‚å®¢æˆ·ç«¯ä¸Šä¼ ä¸€äº›è§†é¢‘æ–‡ä»¶ï¼Œå¯ä»¥å…ˆåœ¨è¯·æ±‚å¤´åŠ ä¸€ä¸ª<code>Expect: 100-continue</code> å¦‚æœæœåŠ¡ç«¯å…è®¸æ¥æ”¶è¯¥æ–‡ä»¶ï¼ˆå¤§å°ï¼‰ï¼Œå°±è¿”å›100ï¼Œä¸å…è®¸åˆ™è¿”å›417çŠ¶æ€ç ã€‚</p><h2 id="2xx"><a href="#2xx" class="headerlink" title="2xx"></a>2xx</h2><p>2xx ç³»åˆ—éƒ½æ˜¯è¡¨ç¤ºè¯·æ±‚å·²ç»æˆåŠŸå¤„ç†äº†ï¼Œè¿™é‡Œåˆ—ä¸¾å‡ ä¸ªæ¯”è¾ƒå¸¸è§çš„</p><h3 id="200-OK"><a href="#200-OK" class="headerlink" title="200 OK"></a>200 OK</h3><p>æœ€å¸¸è§çš„å¯èƒ½å°±æ˜¯200äº†ï¼Œå¹³æ—¶å†™ajaxå¾ˆå¤šéƒ½æ˜¯ç›´æ¥åˆ¤æ–­ <code>xmlhttp.status==200</code>, ä»–ä»£è¡¨çš„æ˜¯è¯·æ±‚å·²ç»æˆåŠŸå®Œæˆ</p><h3 id="201-Created"><a href="#201-Created" class="headerlink" title="201 Created"></a>201 Created</h3><p>201è¡¨ç¤ºè¯·æ±‚å·²ç»è¢«å®ç°ï¼Œè€Œä¸”æœ‰ä¸€ä¸ªæ–°çš„èµ„æºå·²ç»ä¾æ®è¯·æ±‚çš„éœ€è¦è€Œåˆ›å»ºï¼Œä¸”å…¶URIå·²ç»éšLocationå¤´ä¿¡æ¯è¿”å›ã€‚å‡å¦‚éœ€è¦çš„èµ„æºæ— æ³•åŠæ—¶åˆ›å»ºçš„è¯ï¼Œåº”å½“è¿”å›â€™202 Acceptedâ€™ã€‚</p><h3 id="202-Accepted"><a href="#202-Accepted" class="headerlink" title="202 Accepted"></a>202 Accepted</h3><p>202ä»£è¡¨æœåŠ¡å™¨å·²æ¥å—è¯·æ±‚ï¼Œä½†å°šæœªå¤„ç†ã€‚æœ€ç»ˆè¯¥è¯·æ±‚å¯èƒ½ä¼šä¹Ÿå¯èƒ½ä¸ä¼šè¢«æ‰§è¡Œï¼Œå¹¶ä¸”å¯èƒ½åœ¨å¤„ç†å‘ç”Ÿæ—¶è¢«ç¦æ­¢</p><h3 id="204-No-Content"><a href="#204-No-Content" class="headerlink" title="204 No Content"></a>204 No Content</h3><p>æœåŠ¡å™¨æˆåŠŸå¤„ç†äº†è¯·æ±‚ï¼Œæ²¡æœ‰è¿”å›ä»»ä½•å†…å®¹ã€‚</p><h3 id="206-Partical-Content"><a href="#206-Partical-Content" class="headerlink" title="206 Partical Content"></a>206 Partical Content</h3><p>206ä¸»è¦æ˜¯ä¸ºäº†æ”¯æŒå¤§æ–‡ä»¶çš„åˆ†æ®µä¸‹è½½ï¼Œç±»ä¼¼è¿…é›·è¿™ç±»çš„HTTP ä¸‹è½½å·¥å…·éƒ½æ˜¯ä½¿ç”¨æ­¤ç±»å“åº”å®ç°æ–­ç‚¹ç»­ä¼ æˆ–è€…å°†ä¸€ä¸ªå¤§æ–‡æ¡£åˆ†è§£ä¸ºå¤šä¸ªä¸‹è½½æ®µåŒæ—¶ä¸‹è½½ã€‚</p><p>è¿™é‡Œç”¨ä¹¦é‡Œçš„ä¸€ä¸ªä¾‹å­æ¥å±•ç¤º,å…ˆç”¨ HEAD è·å–è¯¥èµ„æºçš„å¤§å°ï¼Œå†ç”¨Rangeåˆ†æ®µè·å–ï¼Œè¿™äº›æ–¹æ³•ä¸Šé¢éƒ½æœ‰ä»‹ç»è¿‡ï¼Œè¿™é‡Œç»¼åˆèµ·æ¥è¿ç”¨:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">HEAD /large.jpg HTTP/1.1</span><br><span class="line">Host: example.com</span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Accept-Ranges: bytes</span><br><span class="line">Content-Length: 4000</span><br><span class="line"></span><br><span class="line">Get /large.jpg HTTP/1.1</span><br><span class="line">Host: example.com</span><br><span class="line">Range: bytes=0-1999</span><br><span class="line"></span><br><span class="line">HTTP/1.1 206 Partical Content</span><br><span class="line">Accept-Ranges: bytes</span><br><span class="line">Content-Length: 2000</span><br><span class="line">Content-Range: bytes 0-1999/4000</span><br><span class="line"></span><br><span class="line">&#123;binary data&#125;</span><br><span class="line"></span><br><span class="line">GET /large.jpg HTTP/1.1</span><br><span class="line">Host: example.com</span><br><span class="line">Range: bytes=2000-</span><br><span class="line"></span><br><span class="line">HTTP/1.1 206 Partical Content</span><br><span class="line">Accept-Ranges: bytes</span><br><span class="line">Content-Length: 2000</span><br><span class="line">Content-Range: bytes 2000-3999/4000</span><br><span class="line"></span><br><span class="line">&#123;binary data&#125;</span><br></pre></td></tr></table></figure></p><p>2xx å¾ˆå¤šåªæ˜¯è§„èŒƒä¸è¯­ä¹‰åŒ–çš„åŒºåˆ«ã€‚</p><h2 id="3xx"><a href="#3xx" class="headerlink" title="3xx"></a>3xx</h2><p>3xxç³»åˆ—é™¤äº† 304 ä»¥å¤–ï¼Œå…¶ä»–éƒ½æ˜¯ç”¨äºé‡å®šå‘çš„</p><h3 id="300-Multiple-Choices"><a href="#300-Multiple-Choices" class="headerlink" title="300 Multiple Choices"></a>300 Multiple Choices</h3><p>300æ˜¯è¯·æ±‚çš„èµ„æºæœ‰ä¸€ç³»åˆ—å¯ä¾›é€‰æ‹©çš„å›é¦ˆä¿¡æ¯ï¼Œç”¨æˆ·æˆ–æµè§ˆå™¨èƒ½å¤Ÿè‡ªè¡Œé€‰æ‹©ä¸€ä¸ªé¦–é€‰çš„åœ°å€è¿›è¡Œé‡å®šå‘ã€‚</p><h3 id="301-Moved-Permanently-amp-amp-302-Found"><a href="#301-Moved-Permanently-amp-amp-302-Found" class="headerlink" title="301 Moved Permanently &amp;&amp; 302 Found"></a>301 Moved Permanently &amp;&amp; 302 Found</h3><p>301 ä¸ 302 éƒ½ä»£è¡¨å½“å‰è®¿é—®çš„URLå¯¹åº”çš„èµ„æºè¢«ç§»åŠ¨åˆ°ä¸€ä¸ªæ–°çš„ä½ç½®ï¼Œè¿™ä¸ªä½ç½®ä¼šåœ¨å“åº”å¤´Locationå†…æŒ‡å®šã€‚<br>ä»–ä»¬çš„åŒºåˆ«æ˜¯ 301æ˜¯æ°¸ä¹…è¢«ç§»åŠ¨åˆ°æ–°ä½ç½®ï¼Œè€Œ302æ˜¯æš‚æ—¶æ€§çš„ä¸´æ—¶é‡å®šå‘</p><h3 id="304-Not-Modified"><a href="#304-Not-Modified" class="headerlink" title="304 Not Modified"></a>304 Not Modified</h3><p>304æˆ‘ä»¬åœ¨å‰é¢å·²ç»æœ‰è§åˆ°è¿‡äº†ï¼Œç”¨ETagä¸If-None-Matché…åˆåšç¼“å­˜æ—¶ï¼Œå°±ä¼šè¿”å›304 ä»£è¡¨è¯¥èµ„æºæœªè¢«ä¿®æ”¹ï¼Œå¯ä»¥ç»§ç»­ç”¨ä»¥å‰ä¸‹è½½çš„å‰¯æœ¬ã€‚</p><h2 id="400"><a href="#400" class="headerlink" title="400"></a>400</h2><p>400æŒ‡çš„æ˜¯å®¢æˆ·ç«¯é”™è¯¯ï¼Œæ—¢æœåŠ¡ç«¯æ¥æ”¶åˆ°è¯¥è¯·æ±‚ï¼Œä½†æ˜¯æ”¶åˆ°çš„è¯·æ±‚æ— æ³•å¤„ç†,è¿™é‡Œåˆ—å‡ºå¸¸è§çš„å‡ ç§</p><h3 id="400-Bad-Request"><a href="#400-Bad-Request" class="headerlink" title="400 Bad Request"></a>400 Bad Request</h3><p>ç”±äºæ˜æ˜¾çš„å®¢æˆ·ç«¯é”™è¯¯ï¼ˆä¾‹å¦‚ï¼Œæ ¼å¼é”™è¯¯çš„è¯·æ±‚è¯­æ³•ï¼Œå¤ªå¤§çš„å¤§å°ï¼Œæ— æ•ˆçš„è¯·æ±‚æ¶ˆæ¯æˆ–æ¬ºéª—æ€§è·¯ç”±è¯·æ±‚ï¼‰ï¼ŒæœåŠ¡å™¨ä¸èƒ½æˆ–ä¸ä¼šå¤„ç†è¯¥è¯·æ±‚</p><h3 id="401-Unauthorized"><a href="#401-Unauthorized" class="headerlink" title="401 Unauthorized"></a>401 Unauthorized</h3><p>401æ—¢æœªè®¤è¯ï¼Œåº”è¯¥æ˜¯æœ€ç®€å•çš„ç”¨æˆ·è®¤è¯ç™»å½•ç³»ç»Ÿäº†ã€‚ä¸403ä¸åŒï¼Œè¿™é‡Œå¦‚æœç”¨æˆ·æä¾›å¿…è¦çš„å‡­æ®ï¼Œå°±å¯ä»¥è®¿é—®èµ„æºã€‚</p><h3 id="403-Forbidden"><a href="#403-Forbidden" class="headerlink" title="403 Forbidden"></a>403 Forbidden</h3><p>æœåŠ¡å™¨å·²ç»ç†è§£è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æ‰§è¡Œå®ƒã€‚ä¸401å“åº”ä¸åŒçš„æ˜¯ï¼Œèº«ä»½éªŒè¯å¹¶ä¸èƒ½æä¾›ä»»ä½•å¸®åŠ©ï¼Œè€Œä¸”è¿™ä¸ªè¯·æ±‚ä¹Ÿä¸åº”è¯¥è¢«é‡å¤æäº¤ã€‚é¡¹ç›®ä¸­çš„ç»éªŒå°±æ˜¯ï¼Œå¦‚æœç”¨æˆ·ç™»å½•çŠ¶æ€è¿‡æœŸï¼Œåå°è¿”å›403çŠ¶æ€ç ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å†å»æ‰§è¡Œè‡ªåŠ¨ç™»å½•æˆ–è€…æç¤ºç™»å½•çš„é€»è¾‘ã€‚</p><h3 id="404-Not-Fount"><a href="#404-Not-Fount" class="headerlink" title="404 Not Fount"></a>404 Not Fount</h3><p>è¯·æ±‚å¤±è´¥ï¼Œè¯·æ±‚æ‰€å¸Œæœ›å¾—åˆ°çš„èµ„æºæœªè¢«åœ¨æœåŠ¡å™¨ä¸Šå‘ç°ï¼Œä½†å…è®¸ç”¨æˆ·çš„åç»­è¯·æ±‚ã€‚è¿™ä¸ªå¯èƒ½æ˜¯æœ€å¸¸è§çš„4xxçŠ¶æ€ç </p><h3 id="412-Precondition-Failed"><a href="#412-Precondition-Failed" class="headerlink" title="412 Precondition Failed"></a>412 Precondition Failed</h3><blockquote><p>å®¢æˆ·ç«¯å‘èµ·äº†æ¡ä»¶è¯·æ±‚ï¼ŒæœåŠ¡å™¨å‘ç°è¿™ä¸ªè¯·æ±‚ä¸­çš„å…¶ä¸­ä¸€ä¸ªæ¡ä»¶å¹¶ä¸æˆç«‹ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°±ä¼šç”¨æ­¤é”™è¯¯ç ä½œä¸ºå“åº”æ¶ˆæ¯çš„çŠ¶æ€ç è¿”å›ç»™å®¢æˆ·ç«¯ã€‚<br>æ¯”å¦‚æˆ‘ä»¬åœ¨è¯·æ±‚å¤´è®¾ç½®æ¡ä»¶é™å®š:<code>If-Unmodified-Since</code>ï¼Œå¦‚æœæœåŠ¡ç«¯æ ¡éªŒè¿™ä¸ªæ¡ä»¶ï¼Œå‘ç°è¯´æ²¡æœ‰æ»¡è¶³çš„è¯ï¼Œå°±ä¼šè¿”å› 412 çŠ¶æ€ç ã€‚</p></blockquote><h2 id="5xx"><a href="#5xx" class="headerlink" title="5xx"></a>5xx</h2><p>400æ˜¯å®¢æˆ·ç«¯é”™è¯¯ï¼Œ500å°±æ˜¯æœåŠ¡ç«¯çš„é”™è¯¯çŠ¶æ€ç ã€‚</p><h3 id="500-Internal-Server-Error"><a href="#500-Internal-Server-Error" class="headerlink" title="500 Internal Server Error"></a>500 Internal Server Error</h3><p>500ä¸ºé€šç”¨é”™è¯¯æ¶ˆæ¯ï¼ŒæœåŠ¡å™¨é‡åˆ°äº†ä¸€ä¸ªæœªæ›¾é¢„æ–™çš„çŠ¶å†µï¼Œå¯¼è‡´äº†å®ƒæ— æ³•å®Œæˆå¯¹è¯·æ±‚çš„å¤„ç†ã€‚æ²¡æœ‰ç»™å‡ºå…·ä½“é”™è¯¯ä¿¡æ¯ï¼Œä¸€èˆ¬å¼€å‘è€…å¯ä»¥æŸ¥æ—¥å¿—ç­‰å»è§£å†³è¯¥é”™è¯¯ã€‚</p><h3 id="503-Service-Unavailable"><a href="#503-Service-Unavailable" class="headerlink" title="503 Service Unavailable"></a>503 Service Unavailable</h3><blockquote><p>è¯´æ˜æœåŠ¡å™¨ç°åœ¨æ— æ³•æä¾›æœåŠ¡ï¼Œä½†æ˜¯å°†æ¥å¯ä»¥ã€‚å¦‚æœæœåŠ¡å™¨çŸ¥é“ä½•æ—¶èµ„æºå¯ç”¨ï¼Œåº”è¯¥åœ¨å“åº”ä¸­åŒ…å«Retry-Afterçš„é¦–éƒ¨ï¼Œæç¤ºå®¢æˆ·ç«¯å¯ä»¥é‡è¯•æœåŠ¡çš„æ—¶é—´ã€‚<br>å¦‚æœæ²¡æœ‰æä¾›Retry-Afterå¤´éƒ¨ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯åº”å½“ä»¥å¤„ç†500å“åº”çš„æ–¹å¼å¤„ç†å®ƒã€‚</p></blockquote><p>ä»¥ä¸Šæ˜¯è§‰å¾—æ¯”è¾ƒå¸¸è§çš„çŠ¶æ€ç ï¼Œæ›´å¤šè¯·è§<a href="https://zh.wikipedia.org/wiki/HTTP%E7%8A%B6%E6%80%81%E7%A0%81" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘</a></p><h2 id="Cache-Control"><a href="#Cache-Control" class="headerlink" title="Cache-Control"></a>Cache-Control</h2><p>ä¸€èˆ¬æˆ‘ä»¬åœ¨æœåŠ¡ç«¯å“åº”å¯ä»¥åŠ ä¸Šè¿™ä¸ªå“åº”å¤´<code>Cache-Control: max-age=2592000</code> æ¥è®©æµè§ˆå™¨æŠŠè¿™ä¸ªèµ„æºç¼“å­˜ä¸‹æ¥ï¼Œç¼“å­˜çš„æ—¶é—´ä¸º<code>2592000</code>æ—¢30å¤©ï¼Œä¹Ÿå¯ä»¥åœ¨æ—¶é—´åé¢åŠ ä¸Šä¸ª<code>public</code>æ¥æŒ‡ç¤ºè¯¥å“åº”å¯ä»¥è¢«ä»»ä½•ä¸­é—´äººï¼ˆcdn,ä»£ç†)ç¼“å­˜ã€‚</p><h1 id="æ¶ˆæ¯ä¸»ä½“-1"><a href="#æ¶ˆæ¯ä¸»ä½“-1" class="headerlink" title="æ¶ˆæ¯ä¸»ä½“"></a>æ¶ˆæ¯ä¸»ä½“</h1><p>åœ¨è¯·æ±‚æ¶ˆæ¯æˆ–å“åº”æ¶ˆæ¯é‡Œé¢ï¼Œéƒ½å¯ä»¥åŒ…å«ä¸€ä¸ªå¯é€‰çš„æ¶ˆæ¯ä¸»ä½“ï¼ŒæœåŠ¡ç«¯æˆ–å®¢æˆ·ç«¯éƒ½æ²¡åŠæ³•ä»æ¶ˆæ¯ä¸»ä½“é‡Œé¢è·å–æ˜¯ä»€ä¹ˆå†…å®¹å•Šï¼Œä»€ä¹ˆç±»å‹å•Šä»€ä¹ˆçš„ï¼Œæ‰€ä»¥å°±ä¼šæœ‰ä¸€ç»„å¤´éƒ¨å­—æ®µæ¥æ ‡ç¤ºä»–ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Content-Type å®ä½“ä¸­æ‰€æ‰¿è½½å¯¹è±¡çš„ç±»å‹,å¦‚ txt/html; image/jpeg</span><br><span class="line">Content-Length æ‰€ä¼ é€å®ä½“ä¸»ä½“çš„é•¿åº¦æˆ–å¤§å°ã€‚</span><br><span class="line">Content-Language ä¸æ‰€ä¼ é€å¯¹è±¡æœ€ç›¸é…çš„äººç±»è¯­è¨€, en-usç­‰</span><br><span class="line">Content-Encoding å¯¹è±¡æ•°æ®æ‰€åšçš„å‹ç¼©æ ¼å¼,gzipç­‰.</span><br><span class="line">Content-Location ä¸€ä¸ªå¤‡ç”¨ä½ç½®ï¼Œè¯·æ±‚æ—¶å¯é€šè¿‡å®ƒè·å¾—å¯¹è±¡ã€‚</span><br><span class="line">Content-Range è¯´æ˜å®ƒæ˜¯æ•´ä½“çš„å“ªä¸ªéƒ¨åˆ†,å¯ç”¨äºåˆ†æ®µè·å–ã€‚</span><br><span class="line">Content-MD5 å®ä½“ä¸»ä½“å†…å®¹çš„æ ¡éªŒå’Œã€‚</span><br><span class="line">Last-Modified æ‰€ä¼ è¾“å†…å®¹åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºæˆ–æœ€åä¿®æ”¹çš„æ—¥æœŸæ—¶é—´ã€‚</span><br><span class="line">Expires å®ä½“æ•°æ®å°†è¦å¤±æ•ˆçš„æ—¥æœŸæ—¶é—´ã€‚</span><br><span class="line">Allow è¯¥èµ„æºæ‰€å…è®¸çš„å„ç§è¯·æ±‚æ–¹æ³•ï¼Œä¾‹å¦‚ï¼ŒGET å’Œ HEADã€‚</span><br><span class="line">ETag è¿™ä»½æ–‡æ¡£çš„å”¯ä¸€éªŒè¯ç ï¼Œå¯ç”¨äºç¼“å­˜</span><br></pre></td></tr></table></figure><h1 id="HTTP-2-0-h2"><a href="#HTTP-2-0-h2" class="headerlink" title="HTTP/2.0(h2)"></a>HTTP/2.0(h2)</h1><p>è¿™é‡Œç®€å•è¯´ä¸€ä¸‹h2ä¸HTTP/1.1å¯¹äºå‰ç«¯å¼€å‘äººå‘˜æ¥è¯´æ¯”è¾ƒå¤§çš„æ”¹åŠ¨ã€‚</p><h2 id="å¤šè·¯å¤ç”¨-Multiplexing"><a href="#å¤šè·¯å¤ç”¨-Multiplexing" class="headerlink" title="å¤šè·¯å¤ç”¨ (Multiplexing)"></a>å¤šè·¯å¤ç”¨ (Multiplexing)</h2><p>å¤šè·¯å¤ç”¨å…è®¸åŒæ—¶é€šè¿‡å•ä¸€çš„ HTTP/2 è¿æ¥å‘èµ·å¤šé‡çš„è¯·æ±‚-å“åº”æ¶ˆæ¯ã€‚<br>åœ¨HTTP/1.1ä¸­ï¼Œæˆ‘ä»¬å®¢æˆ·ç«¯åœ¨åŒä¸€æ—¶é—´ï¼Œé’ˆå¯¹åŒä¸€äºåŸŸåä¸‹çš„è¯·æ±‚ä¼šæœ‰é™åˆ¶ï¼Œå¦‚æœè¶…è¿‡æŸä¸ªå€¼çš„è¯·æ±‚ä¼šè¢«å µå¡åˆ°ã€‚æ‰€ä»¥ä¸€èˆ¬çš„ä¼˜åŒ–æœ‰å‰ç«¯ç”¨é›ªç¢§å›¾æ¥åˆå¹¶å¤šä¸ªå°å›¾ç‰‡å‡å°‘è¯·æ±‚ï¼Œåç«¯æŠŠèµ„æºåˆ†åˆ°ä¸åŒçš„åŸŸä¸‹é¢ï¼Œå‡å°‘åŒåŸŸçš„é™åˆ¶ã€‚<br>ä½†æ˜¯å¦‚æœç½‘ç«™ç”¨äº†h2çš„è¯ï¼Œå‰ç«¯ä¸éœ€è¦è€ƒè™‘ç±»ä¼¼é›ªç¢§å›¾ä¹‹ç±»çš„æŠŠå¤šä¸ªè¯·æ±‚åˆå¹¶ä¸ºä¸€ä¸ªå‡å°‘çš„ä¼˜åŒ–ã€‚</p><h1 id="æœ€åå•°å—¦ä¸¤å¥"><a href="#æœ€åå•°å—¦ä¸¤å¥" class="headerlink" title="æœ€åå•°å—¦ä¸¤å¥"></a>æœ€åå•°å—¦ä¸¤å¥</h1><p>ä¹‹æ‰€ä»¥ä¼šçœ‹ã€ŠHTTPå°ä¹¦ã€‹æ˜¯å› ä¸ºå‰æ®µæ—¶é—´é—®æˆ‘ä¸€ä¸ªæœ‹å‹è¯´æœ‰æ²¡æœ‰å…³äºHTTPæ¯”è¾ƒå¥½çš„ä¹¦ç±æ¨èï¼Œã€ŠHTTPæƒå¨æŒ‡å—ã€‹å…­ä¸ƒç™¾é¡µç»†èŠ‚å¤ªå¤šæ€•æ˜¯çœ‹å®Œç•™ä¸ä½ä»€ä¹ˆæ¦‚å¿µã€‚ä»–ç»™æˆ‘æ¨äº†ã€ŠHTTPå°ä¹¦ã€‹ï¼Œè¿™æœ¬ä¹¦ç®—æ˜¯æœ‰ç‚¹æ”¹å˜æˆ‘ä¸€äº›å…³äºçŸ¥è¯†è·å–çš„è®¤çŸ¥ã€‚<br>ç®€å•æ¥è¯´å°±æ˜¯ï¼Œå¤§å®¶åˆ«çœ‹9å—é’±çš„ä¹¦å°±é‚£ä¹ˆå‡ é¡µï¼Œç¿»ä¸€ä¸ªä¸Šåˆæˆ–è€…ä¸€å¤©å°±çœ‹å®Œï¼Œç„¶åå°±è§‰å¾—ä¸å€¼ï¼Œéå¾—è¦çœ‹å“ªç§å‡ ç™¾é¡µçš„æ‰è§‰å¾—é’±å›æœ¬äº†ã€‚<br>è¿™ç¯‡æ–‡åªæ˜¯ä¸ªäººåœ¨çœ‹çš„æ—¶å€™åšäº†ä¸€äº›å½’çº³ï¼Œä¹¦ä¸­æœ‰æ›´è¯¦ç»†æ›´å¥½çš„è§£é‡Šï¼Œå…³é”®æ˜¯æä¾›äº†æºç ä¸ä¾‹å­ï¼Œåœ¨çœ‹æ¦‚å¿µçš„æ—¶å€™å®æ“ä¸€éä¼šåŠ æ·±å¾ˆå¤šå°è±¡ã€‚<br>æ€»çš„æ¥è¯´ï¼Œè¿™æœ¬ä¹¦æŒºå€¼çš„ï¼Œå’Œä»–çš„æ ‡è¯­ä¸€æ ·ï¼š<em>å‡†èƒ½å¸®ä½ çœä¸‹ä¸å°‘<strong>æ—¶é—´</strong></em></p><p><a href="http://www.ituring.com.cn/book/1791" target="_blank" rel="noopener">ã€ŠHTTPå°ä¹¦ã€‹</a><br><a href="https://juejin.im/user/58774201570c35006207d274" target="_blank" rel="noopener">ã€ŠHTTPå°ä¹¦ã€‹ä½œè€…åˆ˜ä¼ å›</a><br><a href="http://www.cnblogs.com/machao/p/5788425.html" target="_blank" rel="noopener">HTTP Method æ›´è¯¦ç»†çš„ä»‹ç»</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Caching_FAQ" target="_blank" rel="noopener">HTTPç¼“å­˜ - MDN</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åŒæ ·æ˜¯å› ä¸ºé¢è¯•çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°è‡ªå·±å¯¹httpçš„ä¸€äº›æ¦‚å¿µå’ŒçŸ¥è¯†ç‚¹å’Œé›¶ç¢ï¼Œå€Ÿæ­¤æœºä¼šçœ‹äº†ã€ŠHTTPå°ä¹¦ã€‹ï¼Œé¡ºæ‰‹å†™äº†ç¯‡è®°å½•æ€»ç»“ä¸€äº›å¸¸è§çš„httpçŸ¥è¯†ç‚¹ã€‚&lt;/p&gt;
&lt;h1 id=&quot;http-ç®€ä»‹&quot;&gt;&lt;a href=&quot;#http-ç®€ä»‹&quot; class=&quot;headerlink&quot; title=
      
    
    </summary>
    
      <category term="technology" scheme="https://jsonz1993.github.io/categories/technology/"/>
    
    
      <category term="learn" scheme="https://jsonz1993.github.io/tags/learn/"/>
    
      <category term="Book" scheme="https://jsonz1993.github.io/tags/Book/"/>
    
      <category term="HTTP" scheme="https://jsonz1993.github.io/tags/HTTP/"/>
    
  </entry>
  
  <entry>
    <title>2018-05-21 å°è®°</title>
    <link href="https://jsonz1993.github.io/2018/05/2018-05-21/"/>
    <id>https://jsonz1993.github.io/2018/05/2018-05-21/</id>
    <published>2018-05-21T11:44:44.000Z</published>
    <updated>2019-03-13T03:30:36.808Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘å·¥ä½œä¸æ˜¯å¾ˆå¿™ï¼Œä¹Ÿæ²¡æœ‰å†æŠ•ç®€å†å»é¢è¯•ï¼Œå¥½åƒåˆå¼€å§‹æ¢å¤ä»¥å‰çš„å­¦ä¹ çƒ­æƒ…ä¸èŠ‚å¥ã€‚</p><p>å‘äº†å‡ ç¯‡æ°´æ–‡~ çœ‹äº†ä¸€ä¸ªå°è„šæ‰‹æ¶çš„éƒ¨åˆ†æºç ã€Šcreate-react-appã€‹ï¼Œçœ‹äº†ä¸€æœ¬æŠ€æœ¯ä¹¦ã€Šcssä¸–ç•Œã€‹ï¼Œä¸€æœ¬å°è¯´ã€Šç™½é‡‘æ•°æ®ã€‹ã€‚</p><p>ä½†æ˜¯å†™è¿™ç¯‡æµæ°´çš„ä¸»è¦ç›®çš„æ˜¯å†æ¬¡æ„è¯†åˆ°è‡ªå·±çœ‹é—®é¢˜å¤ªè¿‡ <strong>å±€é™</strong>ã€‚</p><p>å…ˆäº¤ä»£ä¸€ä¸‹èƒŒæ™¯ï¼š</p><ol><li>ç›®å‰å…¬å¸çš„é¡¹ç›®æ˜¯åŸºäº cookie å»åˆ¤æ–­ä¸€äº›ç¯å¢ƒï¼Œç„¶åæŒ‡å‘æµ‹è¯•ç¯å¢ƒæˆ–è€…æ­£å¼ç¯å¢ƒ</li><li>å¯¹äº font å­—ä½“æ–‡ä»¶æ¥è¯´ï¼Œä»–çš„è¯·æ±‚æ˜¯æ²¡æœ‰å¸¦ä¸Šcookieçš„ï¼ˆchromeçš„bugï¼Œchromeè§‰å¾—è¯´è¿™ä¸ªæ–‡ä»¶ä¸éœ€è¦å¸¦ä¸Šcookieï¼Œsafariå°±ä¼šå¸¦)</li><li>å‡ºç°çš„é—®é¢˜æ˜¯ï¼š å¦‚æœæµ‹è¯•ç¯å¢ƒæœ‰äº†æ–°çš„ font å­—ä½“ï¼Œé‚£ä¹ˆå› ä¸ºä»–æ²¡æœ‰å¸¦ä¸Šcookieï¼Œæ‰€ä»¥ä¼šè¢«æŒ‡å‘æ­£å¼ç¯å¢ƒæœåŠ¡å™¨å»è¯·æ±‚èµ„æºï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™æ­£å¼ç¯å¢ƒè¿˜æ²¡æœ‰è¿™ä¸ª font å­—ä½“ï¼Œæ‰€ä»¥ä¼šæŠ¥404ã€‚ æ€ä¹ˆè§£å†³ï¼Ÿ</li></ol><p>æˆ‘ç»™å‡ºçš„æ–¹æ¡ˆæ˜¯:</p><ol><li>åç«¯ç»™å‡ºä¸€ä¸ªé¡µé¢ï¼Œæˆ‘ä»¬æ‰“åŒ…åæŠŠå­—ä½“æ–‡ä»¶ä¸¢åˆ°æ­£å¼ç¯å¢ƒä¸Šé¢</li><li>å¦‚æœä¸æƒ³è¿™ä¹ˆlowæ‰‹åŠ¨çš„è¯ï¼Œ é‚£å°±åœ¨æ‰“åŒ…å­—ä½“çš„å‘½ä»¤è¡Œåé¢è‡ªåŠ¨å»æäº¤åˆ°æ­£å¼ç¯å¢ƒ</li></ol><p>è€å¤§ç»™å‡ºçš„æ–¹æ¡ˆæ˜¯:<br>ç›´æ¥æ ¹æ®ç›®å‰çš„ç¯å¢ƒåˆ†ç¦»æœºåˆ¶ï¼Œåœ¨nginxé…ç½®ä¸€ä¸‹ï¼šæµ‹è¯•ç¯å¢ƒä¸‹æ‰€æœ‰é™æ€èµ„æºç›´æ¥æŒ‡åˆ°æµ‹è¯•ç¯å¢ƒ</p><p>= =ç®€ç›´è¢«åŠæ‰“ï¼Œçœ‹é—®é¢˜è¿˜æ˜¯å¾ˆå±€é™ æ²¡æœ‰è·³å‡ºå‰ç«¯çš„åœˆå­â€¦â•®(â•¯â–½â•°)â•­</p><p>æ‰€ä»¥æ¥ä¸‹æ¥ä¼˜å…ˆè¡¥åç«¯çš„ä¸€äº›åŸºç¡€çŸ¥è¯† ğŸ’ª</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æœ€è¿‘å·¥ä½œä¸æ˜¯å¾ˆå¿™ï¼Œä¹Ÿæ²¡æœ‰å†æŠ•ç®€å†å»é¢è¯•ï¼Œå¥½åƒåˆå¼€å§‹æ¢å¤ä»¥å‰çš„å­¦ä¹ çƒ­æƒ…ä¸èŠ‚å¥ã€‚&lt;/p&gt;
&lt;p&gt;å‘äº†å‡ ç¯‡æ°´æ–‡~ çœ‹äº†ä¸€ä¸ªå°è„šæ‰‹æ¶çš„éƒ¨åˆ†æºç ã€Šcreate-react-appã€‹ï¼Œçœ‹äº†ä¸€æœ¬æŠ€æœ¯ä¹¦ã€Šcssä¸–ç•Œã€‹ï¼Œä¸€æœ¬å°è¯´ã€Šç™½é‡‘æ•°æ®ã€‹ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å†™è¿™ç¯‡æµæ°´çš„ä¸»è¦ç›®çš„æ˜¯å†æ¬¡æ„è¯†
      
    
    </summary>
    
      <category term="blog" scheme="https://jsonz1993.github.io/categories/blog/"/>
    
    
      <category term="blog" scheme="https://jsonz1993.github.io/tags/blog/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šcssä¸–ç•Œã€‹å¸¸ç”¨æŠ€å·§ â€”â€” è¯»ä¹¦ç¬”è®°</title>
    <link href="https://jsonz1993.github.io/2018/05/css-world/"/>
    <id>https://jsonz1993.github.io/2018/05/css-world/</id>
    <published>2018-05-19T14:41:33.000Z</published>
    <updated>2019-03-13T03:30:36.816Z</updated>
    
    <content type="html"><![CDATA[<p>å‰æ®µæ—¶é—´é¢äº†è”æï¼Œåé¦ˆè¯´å¯¹ä¸€äº›cssæ¦‚å¿µæ€§çš„ä¸œè¥¿æŒæ¡ä¸æ˜¯å¾ˆå¥½~ æ‰€ä»¥æœ€è¿‘æœ‰ç©ºçœ‹äº†å¼ é‘«æ—­å¤§ä½¬çš„ã€ŠCSSä¸–ç•Œã€‹<br>å…¨æœ¬é€šç†Ÿæ˜“æ‡‚ï¼Œç»§æ‰¿äº†åšå®¢çš„ç”»é£ï¼Œå…¥å£å³åŒ–</p><p>å¾ˆå¤šä¸œè¥¿ä¸‰è¨€ä¸¤è¯­è®²ä¸æ¸…æ¥šï¼Œå¤§å®¶å¯ä»¥å…¥æ‰‹å¼ é‘«æ—­å¤§ä½¬çš„ä¹¦æ¥çœ‹çœ‹ï¼Œé‡Œé¢å¾ˆå¤šå¸¸ç”¨çš„æ¦‚å¿µå’Œå±æ€§éƒ½å¸®æˆ‘ä»¬æ‹ä¸€éã€‚<a href="http://www.cssworld.cn/" target="_blank" rel="noopener">ã€Šcssä¸–ç•Œã€‹è´­ä¹°é“¾æ¥</a><br>é™„ä¸Šå¼ é‘«æ—­å¤§ä½¬çš„åšå®¢ï¼Œæœ‰äº‹æ²¡äº‹çœ‹ä¸€çœ‹ç»å¸¸ä¼šæœ‰æ„å¤–æ”¶è·<a href="http://www.zhangxinxu.com/" target="_blank" rel="noopener">å¼ é‘«æ—­åšå®¢</a></p><h2 id="æ”¹å˜-width-height-ä½œç”¨ç»†èŠ‚çš„-box-sizing"><a href="#æ”¹å˜-width-height-ä½œç”¨ç»†èŠ‚çš„-box-sizing" class="headerlink" title="æ”¹å˜ width/height ä½œç”¨ç»†èŠ‚çš„ box-sizing"></a>æ”¹å˜ width/height ä½œç”¨ç»†èŠ‚çš„ box-sizing</h2><blockquote><p>box-sizingçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ ä¸€å¥è¯ï¼Œæ”¹å˜äº† width ä½œç”¨çš„ç›’å­ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œwidth æ˜¯ä½œç”¨åœ¨ content box ä¸Šçš„ï¼Œbox-sizing çš„ä½œç”¨å°±æ˜¯å¯ä»¥æŠŠ width ä½œç”¨çš„ç›’å­å˜æˆå…¶ä»–å‡ ä¸ªã€‚</p></blockquote><p>ä½†æ˜¯ç›®å‰ box-sizing ä»…æ”¯æŒ <code>content-box</code> å’Œ <code>border-box</code>ã€‚<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* è¿™é‡Œ box1å®½åº¦é»˜è®¤ä½œç”¨åœ¨content-box,æ‰€ä»¥ width è¡¨ç°ä¸º 100 + 10*2 + 20*2 = 160px */</span></span><br><span class="line"><span class="selector-class">.box1</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* è¿™é‡Œ box2æ·»åŠ äº† box-sizing: border-box; æ‰€ä»¥å®½åº¦ä½œç”¨æ”¹æˆäº†contentã€paddingä¸borderï¼Œwidth è¡¨ç°ä¸º100px, contentä¸º: 100- 10* 2- 20* 2 = 40px*/</span></span><br><span class="line"><span class="selector-class">.box2</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: red;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><img src="./box-sizing.png" width="200" alt="box-sizing" align="center"></p><h2 id="min-width-max-width-min-height-max-height-æƒé‡è¶…è¶Š-important-min-widthè¶…è¶Šmax-width"><a href="#min-width-max-width-min-height-max-height-æƒé‡è¶…è¶Š-important-min-widthè¶…è¶Šmax-width" class="headerlink" title="min-width/max-width min-height/max-height æƒé‡è¶…è¶Š !important, min-widthè¶…è¶Šmax-width"></a>min-width/max-width min-height/max-height æƒé‡è¶…è¶Š !important, min-widthè¶…è¶Šmax-width</h2><p><strong>min-*åˆå§‹å€¼è§„èŒƒé‡Œä¸º 0ï¼Œå®é™…å°è¯•ä¸ºauto</strong><br><strong>max-*åˆå§‹å€¼ä¸º auto</strong><br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ä¸‹é¢ä»£ç è¡¨ç°ä¸º 100px</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="selector-class">.box1</span> &#123;</span><br><span class="line">  <span class="attribute">min-width</span>: <span class="number">100px</span></span><br><span class="line">  max-width: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50px</span><span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="paddingçš„ç™¾åˆ†æ¯”å€¼è®¡ç®—è§„åˆ™æ˜¯ç›¸å¯¹äºå®½åº¦è®¡ç®—çš„"><a href="#paddingçš„ç™¾åˆ†æ¯”å€¼è®¡ç®—è§„åˆ™æ˜¯ç›¸å¯¹äºå®½åº¦è®¡ç®—çš„" class="headerlink" title="paddingçš„ç™¾åˆ†æ¯”å€¼è®¡ç®—è§„åˆ™æ˜¯ç›¸å¯¹äºå®½åº¦è®¡ç®—çš„"></a>paddingçš„ç™¾åˆ†æ¯”å€¼è®¡ç®—è§„åˆ™æ˜¯ç›¸å¯¹äºå®½åº¦è®¡ç®—çš„</h2><p>è¿™é‡Œå¼•å‡ºä¸€é“é¢è¯•é¢˜ï¼Œ <strong>ä¸å€ŸåŠ©jsçš„æƒ…å†µä¸‹ç”¨ä¸€ä¸ªå…ƒç´ å®ç°ç›¸å¯¹äºæµè§ˆå™¨çª—å£å®½åº¦1/2çš„æ­£æ–¹å½¢</strong><br>å½“æ—¶æˆ‘çš„å›ç­”æ˜¯ç”¨<code>vw</code>ï¼Œå¦‚æœæ—©ç‚¹çœ‹cssä¸–ç•Œå°±çŸ¥é“paddingè¿™ä¸ªå±æ€§äº†ã€‚<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* vwæ–¹æ³• */</span></span><br><span class="line"><span class="selector-class">.box1</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50vw</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50vw</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* paddingæ–¹æ³• */</span></span><br><span class="line"><span class="selector-class">.box2</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">25%</span>;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="padding-çš„å›¾å½¢ç»˜åˆ¶-ä¸€ä¸ªå…ƒç´ ç”»å‡ºçº¢é¢†å·¾çš„â€œä¸‰é“æ â€"><a href="#padding-çš„å›¾å½¢ç»˜åˆ¶-ä¸€ä¸ªå…ƒç´ ç”»å‡ºçº¢é¢†å·¾çš„â€œä¸‰é“æ â€" class="headerlink" title="padding çš„å›¾å½¢ç»˜åˆ¶ ä¸€ä¸ªå…ƒç´ ç”»å‡ºçº¢é¢†å·¾çš„â€œä¸‰é“æ â€"></a>padding çš„å›¾å½¢ç»˜åˆ¶ ä¸€ä¸ªå…ƒç´ ç”»å‡ºçº¢é¢†å·¾çš„â€œä¸‰é“æ â€</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box1</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">background</span>: currentColor;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">140px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">border-top</span>: <span class="number">10px</span> solid;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">10px</span> solid;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">35px</span> <span class="number">0</span>;</span><br><span class="line">  <span class="comment">/* è¿™é‡Œå…¶å®å…³é”®èµ·ä½œç”¨çš„è¿˜æ˜¯ background-clip: content-box; æŠŠèƒŒæ™¯è‰²ä½œç”¨ä»border-boxæ”¹ä¸ºcontent-box*/</span></span><br><span class="line">  <span class="attribute">background-clip</span>: content-box;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="./padding1.png" alt title="ä¸‰é“æ "></p><h2 id="padding-çš„å›¾å½¢ç»˜åˆ¶-ä¸€ä¸ªå…ƒç´ ç”»å‡ºåŒå±‚åœ†ç‚¹å›¾å½¢æ•ˆæœ"><a href="#padding-çš„å›¾å½¢ç»˜åˆ¶-ä¸€ä¸ªå…ƒç´ ç”»å‡ºåŒå±‚åœ†ç‚¹å›¾å½¢æ•ˆæœ" class="headerlink" title="padding çš„å›¾å½¢ç»˜åˆ¶ ä¸€ä¸ªå…ƒç´ ç”»å‡ºåŒå±‚åœ†ç‚¹å›¾å½¢æ•ˆæœ"></a>padding çš„å›¾å½¢ç»˜åˆ¶ ä¸€ä¸ªå…ƒç´ ç”»å‡ºåŒå±‚åœ†ç‚¹å›¾å½¢æ•ˆæœ</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box1</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">background</span>: currentColor;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">background-clip</span>: content-box;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">10px</span> solid;</span><br><span class="line">  <span class="attribute">background-clip</span>: content-box;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="./padding2.png" alt title="åŒå±‚åœ†ç‚¹"></p><h2 id="marginçš„ç™¾åˆ†æ¯”å€¼è®¡ç®—è§„åˆ™å’Œpaddingä¸€æ ·ï¼Œä½†æ˜¯marginåœ¨å‚ç›´æ–¹å‘æ²¡åŠæ³•æ”¹å˜è‡ªèº«å†…éƒ¨å°ºå¯¸å¾€å¾€è¦å€ŸåŠ©çˆ¶å…ƒç´ ä½œä¸ºè½½ä½“ï¼Œè¿˜å­˜åœ¨marginåˆå¹¶çš„é—®é¢˜"><a href="#marginçš„ç™¾åˆ†æ¯”å€¼è®¡ç®—è§„åˆ™å’Œpaddingä¸€æ ·ï¼Œä½†æ˜¯marginåœ¨å‚ç›´æ–¹å‘æ²¡åŠæ³•æ”¹å˜è‡ªèº«å†…éƒ¨å°ºå¯¸å¾€å¾€è¦å€ŸåŠ©çˆ¶å…ƒç´ ä½œä¸ºè½½ä½“ï¼Œè¿˜å­˜åœ¨marginåˆå¹¶çš„é—®é¢˜" class="headerlink" title="marginçš„ç™¾åˆ†æ¯”å€¼è®¡ç®—è§„åˆ™å’Œpaddingä¸€æ ·ï¼Œä½†æ˜¯marginåœ¨å‚ç›´æ–¹å‘æ²¡åŠæ³•æ”¹å˜è‡ªèº«å†…éƒ¨å°ºå¯¸å¾€å¾€è¦å€ŸåŠ©çˆ¶å…ƒç´ ä½œä¸ºè½½ä½“ï¼Œè¿˜å­˜åœ¨marginåˆå¹¶çš„é—®é¢˜"></a>marginçš„ç™¾åˆ†æ¯”å€¼è®¡ç®—è§„åˆ™å’Œpaddingä¸€æ ·ï¼Œä½†æ˜¯marginåœ¨å‚ç›´æ–¹å‘æ²¡åŠæ³•æ”¹å˜è‡ªèº«å†…éƒ¨å°ºå¯¸å¾€å¾€è¦å€ŸåŠ©çˆ¶å…ƒç´ ä½œä¸ºè½½ä½“ï¼Œè¿˜å­˜åœ¨marginåˆå¹¶çš„é—®é¢˜</h2><p>è¿˜æ˜¯é‚£é“æµè§ˆå™¨çª—å£1/2çš„é¢è¯•é¢˜ï¼Œå¦‚æœæ²¡æœ‰è¦æ±‚åªç”¨ä¸€ä¸ªå…ƒç´ å®ç°çš„è¯ï¼Œå¯ä»¥ç”¨marginå»å®ç°</p><p>è¿™é‡Œç®€å•è¯´ä¸€ä¸‹ï¼Œä¹‹æ‰€ä»¥è®¾ç½®çˆ¶çº§box1çš„overflow:hiddenï¼Œæ˜¯å› ä¸ºè¦åˆ›å»ºä¸€ä¸ªå—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡å…ƒç´ ,ä¸€æ–¹é¢å¯ä»¥ç”¨å­çº§marginæ’‘èµ·é«˜åº¦ï¼Œå¦ä¸€æ–¹é¢å¤„ç†marginåˆå¹¶é—®é¢˜ï¼Œæ‰€ä»¥å­çº§.box2ç›´æ¥ç”¨margin:100%ï¼Œè€Œä¸æ˜¯200%ã€‚<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box1</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: currentColor;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="comment">/* å®½åº¦çª—å£1/2 */</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.box2</span> &#123;</span><br><span class="line">  <span class="comment">/* é«˜åº¦çª—å£1/2 */</span></span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box2"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="marginåˆå¹¶çš„è§£å†³æ–¹æ³•"><a href="#marginåˆå¹¶çš„è§£å†³æ–¹æ³•" class="headerlink" title="marginåˆå¹¶çš„è§£å†³æ–¹æ³•"></a>marginåˆå¹¶çš„è§£å†³æ–¹æ³•</h2><p>è¿™é‡Œåªåˆ—ä¸¾å‡ºmargin-topåˆå¹¶çš„æƒ…å†µ, margin-bottomä¸å…¶ç›¸å¯¹åº”</p><ul><li>çˆ¶å…ƒç´ è®¾ä¸ºå—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼Œ7å°±æ˜¯</li><li>çˆ¶å…ƒç´ è®¾ç½®border-top</li><li>çˆ¶å…ƒç´ è®¾ç½®padding-top (è¿™é‡Œå¯ä»¥ç”¨margin-topè´Ÿå€¼æ¥æ¶ˆé™¤ä½œç”¨)</li><li>çˆ¶å…ƒç´ ä¸ç¬¬ä¸€ä¸ªå­å…ƒç´ ä¹‹é—´æ·»åŠ å†…è”å…ƒç´ è¿›è¡Œåˆ†éš”</li></ul><h2 id="åˆ©ç”¨-margin-auto-åšå‚ç›´ä¸Šä¸‹å±…ä¸­"><a href="#åˆ©ç”¨-margin-auto-åšå‚ç›´ä¸Šä¸‹å±…ä¸­" class="headerlink" title="åˆ©ç”¨ margin: auto åšå‚ç›´ä¸Šä¸‹å±…ä¸­"></a>åˆ©ç”¨ margin: auto åšå‚ç›´ä¸Šä¸‹å±…ä¸­</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box1</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">400px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid ;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.box2</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: currentColor;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box2"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="border-é»˜è®¤é¢œè‰²ä¸ºå…ƒç´ colorå€¼"><a href="#border-é»˜è®¤é¢œè‰²ä¸ºå…ƒç´ colorå€¼" class="headerlink" title="border é»˜è®¤é¢œè‰²ä¸ºå…ƒç´ colorå€¼"></a>border é»˜è®¤é¢œè‰²ä¸ºå…ƒç´ colorå€¼</h2><h2 id="borderç»˜åˆ¶ä¸‰è§’å½¢"><a href="#borderç»˜åˆ¶ä¸‰è§’å½¢" class="headerlink" title="borderç»˜åˆ¶ä¸‰è§’å½¢"></a>borderç»˜åˆ¶ä¸‰è§’å½¢</h2><p>é¡¹ç›®ä¸Šç”»ä¸‰è§’å½¢ç»å¤§éƒ¨åˆ†éƒ½æ˜¯ç”¨borderï¼Œå¥½æ§åˆ¶ï¼Œå®ç°ç®€å•ï¼Œæˆæœ¬ä½åªéœ€ä¸€ä¸ªå…ƒç´ ã€‚<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box1</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">border-style</span>: solid;</span><br><span class="line">  <span class="attribute">border-color</span>: currentColor transparent transparent;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="csså°ºå¯¸å•ä½exï¼ŒæŒ‡çš„æ˜¯å­—æ¯xçš„é«˜åº¦ã€‚"><a href="#csså°ºå¯¸å•ä½exï¼ŒæŒ‡çš„æ˜¯å­—æ¯xçš„é«˜åº¦ã€‚" class="headerlink" title="csså°ºå¯¸å•ä½exï¼ŒæŒ‡çš„æ˜¯å­—æ¯xçš„é«˜åº¦ã€‚"></a>csså°ºå¯¸å•ä½<code>ex</code>ï¼ŒæŒ‡çš„æ˜¯å­—æ¯xçš„é«˜åº¦ã€‚</h2><p>è¿™é‡Œç®€å•è¯´ä¸€ä¸‹ï¼Œcssé‡Œé¢çš„åŸºçº¿(baseline)å…¶å®å°±æ˜¯å­—æ¯xçš„ä¸‹è¾¹ç¼˜çº¿<br>å…³äºexçš„åº”ç”¨è¿™é‡Œä¸å†™å‘†æ¯›äº†ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä»–æ¥å®ç°æ–‡å­—ä¸å›¾ç‰‡å±…ä¸­ï¼Œç›´æ¥ç»™å¼ é‘«æ—­å¤§ä½¬çš„<a href="http://demo.cssworld.cn/5/1-1.php" target="_blank" rel="noopener">demo</a><br><em>å†æ„Ÿæ…¨ä¸€ä¸‹ï¼Œè™½ç„¶è¿™äº›ä¸œè¥¿å¤šå¤šå°‘å°‘éƒ½åœ¨å¼ é‘«æ—­åšå®¢çœ‹åˆ°ï¼Œä½†æ˜¯è¿™æœ¬ä¹¦çœŸçš„å¯¹ä¸€äº›ä¸œè¥¿çš„è®²è§£å¾ˆé€šä¿—æ˜“æ‡‚ã€‚å¤§å®¶å¯ä»¥å…¥æ‰‹æœ‰ç©ºç¿»ä¸€ç¿»</em></p><h2 id="BFC-å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡"><a href="#BFC-å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡" class="headerlink" title="BFC å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡"></a>BFC å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡</h2><p>åœ¨ä¸Šé¢æˆ‘ä»¬è®²è¿‡äº†è®¾ç½®overflow:hidden;å¯ä»¥åˆ›å»ºBFCæ¥æ¸…é™¤æµ®åŠ¨ï¼Œé‚£ä¹ˆè¿˜æœ‰å“ªäº›æ–¹æ³•å¯ä»¥åˆ›å»ºBFCå‘¢ï¼Ÿ</p><ul><li><html>æ ¹ç›®å½•</html></li><li>float å€¼ä¸ä¸º node</li><li>overflow çš„å€¼ä¸º autoã€scrollæˆ–hidden(å¸¸ç”¨)</li><li>display å€¼ä¸º table-cellã€ table-captionå’Œ inline-block(å¸¸ç”¨)</li><li>position çš„å€¼ä¸ä¸º relativeå’Œ static<br>BFCçš„ç»“ç•Œç‰¹æ€§æœ€é‡è¦çš„ç”¨é€”ä¸æ˜¯å»marginé‡å æˆ–æ¸…é™¤floatå½±å“ï¼Œè€Œæ˜¯å®ç°æ›´å¥å£®ã€æ›´æ™ºèƒ½çš„è‡ªé€‚åº”å¸ƒå±€<br><em>é¢è¯•çš„æ—¶å€™é¢è¯•å®˜é—®æˆ‘BFCä¸»è¦ç”¨æ¥åšä»€ä¹ˆï¼Œæˆ‘çš„å›ç­”æ˜¯ æ¸…é™¤æµ®åŠ¨å’Œå»marginé‡å ã€‚çœŸçš„æ˜¯å“ªå£¶ä¸å¼€æå“ªå£¶â€¦å“­æ­»ğŸ˜­</em></li></ul><h2 id="ç”¨BFCå®ç°ä¸€è¾¹å›ºå®šå®½åº¦ï¼Œå¦ä¸€è¾¹è‡ªé€‚åº”å¸ƒå±€"><a href="#ç”¨BFCå®ç°ä¸€è¾¹å›ºå®šå®½åº¦ï¼Œå¦ä¸€è¾¹è‡ªé€‚åº”å¸ƒå±€" class="headerlink" title="ç”¨BFCå®ç°ä¸€è¾¹å›ºå®šå®½åº¦ï¼Œå¦ä¸€è¾¹è‡ªé€‚åº”å¸ƒå±€"></a>ç”¨BFCå®ç°ä¸€è¾¹å›ºå®šå®½åº¦ï¼Œå¦ä¸€è¾¹è‡ªé€‚åº”å¸ƒå±€</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.box1</span> &#123;</span></span><br><span class="line"><span class="undefined">    float: left;</span></span><br><span class="line"><span class="undefined">    width: 200px;</span></span><br><span class="line"><span class="undefined">    background: currentColor;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.box2</span> &#123;</span></span><br><span class="line"><span class="undefined">    overflow: hidden;</span></span><br><span class="line"><span class="undefined">    background: red;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">  div &#123;</span></span><br><span class="line"><span class="undefined">    height: 200px;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box2"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="æ— ä¾èµ–absoluteç»å¯¹å®šä½ï¼ˆæ²¡æœ‰left-top-right-bottom"><a href="#æ— ä¾èµ–absoluteç»å¯¹å®šä½ï¼ˆæ²¡æœ‰left-top-right-bottom" class="headerlink" title="æ— ä¾èµ–absoluteç»å¯¹å®šä½ï¼ˆæ²¡æœ‰left/top/right/bottom)"></a>æ— ä¾èµ–absoluteç»å¯¹å®šä½ï¼ˆæ²¡æœ‰left/top/right/bottom)</h2><p>æˆ‘ä»¬å¹³æ—¶å¦‚æœå¯¹å…ƒç´ è¿›è¡Œ absolute å®šä½ï¼Œå¤šåŠä¼šåŠ å¤šä¸ª left,topç„¶åç»™çˆ¶çº§åŠ ä¸ª relativeã€‚<br>å®é™…ä¸Šå¤§å¤šæ•°æƒ…å†µæˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨marginè¾…åŠ©å®šä½ï¼Œ<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span>&#123; <span class="attribute">position</span>: relative; &#125;</span><br><span class="line"><span class="comment">/* @before */</span></span><br><span class="line"><span class="selector-class">.son</span> &#123;<span class="attribute">position</span>: absolute; <span class="attribute">top</span>: <span class="number">10px</span>; <span class="attribute">left</span>: <span class="number">10px</span>;&#125;</span><br><span class="line"><span class="comment">/* @after */</span></span><br><span class="line"><span class="selector-class">.son</span> &#123;<span class="attribute">position</span>: absolute; <span class="attribute">margin-top</span>: <span class="number">10px</span>; <span class="attribute">margin-left</span>: <span class="number">10px</span>;&#125;</span><br></pre></td></tr></table></figure></p><p>è¿™ä¹ˆå®ç°æœ‰ä¸¤ä¸ªå¥½å¤„ï¼Œä¸€ä¸ªæ˜¯æˆ‘ä»¬ä¸éœ€è¦çˆ¶çº§å»åŠ ä¸ª<code>relative</code>åé¢è¦æ’¤é”€ï¼Œç›´æ¥æ”¹ .sonæ ·å¼å°±å¥½ã€‚<br>ç¬¬äºŒä¸ªå¥½å¤„å°±æ˜¯æŸäº›åœºæ™¯é€‚åº”æ€§æ¯”ä¾èµ–é¡¹å®šä½å¥½<br><img src="./absolute.png" alt title="Hotä¸ºæ— ä¾èµ– Nä¸ºä¾èµ–"><br><img src="./absolute2.png" alt title="æ”¹å˜æ–‡å­—é•¿åº¦ä¹‹åçš„æƒ…å†µ"><br><strong>æ— ä¾èµ–åœ¨æœ‰å¤šè¯­è¨€åœºæ™¯ä¸‹åšè§’æ ‡ç®€ç›´æ˜¯å¤©ä½¿ï¼ï¼ï¼ä¸ç„¶ä¸€ä¸ªè‹±è¯­åœºæ™¯ï¼Œä¸€ä¸ªæ—¥è¯­åœºæ™¯ç½‘ç«™è‚¯å®šä¼šä¹±å¥—â€¦.</strong></p><h2 id="å•è¡Œæ˜¾ç¤ºâ€¦æ›´å¤šæ•ˆæœ"><a href="#å•è¡Œæ˜¾ç¤ºâ€¦æ›´å¤šæ•ˆæœ" class="headerlink" title="å•è¡Œæ˜¾ç¤ºâ€¦æ›´å¤šæ•ˆæœ"></a>å•è¡Œæ˜¾ç¤ºâ€¦æ›´å¤šæ•ˆæœ</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.p1</span> &#123;</span></span><br><span class="line"><span class="undefined">    text-overflow: ellipsis;</span></span><br><span class="line"><span class="undefined">    width: 200px;</span></span><br><span class="line"><span class="undefined">    overflow: hidden;</span></span><br><span class="line"><span class="undefined">    white-space: nowrap;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"p1"</span>&gt;</span></span><br><span class="line">  ç›®å‰ï¼Œå¯¹-webkit-ç§æœ‰å‰ç¼€æ”¯æŒè‰¯å¥½çš„æµè§ˆå™¨è¿˜å¯ä»¥å®ç°å¤šè¡Œæ–‡å­—æ‰“ç‚¹æ•ˆæœï¼Œä½†æ˜¯å´æ—  é¡»ä¾èµ– overflow:hiddenã€‚æ¯”æ–¹è¯´ï¼Œæœ€å¤šæ˜¾ç¤º 2 è¡Œå†…å®¹ï¼Œå†å¤šå°±æ‰“ç‚¹å°±</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="./ellipsis1.png" alt></p><h2 id="å¤šè¡Œæ˜¾ç¤ºâ€¦æ›´å¤šæ•ˆæœ"><a href="#å¤šè¡Œæ˜¾ç¤ºâ€¦æ›´å¤šæ•ˆæœ" class="headerlink" title="å¤šè¡Œæ˜¾ç¤ºâ€¦æ›´å¤šæ•ˆæœ"></a>å¤šè¡Œæ˜¾ç¤ºâ€¦æ›´å¤šæ•ˆæœ</h2><p>è¿™é‡Œç”¨äº†Overflowæ˜¯å› ä¸ºï¼Œä¸ç”¨çš„è¯ï¼Œä¼šæŠŠå¤šä½™çš„å†…å®¹å±•ç¤ºå‡ºæ¥ï¼Œä½†æ˜¯ç”¨ä¸ç”¨éƒ½ä¼šæœ‰çœç•¥å·æ•ˆæœ<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.p1</span> &#123;</span></span><br><span class="line"><span class="undefined">display: -webkit-box;</span></span><br><span class="line"><span class="undefined">-webkit-box-orient: vertical;</span></span><br><span class="line"><span class="undefined">-webkit-line-clamp: 2;</span></span><br><span class="line"><span class="undefined">width: 500px;</span></span><br><span class="line"><span class="undefined">overflow: hidden;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"p1"</span>&gt;</span></span><br><span class="line">ç›®å‰ï¼Œå¯¹-webkit-ç§æœ‰å‰ç¼€æ”¯æŒè‰¯å¥½çš„æµè§ˆå™¨è¿˜å¯ä»¥å®ç°å¤šè¡Œæ–‡å­—æ‰“ç‚¹æ•ˆæœï¼Œä½†æ˜¯å´æ—  é¡»ä¾èµ– overflow:hiddenã€‚æ¯”æ–¹è¯´ï¼Œæœ€å¤šæ˜¾ç¤º 2 è¡Œå†…å®¹ï¼Œå†å¤šå°±æ‰“ç‚¹å°±</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><img src="./ellipsis2.png" alt></p><h2 id="outlineè‡ªåŠ¨å¡«æ»¡å±å¹•å‰©ä½™ç©ºé—´çš„åº”ç”¨æŠ€å·§"><a href="#outlineè‡ªåŠ¨å¡«æ»¡å±å¹•å‰©ä½™ç©ºé—´çš„åº”ç”¨æŠ€å·§" class="headerlink" title="outlineè‡ªåŠ¨å¡«æ»¡å±å¹•å‰©ä½™ç©ºé—´çš„åº”ç”¨æŠ€å·§"></a>outlineè‡ªåŠ¨å¡«æ»¡å±å¹•å‰©ä½™ç©ºé—´çš„åº”ç”¨æŠ€å·§</h2><p><em>tip:clipæ˜¯è£å‰ªåŠŸèƒ½ï¼Œå¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬éƒ½ç”¨ä»–æ¥å®ç°ä¸€äº›éšè—çš„æ•ˆæœï¼Œæ¯”å¦‚è¿™ä¸ªæ —å­ğŸŒ°..</em><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.footer</span> &#123;</span></span><br><span class="line"><span class="undefined">height: 50px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.footer</span> &gt;<span class="selector-tag">p</span> &#123;</span></span><br><span class="line"><span class="undefined">position: absolute;</span></span><br><span class="line"><span class="undefined">left: 0;right: 0;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-id">#abcdef</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">outline</span>: 9999<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#abcdef</span>;</span></span><br><span class="line"><span class="undefined">clip: rect(0 9999px 9999px 0);</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>I am Jsonz.<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"footer"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>footer<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><img src="./outline.png" alt></p><h2 id="å±‚å ä¸Šä¸‹æ–‡"><a href="#å±‚å ä¸Šä¸‹æ–‡" class="headerlink" title="å±‚å ä¸Šä¸‹æ–‡"></a>å±‚å ä¸Šä¸‹æ–‡</h2><p>ä»€ä¹ˆæ˜¯å±‚å ä¸Šä¸‹æ–‡ï¼Ÿ</p><blockquote><p>å±‚å ä¸Šä¸‹æ–‡ï¼Œè‹±æ–‡ç§°ä½œ stacking contextï¼Œæ˜¯ HTML ä¸­çš„ä¸€ä¸ªä¸‰ç»´çš„æ¦‚å¿µã€‚å¦‚æœä¸€ä¸ªå…ƒç´ å« æœ‰å±‚å ä¸Šä¸‹æ–‡ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºè¿™ä¸ªå…ƒç´ åœ¨ z è½´ä¸Šå°±â€œé«˜äººä¸€ç­‰â€ã€‚</p></blockquote><p>å±‚å ä¸Šä¸‹æ–‡ç”Ÿæˆè§„åˆ™:</p><ul><li>position å€¼ä¸º relative/absolute</li><li>flex å¸ƒå±€</li><li>opacity å€¼ä¸æ˜¯ 1</li><li>transform å€¼ä¸æ˜¯ none</li><li>filter å€¼ä¸æ˜¯ none</li><li>-webkit-overflow-scrolling è®¾ä¸º touch</li></ul><p>å±‚å ä¸Šä¸‹æ–‡çš„é¡ºåº:</p><ol><li>å¦‚æœä¸ä¾èµ–z-indexï¼Œåˆ™å¯ä»¥çœ‹æˆ z-index: 0</li><li>ä¾èµ–z-index åˆ™çœ‹ z-index çš„å€¼</li></ol><h2 id="textarea-å®½åº¦100-è‡ªé€‚åº”æ•ˆæœ"><a href="#textarea-å®½åº¦100-è‡ªé€‚åº”æ•ˆæœ" class="headerlink" title="textarea å®½åº¦100%è‡ªé€‚åº”æ•ˆæœ"></a>textarea å®½åº¦100%è‡ªé€‚åº”æ•ˆæœ</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css">  <span class="comment">/*çˆ¶çº§*/</span></span></span><br><span class="line"><span class="css">  <span class="selector-class">.box1</span> &#123;</span></span><br><span class="line"><span class="undefined">    width: 280px;</span></span><br><span class="line"><span class="undefined">    margin: 0 auto;</span></span><br><span class="line"><span class="undefined">    padding: 10px 0;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#abcdef</span>;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="css">  <span class="comment">/* æ¨¡æ‹Ÿè¾¹æ¡†ä¸padding */</span></span></span><br><span class="line"><span class="css">  <span class="selector-class">.box2</span> &#123;</span></span><br><span class="line"><span class="undefined">      padding: 9px 8px;</span></span><br><span class="line"><span class="css">      <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#d0d0d5</span>;</span></span><br><span class="line"><span class="undefined">      border-radius: 4px;</span></span><br><span class="line"><span class="css">      <span class="selector-tag">background-color</span>: <span class="selector-id">#fff</span>; </span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="css">  <span class="comment">/* çœŸå® textarea */</span></span></span><br><span class="line"><span class="css">  <span class="selector-class">.box2</span>&gt; <span class="selector-tag">textarea</span> &#123;</span></span><br><span class="line"><span class="undefined">      width: 100%;</span></span><br><span class="line"><span class="undefined">      line-height: 20px;</span></span><br><span class="line"><span class="undefined">      padding: 0;</span></span><br><span class="line"><span class="undefined">      border: 0 none;</span></span><br><span class="line"><span class="undefined">      outline: 0 none;</span></span><br><span class="line"><span class="undefined">      background: none;</span></span><br><span class="line"><span class="undefined">      resize: none;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box2"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">textarea</span> &gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="./textarea.png" alt></p><h2 id="ç©ºå…ƒç´ é€‰æ‹©å™¨-empty"><a href="#ç©ºå…ƒç´ é€‰æ‹©å™¨-empty" class="headerlink" title="ç©ºå…ƒç´ é€‰æ‹©å™¨ :empty"></a>ç©ºå…ƒç´ é€‰æ‹©å™¨ :empty</h2><p>çœ‹ã€Šcssä¸–ç•Œã€‹ä¹‹åæ‰çŸ¥é“æœ‰è¿™ä¹ˆä¸€ä¸ªç©ºå…ƒç´ é€‰æ‹©å™¨â€¦ç»å¯¹ä¸æ˜¯å…¶ä»–ç›®çš„<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">span</span><span class="selector-pseudo">:empty</span><span class="selector-pseudo">::after</span> &#123;</span></span><br><span class="line"><span class="undefined">content: 'æ˜¯å¸…å“¥';</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>Jsonz<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><img src="./empty.png" alt></p><h2 id="ç¬¬ä¸€è¡Œè¦é€‰æ‹©å™¨-first-line"><a href="#ç¬¬ä¸€è¡Œè¦é€‰æ‹©å™¨-first-line" class="headerlink" title="ç¬¬ä¸€è¡Œè¦é€‰æ‹©å™¨:first-line"></a>ç¬¬ä¸€è¡Œè¦é€‰æ‹©å™¨:first-line</h2><p>åŒä¸Šï¼Œæ¯”è¾ƒå°‘ç”¨çš„é€‰æ‹©å™¨ï¼Œä½†æ˜¯æ„Ÿè§‰éƒ¨åˆ†åœºæ™¯æŒºå®ç”¨çš„<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span><span class="selector-pseudo">:first-line</span> &#123; <span class="attribute">color</span>: red; &#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span> &#123; <span class="attribute">width</span>: <span class="number">40px</span>; &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span> å¯ä¹é¸¡ç¿… <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><img src="./first-line.png" alt></p><h2 id="ç¬¬ä¸€ä¸ªå­—ï¼ˆæ¯ï¼‰é€‰æ‹©å™¨-first-letter"><a href="#ç¬¬ä¸€ä¸ªå­—ï¼ˆæ¯ï¼‰é€‰æ‹©å™¨-first-letter" class="headerlink" title="ç¬¬ä¸€ä¸ªå­—ï¼ˆæ¯ï¼‰é€‰æ‹©å™¨:first-letter"></a>ç¬¬ä¸€ä¸ªå­—ï¼ˆæ¯ï¼‰é€‰æ‹©å™¨:first-letter</h2><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœè¿™é‡Œæˆ‘ç”¨çš„æ˜¯å­—ï¼ˆæ¯ï¼‰æ¥æè¿°é€‰æ‹©å™¨ï¼Œæ„å‘³ç€ï¼Œå¦‚æœç¬¬ä¸€ä¸ªæ˜¯ç¬¦å·çš„è¯ï¼Œä¼šæ‰¾ä¸‹ä¸€ä¸ªç›´åˆ°æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„æ‰ä¼šæ¸²æŸ“æˆæˆ‘ä»¬è¦çš„æ ·å¼ï¼Œå¦åˆ™éƒ½æ˜¯é»˜è®¤æ ·å¼ã€‚<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span><span class="selector-pseudo">:first-letter</span> &#123; <span class="attribute">color</span>: red; &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">  !!!!åæ²™èŠ‹</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>!!!!!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><img src="./first-letter.png" alt></p><h2 id="åŠ¨æ€loadingæ‰“ç‚¹æ•ˆæœ"><a href="#åŠ¨æ€loadingæ‰“ç‚¹æ•ˆæœ" class="headerlink" title="åŠ¨æ€loadingæ‰“ç‚¹æ•ˆæœ"></a>åŠ¨æ€loadingæ‰“ç‚¹æ•ˆæœ</h2><p>è¿™é‡Œä¸»è¦åˆ©ç”¨äº†content æ”¯æŒ<code>\A</code>æ¢è¡Œæ¥å®ç°ï¼Œç”¨<code>dot</code>æ˜¯å› ä¸º</p><blockquote><p><dot>æ˜¯è‡ªå®šä¹‰çš„ä¸€ä¸ªæ ‡ç­¾å…ƒç´ ï¼Œé™¤äº†ç®€çº¦ã€è¯­ä¹‰åŒ–æ˜æ˜¾<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">dot &#123;</span></span><br><span class="line"><span class="undefined">    display: inline-block; </span></span><br><span class="line"><span class="undefined">    height: 1em;</span></span><br><span class="line"><span class="undefined">    line-height: 1;</span></span><br><span class="line"><span class="undefined">    text-align: left;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">vertical-align</span>: <span class="selector-tag">-</span><span class="selector-class">.25em</span>;</span></span><br><span class="line"><span class="undefined">    overflow: hidden;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">dot</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line"><span class="undefined">    display: block;</span></span><br><span class="line"><span class="undefined">    content: '...\A..\A.';</span></span><br><span class="line"><span class="undefined">    white-space: pre-wrap;</span></span><br><span class="line"><span class="undefined">    animation: dot 3s infinite step-start both;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css">@<span class="keyword">keyframes</span> dot &#123;</span></span><br><span class="line"><span class="css">    33% &#123; <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-2em); &#125;</span></span><br><span class="line"><span class="css">    66% &#123; <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-1em); &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">æ­£åœ¨åŠ è½½ä¸­<span class="tag">&lt;<span class="name">dot</span>&gt;</span>...<span class="tag">&lt;/<span class="name">dot</span>&gt;</span></span><br></pre></td></tr></table></figure></dot></p></blockquote><p><img src="loading.gif" width="200"></p><h2 id="å•è¡Œæ–‡å­—å±…ä¸­å¯¹é½ï¼Œå¤šè¡Œæ–‡å­—å·¦å¯¹é½"><a href="#å•è¡Œæ–‡å­—å±…ä¸­å¯¹é½ï¼Œå¤šè¡Œæ–‡å­—å·¦å¯¹é½" class="headerlink" title="å•è¡Œæ–‡å­—å±…ä¸­å¯¹é½ï¼Œå¤šè¡Œæ–‡å­—å·¦å¯¹é½"></a>å•è¡Œæ–‡å­—å±…ä¸­å¯¹é½ï¼Œå¤šè¡Œæ–‡å­—å·¦å¯¹é½</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.box1</span> &#123;</span></span><br><span class="line"><span class="undefined">  text-align: center;</span></span><br><span class="line"><span class="undefined">  width: 200px;</span></span><br><span class="line"><span class="undefined">  border: 1px solid ;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">p &#123;</span></span><br><span class="line"><span class="undefined">  display: inline-block;</span></span><br><span class="line"><span class="undefined">  text-align: left;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>å¤§å®¶å¥½<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>æˆ‘æ˜¯Jsonzï¼Œç°åœ¨æ˜¯ä¸€åå°åˆ‡å›¾ä»”<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="./yo.png" alt></p><h2 id="å­—ä½“ä½¿ç”¨ç³»ç»Ÿå­—ä½“"><a href="#å­—ä½“ä½¿ç”¨ç³»ç»Ÿå­—ä½“" class="headerlink" title="å­—ä½“ä½¿ç”¨ç³»ç»Ÿå­—ä½“"></a>å­—ä½“ä½¿ç”¨ç³»ç»Ÿå­—ä½“</h2><p>è¿™é‡Œä¸ªäººæœ‰ç‚¹ç–‘æƒ‘~ å¦‚æœå•çº¯æ˜¯æƒ³ä½¿ç”¨ç³»ç»Ÿé»˜è®¤å­—ä½“ï¼Œç›´æ¥ä¸è®¾ç½® font ä¸å°±å¥½äº†~ å¤šæ­¤ä¸€ä¸¾è®¾ç½®ä¸ª <code>menu</code>â€¦<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span> &#123; <span class="attribute">font</span>: menu; &#125;</span><br><span class="line"><span class="selector-tag">body</span> &#123; <span class="attribute">font-size</span>: <span class="number">16px</span>; &#125;</span><br></pre></td></tr></table></figure></p><p>ä¹¦é‡Œæ›´å¤šçš„ä¸æ˜¯ç»™æˆ‘ä»¬å±•ç¤ºè¿™äº›å°æŠ€å·§ï¼Œè€Œæ˜¯å¸®æˆ‘ä»¬è®²æ¸…æ¥šå¾ˆå¤šæ¦‚å¿µä¸ä»–çš„ç‰¹æ€§ï¼Œè¿™ç¯‡æ–‡æ¯”è¾ƒæ²¡ç»éªŒï¼Œæ•ˆæœå›¾éƒ½æ˜¯ç”¨çš„æˆªå›¾â€¦ä¸‹æ¬¡æœ‰æœºä¼šçš„è¯æ³¨æ„ç›´æ¥å±•ç¤ºä¸ªdemoå¯èƒ½çœ‹èµ·æ¥ä¼šæ›´ç›´è§‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å‰æ®µæ—¶é—´é¢äº†è”æï¼Œåé¦ˆè¯´å¯¹ä¸€äº›cssæ¦‚å¿µæ€§çš„ä¸œè¥¿æŒæ¡ä¸æ˜¯å¾ˆå¥½~ æ‰€ä»¥æœ€è¿‘æœ‰ç©ºçœ‹äº†å¼ é‘«æ—­å¤§ä½¬çš„ã€ŠCSSä¸–ç•Œã€‹&lt;br&gt;å…¨æœ¬é€šç†Ÿæ˜“æ‡‚ï¼Œç»§æ‰¿äº†åšå®¢çš„ç”»é£ï¼Œå…¥å£å³åŒ–&lt;/p&gt;
&lt;p&gt;å¾ˆå¤šä¸œè¥¿ä¸‰è¨€ä¸¤è¯­è®²ä¸æ¸…æ¥šï¼Œå¤§å®¶å¯ä»¥å…¥æ‰‹å¼ é‘«æ—­å¤§ä½¬çš„ä¹¦æ¥çœ‹çœ‹ï¼Œé‡Œé¢å¾ˆå¤šå¸¸ç”¨çš„æ¦‚å¿µå’Œå±æ€§éƒ½å¸®æˆ‘ä»¬æ‹ä¸€éã€‚&lt;a
      
    
    </summary>
    
      <category term="technology" scheme="https://jsonz1993.github.io/categories/technology/"/>
    
    
      <category term="learn" scheme="https://jsonz1993.github.io/tags/learn/"/>
    
      <category term="CSS" scheme="https://jsonz1993.github.io/tags/CSS/"/>
    
      <category term="Book" scheme="https://jsonz1993.github.io/tags/Book/"/>
    
  </entry>
  
  <entry>
    <title>æµè§ˆå™¨æ¢å¤æ»šåŠ¨è¡Œä¸º â€”â€” history.scrollRestoration</title>
    <link href="https://jsonz1993.github.io/2018/05/history-scroll-restoration/"/>
    <id>https://jsonz1993.github.io/2018/05/history-scroll-restoration/</id>
    <published>2018-05-17T11:27:02.000Z</published>
    <updated>2019-03-13T03:30:36.820Z</updated>
    
    <content type="html"><![CDATA[<p>ç›´å…¥ä¸»é¢˜ã€‚ä¹‹å‰åšç§»åŠ¨ç«¯çš„éœ€æ±‚æ—¶ï¼Œç»å¸¸é‡åˆ°ä¸€ç§å¸¸è§ï¼Œå°±æ˜¯:<br>aé¡µé¢æ˜¯ä¸€ä¸ªé•¿åˆ—è¡¨ï¼Œæˆ‘ä»¬æ»‘åŠ¨åˆ°æŸä¸ªåœ°æ–¹å‡è®¾ä¸º <strong>100px</strong> ï¼Œç‚¹å‡»ä¹‹åè¿›å…¥åˆ°bé¡µé¢<br>å†ä»bé¡µé¢å›åˆ°aé¡µé¢ï¼Œè¿™æ—¶å€™æµè§ˆå™¨çš„æ»šåŠ¨æ¡ä¼šè‡ªåŠ¨å›åˆ°æˆ‘ä»¬è·³è½¬å‰çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯ <strong>100px</strong> çš„ä½ç½®ã€‚<br><img src="./history-scroll-restoration.gif" alt title="æµè§ˆå™¨è®°ä½æ»šåŠ¨è¡Œä¸º"></p><p>è¿™ç§ä½“è´´çš„è¡Œä¸ºæˆ‘æ˜¯å¾ˆå–œæ¬¢çš„~ ä½†æ˜¯æœ‰æ—¶å€™äº§å“å°±éè¦æŠ¬æ ï¼Œè¯´ æˆ‘å°±ä¸æƒ³è¦è¿™ç§è¡Œä¸ºï¼Œä½ ç»™æˆ‘å›åˆ°é¡¶éƒ¨å»(â•¯â€µâ–¡â€²)â•¯ï¸µâ”»â”â”»</p><p>ä»¥å‰æ²¡åŠæ³•å°±ç»å¸¸ç”¨ä»€ä¹ˆ setTimeout å¤§æ³•å»æ‰‹åŠ¨å¤„ç†è¿™äº›ä¸œè¥¿</p><p>æ°®ç´ !!! å¦‚æœåªæ˜¯è¯´setTimeoutå¤§æ³•çš„è¯ï¼Œå°±æ²¡æˆ‘ä»€ä¹ˆäº‹äº†ã€‚<br>ä»Šå¤©è¦è¯´çš„æ˜¯ <strong>history.scrollRestoration</strong> ï¼Œè¿™ä¸ªå±æ€§æ˜¯å®éªŒæ€§çš„å±æ€§ï¼Œä»–çš„ä½œç”¨æ˜¯: <strong>å…è®¸Webåº”ç”¨ç¨‹åºåœ¨å†å²å¯¼èˆªä¸Šæ˜¾å¼åœ°è®¾ç½®é»˜è®¤æ»šåŠ¨æ¢å¤è¡Œä¸ºã€‚æ­¤å±æ€§å¯ä»¥æ˜¯è‡ªåŠ¨çš„ï¼ˆautoï¼‰æˆ–è€…æ‰‹åŠ¨çš„ï¼ˆmanualï¼‰ã€‚</strong></p><p>è¯´çš„å¾ˆæ˜ç™½äº†ï¼Œå¦‚æœæµè§ˆå™¨æ”¯æŒ <code>history.scrollRestoration</code>å¹¶ä¸”å€¼ä¸º<code>auto</code>åˆ™ä¼šé»˜è®¤æ¢å¤æ»šåŠ¨è¡Œä¸ºã€‚å¦‚æœè®¾ç½®ä¸º <code>manual</code>åˆ™å¯ä»¥å–æ¶ˆï¼Œè¿™ä¸ªè¡Œä¸ºä¸ç”¨å»è€ƒè™‘å…¼å®¹æ€§çš„é—®é¢˜ï¼Œå¦‚æœæœ‰è¿™ä¸ªåŠŸèƒ½æ‰ä¼šæœ‰æ¢å¤æ»šåŠ¨ï¼Œæ‰€ä»¥ç›´æ¥åˆ¤æ–­ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚æ— éœ€å¤šè€ƒè™‘</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.history.scrollRestoration &amp;&amp; (<span class="built_in">window</span>.history.scrollRestoration = <span class="string">'auto'</span>);</span><br></pre></td></tr></table></figure><p>ä»¥åå¦ˆå¦ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒæˆ‘è¢«äº§å“æ€¼äº† O(âˆ©_âˆ©)O~~</p><p><a href="https://developers.google.com/web/updates/2015/09/history-api-scroll-restoration" target="_blank" rel="noopener">google-developers èµ„æ–™</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/History" target="_blank" rel="noopener">mozilla-developer èµ„æ–™</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ç›´å…¥ä¸»é¢˜ã€‚ä¹‹å‰åšç§»åŠ¨ç«¯çš„éœ€æ±‚æ—¶ï¼Œç»å¸¸é‡åˆ°ä¸€ç§å¸¸è§ï¼Œå°±æ˜¯:&lt;br&gt;aé¡µé¢æ˜¯ä¸€ä¸ªé•¿åˆ—è¡¨ï¼Œæˆ‘ä»¬æ»‘åŠ¨åˆ°æŸä¸ªåœ°æ–¹å‡è®¾ä¸º &lt;strong&gt;100px&lt;/strong&gt; ï¼Œç‚¹å‡»ä¹‹åè¿›å…¥åˆ°bé¡µé¢&lt;br&gt;å†ä»bé¡µé¢å›åˆ°aé¡µé¢ï¼Œè¿™æ—¶å€™æµè§ˆå™¨çš„æ»šåŠ¨æ¡ä¼šè‡ªåŠ¨å›åˆ°æˆ‘ä»¬è·³è½¬å‰çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯ &lt;stro
      
    
    </summary>
    
      <category term="technology" scheme="https://jsonz1993.github.io/categories/technology/"/>
    
    
      <category term="work" scheme="https://jsonz1993.github.io/tags/work/"/>
    
      <category term="github" scheme="https://jsonz1993.github.io/tags/github/"/>
    
      <category term="JavaScript" scheme="https://jsonz1993.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>create-react-app æºç è§£æä¹‹react-scripts</title>
    <link href="https://jsonz1993.github.io/2018/05/create-react-app-t/"/>
    <id>https://jsonz1993.github.io/2018/05/create-react-app-t/</id>
    <published>2018-05-14T20:44:48.000Z</published>
    <updated>2019-03-13T03:30:36.816Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸Šä¸€ç¯‡æˆ‘ä»¬å·²ç»è®²äº† <code>create-react-app</code>é‡Œé¢åˆ›å»º<code>package.json</code>å®‰è£…ä¾èµ–å¹¶ä¸”æ‹·è´å¯è¿è¡Œçš„demoç­‰æ­¥éª¤ã€‚<a href="https://jsonz1993.github.io/2018/05/create-react-app-o/">ä¼ é€é—¨</a></p><p>è¿™ä¸€ç¯‡æˆ‘ä»¬æ¥è®²ä¸€ä¸‹ <code>create-react-app</code>é‡Œé¢çš„å¯åŠ¨æœåŠ¡ç­‰éƒ¨åˆ†ï¼Œå°±æ˜¯å¹³æ—¶æˆ‘ä»¬å®‰è£…å®Œä¾èµ–ä¹‹åï¼Œå¯åŠ¨å¼€å‘æœåŠ¡:<code>npm start</code>ã€‚è¿™ä¸€å—æ¶‰åŠåˆ°å¤ªå¤šå…³äºwebpackä¸é…ç½®çš„ä¸œè¥¿ï¼ŒåŠ ä¸Šç¬¬ä¸€ç¯‡è§‰å¾—æè¿°çš„å¤ªè¿‡å†—ä½™~æ‰€ä»¥è¿™ç¯‡ä¸ä¼šè®²å¾—å¾ˆç»†ï¼Œåªæ˜¯å¤§æ¦‚æŠŠä»–è¿è½¬çš„é€»è¾‘æ€è·¯å†™å‡ºæ¥ï¼Œå…·ä½“æºç ä¼šæä¾›ä¼ é€é—¨ã€‚</p><p>æ¨èå¤§å®¶çœ‹ç¬¬ä¸€ç¯‡çš„ <strong>é¡¹ç›®åˆå§‹åŒ–</strong> å’Œ <strong>æ–­ç‚¹è°ƒè¯•</strong> éƒ¨åˆ†ï¼Œè¿™é‡Œå°±ä¸åœ¨èµ˜è¿°ã€‚<a href="https://jsonz1993.github.io/2018/05/create-react-app-o/#%E9%A1%B9%E7%9B%AE%E5%88%9D%E5%A7%8B%E5%8C%96">ä¼ é€é—¨ é¡¹ç›®åˆå§‹åŒ–æ–­ç‚¹è°ƒè¯•éƒ¨åˆ†</a></p><h1 id="å‡†å¤‡é˜¶æ®µ"><a href="#å‡†å¤‡é˜¶æ®µ" class="headerlink" title="å‡†å¤‡é˜¶æ®µ"></a><a href="#å‡†å¤‡é˜¶æ®µ">å‡†å¤‡é˜¶æ®µ</a></h1><p><strong>è¿™é‡Œæˆ‘ä»¬è®¨è®ºçš„create-react-appç‰ˆæœ¬ä¾æ—§æ˜¯<code>v1.1.4</code></strong></p><p>æ—¢ç„¶è¿™ç¯‡æˆ‘ä»¬ä¸»è¦è®²çš„æ˜¯ <code>create-react-app</code>é‡Œé¢çš„webpackæœåŠ¡ï¼Œé‚£æˆ‘ä»¬è‚¯å®šè¦å…ˆæ–°å»ºä¸€ä¸ªé¡¹ç›®ã€‚</p><ul><li><code>npm install create-react-app -g</code> å…¨å±€å®‰è£…create-react-app</li><li><code>create-react-app my-react-project</code> ç”¨create-react-appæ–°å»ºä¸€ä¸ªé¡¹ç›®</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd my-react-project</span><br><span class="line">yarn start</span><br></pre></td></tr></table></figure><p>æ–°å»ºå®Œä¹‹åï¼Œç»ˆç«¯æç¤ºäº†æˆ‘ä»¬ç›´æ¥è¿›å…¥é¡¹ç›®ï¼Œè·‘ yarn(npm) start å°±å¯ä»¥å¼€å‘äº†ã€‚æˆ‘ä»¬æ‰“å¼€ <code>package.json</code>å°±å¯ä»¥çœ‹åˆ° yarn start è·‘çš„å‘½ä»¤æ˜¯ <code>&quot;react-scripts start&quot;</code></p><p>é‚£ä¹ˆè¿™ä¸ª react-scripts å‘½ä»¤åˆ°åº•æ˜¯å“ªä¸€ä¸ªå‘¢ï¼Ÿ</p><p>ä¸€èˆ¬å†™åœ¨ <code>package.json=&gt; scripts</code> çš„å‘½ä»¤ï¼Œéƒ½ä¼šå…ˆå» <code>project_path(é¡¹ç›®ç›®å½•ï¼‰/node_modules/.bin</code> æŸ¥æ‰¾ï¼Œæ‰¾ä¸åˆ°å†æ‰¾å…¨å±€å®‰è£…çš„åŒ…ã€‚</p><p>é‚£ä¹ˆ node_modules/.bin é‡Œé¢çš„æ–‡ä»¶åˆæ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿ<br>æˆ‘ä»¬å¦‚æœåœ¨åŒ…çš„ package.json åŠ ä¸Š <code>bin</code> å­—æ®µï¼Œnpmå°±ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬æ˜ å°„åˆ° node_modules/.bin é‡Œé¢ <a href="https://docs.npmjs.com/files/package.json#bin" target="_blank" rel="noopener">npm binæ–‡æ¡£ä¼ é€é—¨</a></p><p>æˆ‘ä»¬ç›´æ¥æ‰“å¼€ <code>node_modules/react-scripts/package.json</code> èƒ½çœ‹åˆ°è¿™ä¹ˆä¸€è¡Œ<code>&quot;react-scripts&quot;: &quot;./bin/react-scripts.js&quot;</code>,ç›´æ¥æŠŠå‘½ä»¤æŒ‡å‘<code>node_modules/react-scripts/.bin/react-scripts.js</code>ï¼Œä¹ŸéªŒè¯äº†æˆ‘ä»¬çš„è§‚ç‚¹ã€‚</p><p>è¿˜è®°å¾—ä¸Šä¸€ç¯‡ï¼Œæˆ‘ä»¬åœ¨ <code>create-react-app/packages</code> é‡Œé¢å‘ç°äº†æœ‰ä¸€ä¸ª <code>react-scripts</code>ã€‚å…¶å®æ˜¯åŒä¸€ä¸ªä¸œè¥¿æ¥çš„ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥çš„æ­¥éª¤å°±å¾ˆæ˜ç¡®äº†ï¼Œç›´æ¥ç”¨è€åŠæ³•ï¼Œæ”¹ä¸‹é…ç½®ï¼Œç„¶åç”¨vscodeè·‘æ–­ç‚¹è°ƒè¯•é˜…è¯»<code>project_path/node_modules/react-scripts/.bin/react-scripts.js</code>çš„æºç  ä¸€æ¢ç©¶ç«Ÿã€‚</p><h3 id="vscode-launch-json"><a href="#vscode-launch-json" class="headerlink" title="vscode launch.json"></a><a href="#vscode_launch.json">vscode launch.json</a></h3><p>è¿™é‡Œæˆ‘ä»¬ä¼ å…¥ start ä½œä¸ºå‚æ•°,æ¨¡æ‹Ÿåœ¨é¡¹ç›®é‡Œè·‘ <code>yarn start</code> çš„æ•ˆæœã€‚<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"0.2.0"</span>,</span><br><span class="line">  <span class="attr">"configurations"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"type"</span>: <span class="string">"node"</span>,</span><br><span class="line">      <span class="attr">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">      <span class="attr">"name"</span>: <span class="string">"å¯åŠ¨ç¨‹åº"</span>,</span><br><span class="line">      "program": "$&#123;workspaceFolder&#125;/node_modules/react-scripts/bin/react-scripts.js", //è°ƒè¯•çš„æ–‡ä»¶è·¯å¾„</span><br><span class="line">      "args": [</span><br><span class="line">        "start" // ä¼ å…¥ start åšä¸ºå‚æ•°</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><em><strong>ps:ä¸‹é¢çš„<code>react-scripts</code>æ²¡æœ‰ç‰¹æ®Šè¯´æ˜ï¼Œéƒ½ä»£è¡¨<code>project_path/node_modules/react-scripts</code>ç›®å½•æ–¹ä¾¿é˜…è¯»</strong></em></p><h1 id="react-scripts-bin-react-scripts-js"><a href="#react-scripts-bin-react-scripts-js" class="headerlink" title="react-scripts/.bin/react-scripts.js"></a><a href="#react-scripts-bin-react-scripts-js">react-scripts/.bin/react-scripts.js</a></h1><p><a href="https://github.com/facebook/create-react-app/blob/v1.1.4/packages/react-scripts/bin/react-scripts.js" target="_blank" rel="noopener">æ–‡ä»¶ä¼ é€é—¨</a><br>è¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯è€åŠæ³•ï¼Œå…ˆä¸çœ‹ä¾èµ– çœ‹ä¸»æµç¨‹ç†è§£å…ˆï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶ä¹Ÿæ˜¯ä¸€ä¸ªå…¥å£æ–‡ä»¶ï¼Œéå¸¸ç®€çŸ­ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> args = process.argv.slice(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> scriptIndex = args.findIndex(</span><br><span class="line">  x =&gt; x === <span class="string">'build'</span> || x === <span class="string">'eject'</span> || x === <span class="string">'start'</span> || x === <span class="string">'test'</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">const</span> script = scriptIndex === <span class="number">-1</span> ? args[<span class="number">0</span>] : args[scriptIndex];</span><br><span class="line"><span class="keyword">const</span> nodeArgs = scriptIndex &gt; <span class="number">0</span> ? args.slice(<span class="number">0</span>, scriptIndex) : [];</span><br></pre></td></tr></table></figure><p>é¦–å…ˆå¤„ç†ä¼ è¿›æ¥çš„å‚æ•°ï¼Œç”¨<code>script</code>å˜é‡æ¥è·å–æˆ‘ä»¬è·‘çš„å‘½ä»¤æ˜¯å“ªä¸€ä¸ªï¼Œæœ‰[â€˜buildâ€™, â€˜ejectâ€™, â€˜startâ€™, â€˜testâ€™]è¿™ä¹ˆå‡ ç§ï¼Œåˆ†åˆ«å¯¹åº” æ„å»ºã€æš´éœ²é…ç½®ã€å¼€å‘ã€æµ‹è¯•å‘½ä»¤ã€‚<br>ç„¶åå†è·å–ä¸€èµ·ä¼ å…¥çš„å…¶ä»–çš„å‚æ•°ï¼Œæ¯”å¦‚<code>npm test</code>å‘½ä»¤å°±ä¼šå¸¦ä¸€ä¸ªé¢å¤–çš„å‚æ•°<code>--env=jsdom</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (script) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'build'</span>:</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'eject'</span>:</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'start'</span>:</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'test'</span>: &#123;</span><br><span class="line">    <span class="comment">// ç”¨ cross-spawn å»è·‘ä¸€ä¸ªåŒæ­¥çš„å‘½ä»¤</span></span><br><span class="line">    <span class="comment">// æ ¹æ®ä¼ å…¥çš„å‘½ä»¤æ¥æ‹¼æ¥å¯¹åº”çš„è·¯å¾„ ç”¨nodeå»è·‘</span></span><br><span class="line">    <span class="keyword">const</span> result = spawn.sync(</span><br><span class="line">      <span class="string">'node'</span>,</span><br><span class="line">      nodeArgs</span><br><span class="line">        .concat(<span class="built_in">require</span>.resolve(<span class="string">'../scripts/'</span> + script))</span><br><span class="line">        .concat(args.slice(scriptIndex + <span class="number">1</span>)),</span><br><span class="line">      &#123; <span class="attr">stdio</span>: <span class="string">'inherit'</span> &#125;</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">if</span> (result.signal) &#123;</span><br><span class="line">      <span class="keyword">if</span> (result.signal === <span class="string">'SIGKILL'</span>) &#123;</span><br><span class="line">        <span class="comment">// è¾“å‡ºé”™è¯¯æé†’æ—¥å¿—</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (result.signal === <span class="string">'SIGTERM'</span>) &#123;</span><br><span class="line">        <span class="comment">// è¾“å‡ºé”™è¯¯æé†’æ—¥å¿—</span></span><br><span class="line">      &#125;</span><br><span class="line">      process.exit(<span class="number">1</span>); <span class="comment">// é€€å‡ºè¿›ç¨‹ï¼Œ ä¼ 1ä»£è¡¨æœ‰é”™è¯¯</span></span><br><span class="line">    &#125;</span><br><span class="line">    process.exit(result.status);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">default</span>:</span><br><span class="line">    <span class="comment">// è¿™é‡Œè¾“å‡ºåŒ¹é…ä¸åˆ°å¯¹åº”çš„å‘½ä»¤</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæ ¹æ®è·å–åˆ°çš„å‘½ä»¤ï¼Œå¯¹åº”åˆ°<code>react-scripts/scripts</code>ä¸‹é¢çš„æ–‡ä»¶å»è·‘ï¼Œæ¯”å¦‚ <code>react-scripts start</code> å°±ä¼šå»è·‘ <code>react-scripts/scripts/start.js</code>ã€‚</p><p>è¿™é‡Œæ’å‡ å¥è®²ä¸€ä¸‹ä¸€ä¸ªé¡¹ç›®ä¸Šæ¯”è¾ƒå¸¸è§çš„ç±»åº“è§£è€¦æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„ <code>spawn</code>å¼•ç”¨çš„æ˜¯<code>react-dev-utils/crossSpawn</code>ã€‚è€Œåœ¨<code>react-dev-utils/corssSpawn</code>é‡Œé¢ä¹Ÿåªæ˜¯ç®€ç®€å•å•çš„å‡ å¥ï¼Œå¼•å…¥<code>cross-spawn</code>å†æŠŠ<code>cross-spawn</code>æš´éœ²å‡ºå»ã€‚<br>ä½†æ˜¯è¿™ä¹ˆå†™å°±å¯ä»¥èµ·åˆ°ç±»åº“è§£è€¦çš„ä½œç”¨ï¼Œæ¯”å¦‚ä»¥åè¿™ä¸ªåº“è¢«çˆ†å‡ºæœ‰é‡å¤§çš„bugæˆ–è€…åœæ­¢ç»´æŠ¤äº†ï¼Œç›´æ¥ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶å¼•å…¥å…¶ä»–çš„ç±»åº“ï¼Œå…¶ä»–å¼•ç”¨è¯¥æ–‡ä»¶çš„ä»£ç å°±ä¸éœ€è¦æ”¹åŠ¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// react-dev-utils/corssSpawn</span></span><br><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> crossSpawn = <span class="built_in">require</span>(<span class="string">'cross-spawn'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = crossSpawn;</span><br></pre></td></tr></table></figure><h1 id="react-scripts-scripts-start-js"><a href="#react-scripts-scripts-start-js" class="headerlink" title="react-scripts/scripts/start.js"></a><a href="#react-scripts-scripts-start-js">react-scripts/scripts/start.js</a></h1><p><a href="https://github.com/facebook/create-react-app/blob/v1.1.4/packages/react-scripts/scripts/start.js" target="_blank" rel="noopener">æ–‡ä»¶ä¼ é€é—¨</a></p><p>çœ‹è¿‡ç¬¬ä¸€ç¯‡çš„äººå¯¹è¿™ä¸ªæ–‡ä»¶å¤¹åº”è¯¥ä¸é™Œç”Ÿï¼Œ<code>create-react-app</code> åœ¨å®‰è£…å®Œ <code>react</code> ç­‰ä¾èµ–ä¹‹åï¼Œå°±ä¼šè·‘è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹é¢çš„<code>init.js</code>æ¥æ‹·è´æ¨¡ç‰ˆæ–‡ä»¶ï¼Œä¿®æ”¹<code>package.json</code>ç­‰æ“ä½œã€‚</p><p>æ—¢ç„¶æˆ‘ä»¬å·²ç»çŸ¥é“ä»–è¦æ‰§è¡Œ start.js, æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠvscodeè°ƒè¯•æ–‡ä»¶ä¿®æ”¹ä¸º start.js æ–‡ä»¶<code>&quot;program&quot;: &quot;${workspaceFolder}/node_modules/react-scripts/scripts/start.js&quot;,</code> ä¹‹æ‰€ä»¥è¦ä¿®æ”¹æ˜¯å› ä¸ºä»–è¿™é‡Œä¸æ˜¯å¼•ç”¨jsæ–‡ä»¶æ¥è¿è¡Œï¼Œè€Œæ˜¯ç”¨ç»ˆç«¯æ¥è·‘ï¼Œæ‰€ä»¥ä¸å±äºæˆ‘ä»¬çš„é¡¹ç›®è°ƒè¯•èŒƒå›´~</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">process.env.BABEL_ENV = <span class="string">'development'</span>;</span><br><span class="line">process.env.NODE_ENV = <span class="string">'development'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Makes the script crash on unhandled rejections instead of silently</span></span><br><span class="line"><span class="comment">// ignoring them. In the future, promise rejections that are not handled will</span></span><br><span class="line"><span class="comment">// terminate the Node.js process with a non-zero exit code.</span></span><br><span class="line">process.on(<span class="string">'unhandledRejection'</span>, err =&gt; &#123;</span><br><span class="line">  <span class="keyword">throw</span> err;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æ–‡ä»¶çš„æœ€å¼€å¤´è®¾ç½®äº†ä¸¤ä¸ªç¯å¢ƒå˜é‡ï¼Œå› ä¸º start æ˜¯ç”¨æ¥è·‘å¼€å‘çš„ï¼Œæ‰€ä»¥è¿™é‡Œçš„ç¯å¢ƒå˜é‡éƒ½æ˜¯ <code>development</code>ï¼Œç„¶åå†ç»™ <code>process</code> ç»‘å®šä¸€ä¸ªé”™è¯¯ç›‘å¬å‡½æ•°ï¼Œè¿™ä¸ªé”™è¯¯ç›‘å¬å®è´¨ä¸Šæ˜¯ç”¨æ¥ç›‘å¬ <em>ä¸€äº›æ²¡æœ‰è¢«.catchçš„Promise</em>ã€‚ <a href="https://nodejs.org/dist/latest-v8.x/docs/api/process.html#process_event_unhandledrejection" target="_blank" rel="noopener">å…·ä½“å¯ä»¥çœ‹nodeçš„æ–‡æ¡£</a>, å…³äº Promiseå¯ä»¥çœ‹ä¸€ä¸‹ä¹‹å‰å†™è¿‡çš„ä¸€ç¯‡<a href="https://jsonz1993.github.io/2017/12/%E6%B5%85%E6%9E%90Promise/">ä»‹ç»Promiseçš„æ–‡ç« ä»ç”¨æ³•å’Œå®ç°åŸç†éƒ½æœ‰æ‰€æ¶‰åŠ</a></p><p>æ¥ç€å¼•è¿›ä¸€ä¸ª <code>../config/env</code>ï¼Œ çœ‹æ–‡ä»¶åçŒœåº”è¯¥æ˜¯åšä¸€äº›å…³äºç¯å¢ƒé…ç½®çš„äº‹æƒ…ï¼Œæ‰¾åˆ°æ–‡ä»¶æ–­ç‚¹è¿›æ¥</p><h1 id="react-scripts-config-env-js"><a href="#react-scripts-config-env-js" class="headerlink" title="react-scripts/config/env.js"></a><a href="#react-scripts-config-env-js">react-scripts/config/env.js</a></h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> paths = <span class="built_in">require</span>(<span class="string">'./paths'</span>);</span><br><span class="line"><span class="comment">// Make sure that including paths.js after env.js will read .env variables.</span></span><br><span class="line"><span class="keyword">delete</span> <span class="built_in">require</span>.cache[<span class="built_in">require</span>.resolve(<span class="string">'./paths'</span>)];</span><br></pre></td></tr></table></figure><p><code>env.js</code> æ–‡ä»¶åœ¨å¼•å…¥ <code>./paths.js</code> ä¹‹åï¼Œç«‹å³æŠŠä»–ä»cacheä¸­åˆ é™¤æ‰ï¼Œè¿™æ ·ä¸‹æ¬¡å¦‚æœæœ‰å…¶ä»–çš„æ¨¡å—å¼•å…¥<code>paths.js</code>ï¼Œå°±ä¸ä¼šä»ç¼“å­˜é‡Œé¢å»è·å–ï¼Œä¿è¯äº†<code>paths.js</code>é‡Œé¢æ‰§è¡Œé€»è¾‘éƒ½ä¼šç”¨åˆ°æœ€æ–°çš„ç¯å¢ƒå˜é‡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> dotenvFiles = [</span><br><span class="line">  <span class="comment">// ä¸¾ä¸ªä¾‹å­ï¼šç¬¬ä¸€ä¸ªå…ƒç´ åœ¨æˆ‘çš„ç”µè„‘è·¯å¾„æ˜¯è¿™æ ·çš„ Users/jsonz/Documents/my-react-project/.env.development.local.js</span></span><br><span class="line">  <span class="string">`<span class="subst">$&#123;paths.dotenv&#125;</span>.<span class="subst">$&#123;NODE_ENV&#125;</span>.local`</span>,</span><br><span class="line">  <span class="string">`<span class="subst">$&#123;paths.dotenv&#125;</span>.<span class="subst">$&#123;NODE_ENV&#125;</span>`</span>,</span><br><span class="line">  NODE_ENV !== <span class="string">'test'</span> &amp;&amp; <span class="string">`<span class="subst">$&#123;paths.dotenv&#125;</span>.local`</span>,</span><br><span class="line">  paths.dotenv,</span><br><span class="line">].filter(<span class="built_in">Boolean</span>);</span><br></pre></td></tr></table></figure><p>ç„¶åå†æ ¹æ®pathsç»™å‡ºçš„åœ°å€å»æ‹¿å…¶ä»–çš„ç¯å¢ƒå˜é‡ï¼Œè¿™é‡Œ<code>paths.js</code>ä¼šæ ¹æ®ä¸åŒçš„æƒ…å†µç»™å‡ºä¸åŒçš„è·¯å¾„ï¼Œæˆ‘ä»¬è®¨è®ºçš„æ˜¯æ­£å¸¸çš„åˆ›å»ºé¡¹ç›®æƒ…å†µã€‚<br>å…¶ä»–çš„å‡ ç§æƒ…å†µæœ‰ï¼š</p><ol><li>æˆ‘ä»¬åœ¨å·²ç»åˆ›å»ºçš„é¡¹ç›®è·‘äº† <code>npm(yarn) eject</code>ï¼Œè¿™æ—¶å€™ <code>react-scripts</code>ä¼šæŠŠé…ç½®éƒ½æš´éœ²åˆ° <code>project_path/config</code> æ–¹ä¾¿æˆ‘ä»¬å»æ ¹æ®é¡¹ç›®ä¿®æ”¹é…ç½®ï¼Œè¿™ä¸ªæ“ä½œæ˜¯ä¸å¯é€†çš„ã€‚</li><li>æˆ‘ä»¬æ­£å¸¸åˆ›å»ºé¡¹ç›®ï¼Œç›´æ¥è·‘é¡¹ç›®ï¼Œè¿™æ—¶å€™é…ç½®å°±å­˜æ”¾åœ¨<code>project/node_modules/react-scripts</code>ã€‚</li><li>å¼€å‘äººå‘˜è‡ªå·±è°ƒè¯•ç”¨çš„ï¼Œè¿™æ—¶å€™é…ç½®å­˜æ”¾åœ¨<code>create-react/packages/react-scripts/config</code>ã€‚</li></ol><p>æ‹¼è£…å®Œè·¯å¾„ä¹‹åï¼Œç”¨<a href="https://www.npmjs.com/package/dotenv-expand" target="_blank" rel="noopener">dotenv-expand</a>å’Œ<a href="https://www.npmjs.com/package/dotenv" target="_blank" rel="noopener">dotenv</a>æ¥æŠŠæ–‡ä»¶é‡Œé¢çš„ç¯å¢ƒå˜é‡åŠ è½½è¿›æ¥ï¼Œè¿™ä¸€å—ä¸€èˆ¬åœºæ™¯ç”¨ä¸ä¸Šã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getClientEnvironment</span>(<span class="params">publicUrl</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> raw = <span class="built_in">Object</span>.keys(process.env)</span><br><span class="line">    .filter(<span class="function"><span class="params">key</span> =&gt;</span> REACT_APP.test(key))</span><br><span class="line">    .reduce(</span><br><span class="line">      (env, key) =&gt; &#123;</span><br><span class="line">        env[key] = process.env[key];</span><br><span class="line">        <span class="keyword">return</span> env;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        NODE_ENV: process.env.NODE_ENV || <span class="string">'development'</span>,</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  <span class="keyword">const</span> stringified = &#123;</span><br><span class="line">    <span class="string">'process.env'</span>: <span class="built_in">Object</span>.keys(raw).reduce(<span class="function">(<span class="params">env, key</span>) =&gt;</span> &#123;</span><br><span class="line">      env[key] = <span class="built_in">JSON</span>.stringify(raw[key]);</span><br><span class="line">      <span class="keyword">return</span> env;</span><br><span class="line">    &#125;, &#123;&#125;),</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> &#123; raw, stringified &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åè¿”å›ä¸€ä¸ª <code>getClientEnvironment</code>å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ‰§è¡Œåä¼šè¿”å›å®¢æˆ·ç«¯çš„ç¯å¢ƒå˜é‡ã€‚</p><h1 id="react-scripts-scripts-start-js-2"><a href="#react-scripts-scripts-start-js-2" class="headerlink" title="react-scripts/scripts/start.js(2)"></a><a href="#react-scripts-scripts-start-js-2">react-scripts/scripts/start.js(2)</a></h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">const</span> chalk = <span class="built_in">require</span>(<span class="string">'chalk'</span>);</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"><span class="keyword">const</span> WebpackDevServer = <span class="built_in">require</span>(<span class="string">'webpack-dev-server'</span>);</span><br><span class="line"><span class="keyword">const</span> clearConsole = <span class="built_in">require</span>(<span class="string">'react-dev-utils/clearConsole'</span>);</span><br><span class="line"><span class="keyword">const</span> checkRequiredFiles = <span class="built_in">require</span>(<span class="string">'react-dev-utils/checkRequiredFiles'</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;</span><br><span class="line">  choosePort,</span><br><span class="line">  createCompiler,</span><br><span class="line">  prepareProxy,</span><br><span class="line">  prepareUrls,</span><br><span class="line">&#125; = <span class="built_in">require</span>(<span class="string">'react-dev-utils/WebpackDevServerUtils'</span>);</span><br><span class="line"><span class="keyword">const</span> openBrowser = <span class="built_in">require</span>(<span class="string">'react-dev-utils/openBrowser'</span>);</span><br><span class="line"><span class="keyword">const</span> paths = <span class="built_in">require</span>(<span class="string">'../config/paths'</span>);</span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">'../config/webpack.config.dev'</span>);</span><br><span class="line"><span class="keyword">const</span> createDevServerConfig = <span class="built_in">require</span>(<span class="string">'../config/webpackDevServer.config'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> useYarn = fs.existsSync(paths.yarnLockFile);</span><br><span class="line"><span class="keyword">const</span> isInteractive = process.stdout.isTTY;</span><br></pre></td></tr></table></figure><p>åŠ è½½å®Œå„ç§ç¯å¢ƒå˜é‡ä¹‹åï¼Œæˆ‘ä»¬å›åˆ°<code>react-scripts/scripts/start.js</code>ï¼Œè€è§„çŸ©ï¼Œä¸€ç³»åˆ—çš„ä¾èµ–å…ˆè·³è¿‡ä¸çœ‹ï¼Œåé¢ç”¨åˆ°å†æ¥çœ‹ã€‚<br>è¿˜è®°å¾—æˆ‘ä»¬åœ¨<code>env.js</code>é‡Œé¢deletæ‰node.catchå—ï¼Œè¿™é‡Œ<code>conts paths = require(&#39;../config/paths)</code>å°±ä¸ä¼šä»ç¼“å­˜é‡Œé¢å»æ‹¿è€Œæ˜¯é‡æ–°å»åŠ è½½ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!checkRequiredFiles([paths.appHtml, paths.appIndexJs])) &#123;</span><br><span class="line">  process.exit(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…ˆåˆ¤æ–­ä¸€ä¸‹æˆ‘ä»¬ä¸¤ä¸ªå…¥å£æ–‡ä»¶æœ‰æ²¡æœ‰å­˜åœ¨ï¼Œåˆ†åˆ«æ˜¯<code>project_path/public/index.html</code>å’Œ<code>project_path/src/index.js</code>ï¼Œå¦‚æœä¸å­˜åœ¨ç»™å‡ºæç¤ºç»“æŸç¨‹åºã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> DEFAULT_PORT = <span class="built_in">parseInt</span>(process.env.PORT, <span class="number">10</span>) || <span class="number">3000</span>;</span><br><span class="line"><span class="keyword">const</span> HOST = process.env.HOST || <span class="string">'0.0.0.0'</span>;</span><br></pre></td></tr></table></figure><p>ç„¶åè®¾ç½®é»˜è®¤çš„ç«¯å£å’Œhostï¼Œå¦‚æœæœ‰ç‰¹æ®Šçš„éœ€æ±‚ï¼Œå¯ä»¥ä»ç¯å¢ƒå˜é‡ä¼ è¿›å»æ”¹å˜ï¼Œæ²¡æœ‰å°±ä¼šç”¨é»˜è®¤çš„<code>3000</code>ç«¯å£ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">choosePort(HOST, DEFAULT_PORT).then(...) <span class="comment">// @return Promise</span></span><br></pre></td></tr></table></figure><p>è®¾ç½®å®Œé»˜è®¤çš„ç«¯å£ä¸hostä¹‹åï¼Œå¼€å§‹åˆ¤æ–­è¿™ä¸ªç«¯å£æœ‰æ²¡æœ‰è¢«å…¶ä»–çš„è¿›ç¨‹å ç”¨ï¼Œæœ‰çš„è¯ä¼šæä¾›ä¸‹ä¸€ä¸ªå¯ç”¨çš„ç«¯å£ï¼Œæˆ‘ä»¬é¡ºç€<code>choosePort</code>å»æ–‡ä»¶å¤´æ‰¾ä¾èµ–ï¼Œæ‰¾åˆ°è¯¥æ–¹æ³•ä½äºä¾èµ–<code>react-dev-utils/WebpackDevServerUtils</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">choosePort</span>(<span class="params">host, defaultPort</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> detect(defaultPort, host).then(</span><br><span class="line">    port =&gt;</span><br><span class="line">      <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (port === defaultPort) &#123;</span><br><span class="line">          <span class="keyword">return</span> resolve(port);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> message =</span><br><span class="line">          process.platform !== <span class="string">'win32'</span> &amp;&amp; defaultPort &lt; <span class="number">1024</span> &amp;&amp; !isRoot()</span><br><span class="line">            ? <span class="string">`Admin permissions are required to run a server on a port below 1024.`</span></span><br><span class="line">            : <span class="string">`Something is already running on port <span class="subst">$&#123;defaultPort&#125;</span>.`</span>;</span><br><span class="line">        <span class="keyword">if</span> (isInteractive) &#123;</span><br><span class="line">          clearConsole();</span><br><span class="line">          <span class="keyword">const</span> existingProcess = getProcessForPort(defaultPort);</span><br><span class="line">          <span class="keyword">const</span> question = &#123;</span><br><span class="line">            type: <span class="string">'confirm'</span>,</span><br><span class="line">            name: <span class="string">'shouldChangePort'</span>,</span><br><span class="line">            message:</span><br><span class="line">              chalk.yellow(</span><br><span class="line">                message +</span><br><span class="line">                  <span class="string">`<span class="subst">$&#123;existingProcess ? <span class="string">` Probably:\n  <span class="subst">$&#123;existingProcess&#125;</span>`</span> : <span class="string">''</span>&#125;</span>`</span></span><br><span class="line">              ) + <span class="string">'\n\nWould you like to run the app on another port instead?'</span>,</span><br><span class="line">            <span class="keyword">default</span>: <span class="literal">true</span>,</span><br><span class="line">          &#125;;</span><br><span class="line">          inquirer.prompt(question).then(<span class="function"><span class="params">answer</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (answer.shouldChangePort) &#123;</span><br><span class="line">              resolve(port);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              resolve(<span class="literal">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(chalk.red(message));</span><br><span class="line">          resolve(<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;),</span><br><span class="line">    err =&gt; &#123;</span><br><span class="line">      <span class="comment">// è¾“å‡ºé”™è¯¯æ—¥å¿—</span></span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>choosePort</code> é‡Œé¢ç”¨åˆ°<a href="https://www.npmjs.com/package/detect-port-alt" target="_blank" rel="noopener">detect-port-alt</a>å»æ£€æµ‹ç«¯å£å ç”¨ï¼Œå¦‚æœè¢«å ç”¨äº†è¿”å›ä¸€ä¸ªæœ€æ¥è¿‘çš„é€’å¢æ–¹å‘å¯ç”¨çš„ç«¯å£ï¼Œæ¯”å¦‚3000ç«¯å£è¢«å ç”¨,3001æ²¡è¢«å ç”¨å°±è¿”å›å›æ¥ã€‚<br>å¦‚æœå‘ç°è¿”å›çš„å¯ç”¨ç«¯å£ä¸æ˜¯é»˜è®¤çš„ç«¯å£ï¼Œç»™å‡ºä¸€ä¸ªäº¤äº’å¼çš„å‘½ä»¤è¯¢é—®ç”¨æˆ·æ˜¯å¦è¦æ¢ä¸€ä¸ªç«¯å£å»è®¿é—®ï¼Œäº¤äº’å¼å‘½ä»¤ç”¨çš„æ˜¯<a href="https://www.npmjs.com/package/inquirer" target="_blank" rel="noopener">inquirer</a>è¿™ä¸ªåŒ…ã€‚<br>è¿™é‡Œå¦‚æœç”¨vsCodeæ¥è°ƒè¯•ï¼Œ<code>process.stdout.isTTY</code> è¿”å›çš„å€¼æ˜¯<code>undefined</code>ã€‚æ‰€ä»¥å¦‚æœè¦æµ‹è¯•è¿™ä¸€å—äº¤äº’å¼å‘½ä»¤ï¼Œåªèƒ½åˆ‡å›ç³»ç»Ÿçš„ç»ˆç«¯å»è°ƒè¯•~</p><p><img src="./tty_choose_port.png" alt="äº¤äº’å¼å‘½ä»¤è¯¢é—®æ˜¯å¦åˆ‡æ¢ç«¯å£" title="äº¤äº’å¼å‘½ä»¤è¯¢é—®æ˜¯å¦åˆ‡æ¢ç«¯å£"></p><p><a href="https://github.com/facebook/create-react-app/blob/v1.1.4/packages/react-scripts/scripts/start.js#L71" target="_blank" rel="noopener">æ–‡ä»¶ä¼ é€é—¨</a><br>æ£€æµ‹å®Œå¯ç”¨ç«¯å£ä¹‹åï¼Œå›åˆ°<code>start.js</code>ã€‚</p><p>å‰ç«¯å¤„ç†ä¸€å †ç¯å¢ƒå˜é‡ï¼Œè¿˜æœ‰åŠ è½½ä¸€å †é…ç½®ï¼Œå…¨éƒ½ç”¨åœ¨è¿™ä¸€å—ã€‚è¿™é‡Œä¸»è¦åšçš„å°±æ˜¯æŠŠç¯å¢ƒå˜é‡å’Œé…ç½®ç»„è£…èµ·æ¥ï¼Œå¼€ä¸ªwebpackæœ¬åœ°è°ƒè¯•æœåŠ¡ã€‚ä¸»è¦åšçš„äº‹æƒ…æœ‰:</p><ol><li>å¦‚æœæ²¡æœ‰æ‰¾åˆ°å¯ç”¨çš„ç«¯å£ç›´æ¥è¿”å›ä¸ç»§ç»­æ‰§è¡Œä¸‹å»</li><li>æ ¹æ®ç¯å¢ƒå˜é‡åˆ¤æ–­æ˜¯å¦å¯ç”¨<code>https</code>ï¼Œé»˜è®¤æ˜¯<code>http</code>ã€‚</li><li>æ ¹æ® host, protocol, port æ‹¼è£…ä¸€ç³»åˆ—çš„urlï¼ŒåŒ…æ‹¬<code>Browser</code>çš„urlä¸<code>Terminal</code>çš„urlã€‚</li><li>è°ƒç”¨<code>createCompiler</code> ä¼ å…¥webpackï¼Œwebpacké…ç½®ï¼ŒappNameï¼Œç¬¬ä¸‰æ­¥è·å–çš„urlï¼Œè¿˜æœ‰æ˜¯å¦ä½¿ç”¨Yarnç­‰å‚æ•°ï¼Œç”Ÿæˆä¸€ä¸ª webpackCompilerã€‚createCompilerè´Ÿè´£çš„ä¸œè¥¿æœ‰:<br>4.1 æ ¹æ®ç¯å¢ƒå˜é‡åˆ¤æ–­æ˜¯å¦æœ‰å†’çƒŸæµ‹è¯•çš„éœ€æ±‚ï¼Œå¦‚æœæœ‰åŠ ä¸€ä¸ª <code>handleCompile</code>ï¼Œä¸€æœ‰é”™è¯¯å°±ä¸­æ–­ç¨‹åºã€‚<br>4.2 ç”¨ä¼ è¿›æ¥çš„é…ç½®å’ŒhandleCompileç”Ÿæˆä¸€ä¸ªwebpackCompiler<br>4.2 å¢åŠ <code>invalid</code>é’©å­ï¼Œä¸€æ£€æµ‹åˆ°æ›´æ”¹æ–‡ä»¶ï¼Œè€Œä¸”æ˜¯äº¤äº’å¼ç»ˆç«¯çš„è¯ï¼Œå…ˆæ¸…ç©ºæ§åˆ¶å°ï¼Œå†è¾“å‡ºæ—¥å¿—<br>4.3 å¢åŠ <code>done</code>é’©å­ï¼Œå¯¹webpackçš„è¾“å‡ºæ—¥å¿—æ•´ç†ç»Ÿä¸€è¾“å‡º</li><li>åˆ›å»ºå¼€å‘æœåŠ¡é…ç½® å…·ä½“çš„é…ç½®ä»£ç æ”¾åœ¨<code>webpackDevServer.config.js</code></li><li>æŠŠ4å’Œ5ä¸¢ç»™ <code>WebpackDevServer</code>ï¼Œç”Ÿæˆä¸€ä¸ª webpack æœ¬åœ°å¼€å‘æœåŠ¡</li><li>å¤§åŠŸå‘Šæˆï¼Œæ¸…é™¤å±å¹•ï¼Œæ‰“å¼€è°ƒè¯•è¿æ¥</li></ol><p>ç›¸å…³çš„ä»£ç æ‰§è¡Œå†™åˆ°æ³¨é‡Šé‡Œé¢å»äº†ï¼Œæ²¡åŠæ³•æ¯ä¸ªæ–¹æ³•é…ç½®éƒ½æ‹å‡ºæ¥è®²â€¦ä¸ç„¶ç¯‡å¹…ä¼šå¾ˆé•¿ï¼Œè¿™é‡Œé¢å¾ˆå¤šç‚¹ä¸€è®²éƒ½å¯ä»¥æ˜¯ä¸€ä¸ªçŸ¥è¯†ç‚¹ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">choosePort(HOST, DEFAULT_PORT)</span><br><span class="line">  .then(<span class="function"><span class="params">port</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// æ²¡æœ‰æ‰¾åˆ°å¯ç”¨ç«¯å£ï¼Œç›´æ¥return</span></span><br><span class="line">    <span class="keyword">if</span> (port == <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ ¹æ®ç¯å¢ƒå˜é‡åˆ¤æ–­æ˜¯å¦è¦ç”¨https</span></span><br><span class="line">    <span class="keyword">const</span> protocol = process.env.HTTPS === <span class="string">'true'</span> ? <span class="string">'https'</span> : <span class="string">'http'</span>;</span><br><span class="line">    <span class="keyword">const</span> appName = <span class="built_in">require</span>(paths.appPackageJson).name;</span><br><span class="line">    <span class="comment">// è·å–å½“å‰çš„ host, port, protocol ç”Ÿæˆä¸€ç³»åˆ—url</span></span><br><span class="line">    <span class="keyword">const</span> urls = prepareUrls(protocol, HOST, port);</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªwebpack compiler</span></span><br><span class="line">    <span class="keyword">const</span> compiler = createCompiler(webpack, config, appName, urls, useYarn);</span><br><span class="line">    <span class="comment">// åŠ è½½ä»£ç†çš„é…ç½®ï¼Œåœ¨ project_path/package.json é‡Œé¢åŠ è½½é…ç½®</span></span><br><span class="line">    <span class="keyword">const</span> proxySetting = <span class="built_in">require</span>(paths.appPackageJson).proxy;</span><br><span class="line">    <span class="keyword">const</span> proxyConfig = prepareProxy(proxySetting, paths.appPublic);</span><br><span class="line">    <span class="comment">// ç”Ÿæˆ webpack dev server çš„é…ç½®</span></span><br><span class="line">    <span class="keyword">const</span> serverConfig = createDevServerConfig(</span><br><span class="line">      proxyConfig,</span><br><span class="line">      urls.lanUrlForConfig</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">const</span> devServer = <span class="keyword">new</span> WebpackDevServer(compiler, serverConfig);</span><br><span class="line">    <span class="comment">// ç›‘å¬ devServer</span></span><br><span class="line">    devServer.listen(port, HOST, err =&gt; &#123;</span><br><span class="line">      <span class="comment">// ä¸€äº›æ—¥å¿—è¾“å‡º</span></span><br><span class="line">      <span class="comment">// è‡ªåŠ¨ç”¨é»˜è®¤æµè§ˆå™¨æ‰“å¼€è°ƒè¯•é“¾æ¥</span></span><br><span class="line">      openBrowser(urls.localUrlForBrowser);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// é”™è¯¯å¤„ç†</span></span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure></p><p><code>react-dev-utils/WebpackDevServerUtils.js</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createCompiler</span>(<span class="params">webpack, config, appName, urls, useYarn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> compiler;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    compiler = webpack(config, handleCompile); <span class="comment">// handleCompileä¸ºå†’çƒŸæµ‹è¯•çš„å¯¹åº”å¤„ç†</span></span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="comment">// é”™è¯¯æç¤º</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  compiler.plugin(<span class="string">'invalid'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="comment">// invalid é’©å­ï¼Œå¦‚æœå½“å‰å¤„äºTTYç»ˆç«¯ï¼Œé‚£ä¹ˆå…ˆæ¸…é™¤æ§åˆ¶å°å†è¾“å‡º Compiling...</span></span><br><span class="line">    <span class="keyword">if</span> (isInteractive) &#123;</span><br><span class="line">      clearConsole();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Compiling...'</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> isFirstCompile = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">  compiler.plugin(<span class="string">'done'</span>, stats =&gt; &#123;</span><br><span class="line">    <span class="comment">// ç›‘å¬äº† done äº‹ä»¶ï¼Œå¯¹è¾“å‡ºçš„æ—¥å¿—åšäº†æ ¼å¼åŒ–è¾“å‡º</span></span><br><span class="line">    <span class="comment">// æ­£å¸¸æƒ…å†µä¸‹ä¼šç›´æ¥è¾“å‡º `Compiled successfully!`</span></span><br><span class="line">    <span class="comment">// å¦‚æœæœ‰é”™è¯¯åˆ™è¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼Œè¿™é‡Œå¯¹é”™è¯¯ä¿¡æ¯åšä¸€äº›å¤„ç†ï¼Œè®©å…¶è¾“å‡ºæ¯”è¾ƒå‹å¥½</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> compiler;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><img src="./webpackDevServer_error.png" alt="è¾“å‡ºæ—¥å¿—æ ¼å¼åŒ–å¤„ç†" title="è¾“å‡ºæ—¥å¿—ç»Ÿä¸€æ ¼å¼åŒ–å¤„ç†"></p><h1 id="æœ€åè®²ä¸¤å¥"><a href="#æœ€åè®²ä¸¤å¥" class="headerlink" title="æœ€åè®²ä¸¤å¥"></a>æœ€åè®²ä¸¤å¥</h1><p>ä¹‹å‰å°±ä¸€ç›´å¥½å¥‡ï¼Œè¿™äº›è„šæ‰‹æ¶æ˜¯æ€ä¹ˆæ¸…ç©ºæˆ‘ä»¬çš„ç»ˆç«¯å±å¹•çš„ã€‚åœ¨çœ‹<code>create-react-app</code>çš„æ—¶å€™ï¼Œç„åˆ°æœ‰è¿™ä¹ˆä¸€ä¸ªæ–‡ä»¶<a href="https://github.com/facebook/create-react-app/blob/v1.1.4/packages/react-dev-utils/clearConsole.js" target="_blank" rel="noopener">react-dev-utils/clearConsole.js</a>ã€‚è¿™ä¸ªæ–‡ä»¶ååˆ†å‰ªçŸ­ï¼Œæ ¸å¿ƒä»£ç å°±é‚£ä¹ˆä¸€å¥:</p><h2 id="react-dev-utils-clearConsole-js"><a href="#react-dev-utils-clearConsole-js" class="headerlink" title="react-dev-utils/clearConsole.js"></a><a href="#react-dev-utils-clearConsole-js">react-dev-utils/clearConsole.js</a></h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">process.stdout.write(process.platform === <span class="string">'win32'</span> ? <span class="string">'\x1B[2J\x1B[0f'</span> : <span class="string">'\x1B[2J\x1B[3J\x1B[H'</span>);</span><br></pre></td></tr></table></figure><p>ç„¶åå¥½å¥‡å¿ƒç‰¹åˆ«é‡ï¼Œä¸çŸ¥é“åé¢ä¸¤ä¸²æ˜¯ä»€ä¹ˆæ„æ€ï¼Œä¸€ç›´æœæ²¡æœ‰æ‰¾åˆ°æƒ³è¦çš„ç­”æ¡ˆã€‚é—®äº†èº«è¾¹çš„åŒäº‹ï¼Œè¯´æ˜¯åå…­è¿›åˆ¶ï¼Œè€Œåœ¨æˆ‘ç‹­éš˜çš„è®¤çŸ¥é‡Œé¢ä¸€ç›´ä»¥ä¸ºåå…­è¿›åˆ¶åªèƒ½è½¬æˆæ•°å­—â€¦.ä½†æ˜¯å®šç›ä¸€çœ‹ï¼Œè¿™æœ‰ä¸ª<code>J</code> æ˜æ˜¾ä¸æ˜¯åå…­è¿›åˆ¶ã€‚ä¸€ä¸ªå¥³è£…å¤§ä½¬å’Œæˆ‘è¯´è¿™æ˜¯ASCIIç ï¼Œç™¾åº¦äº†ä¸€ä¸‹ASCIIç ï¼Œçœ‹äº† <code>\x1B</code> ASCIIå¯¹åº”åˆ° <code>ESC</code>ã€‚ ä½†æ˜¯åé¢çš„ <code>[2J</code> <code>[3J</code> <code>[H</code> æ˜¯ä»€ä¹ˆæ„æ€è¿˜æ˜¯ä¸æ¸…æ¥šâ€¦<br>åé¢å¤§ä½¬åˆå’Œæˆ‘è¯´æ‰¾åˆ°å¯èƒ½æ˜¯ <strong>Linux ANSI æ§åˆ¶ç </strong> æ‰¾æ¥æ‰¾å»æŠ˜è…¾äº†æŒºä¹…çš„åé¢æ‰æ­å¼€ç¥ç§˜é¢çº±~<br>è¿™å‡ ä¸ªå‘½ä»¤å¤§æ¦‚çš„æ„æ€æ˜¯:<br><code>[2J</code> æ¸…é™¤æ§åˆ¶å°<br><code>[H</code> å°†å…‰æ ‡ç§»è‡³æœ€é¡¶éƒ¨<br><code>[3J</code>è¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°ï¼Œåº”è¯¥æ˜¯æ›´é«˜çº§çš„ç³»ç»Ÿå±‚çº§çš„æ¸…é™¤æ§åˆ¶å°<br>ç»™å‡ºå‡ ä¸ª Linux ANSI æ§åˆ¶ç èµ„æ–™ç½‘ç«™<br><a href="http://manpages.ubuntu.com/manpages/bionic/zh_CN/man4/console_codes.4.html" target="_blank" rel="noopener">Ubuntu Manpage: æ§åˆ¶ç»ˆç«¯ä»£ç  - Linux æ§åˆ¶ç»ˆç«¯è½¬ä¹‰å’Œæ§åˆ¶åºåˆ—</a><br><a href="www.cnblogs.com/mugua/archive/2009/11/25/1610118.html">æ§åˆ¶ç»ˆç«¯ä»£ç  - Linux æ§åˆ¶ç»ˆç«¯è½¬ä¹‰å’Œæ§åˆ¶åºåˆ—(è½¬) - æœ¨ç“œè„‘è¢‹ - åšå®¢å›­</a></p><p>æœ€åå‰ç«¯çš„å°ä¼™ä¼´å¾ˆå¤šå’Œæˆ‘ä¸€æ ·ä¸æ˜¯ç§‘ç­å‡ºèº«çš„ï¼ŒçœŸçš„å¾—åŠ æŠŠåŠ²è¡¥è¡¥ä¸€äº›è®¡ç®—æœºæ¯”è¾ƒåŸç†æ€§æˆ–æ¯”è¾ƒæ¥è¿‘ç³»ç»Ÿå±‚çº§çš„çŸ¥è¯†~</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ä¸Šä¸€ç¯‡æˆ‘ä»¬å·²ç»è®²äº† &lt;code&gt;create-react-app&lt;/code&gt;é‡Œé¢åˆ›å»º&lt;code&gt;package.json&lt;/code&gt;å®‰è£…ä¾èµ–å¹¶ä¸”æ‹·è´å¯è¿è¡Œçš„demoç­‰æ­¥éª¤ã€‚&lt;a href=&quot;https://jsonz1993.github.io/2018/05/crea
      
    
    </summary>
    
      <category term="technology" scheme="https://jsonz1993.github.io/categories/technology/"/>
    
    
      <category term="learn" scheme="https://jsonz1993.github.io/tags/learn/"/>
    
      <category term="github" scheme="https://jsonz1993.github.io/tags/github/"/>
    
      <category term="React" scheme="https://jsonz1993.github.io/tags/React/"/>
    
      <category term="JavaScript" scheme="https://jsonz1993.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>2018-05-08é¢è¯•è®°B</title>
    <link href="https://jsonz1993.github.io/2018/05/2018-05-08/"/>
    <id>https://jsonz1993.github.io/2018/05/2018-05-08/</id>
    <published>2018-05-08T23:29:16.000Z</published>
    <updated>2019-03-13T03:30:36.808Z</updated>
    
    <content type="html"><![CDATA[<p>æ¬§å•¦å•¦å•¦å•¦å•¦å•¦å•¦å•¦å•¦ </p><p>è®°å½•ä¸‹æœ€è¿‘çš„é¢è¯•ç­‰æƒ…å†µ~~~ </p><h2 id="ç®€å†æŠ•é€’æƒ…å†µ2"><a href="#ç®€å†æŠ•é€’æƒ…å†µ2" class="headerlink" title="ç®€å†æŠ•é€’æƒ…å†µ2"></a>ç®€å†æŠ•é€’æƒ…å†µ2</h2><p><a href="https://jsonz1993.github.io/2018/04/2018-04-29/">ç®€å†æŠ•é€’æƒ…å†µä¼ é€é—¨</a><br>æ®ä¸å®Œå…¨ç»Ÿè®¡:<br>æŠ• <code>è”æ</code> æŠ€æœ¯é¢<br>æŠ• <code>100æ•™è‚²</code> å¾…æ²Ÿé€š<br>æŠ• <code>å°šå¾·æ•™è‚²</code> æ²¡é¢è¯•æœºä¼š</p><p>æœ€æœ€æœ€æœ€æœ€å¼€å¿ƒçš„äº‹æƒ…å¯èƒ½å°±æ˜¯é¢äº†è”æ~ è™½ç„¶æœ€åæ²¡æœ‰è¿‡ ä¸è¿‡è¿˜æ˜¯æŒºä¸é”™çš„ä¸€æ¬¡ä½“éªŒ è®°å½•ä¸€ä¸‹</p><p>é¦–å…ˆæµç¨‹æ˜¯ï¼š ç¬”è¯• =&gt; æœºè¯• =&gt; ä¸¤ä¸ªäººçš„æŠ€æœ¯é¢</p><p>ç¬”è¯•æ¯”è¾ƒåŸºç¡€çš„é—®é¢˜ï¼Œä½†æ˜¯é¢è¯•å®˜ä¼šæ ¹æ®å†™çš„é¢˜é—®æ€è·¯ï¼Œè€Œä¸”ä¼šå„ç§å˜å½¢é—®ï¼Œå¯ä»¥æ¯”è¾ƒæ·±äº†è§£åŸºç¡€çš„çŸ¥è¯†ã€‚</p><p>ä»¥ä¸‹åªæ˜¯ä¸ªäººçš„é¢è¯•è®°å½•ï¼Œå¦‚æœå‘ç°æœ‰ä¸å¦¥çš„è”ç³»å³åˆ ã€‚</p><h2 id="è”æç¬”è¯•"><a href="#è”æç¬”è¯•" class="headerlink" title="è”æç¬”è¯•"></a>è”æç¬”è¯•</h2><ol><li><p>ä½œç”¨åŸŸçš„é—®é¢˜</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> t;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">  <span class="keyword">var</span> t;</span><br><span class="line">  t = <span class="number">20</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typeof</span> a();</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿˜æœ‰å„ç§å˜å½¢</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">  <span class="keyword">var</span> t;</span><br><span class="line">  <span class="keyword">return</span> t;</span><br><span class="line">  t = <span class="number">20</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">  <span class="keyword">var</span> t;</span><br><span class="line">  <span class="keyword">return</span> t;</span><br><span class="line">  t = <span class="number">20</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">  <span class="keyword">var</span> t;</span><br><span class="line">  <span class="keyword">return</span> t;</span><br><span class="line">  t = <span class="number">20</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> t;</span><br><span class="line">  <span class="keyword">var</span> t;</span><br><span class="line">  t = <span class="number">20</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å…¼å®¹ä½ç‰ˆæœ¬æµè§ˆå™¨æ¨¡æ‹Ÿ Function.prototype.bind</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç›´æ¥ç”¨ call || allpy æ¨¡æ‹Ÿï¼Œè¿”å›ä¸€ä¸ªé—­åŒ…ï¼Œå‚æ•°ç”¨ <span class="built_in">Array</span>.prototype.slice.apple å»å–å³å¯~</span><br></pre></td></tr></table></figure></li><li><p>å…³äºæ­£åˆ™çš„æ¯”è¾ƒç®€å•~ ä¸å†™å‡ºæ¥äº†</p></li><li><p>å…³äºzIndexçš„ï¼Œæ¨èç›´æ¥çœ‹å¼ é‘«æ—­å¤§ä½¬çš„æ–‡ç« ï¼Œè¶…ä¸è¿‡é‚£ä¸ªèŒƒå›´<a href="http://www.zhangxinxu.com/wordpress/2016/01/understand-css-stacking-context-order-z-index/" target="_blank" rel="noopener">å¼ é‘«æ—­å¤§ä½¬ä¼ é€é—¨</a></p></li><li><p>å®ç°ä¸€ä¸ªå®½é«˜éƒ½æ˜¯æµè§ˆå™¨ 40%çš„æ­£æ–¹å½¢</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. ç”¨vwæ–¹æ¡ˆ</span><br><span class="line">2. ç”¨padding ( emmm è¿™ä¸ªé¢è¯•å¤§ä½¬æç¤ºäº†æ‰æƒ³èµ· padding æ˜¯æ ¹æ®çˆ¶çº§å®½åº¦çš„)</span><br></pre></td></tr></table></figure></li><li><p>a,b,c,d å››ä¸ªæ¥å£ï¼Œæ±‚æœ€å¿« || æœ€æ…¢çš„å“åº”æ—¶é—´</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç›´æ¥ç”¨ <span class="built_in">Promise</span>.all || <span class="built_in">Promise</span>.race å³å¯</span><br></pre></td></tr></table></figure></li></ol><p>ç¬”è¯•é¢˜è¿˜å¥½ï¼Œä½œç”¨åŸŸé‚£ä¸€é¢˜æœ‰ç‚¹æ·· å…¶ä»–æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œç®—æ˜¯æœ‰æƒŠæ— é™©</p><h2 id="æœºè¯•"><a href="#æœºè¯•" class="headerlink" title="æœºè¯•"></a>æœºè¯•</h2><p>æœºè¯•é¢˜äºŒé€‰ä¸€ ä¸€ä¸ªæ˜¯å®ç°ä¸€ä¸ª<code>dialog</code> ä¸€ä¸ªæ˜¯å®ç°ä¸€ä¸ªéªŒè¯è¡¨å•<br>é€‰äº† dialog åšçš„æ—¶å€™æ²¡æœ‰çœ‹é¢˜â€¦æœ‰ä¸ªåŠŸèƒ½ç‚¹æ²¡æœ‰å®ç°å®Œå…¨å°±è·‘å»åšéªŒè¯é¢˜ï¼ŒéªŒè¯é¢˜æ²¡æœ‰åšå®Œ<br>dialog åº”è¯¥ç®—æ˜¯å®ç°çš„ä¸å¤ŸåŠæ ¼çº¿</p><p>å¼•å‡ºäº†æŒºå¤šä¼˜åŒ–æ–¹æ¡ˆçš„ï¼Œæ¯”å¦‚ dom å¤„ç†ï¼Œæ¯”å¦‚åŠ¨ç”»å¤„ç†ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªé¢è¯•å®˜æš—ç¤ºäº†å¥½å¤šæ¬¡ï¼Œä½†æ˜¯æ²¡æœ‰æƒ³èµ·æ¥çš„ä¸€ä¸ªapi <a href="https://developer.mozilla.org/zh-CN/docs/Web/Events/animationend" target="_blank" rel="noopener">animationend</a><br><a href="http://www.runoob.com/jsref/event-animationend.html" target="_blank" rel="noopener">animationend demo</a></p><h2 id="é¢è¯•"><a href="#é¢è¯•" class="headerlink" title="é¢è¯•"></a>é¢è¯•</h2><p>é¢è¯•å°±æ ¹æ®å‰é¢åšçš„ä¸¤ä»½é¢˜æ‰©å±•å»é—®æ€è·¯ç­‰ç­‰</p><p>é—®é¢˜çš„å¥—è·¯æ˜¯æ¯”è¾ƒå–œæ¬¢çš„ï¼Œä¸¾ä¸ªä¾‹å­ï¼š</p><p>Q: å·¦è¾¹è‡ªé€‚åº”ï¼Œå³è¾¹å›ºå®šæœ‰ä»€ä¹ˆå¸ƒå±€?<br>A: flexå¸ƒå±€, flex: 1 &amp;&amp; width: â€¦<br>Q: æµè§ˆå™¨è¿™æ—¶å€™ç¼©å°ä¼šæœ‰ä»€ä¹ˆæƒ…å†µï¼Ÿ<br>A: flex: 1 æ…¢æ…¢ç¼©å°ï¼Œå¦ä¸€ä¸ªä¸å˜ï¼ˆè¿™ä¸ªå›ç­”æˆ‘æ¨¡æ£±ä¸¤å¯çŠ¹è±«äº†ï¼Œè™½ç„¶çŸ¥é“æ˜¯ä¸å˜ï¼Œä½†æ˜¯å¥½åƒé¡¹ç›®ä¸­æœ‰é‡è¿‡å˜çš„â€¦æ‰£åˆ†äº†)<br>Q: è¿˜æœ‰å…¶ä»–çš„å—?<br>A: æµ®åŠ¨ float:left; overflow: auto<br>Q: æ¸…é™¤æµ®åŠ¨æœ‰å“ªäº›<br>A: å§”å…ƒç´ æ¸…é™¤ &amp;&amp; BFC<br>Q: BFCæ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆä½œç”¨ï¼Œæ€ä¹ˆè®¾ç½®BFC<br>A: å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼Œæ¸…é™¤æµ®åŠ¨æˆ–è€…æ¶ˆé™¤masteråˆå¹¶ï¼Œå¯ä»¥ç”¨overflow(hidden,auto,scroll) || float(left,right) || display(inline-block) || position(absolute, fixed)</p><p>åé¢èŠäº†ä¸‹ å·¥ä½œçš„ä¼˜åŒ–ï¼Œ webpackæ„å»ºï¼Œ reactä¼˜åŒ–, ç¼“å­˜æœºåˆ¶(æ¶‰åŠhttp), pwaç­‰ç­‰</p><p>è¿˜é—®äº†å°ç¨‹åºå’Œvueçš„ä¸œè¥¿ï¼Œä½†æ˜¯å…¶å®ä¸Šä¸€æ¬¡åšå°ç¨‹åºå·²ç»æ˜¯ä¸€å¹´å‰äº†ï¼Œè¯´äº†vueå’Œå°ç¨‹åºçš„ä¸Šæ‰‹ä¸åº”è¯¥æˆä¸ºä¸€ä¸ªé—®é¢˜æ‰€åœ¨ã€‚</p><p>ç„¶åé—®äº†ä¸‹èŒä¸šè§„åˆ’ï¼Œè¯´äº†æœ€è¿‘æ˜¯åœ¨çœ‹ <code>create-react-app</code>æºç ï¼Œæ¥ä¸‹æ¥çš„è§„åˆ’æ˜¯ <strong>ä¸“å‰ç«¯ é€šå…¶ä»–</strong></p><h2 id="è”æç»“æœ"><a href="#è”æç»“æœ" class="headerlink" title="è”æç»“æœ"></a>è”æç»“æœ</h2><p>å·¥ä½œä¼˜åŒ–å¯èƒ½ä¸æ˜¯å¾ˆæ»¡æ„<br>webpackæ„å»ºä¼˜åŒ–åº”è¯¥è¿˜è¡Œï¼Œæ¯•ç«Ÿé¡¹ç›®ä¸Šç”¨çš„æ¯”è¾ƒå¤š<br>reactä¹Ÿè¿˜å¥½ï¼Œè™½ç„¶é¢è¯•çš„æ˜¯ç”¨vueå’Œå°ç¨‹åº<br>pwaä¹Ÿæœ‰æ‰€äº†è§£<br>ä¸»è¦æ˜¯ httpè¿™å—æš´éœ²äº†åå°çŸ¥è¯†è–„å¼±ï¼Œæ²¡æœ‰å½¢æˆä¸€ä¸ªæ¯”è¾ƒå…¨é¢çŸ¥è¯†ä½“ç³»</p><p>åé¢è¿˜è¢«å«Œå¼ƒäº†ä¸‰å¹´å‘†äº†ä¸‰ä¸ªå…¬å¸å¤ªè¿‡é¢‘ç¹</p><p>æœ€åè®©é¢è¯•å®˜ç»™äº†ä¸€ä¸‹é¢è¯•çš„è¯„ä»·ï¼š<br><strong>1. css æ¦‚å¿µä¸ç†Ÿ</strong><br><strong>2. æµè§ˆå™¨apiè®¤è¯†ä¸å…¨</strong><br><strong>3. httpã€åç«¯çŸ¥è¯†æ²¡æœ‰ç³»ç»Ÿå­¦ä¹ </strong><br><strong>4. è·³æ§½è¿‡å¤š~ ä¸‰å¹´å‘†äº†ä¸‰ä¸ªå…¬å¸</strong></p><p>â•®(â•¯â–½â•°)â•­å“ è¿˜é—¹äº†ä¸ªä¹Œé¾™ï¼Œæƒ³è¯´ ã€ŠCSSä¸–ç•Œã€‹ è¯´æˆ ã€Šcssæ­ç§˜ã€‹</p><p>æœ€è¿‘åº”è¯¥æŠ˜è…¾å®Œæ‰‹ä¸Šä¸œè¥¿åï¼Œä¼šæ¯”è¾ƒç³»ç»Ÿçš„å»çœ‹ åˆ‡å›¾å†™é¡µé¢çš„è¿™ä¸€å—ï¼Œæ¯”è¾ƒ html+css å…¶å®ä¹Ÿæ˜¯å¾ˆé‡è¦çš„</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æ¬§å•¦å•¦å•¦å•¦å•¦å•¦å•¦å•¦å•¦ &lt;/p&gt;
&lt;p&gt;è®°å½•ä¸‹æœ€è¿‘çš„é¢è¯•ç­‰æƒ…å†µ~~~ &lt;/p&gt;
&lt;h2 id=&quot;ç®€å†æŠ•é€’æƒ…å†µ2&quot;&gt;&lt;a href=&quot;#ç®€å†æŠ•é€’æƒ…å†µ2&quot; class=&quot;headerlink&quot; title=&quot;ç®€å†æŠ•é€’æƒ…å†µ2&quot;&gt;&lt;/a&gt;ç®€å†æŠ•é€’æƒ…å†µ2&lt;/h2&gt;&lt;p&gt;&lt;a href=
      
    
    </summary>
    
      <category term="blog" scheme="https://jsonz1993.github.io/categories/blog/"/>
    
    
      <category term="blog" scheme="https://jsonz1993.github.io/tags/blog/"/>
    
  </entry>
  
  <entry>
    <title>create-react-app æºç è§£æ</title>
    <link href="https://jsonz1993.github.io/2018/05/create-react-app-o/"/>
    <id>https://jsonz1993.github.io/2018/05/create-react-app-o/</id>
    <published>2018-05-05T17:44:23.000Z</published>
    <updated>2019-03-13T03:30:36.808Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘å·¥ä½œå¼€å§‹ç¨³å®šä¸‹æ¥ï¼Œæ²¡æœ‰é‚£ä¹ˆå¤šåŠ ç­ï¼ŒåŠ ä¸Šè¯´æŠ•ç®€å†æ‰¾é¢è¯•ä¸€ç›´æ²¡æ‹¿åˆ°é¢è¯•æœºä¼šâ€¦æ‰€ä»¥å¼€å§‹æœ‰ç©ºé—²çš„æ—¶é—´</p><p>ä¹‹å‰å…¬å¸æœ‰ä¸ªå¤§ä½¬å†™äº†ä¸ªç±»ä¼¼ create-react-app çš„è„šæ‰‹æ¶ï¼Œç”¨æ¥åˆ›å»ºå…¬å¸çš„é¡¹ç›®ã€‚ä¸€ç›´ä¸çŸ¥é“é‡Œé¢å®ç°çš„åŸç†ï¼Œå€Ÿæ­¤æœºä¼šä¸€æ¢ <code>create-react-app</code> æºç ï¼Œäº†è§£ä¸‹é‡Œé¢è¿è¡Œçš„æœºåˆ¶ã€‚</p><p>æˆäººä»¥é±¼ä¸å¦‚æˆäººä»¥æ¸”ï¼Œå¸Œæœ›é€šè¿‡è¿™ç¯‡æ–‡ç« ä¹‹åï¼Œå¯¹å¤§å®¶ä»¥åçœ‹æºç å¯ä»¥æœ‰æ‰€å¸®åŠ©ã€‚<br>å¤§å®¶ä¹Ÿä¸è¦ä¸€çœ‹åˆ°æºç å°±å®³æ€•ä¸æ•¢å»çœ‹ï¼Œç°åœ¨è¿™ä¹ˆä¼˜ç§€é¡¹ç›®éƒ½å¼€æºäº†ï¼ŒåŠ ä¸Šå„ç§IDEæ”¯æŒå¾ˆå¥½ï¼Œç›´æ¥æ‰“ä¸ªæ–­ç‚¹è¿›å»è°ƒè¯•ï¼Œå¾ˆå®¹æ˜“çœ‹å‡ºä¸ªå¤§æ¦‚ã€‚<br>ä¹Ÿå¯ä»¥ç”¨è¿™ç§æ€è·¯å»äº†è§£å…¶ä»–çš„å¼€æºé¡¹ç›®</p><h1 id="å¿«é€Ÿäº†è§£"><a href="#å¿«é€Ÿäº†è§£" class="headerlink" title="å¿«é€Ÿäº†è§£"></a><a href="#å¿«é€Ÿäº†è§£">å¿«é€Ÿäº†è§£</a></h1><p>å¯¹äºæƒ³å¿«é€Ÿäº†è§£çš„ç›´æ¥æµè§ˆè¿™ä¸€å—å³å¯<br>create-react-app å…¶å®å°±æ˜¯ç”¨nodeå»è·‘ä¸€äº›åŒ…å®‰è£…æµç¨‹ï¼Œå¹¶ä¸”æŠŠæ–‡ä»¶æ¨¡æ¿demoè€ƒåˆ°å¯¹äºçš„ç›®å½•ä¸‹ã€‚<br>å¯ä»¥ç®€å•åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤:</p><ul><li>åˆ¤æ–­Nodeç‰ˆæœ¬</li><li>åšä¸€äº›å‘½ä»¤è¡Œå¤„ç†çš„åˆå§‹åŒ–ï¼Œæ¯”å¦‚è¾“å…¥ <code>-help</code> åˆ™è¾“å‡ºå¸®åŠ©å†…å®¹</li><li>åˆ¤æ–­æ˜¯å¦æœ‰è¾“å…¥é¡¹ç›®åï¼Œæœ‰åˆ™æ ¹æ®å‚æ•°å»è·‘åŒ…å®‰è£…ï¼Œé»˜è®¤æ˜¯yarnå®‰è£…æ–¹å¼ï¼Œeg: <code>yarn add react react-dom react-scripts</code></li><li>ä¿®æ”¹package.jsoné‡Œé¢å·²å®‰è£…çš„ä¾èµ–ç‰ˆæœ¬ï¼Œä»ç²¾ç¡®ç‰ˆæœ¬<code>16.0.0</code>æ”¹ä¸º^å‘ä¸Šå…¼å®¹ç‰ˆæœ¬<code>^16.0.0</code> å¹¶åŠ å…¥ <code>start</code>,<code>build</code>ç­‰å¯åŠ¨è„šæœ¬</li><li>æ‹·è´ <code>react-scripts</code>ä¸‹çš„ <code>template</code> åˆ°ç›®æ ‡æ–‡ä»¶ï¼Œé‡Œé¢æœ‰<code>public</code>,<code>src</code>ç­‰æ–‡ä»¶å¤¹ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªç®€å•çš„å¯è¿è¡Œdemo</li><li>END~</li></ul><p>ç»§ç»­å¾€ä¸‹çœ‹çš„å°ä¼™ä¼´å¯ä»¥è·Ÿç€ä¸€æ­¥ä¸€æ­¥äº†è§£é‡Œé¢çš„å®ç°é€»è¾‘ï¼Œå…ˆä¾‹è¡Œäº¤ä»£ä¸‹ç¯å¢ƒç‰ˆæœ¬:<br><strong>create-react-app v1.1.4</strong><br>macOS 10.13.4<br>node v8.9.4<br>npm 6.0.0<br>yarn 1.6.0<br>vsCode 1.22.2</p><h1 id="é¡¹ç›®åˆå§‹åŒ–"><a href="#é¡¹ç›®åˆå§‹åŒ–" class="headerlink" title="é¡¹ç›®åˆå§‹åŒ–"></a><a href="#é¡¹ç›®åˆå§‹åŒ–">é¡¹ç›®åˆå§‹åŒ–</a></h1><p>å…ˆä¸Šgithub æ‹‰é¡¹ç›®ä»£ç ï¼Œæ‹‰ä¸‹æ¥ä¹‹ååˆ‡æ¢åˆ°æŒ‡å®šçš„ <code>tag</code></p><ul><li><code>git clone https://github.com/facebook/create-react-app.git</code></li><li><code>git checkout v1.1.4</code></li><li><code>yarn</code> //å¦‚æœä¸éœ€è¦æ–­ç‚¹è°ƒè¯•ï¼Œè¿™ä¸€æ­¥å¯ä»¥è·³è¿‡</li></ul><blockquote><p>è¿™é‡Œå¯èƒ½yarn ç‰ˆæœ¬å¤ªä½çš„è¯ï¼Œä¼šæŠ¥ä¸€ç³»åˆ—é”™è¯¯ï¼Œä¹‹å‰ç”¨çš„æ˜¯ 0.xç‰ˆæœ¬çš„ï¼Œå‡çº§åˆ°1.xå°±æ²¡é—®é¢˜äº†</p></blockquote><p>ä¸‹é¢æˆ‘ä»¬ç”¨ <code>root</code> ä»£æ›¿é¡¹ç›®çš„æ ¹ç›®å½•ï¼Œæ–¹ä¾¿ç†è§£</p><p>é¦–å…ˆæˆ‘ä»¬æ‰“å¼€é¡¹ç›®èƒ½çœ‹åˆ°ä¸€å †çš„é…ç½®æ–‡ä»¶å’Œä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼šeslinté…ç½®æ–‡ä»¶ã€traviséƒ¨ç½²é…ç½®ã€yarné…ç½®ã€æ›´æ–°æ—¥å¿—ã€å¼€æºå£°æ˜ç­‰ç­‰â€¦è¿™äº›æˆ‘ä»¬å…¨éƒ½å¯ä»¥ä¸ç”¨å»çœ‹ï¼Œé‚£æˆ‘ä»¬è¦çœ‹çš„æ ¸å¿ƒæºç æ”¾åœ¨å“ªé‡Œå‘¢<br><img src="./create-react-app-file.png" alt></p><p>åˆ’é‡ç‚¹: <strong>å¦‚æœé¡¹ç›®ä¸çŸ¥é“ä»å“ªé‡Œå…¥æ‰‹çš„è¯ï¼Œé¦–å…ˆä»package.jsonæ–‡ä»¶å¼€å§‹</strong><br><figure class="highlight json"><figcaption><span>root/package.json</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"private"</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">"workspaces"</span>: [</span><br><span class="line">    <span class="string">"packages/*"</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"start"</span>: <span class="string">"cd packages/react-scripts &amp;&amp; node scripts/start.js"</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"devDependencies"</span>: &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"lint-staged"</span>: &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ‰“å¼€æ ¹ç›®å½• package.json æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é‡Œé¢å¾ˆç®€æ´~ npmè„šæœ¬å‘½ä»¤ï¼Œå¼€å‘ä¾èµ–ï¼Œè¿˜æœ‰æäº¤é’©å­ï¼Œå‰©ä¸‹çš„å°±æ˜¯æˆ‘ä»¬è¦å…³æ³¨çš„ <strong>workspaces</strong> è¿™é‡ŒæŒ‡å‘çš„æ˜¯ <code>&quot;packages/*&quot;</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬ç°åœ¨çš„é‡ç‚¹å°±æ”¾åœ¨ <strong>packages</strong> æ–‡ä»¶å¤¹</p><p>packages æ–‡ä»¶å¤¹ä¸‹é¢ä¹Ÿæœ‰å‡ ä¸ªæ–‡ä»¶å¤¹ï¼Œè¿™é‡Œæ–‡ä»¶å¤¹å‘½åå¾ˆè§„èŒƒï¼Œä¸€çœ‹å°±çŸ¥é“åŠŸèƒ½åˆ’åˆ†ï¼Œæ‰€ä»¥è¿˜æ˜¯è€å¥—è·¯ç›´æ¥çœ‹ <code>root/packages/create-react-app/package.json</code></p><figure class="highlight json"><figcaption><span>packages/create-react-app/package.json</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"create-react-app"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"1.5.2"</span>,</span><br><span class="line">  <span class="attr">"license"</span>: <span class="string">"MIT"</span>,</span><br><span class="line">  <span class="attr">"engines"</span>: &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"bugs"</span>: &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"files"</span>: [</span><br><span class="line">    <span class="string">"index.js"</span>,</span><br><span class="line">    <span class="string">"createReactApp.js"</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">"bin"</span>: &#123;</span><br><span class="line">    <span class="attr">"create-react-app"</span>: <span class="string">"./index.js"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"dependencies"</span>: &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™æ²¡æœ‰ <code>workspaces</code>é¡¹ï¼Œ æˆ‘ä»¬å¯ä»¥çœ‹ <code>bin</code> binçš„åŠŸèƒ½æ˜¯æŠŠå‘½ä»¤å¯¹åº”åˆ°å¯æ‰§è¡Œçš„æ–‡ä»¶ï¼Œå…·ä½“çš„ä»‹ç»å¯ä»¥çœ‹<a href="https://docs.npmjs.com/files/package.json#bin" target="_blank" rel="noopener">package Document</a></p><p>è¿™é‡Œå¯ä»¥ç®€å•ç†è§£æˆï¼Œå½“æˆ‘ä»¬å…¨å±€å®‰è£…äº† <code>create-react-app</code> ä¹‹åï¼Œè·‘ <code>create-react-app my-react-app</code> ç³»ç»Ÿä¼šå¸®æˆ‘ä»¬å»è·‘ <code>packages/create-react-app/index.js my-react-app</code></p><p>ç»ˆäºæ‰¾åˆ°æºç çš„å…¥å£äº†ï¼Œå¯¹äºç®€å•çš„æºç æˆ‘ä»¬å¯ä»¥ç›´æ¥çœ‹ï¼Œå¯¹äºæ¯”è¾ƒå¤æ‚çš„ æˆ–è€…æƒ³è¦çœ‹åˆ°æ‰§è¡Œåˆ°æ¯ä¸€è¡Œä»£ç æ—¶é‚£äº›å˜é‡æ˜¯ä»€ä¹ˆå€¼çš„æƒ…å†µï¼Œæˆ‘ä»¬å°±è¦ç”¨IDEæˆ–å…¶ä»–å·¥å…·æ¥æ–­ç‚¹è°ƒè¯•ä»£ç äº†ã€‚</p><h1 id="é…ç½®æ–­ç‚¹è°ƒè¯•"><a href="#é…ç½®æ–­ç‚¹è°ƒè¯•" class="headerlink" title="é…ç½®æ–­ç‚¹è°ƒè¯•"></a><a href="#é…ç½®æ–­ç‚¹è°ƒè¯•">é…ç½®æ–­ç‚¹è°ƒè¯•</a></h1><p>å¯¹äºvscodeæˆ–nodeè°ƒè¯• æ¯”è¾ƒç†Ÿæ‚‰çš„å¯ä»¥è·³è¿‡ç›´æ¥çœ‹ <a href="#å¼€å§‹æ–­ç‚¹é˜…è¯»æºç ">å¼€å§‹æ–­ç‚¹é˜…è¯»æºç </a></p><h2 id="vscode-debug"><a href="#vscode-debug" class="headerlink" title="vscode debug"></a><a href="#vscode_debug">vscode debug</a></h2><p>å¯¹äºvscodeç”¨æˆ·æ¥è¯´ï¼Œè°ƒè¯•éå¸¸ç®€å•ï¼Œç‚¹å‡»ä¾§è¾¹æ çš„å°ç”²è™«å›¾æ ‡ï¼Œç‚¹å‡»è®¾ç½®<br>ç„¶åç›´æ¥ä¿®æ”¹ â€œprogramâ€çš„å€¼ï¼Œä¿®æ”¹å®Œç‚¹å‡»å·¦ä¸Šè§’çš„ç»¿è‰²ç®­å¤´å°±å¯ä»¥è·‘èµ·æ¥äº†ï¼Œå¦‚æœè¦åœ¨æŸä¸€å¤„æ–­ç‚¹ï¼Œæ¯”å¦‚ <code>create-react-app/index.js</code> line39 æ–­ç‚¹ï¼Œç›´æ¥åœ¨è¡Œå·çš„å·¦è¾¹ç‚¹ä¸€ä¸‹é¼ æ ‡å°±å¯ä»¥äº†<br><img src="./debug1.png" alt><br><img src="./debug2.png" alt><br><figure class="highlight json"><figcaption><span>launch.json é…ç½®</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"0.2.0"</span>,</span><br><span class="line">  <span class="attr">"configurations"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"type"</span>: <span class="string">"node"</span>,</span><br><span class="line">      <span class="attr">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">      <span class="attr">"name"</span>: <span class="string">"å¯åŠ¨ç¨‹åº"</span>,</span><br><span class="line">      <span class="attr">"program"</span>: <span class="string">"$&#123;workspaceFolder&#125;/packages/create-react-app/index.js"</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="node-è°ƒè¯•"><a href="#node-è°ƒè¯•" class="headerlink" title="node è°ƒè¯•"></a>node è°ƒè¯•</h2><p>å¦‚æœå¹³æ—¶æ²¡æœ‰ç”¨vscodeå¼€å‘æˆ–è€…ä¹ æƒ¯chrome-devtoolçš„ï¼Œå¯ä»¥ç›´æ¥ç”¨nodeå‘½ä»¤è·‘ï¼Œç„¶ååœ¨chromeé‡Œé¢è°ƒè¯•<br>é¦–å…ˆä¿è¯nodeçš„ç‰ˆæœ¬çš„ 6 ä»¥ä¸Š<br>ç„¶ååœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œ <code>node --inspect-brk packages/create-react-app/index.js</code><br>åœ¨chromeåœ°å€æ è¾“å…¥ chrome://inspect/#devices ç„¶åå°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è¦è°ƒè¯•çš„è„šæœ¬äº†<br>å…³äºnode chrome-devtool è°ƒè¯•è¯¦ç»†å¯ä»¥çœ‹è¿™é‡Œ <a href="https://medium.com/@paul_irish/debugging-node-js-nightlies-with-chrome-devtools-7c4a1b95ae27" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p><img src="./debug3.png" alt title="ç»ˆç«¯å¯åŠ¨nodeè°ƒè¯•"><br><img src="./debug4.png" alt><br><img src="./debug5.png" alt><br>(psï¼šè¿™é‡Œå¯ä»¥çœ‹å‡ºæ¥nodeåœ¨æ¨¡å—åŒ–çš„å®ç°æ˜¯é€šè¿‡ç”¨ä¸€ä¸ªå‡½æ•°åŒ…è£¹èµ·æ¥ï¼Œç„¶åæŠŠ exports, requestdç­‰å‚æ•°ä¼ è¿›æ¥ä»¥ä¾›ä½¿ç”¨)</p><h1 id="å¼€å§‹æ–­ç‚¹é˜…è¯»æºç "><a href="#å¼€å§‹æ–­ç‚¹é˜…è¯»æºç " class="headerlink" title="å¼€å§‹æ–­ç‚¹é˜…è¯»æºç "></a><a href="#å¼€å§‹æ–­ç‚¹é˜…è¯»æºç ">å¼€å§‹æ–­ç‚¹é˜…è¯»æºç </a></h1><h2 id="packages-create-react-app-index-js-githubæ–‡ä»¶ä¼ é€é—¨"><a href="#packages-create-react-app-index-js-githubæ–‡ä»¶ä¼ é€é—¨" class="headerlink" title="packages/create-react-app/index.js githubæ–‡ä»¶ä¼ é€é—¨"></a><a href="#packages/create-react-app/index.js">packages/create-react-app/index.js</a> <a href="https://github.com/facebook/create-react-app/blob/v1.1.4/packages/create-react-app/index.js" target="_blank" rel="noopener">githubæ–‡ä»¶ä¼ é€é—¨</a></h2><p><img src="./create-react-app_index.png" alt title="packages/creat-react-app/index.js"><br>è¿™ä¸ªæ–‡ä»¶ååˆ†ç®€å•ï¼Œåªæ˜¯åšä¸ºä¸€ä¸ªå…¥å£æ–‡ä»¶åˆ¤æ–­ä¸€ä¸‹ nodeç‰ˆæœ¬ï¼Œå°äº 4.xçš„æç¤ºå¹¶ç»ˆæ­¢ç¨‹åºï¼Œ å¦‚æœæ­£å¸¸åˆ™åŠ è½½ <code>./createReactApp</code> è¿™ä¸ªæ–‡ä»¶ï¼Œä¸»è¦çš„é€»è¾‘åœ¨è¯¥æ–‡ä»¶å®ç°ã€‚</p><h2 id="packages-create-react-app-createReactApp-js-githubæ–‡ä»¶ä¼ é€é—¨"><a href="#packages-create-react-app-createReactApp-js-githubæ–‡ä»¶ä¼ é€é—¨" class="headerlink" title="packages/create-react-app/createReactApp.js githubæ–‡ä»¶ä¼ é€é—¨"></a><a href="#packages/create-react-app/createReactApp.js">packages/create-react-app/createReactApp.js</a> <a href="https://github.com/facebook/create-react-app/blob/v1.1.4/packages/create-react-app/createReactApp.js" target="_blank" rel="noopener">githubæ–‡ä»¶ä¼ é€é—¨</a></h2><p>é¡ºç€æˆ‘ä»¬çš„æ–­ç‚¹è¿›å…¥åˆ° <code>createReactApp.js</code> è¿™ä¸ªæ–‡ä»¶æœ‰750è¡Œä¹ä¸€çœ‹å¾ˆå¤šï¼Œæ–‡ä»¶å¤´åˆæœ‰åå‡ ä¸ªä¾èµ–å¼•å…¥ï¼Œä½†æ˜¯ä¸è¦è¢«å“åˆ°ï¼Œä¸€èˆ¬è¿™ç§é«˜è´¨é‡çš„å¼€æºé¡¹ç›®ï¼Œé‡Œé¢æœ‰ä¸€å¤§åŠæ˜¯æ³¨é‡Šå’Œé”™è¯¯å‹å¥½ä¿¡æ¯ã€‚</p><blockquote><p>è¿™é‡Œå»ºè®®æ²¡æœ‰æ‰“æ–­ç‚¹è°ƒè¯•çš„å°ä¼™ä¼´è¯•ä¸€ä¸‹æŠŠä»£ç å¤åˆ¶åˆ°å¦ä¸€ä¸ªjsæ–‡ä»¶ï¼Œç„¶åå…ˆä¸çœ‹å‰é¢çš„ä¾èµ–ï¼Œä¸‹é¢ç”¨åˆ°å†å» npmæŸ¥ä¸€ä¸‹æ˜¯ä»€ä¹ˆä½œç”¨çš„ã€‚ä¸è¦è¢«ç»•è¿›å»çœ‹äº†ä¸€ä¸ªåˆä¸€ä¸ªçš„ä¾èµ–ï¼Œæ ¸å¿ƒä»£ç åè€Œæ²¡æœ‰çœ‹åˆ°ã€‚ ç„¶åçœ‹ä¸€éƒ¨åˆ†ä¹‹åå°±æŠŠé‚£éƒ¨åˆ†çš„ä»£ç åˆ æ‰ï¼Œæ¯”å¦‚æˆ‘çœ‹äº†200è¡Œï¼Œå°±æŠŠå‰é¢200è¡Œåˆ äº†ï¼Œè¿™æ ·å‰©ä¸‹500è¡Œçœ‹ç€å°±æ²¡æœ‰é‚£ä¹ˆå¿ƒè™šäº†ã€‚å½“ç„¶è¿˜æ˜¯å»ºè®®ç”¨æ–­ç‚¹è°ƒè¯•é˜…è¯»ï¼Œé€»è¾‘ä¼šæ¯”è¾ƒæ¸…æ™°ã€‚</p></blockquote><p>é¦–å…ˆæ–‡ä»¶å¤´éƒ¨è¿™ä¸€å¤§ä¸²çš„ä¾èµ–ï¼Œæˆ‘ä»¬æš‚æ—¶ä¸å»å…³æ³¨ä»–ä»¬ï¼Œç­‰åé¢ç”¨åˆ°å†å»æŸ¥<br><figure class="highlight javascript"><figcaption><span>createReactApp.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> validateProjectName = <span class="built_in">require</span>(<span class="string">'validate-npm-package-name'</span>);</span><br><span class="line"><span class="keyword">const</span> chalk = <span class="built_in">require</span>(<span class="string">'chalk'</span>);</span><br><span class="line"><span class="keyword">const</span> commander = <span class="built_in">require</span>(<span class="string">'commander'</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs-extra'</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> execSync = <span class="built_in">require</span>(<span class="string">'child_process'</span>).execSync;</span><br><span class="line"><span class="keyword">const</span> spawn = <span class="built_in">require</span>(<span class="string">'cross-spawn'</span>);</span><br><span class="line"><span class="keyword">const</span> semver = <span class="built_in">require</span>(<span class="string">'semver'</span>);</span><br><span class="line"><span class="keyword">const</span> dns = <span class="built_in">require</span>(<span class="string">'dns'</span>);</span><br><span class="line"><span class="keyword">const</span> tmp = <span class="built_in">require</span>(<span class="string">'tmp'</span>);</span><br><span class="line"><span class="keyword">const</span> unpack = <span class="built_in">require</span>(<span class="string">'tar-pack'</span>).unpack;</span><br><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>);</span><br><span class="line"><span class="keyword">const</span> hyperquest = <span class="built_in">require</span>(<span class="string">'hyperquest'</span>);</span><br><span class="line"><span class="keyword">const</span> envinfo = <span class="built_in">require</span>(<span class="string">'envinfo'</span>);</span><br></pre></td></tr></table></figure></p><h3 id="commander-å‘½ä»¤è¡Œå¤„ç†ç¨‹åº"><a href="#commander-å‘½ä»¤è¡Œå¤„ç†ç¨‹åº" class="headerlink" title="commander å‘½ä»¤è¡Œå¤„ç†ç¨‹åº"></a><a href="#commander">commander å‘½ä»¤è¡Œå¤„ç†ç¨‹åº</a></h3><p>æ¥ä¸‹æ¥é¡ºç€æˆ‘ä»¬çš„æ–­ç‚¹ï¼Œç¬¬ä¸€è¡Œè¢«æ‰§è¡Œçš„ä»£ç æ˜¯ <a href="https://github.com/facebook/create-react-app/blob/v1.1.4/packages/create-react-app/createReactApp.js#L56" target="_blank" rel="noopener">L56</a></p><figure class="highlight javascript"><figcaption><span>createReactApp.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> program = <span class="keyword">new</span> commander.Command(packageJson.name)</span><br><span class="line">  .version(packageJson.version) <span class="comment">// create-react-app -v æ—¶è¾“å‡º $&#123;packageJson.version&#125;</span></span><br><span class="line">  .arguments(<span class="string">'&lt;project-directory&gt;'</span>) <span class="comment">// è¿™é‡Œç”¨&lt;&gt; åŒ…ç€project-directory è¡¨ç¤º project-directoryä¸ºå¿…å¡«é¡¹</span></span><br><span class="line">  .usage(<span class="string">`<span class="subst">$&#123;chalk.green(<span class="string">'&lt;project-directory&gt;'</span>)&#125;</span> [options]`</span>) <span class="comment">// ç”¨ç»¿è‰²å­—ä½“è¾“å‡º &lt;project-directory&gt;</span></span><br><span class="line">  .action(<span class="function"><span class="params">name</span> =&gt;</span> &#123;</span><br><span class="line">    projectName = name;</span><br><span class="line">  &#125;) <span class="comment">// è·å–ç”¨æˆ·ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸º projectName **ä¸‹é¢å°±ä¼šç”¨åˆ°**</span></span><br><span class="line">  .option(<span class="string">'--verbose'</span>, <span class="string">'print additional logs'</span>) <span class="comment">// optionç”¨äºé…ç½®`create-react-app -[option]`çš„é€‰é¡¹ï¼Œæ¯”å¦‚è¿™é‡Œå¦‚æœç”¨æˆ·å‚æ•°å¸¦äº† --verboseï¼Œ ä¼šè‡ªåŠ¨è®¾ç½®program.verbose = true;</span></span><br><span class="line">  .option(<span class="string">'--info'</span>, <span class="string">'print environment debug info'</span>) <span class="comment">// åé¢ä¼šç”¨åˆ°è¿™ä¸ªå‚æ•°ï¼Œç”¨äºæ‰“å°å‡ºç¯å¢ƒè°ƒè¯•çš„ç‰ˆæœ¬ä¿¡æ¯</span></span><br><span class="line">  .option(</span><br><span class="line">    <span class="string">'--scripts-version &lt;alternative-package&gt;'</span>,</span><br><span class="line">    <span class="string">'use a non-standard version of react-scripts'</span></span><br><span class="line">  )</span><br><span class="line">  .option(<span class="string">'--use-npm'</span>)</span><br><span class="line">  .allowUnknownOption()</span><br><span class="line">   <span class="comment">// on('option', cb) è¾“å…¥ create-react-app --help è‡ªåŠ¨æ‰§è¡Œåé¢çš„æ“ä½œè¾“å‡ºå¸®åŠ©</span></span><br><span class="line">  .on(<span class="string">'--help'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`    Only <span class="subst">$&#123;chalk.green(<span class="string">'&lt;project-directory&gt;'</span>)&#125;</span> is required.`</span>);</span><br><span class="line">    <span class="built_in">console</span>.log();</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">`    A custom <span class="subst">$&#123;chalk.cyan(<span class="string">'--scripts-version'</span>)&#125;</span> can be one of:`</span></span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`      - a specific npm version: <span class="subst">$&#123;chalk.green(<span class="string">'0.8.2'</span>)&#125;</span>`</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">`      - a custom fork published on npm: <span class="subst">$&#123;chalk.green(</span></span></span><br><span class="line"><span class="string"><span class="subst">        <span class="string">'my-react-scripts'</span></span></span></span><br><span class="line"><span class="string"><span class="subst">      )&#125;</span>`</span></span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">`      - a .tgz archive: <span class="subst">$&#123;chalk.green(</span></span></span><br><span class="line"><span class="string"><span class="subst">        <span class="string">'https://mysite.com/my-react-scripts-0.8.2.tgz'</span></span></span></span><br><span class="line"><span class="string"><span class="subst">      )&#125;</span>`</span></span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">`      - a .tar.gz archive: <span class="subst">$&#123;chalk.green(</span></span></span><br><span class="line"><span class="string"><span class="subst">        <span class="string">'https://mysite.com/my-react-scripts-0.8.2.tar.gz'</span></span></span></span><br><span class="line"><span class="string"><span class="subst">      )&#125;</span>`</span></span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">`    It is not needed unless you specifically want to use a fork.`</span></span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">console</span>.log();</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">`    If you have any problems, do not hesitate to file an issue:`</span></span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">`      <span class="subst">$&#123;chalk.cyan(</span></span></span><br><span class="line"><span class="string"><span class="subst">        <span class="string">'https://github.com/facebookincubator/create-react-app/issues/new'</span></span></span></span><br><span class="line"><span class="string"><span class="subst">      )&#125;</span>`</span></span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">console</span>.log();</span><br><span class="line">  &#125;)</span><br><span class="line">  .parse(process.argv); <span class="comment">// è§£æä¼ å…¥çš„å‚æ•° å¯ä»¥ä¸ç”¨ç†ä¼š</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œç”¨åˆ°äº†ä¸€ä¸ª commander çš„ä¾èµ–ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å»npm æœä¸€ä¸‹ä»–çš„ä½œç”¨äº†ã€‚å®˜ç½‘çš„æè¿°æ˜¯ <code>The complete solution for node.js command-line interfaces, inspired by Ruby&#39;s commander.API documentation</code> ç¿»è¯‘è¿‡æ¥æ˜¯ node.js å‘½ä»¤è¡Œæ¥å£çš„å®Œæ•´è§£å†³æ–¹æ¡ˆï¼ŒåŸºæœ¬çš„åŠŸèƒ½çœ‹æ³¨é‡Šå³å¯ï¼Œå¤§æ¦‚äº†è§£ä¸€ä¸‹æœ‰è¿™ä¹ˆä¸€ä¸ªä¸œè¥¿ï¼Œåé¢è‡ªå·±è¦åšçš„æ—¶å€™æœ‰é—¨è·¯å³å¯ã€‚<a href="https://github.com/tj/commander.js" target="_blank" rel="noopener">githubä¼ é€é—¨</a>ã€‚</p><h3 id="åˆ¤æ–­æ˜¯å¦æœ‰ä¼ projectName"><a href="#åˆ¤æ–­æ˜¯å¦æœ‰ä¼ projectName" class="headerlink" title="åˆ¤æ–­æ˜¯å¦æœ‰ä¼ projectName"></a><a href="#projectName">åˆ¤æ–­æ˜¯å¦æœ‰ä¼ projectName</a></h3><figure class="highlight javascript"><figcaption><span>createReactApp.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> projectName === <span class="string">'undefined'</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (program.info) &#123; <span class="comment">// å¦‚æœå‘½ä»¤è¡Œæœ‰å¸¦ --info å‚æ•°ï¼Œè¾“å‡º react,react-dom,react-scriptsç‰ˆæœ¬ ç„¶åé€€å‡º</span></span><br><span class="line">    envinfo.print(&#123;</span><br><span class="line">      packages: [<span class="string">'react'</span>, <span class="string">'react-dom'</span>, <span class="string">'react-scripts'</span>],</span><br><span class="line">      noNativeIDE: <span class="literal">true</span>,</span><br><span class="line">      duplicates: <span class="literal">true</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    process.exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">  è¿™é‡Œè¾“å‡ºäº†ä¸€äº›é”™è¯¯æç¤ºä¿¡æ¯</span><br><span class="line">  ...</span><br><span class="line">  process.exit(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾€ä¸‹çœ‹æ˜¯ä¸€ä¸ªåˆ¤æ–­å¿…é¡»ä¼ å…¥çš„å‚æ•° <code>projectName</code>ï¼Œè¿™é‡Œçš„ <code>projectName</code> å°±æ˜¯ä¸Šé¢é€šè¿‡ <code>.action(name =&gt; { projectName = name;})</code> è·å–çš„ã€‚<br>åˆ¤æ–­å¦‚æœæ²¡æœ‰è¾“å…¥çš„è¯ï¼Œç›´æ¥åšä¸€äº›ä¿¡æ¯æç¤ºï¼Œç„¶åç»ˆæ­¢ç¨‹åºã€‚<br>è¿™é‡Œå‚æ•°å¦‚æœä¼ å…¥äº† <code>--info</code> çš„è¯ï¼Œ ä¼šæ‰§è¡Œåˆ°<code>envinfo.print</code>ã€‚ æ—¥å¸¸npm æœä¸€ä¸‹ envinfo è¿™æ˜¯ä¸€ä¸ªç”¨æ¥è¾“å‡ºå½“å‰ç¯å¢ƒç³»ç»Ÿçš„ä¸€äº›ç³»ç»Ÿä¿¡æ¯ï¼Œæ¯”å¦‚ç³»ç»Ÿç‰ˆæœ¬ï¼Œnpmç­‰ç­‰è¿˜æœ‰react,react-dom,react-scriptsè¿™äº›åŒ…çš„ç‰ˆæœ¬ï¼Œéå¸¸å¥½ç”¨ã€‚è¿™ä¸ªåŒ…ç°åœ¨çš„ç‰ˆæœ¬å’Œcreate-react-appçš„ç‰ˆæœ¬å·®å¼‚æ¯”è¾ƒå¤§ï¼Œä½†æ˜¯ä¸å½±å“æˆ‘ä»¬ä½¿ç”¨~ <a href="https://www.npmjs.com/package/envinfo" target="_blank" rel="noopener">envinfo npmä¼ é€é—¨</a></p><p>å¦‚æœæ˜¯ç”¨æˆ‘ä¸Šé¢æä¾›çš„ vscode debugé…ç½®çš„è¯ï¼Œåˆ°è¿™é‡Œç¨‹åºåº”è¯¥å°±è¿è¡Œç»“æŸäº†ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨å¯åŠ¨è°ƒè¯•æœåŠ¡çš„æ—¶å€™ï¼Œæ²¡æœ‰ç»™è„šæœ¬ä¼ å…¥å‚æ•°ä½œä¸º <code>projectName</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹ vscode <code>launch.json</code> åŠ å¤šä¸ªå­—æ®µ <code>&quot;args&quot;: [&quot;test-create-react-app&quot;]</code> <a href="#vscode_debug">å¿˜è®°æ€ä¹ˆè®¾ç½®çš„ç‚¹è¿™é‡Œ</a>~ ä¼ å…¥äº† <code>projectName</code> å‚æ•° ç„¶åé‡æ–°å¯åŠ¨è°ƒè¯•æœåŠ¡<br><figure class="highlight json"><figcaption><span>åŠ å…¥projectName åçš„ launch.json</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"0.2.0"</span>,</span><br><span class="line">  <span class="attr">"configurations"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"type"</span>: <span class="string">"node"</span>,</span><br><span class="line">      <span class="attr">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">      <span class="attr">"name"</span>: <span class="string">"å¯åŠ¨ç¨‹åº"</span>,</span><br><span class="line">      <span class="attr">"program"</span>: <span class="string">"$&#123;workspaceFolder&#125;/packages/create-react-app/index.js"</span>,</span><br><span class="line">      <span class="attr">"args"</span>: [</span><br><span class="line">        <span class="string">"test-create-react-app"</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="éšè—çš„-commander-å‚æ•°"><a href="#éšè—çš„-commander-å‚æ•°" class="headerlink" title="éšè—çš„ commander å‚æ•°"></a><a href="#dev_commander">éšè—çš„ commander å‚æ•°</a></h3><p>æ¥ç€èµ°åˆ¤æ–­å®Œ projectName ä¹‹åï¼Œæ¥åˆ° <a href="https://github.com/facebook/create-react-app/blob/v1.1.4/packages/create-react-app/createReactApp.js#L140" target="_blank" rel="noopener">Line140</a></p><figure class="highlight javascript"><figcaption><span>createReactApp.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> hiddenProgram = <span class="keyword">new</span> commander.Command()</span><br><span class="line">  .option(</span><br><span class="line">    <span class="string">'--internal-testing-template &lt;path-to-template&gt;'</span>,</span><br><span class="line">    <span class="string">'(internal usage only, DO NOT RELY ON THIS) '</span> +</span><br><span class="line">      <span class="string">'use a non-standard application template'</span></span><br><span class="line">  )</span><br><span class="line">  .parse(process.argv);</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ˜¯ä¸€ä¸ªéšè—çš„è°ƒè¯•é€‰é¡¹ï¼Œç»™å‡ºä¸€ä¸ªå‚æ•°ç”¨äºä¼ å…¥æ¨¡ç‰ˆè·¯å¾„ï¼Œç»™å¼€å‘äººå‘˜è°ƒè¯•ç”¨çš„â€¦æ²¡äº‹ä¸æŠ˜è…¾ä»–</p><h3 id="createApp"><a href="#createApp" class="headerlink" title="createApp"></a><a href="#createApp">createApp</a></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">createApp(</span><br><span class="line">  projectName,</span><br><span class="line">  program.verbose,</span><br><span class="line">  program.scriptsVersion,</span><br><span class="line">  program.useNpm,</span><br><span class="line">  hiddenProgram.internalTestingTemplate</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>æ¥ç€å¾€ä¸‹å°±æ˜¯è°ƒç”¨äº† <code>createApp</code>, ä¼ å…¥çš„å‚æ•°å¯¹äºçš„å«ä¹‰æ˜¯ï¼š<code>é¡¹ç›®å</code>ï¼Œ<code>æ˜¯å¦è¾“å‡ºé¢å¤–ä¿¡æ¯</code>ï¼Œ<code>ä¼ å…¥çš„è„šæœ¬ç‰ˆæœ¬</code>ï¼Œ<code>æ˜¯å¦ä½¿ç”¨npm</code>ï¼Œ<code>è°ƒè¯•çš„æ¨¡æ¿è·¯å¾„</code>ã€‚æ¥ä¸‹æ¥å•æ­¥è¿›å…¥å‡½æ•°ä½“çœ‹ä¸€ä¸‹ <code>createApp</code> åˆ°åº•åšäº†ä»€ä¹ˆäº‹æƒ…ã€‚</p><figure class="highlight javascript"><figcaption><span>createReactApp.js createApp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createApp</span>(<span class="params">name, verbose, version, useNpm, template</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> root = path.resolve(name);</span><br><span class="line">  <span class="keyword">const</span> appName = path.basename(root);</span><br><span class="line"></span><br><span class="line">  checkAppName(appName); <span class="comment">// æ£€æŸ¥ä¼ å…¥çš„é¡¹ç›®ååˆæ³•æ€§</span></span><br><span class="line">  fs.ensureDirSync(name); <span class="comment">// è¿™é‡Œçš„fsç”¨çš„æ˜¯ fs-extraï¼Œ å¯¹nodeçš„fsæä¾›ä¸€äº›æ‰©å±•æ–¹æ³•</span></span><br><span class="line">  <span class="comment">// åˆ¤æ–­æ–°å»ºè¿™ä¸ªæ–‡ä»¶å¤¹æ˜¯å¦æ˜¯å®‰å…¨çš„ ä¸å®‰å…¨ç›´æ¥é€€å‡º</span></span><br><span class="line">  <span class="keyword">if</span> (!isSafeToCreateProjectIn(root, name)) &#123;</span><br><span class="line">    process.exit(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åœ¨æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸‹å†™å…¥ package.json æ–‡ä»¶</span></span><br><span class="line">  <span class="keyword">const</span> packageJson = &#123;</span><br><span class="line">    name: appName,</span><br><span class="line">    version: <span class="string">'0.1.0'</span>,</span><br><span class="line">    private: <span class="literal">true</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">  fs.writeFileSync(</span><br><span class="line">    path.join(root, <span class="string">'package.json'</span>),</span><br><span class="line">    <span class="built_in">JSON</span>.stringify(packageJson, <span class="literal">null</span>, <span class="number">2</span>)</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> useYarn = useNpm ? <span class="literal">false</span> : shouldUseYarn();</span><br><span class="line">  <span class="keyword">const</span> originalDirectory = process.cwd();</span><br><span class="line">  process.chdir(root);</span><br><span class="line">  <span class="comment">// å¦‚æœæ˜¯ä½¿ç”¨npmï¼Œæ£€æµ‹npmæ˜¯å¦åœ¨æ­£ç¡®ç›®å½•ä¸‹æ‰§è¡Œ</span></span><br><span class="line">  <span class="keyword">if</span> (!useYarn &amp;&amp; !checkThatNpmCanReadCwd()) &#123;</span><br><span class="line">    process.exit(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ¤æ–­nodeç¯å¢ƒï¼Œè¾“å‡ºä¸€äº›æç¤ºä¿¡æ¯, å¹¶é‡‡ç”¨æ—§ç‰ˆæœ¬çš„ react-scripts</span></span><br><span class="line">  <span class="keyword">if</span> (!semver.satisfies(process.version, <span class="string">'&gt;=6.0.0'</span>)) &#123;</span><br><span class="line">    <span class="comment">// è¾“å‡ºä¸€äº›æç¤ºæ›´æ–°ä¿¡æ¯</span></span><br><span class="line">    version = <span class="string">'react-scripts@0.9.x'</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!useYarn) &#123;</span><br><span class="line">    <span class="comment">// æ£€æµ‹npmç‰ˆæœ¬ åˆ¤æ–­npmç‰ˆæœ¬ï¼Œå¦‚æœä½äº3.xï¼Œä½¿ç”¨æ—§ç‰ˆçš„ react-scriptsæ—§ç‰ˆæœ¬</span></span><br><span class="line">    <span class="keyword">const</span> npmInfo = checkNpmVersion();</span><br><span class="line">    <span class="keyword">if</span> (!npmInfo.hasMinNpm) &#123;</span><br><span class="line">      version = <span class="string">'react-scripts@0.9.x'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ¤æ–­ç»“æŸä¹‹åï¼Œè·‘run æ–¹æ³•</span></span><br><span class="line">  <span class="comment">// ä¼ å…¥ é¡¹ç›®è·¯å¾„ï¼Œé¡¹ç›®åï¼Œ reactScriptsç‰ˆæœ¬ï¼Œ æ˜¯å¦è¾“å…¥é¢å¤–ä¿¡æ¯ï¼Œ è¿è¡Œçš„è·¯å¾„ï¼Œ æ¨¡æ¿ï¼ˆå¼€å‘è°ƒè¯•ç”¨çš„ï¼‰, æ˜¯å¦ä½¿ç”¨yarn</span></span><br><span class="line">  run(root, appName, version, verbose, originalDirectory, template, useYarn);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://github.com/facebook/create-react-app/blob/v1.1.4/packages/create-react-app/createReactApp.js#L156" target="_blank" rel="noopener">createReactApp.js createApp ä¼ é€é—¨</a><br>è¿™é‡Œæˆ‘ç²¾ç®€äº†ä¸€äº›ä¸œè¥¿ï¼Œåˆ é™¤ä¸€äº›è¾“å‡ºä¿¡æ¯ï¼ŒåŠ äº†ä¸€äº›æ³¨é‡Š<br><code>createApp</code> ä¸»è¦åšçš„äº‹æƒ…å°±æ˜¯åšä¸€äº›å®‰å…¨åˆ¤æ–­æ¯”å¦‚ï¼šæ£€æŸ¥é¡¹ç›®åæ˜¯å¦åˆæ³•ï¼Œæ£€æŸ¥æ–°å»ºçš„è¯æ˜¯å¦å®‰å…¨ï¼Œæ£€æŸ¥npmç‰ˆæœ¬ï¼Œå¤„ç†<code>react-script</code>çš„ç‰ˆæœ¬å…¼å®¹<br>å…·ä½“çš„æ‰§è¡Œé€»è¾‘å†™åœ¨æ³¨é‡Šé‡Œäº†ï¼Œä¸€ç³»åˆ—çš„æ£€æŸ¥å¤„ç†ä¹‹åï¼Œè°ƒç”¨ run æ–¹æ³•ï¼Œä¼ å…¥å‚æ•°ä¸º <code>é¡¹ç›®è·¯å¾„</code>ï¼Œ<code>é¡¹ç›®å</code>ï¼Œ <code>reactScriptsç‰ˆæœ¬</code>ï¼Œ <code>æ˜¯å¦è¾“å…¥é¢å¤–ä¿¡æ¯</code>ï¼Œ <code>è¿è¡Œçš„è·¯å¾„</code>ï¼Œ <code>æ¨¡æ¿ï¼ˆå¼€å‘è°ƒè¯•ç”¨çš„ï¼‰</code>, <code>æ˜¯å¦ä½¿ç”¨yarn</code>ã€‚<br>äº†è§£å¤§æ¦‚çš„æµç¨‹ä¹‹åï¼Œå†ä¸€ä¸ªå‡½æ•°ä¸€ä¸ªå‡½æ•°è¿›å»çœ‹ã€‚</p><blockquote><p>checkAppName()  // æ£€æŸ¥ä¼ å…¥çš„é¡¹ç›®ååˆæ³•æ€§<br>isSafeToCreateProjectIn(root, name) // åˆ¤æ–­æ–°å»ºè¿™ä¸ªæ–‡ä»¶å¤¹æ˜¯å¦æ˜¯å®‰å…¨çš„<br>shouldUseYarn() // æ£€æŸ¥yarn<br>checkThatNpmCanReadCwd() // æ£€æŸ¥npm<br>run() // æ£€æŸ¥å®Œä¹‹åè°ƒç”¨runæ‰§è¡Œå®‰è£…ç­‰æ“ä½œ</p></blockquote><h3 id="checkAppName-æ£€æŸ¥projectNameæ˜¯å¦åˆæ³•"><a href="#checkAppName-æ£€æŸ¥projectNameæ˜¯å¦åˆæ³•" class="headerlink" title="checkAppName  æ£€æŸ¥projectNameæ˜¯å¦åˆæ³•"></a><a href="#checkAppName">checkAppName</a>  æ£€æŸ¥projectNameæ˜¯å¦åˆæ³•</h3><figure class="highlight javascript"><figcaption><span>createReactApp.js checkAppName</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkAppName</span>(<span class="params">appName</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> validationResult = validateProjectName(appName);</span><br><span class="line">  <span class="keyword">if</span> (!validationResult.validForNewPackages) &#123;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­æ˜¯å¦ç¬¦åˆnpmè§„èŒƒå¦‚æœä¸ç¬¦åˆï¼Œè¾“å‡ºæç¤ºå¹¶ç»“æŸä»»åŠ¡</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> dependencies = [<span class="string">'react'</span>, <span class="string">'react-dom'</span>, <span class="string">'react-scripts'</span>].sort();</span><br><span class="line">  <span class="keyword">if</span> (dependencies.indexOf(appName) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­æ˜¯å¦é‡åï¼Œå¦‚æœé‡ååˆ™è¾“å‡ºæç¤ºå¹¶ç»“æŸä»»åŠ¡</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>checkAppName</code> ç”¨äºåˆ¤æ–­å½“å‰çš„é¡¹ç›®åæ˜¯å¦ç¬¦åˆnpmè§„èŒƒï¼Œæ¯”å¦‚ä¸èƒ½å¤§å†™ç­‰ï¼Œç”¨çš„æ˜¯ä¸€ä¸ª<a href="validate-npm-package-name">validate-npm-package-name</a>çš„npmåŒ…ã€‚è¿™é‡Œç®€åŒ–äº†å¤§éƒ¨åˆ†çš„é”™è¯¯æç¤ºä»£ç ï¼Œä½†æ˜¯ä¸å½±å“å£æ„Ÿã€‚</p><h3 id="shouldUseYarn-åˆ¤æ–­æ˜¯å¦æœ‰è£…yarn-åŒç†çš„æœ‰-checkThatNpmCanReadCwd-ç”¨æ¥åˆ¤æ–­npm"><a href="#shouldUseYarn-åˆ¤æ–­æ˜¯å¦æœ‰è£…yarn-åŒç†çš„æœ‰-checkThatNpmCanReadCwd-ç”¨æ¥åˆ¤æ–­npm" class="headerlink" title="shouldUseYarn åˆ¤æ–­æ˜¯å¦æœ‰è£…yarn åŒç†çš„æœ‰ checkThatNpmCanReadCwd ç”¨æ¥åˆ¤æ–­npm"></a><a href="#shouldUseYarn">shouldUseYarn</a> åˆ¤æ–­æ˜¯å¦æœ‰è£…yarn åŒç†çš„æœ‰ <code>checkThatNpmCanReadCwd</code> ç”¨æ¥åˆ¤æ–­npm</h3><figure class="highlight javascript"><figcaption><span>createReactApp.js shouldUseYarn</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shouldUseYarn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    execSync(<span class="string">'yarnpkg --version'</span>, &#123; <span class="attr">stdio</span>: <span class="string">'ignore'</span> &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="run"><a href="#run" class="headerlink" title="run"></a><a href="#run">run</a></h3><p>å‰é¢çš„é‚£äº›æ“ä½œå¯ä»¥è¯´éƒ½æ˜¯å¤„ç†ä¸€äº›åˆ¤æ–­ä¸å…¼å®¹é€»è¾‘ï¼Œåˆ°<code>run</code>è¿™é‡Œæ‰æ˜¯ çœŸæ­£çš„æ ¸å¿ƒå®‰è£…é€»è¾‘ï¼Œ<strong>å¼€å§‹å®‰è£…ä¾èµ–ï¼Œæ‹·è´æ¨¡ç‰ˆ</strong>ç­‰ã€‚</p><figure class="highlight javascript"><figcaption><span>createReactApp.js run</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params">...</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// è¿™é‡Œè·å–è¦å®‰è£…çš„packageï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯ `react-scripts`ã€‚ ä¹Ÿå¯èƒ½æ˜¯æ ¹æ®ä¼ å‚å»æ‹¿å¯¹åº”çš„åŒ…</span></span><br><span class="line">  <span class="keyword">const</span> packageToInstall = getInstallPackage(version, originalDirectory);</span><br><span class="line">  <span class="comment">// éœ€è¦å®‰è£…æ‰€æœ‰çš„ä¾èµ–ï¼Œ react, react-dom, react-script</span></span><br><span class="line">  <span class="keyword">const</span> allDependencies = [<span class="string">'react'</span>, <span class="string">'react-dom'</span>, packageToInstall];</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>run</code> åšçš„äº‹æƒ…ä¸»è¦æœ‰è¿™ä¹ˆå‡ ä¸ªï¼Œå…ˆæ ¹æ®ä¼ å…¥çš„ç‰ˆæœ¬<code>version</code> å’ŒåŸå§‹ç›®å½•<code>originalDirectory</code> å»è·å–è¦å®‰è£…çš„æŸä¸ª packageã€‚<br>é»˜è®¤çš„ version ä¸ºç©º,è·å–åˆ°çš„ packageToInstall å€¼æ˜¯ <code>react-scripts</code>, ç„¶åå°†<code>packageToInstall</code>æ‹¼æ¥åˆ° <code>allDependencies</code>æ„ä¸ºæ‰€æœ‰éœ€è¦å®‰è£…çš„ä¾èµ–ã€‚<br>è¿™é‡Œè¯´ä¸€ä¸‹<code>react-scripts</code>å…¶å®å°±æ˜¯ä¸€ç³»åˆ—çš„webpacké…ç½®ä¸æ¨¡ç‰ˆï¼Œå±äº <code>create-react-app</code> å¦ä¸€ä¸ªæ ¸å¿ƒçš„ä¸€ä¸ªå¤§æ¨¡å—ã€‚<a href="https://www.npmjs.com/package/react-scripts" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><figure class="highlight javascript"><figcaption><span>createReactApp.js run</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params">...</span>) </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="comment">// è·å–åŒ…åï¼Œæ”¯æŒ taz|taræ ¼å¼ã€gitä»“åº“ã€ç‰ˆæœ¬å·ã€æ–‡ä»¶è·¯å¾„ç­‰ç­‰</span></span><br><span class="line">  getPackageName(packageToInstall)</span><br><span class="line">    .then(<span class="function"><span class="params">packageName</span> =&gt;</span></span><br><span class="line">      <span class="comment">// å¦‚æœæ˜¯yarn,åˆ¤æ–­æ˜¯å¦åœ¨çº¿æ¨¡å¼ï¼ˆå¯¹åº”çš„å°±æ˜¯ç¦»çº¿æ¨¡å¼ï¼‰ï¼Œå¤„ç†å®Œåˆ¤æ–­å°±è¿”å›ç»™ä¸‹ä¸€ä¸ªthenå¤„ç†</span></span><br><span class="line">      checkIfOnline(useYarn).then(<span class="function"><span class="params">isOnline</span> =&gt;</span> (&#123;</span><br><span class="line">        isOnline: isOnline,</span><br><span class="line">        packageName: packageName,</span><br><span class="line">      &#125;))</span><br><span class="line">    )</span><br><span class="line">    .then(<span class="function"><span class="params">info</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> isOnline = info.isOnline;</span><br><span class="line">      <span class="keyword">const</span> packageName = info.packageName;</span><br><span class="line">      <span class="comment">/** å¼€å§‹æ ¸å¿ƒçš„å®‰è£…éƒ¨åˆ† ä¼ å…¥`å®‰è£…è·¯å¾„`ï¼Œ`æ˜¯å¦ä½¿ç”¨yarn`,`æ‰€æœ‰ä¾èµ–`ï¼Œ`æ˜¯å¦è¾“å‡ºé¢å¤–ä¿¡æ¯`ï¼Œ`åœ¨çº¿çŠ¶æ€` **/</span></span><br><span class="line">      <span class="comment">/** è¿™é‡Œä¸»è¦çš„æ“ä½œæ˜¯ æ ¹æ®ä¼ å…¥çš„å‚æ•°ï¼Œå¼€å§‹è·‘ npm || yarn å®‰è£…react react-domç­‰ä¾èµ– **/</span></span><br><span class="line">      <span class="comment">/** è¿™é‡Œå¦‚æœç½‘ç»œä¸å¥½ï¼Œå¯èƒ½ä¼šæŒ‚ **/</span></span><br><span class="line">      <span class="keyword">return</span> install(root, useYarn, allDependencies, verbose, isOnline).then(</span><br><span class="line">        () =&gt; packageName</span><br><span class="line">      );</span><br><span class="line">    &#125;)</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åå¦‚æœå½“å‰æ˜¯é‡‡ç”¨yarnå®‰è£…æ–¹å¼çš„è¯ï¼Œå°±åˆ¤æ–­æ˜¯å¦å¤„äºç¦»çº¿çŠ¶æ€ã€‚åˆ¤æ–­å®Œè¿ç€å‰é¢çš„ <code>packageToInstall</code> å’Œ <code>allDependencies</code> ä¸€èµ·ä¸¢ç»™ <code>install</code> æ–¹æ³•ï¼Œå†ç”±<code>install</code>æ–¹æ³•å»è·‘å®‰è£…ã€‚</p><blockquote><p>runæ–¹æ³•<br>getInstallPackage(); // è·å–è¦å®‰è£…çš„æ¨¡ç‰ˆåŒ… é»˜è®¤æ˜¯ react-scripts<br>install(); // ä¼ å‚æ•°ç»™install è´Ÿè´£å®‰è£… allDependencies<br>init(); // è°ƒç”¨å®‰è£…äº†çš„ react-scripts/script/init å»æ‹·è´æ¨¡ç‰ˆ<br>.catch(); // é”™è¯¯å¤„ç†</p></blockquote><h3 id="install"><a href="#install" class="headerlink" title="install"></a><a href="#install">install</a></h3><figure class="highlight javascript"><figcaption><span>createReactApp.js install</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">install</span>(<span class="params">root, useYarn, dependencies, verbose, isOnline</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ä¸»è¦æ ¹æ®å‚æ•°æ‹¼è£…å‘½ä»¤è¡Œï¼Œç„¶åç”¨nodeå»è·‘å®‰è£…è„šæœ¬ å¦‚ `npm install react react-dom --save` æˆ–è€… `yarn add react react-dom`</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> command;</span><br><span class="line">    <span class="keyword">let</span> args;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼€å§‹æ‹¼è£… yarn å‘½ä»¤è¡Œ</span></span><br><span class="line">    <span class="keyword">if</span> (useYarn) &#123;</span><br><span class="line">      command = <span class="string">'yarnpkg'</span>;</span><br><span class="line">      args = [<span class="string">'add'</span>, <span class="string">'--exact'</span>]; <span class="comment">// ä½¿ç”¨ç¡®åˆ‡ç‰ˆæœ¬æ¨¡å¼</span></span><br><span class="line">      <span class="comment">// åˆ¤æ–­æ˜¯å¦æ˜¯ç¦»çº¿çŠ¶æ€ åŠ ä¸ªçŠ¶æ€</span></span><br><span class="line">      <span class="keyword">if</span> (!isOnline) &#123;</span><br><span class="line">        args.push(<span class="string">'--offline'</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      [].push.apply(args, dependencies);</span><br><span class="line">      <span class="comment">// å°†cwdè®¾ç½®ä¸ºæˆ‘ä»¬è¦å®‰è£…çš„ç›®å½•è·¯å¾„</span></span><br><span class="line">      args.push(<span class="string">'--cwd'</span>);</span><br><span class="line">      args.push(root);</span><br><span class="line">      <span class="comment">// å¦‚æœæ˜¯ç¦»çº¿çš„è¯è¾“å‡ºä¸€äº›æç¤ºä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// npm å®‰è£…æ¨¡å¼ï¼Œä¸yarnåŒç†</span></span><br><span class="line">      command = <span class="string">'npm'</span>;</span><br><span class="line">      args = [</span><br><span class="line">        <span class="string">'install'</span>,</span><br><span class="line">        <span class="string">'--save'</span>,</span><br><span class="line">        <span class="string">'--save-exact'</span>,</span><br><span class="line">        <span class="string">'--loglevel'</span>,</span><br><span class="line">        <span class="string">'error'</span>,</span><br><span class="line">      ].concat(dependencies);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæœ‰ä¼ verboseï¼Œ åˆ™åŠ è¯¥å‚æ•° è¾“å‡ºé¢å¤–çš„ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">if</span> (verbose) &#123;</span><br><span class="line">      args.push(<span class="string">'--verbose'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”¨ cross-spawn è·¨å¹³å°æ‰§è¡Œå‘½ä»¤è¡Œ</span></span><br><span class="line">    <span class="keyword">const</span> child = spawn(command, args, &#123; <span class="attr">stdio</span>: <span class="string">'inherit'</span> &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  å…³é—­çš„å¤„ç†</span></span><br><span class="line">    child.on(<span class="string">'close'</span>, code =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (code !== <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> reject(&#123; <span class="attr">command</span>: <span class="string">`<span class="subst">$&#123;command&#125;</span> <span class="subst">$&#123;args.join(<span class="string">' '</span>)&#125;</span>`</span>, &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      resolve();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é¡ºç€æ–­ç‚¹ä»<code>run</code>è·‘åˆ°<code>install</code>æ–¹æ³•ï¼Œèƒ½çœ‹åˆ°ä»£ç é‡Œæ ¹æ®æ˜¯å¦ä½¿ç”¨yarnåˆ†æˆä¸¤ç§å¤„ç†æ–¹æ³•ã€‚<br><code>if (useYarn) { yarn å®‰è£…é€»è¾‘ } else { npm å®‰è£…é€»è¾‘ }</code><br>å¤„ç†æ–¹æ³•éƒ½æ˜¯åŒä¸ªé€»è¾‘ï¼Œæ ¹æ®ä¼ å…¥çš„ <code>dependencies</code> å»æ‹¼æ¥éœ€è¦å®‰è£…çš„ä¾èµ–ï¼Œä¸»è¦æœ‰ <code>react</code>,<code>react-dom</code>,<code>react-script</code> ã€‚å†åˆ¤æ–­<code>verbose</code>å’Œ<code>isOnline</code> åŠ ä¸€äº›å‘½ä»¤è¡Œçš„å‚æ•°ã€‚<br>æœ€åå†ç”¨nodeè·‘å‘½ä»¤ï¼Œå¹³å°å·®å¼‚çš„è¯æ˜¯å€ŸåŠ©<a href="https://www.npmjs.com/package/cross-spawn" target="_blank" rel="noopener">cross-spawn</a>å»å¤„ç†çš„ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚<br>å…·ä½“é€»è¾‘è§ä¸Šé¢ä»£ç ï¼Œå»æ‰ä¸é‡è¦çš„ä¿¡æ¯è¾“å‡ºï¼Œä»£ç è¿˜æ˜¯æ¯”è¾ƒæ˜“æ‡‚ã€‚</p><blockquote><p>install<br>æ ¹æ®ä¼ è¿›æ¥çš„å‚æ•°åˆ¤æ–­ç”¨yarnè¿˜æ˜¯npm<br>æ‹¼è£…éœ€è¦çš„ä¾èµ–<br>ç”¨cross-spawnè·‘å‘½ä»¤å®‰è£…</p></blockquote><p>åœ¨<code>install</code>ä¼šè¿”å›ä¸€ä¸ª<code>Promise</code>åœ¨å®‰è£…å®Œä¹‹åï¼Œæ–­ç‚¹åˆå›åˆ°æˆ‘ä»¬çš„<code>run</code>å‡½æ•°ç»§ç»­èµ°æ¥ä¸‹æ¥çš„é€»è¾‘ã€‚<br><figure class="highlight javascript"><figcaption><span>createReactApp.js run</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  getPackageName()</span><br><span class="line">    .then(<span class="function"><span class="params">()</span>=&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> install(root, useYarn, allDependencies, verbose, isOnline).then(</span><br><span class="line">            () =&gt; packageName</span><br><span class="line">      );</span><br><span class="line">    &#125;)</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ—¢ç„¶æˆ‘ä»¬çš„<code>install</code>å·²ç»æŠŠå¼€å‘éœ€è¦çš„ä¾èµ–å®‰è£…å®Œäº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥å¼€åˆ¤æ–­å½“å‰è¿è¡Œçš„<code>node</code>æ˜¯å¦ç¬¦åˆæˆ‘ä»¬å·²ç»å®‰è£…çš„<code>react-scripts</code>é‡Œé¢çš„<code>packages.json</code>è¦æ±‚çš„nodeç‰ˆæœ¬ã€‚<br>è¿™å¥è¯æœ‰ç‚¹ç»•ï¼Œç®€å•æ¥è¯´å°±æ˜¯åˆ¤æ–­å½“å‰è¿è¡Œçš„nodeç‰ˆæœ¬æ˜¯å¦<code>react-scripts</code>è¿™ä¸ªä¾èµ–æ‰€éœ€ã€‚</p><p>ç„¶åå°±æŠŠå¼€å§‹ä¿®æ”¹<code>package.json</code>æˆ‘ä»¬å·²ç»å®‰è£…çš„ä¾èµ–(react, react-dom, react-scripts)ç‰ˆæœ¬ä»åŸæœ¬çš„ç²¾ç¡®ç‰ˆæœ¬eg(16.0.0)ä¿®æ”¹ä¸ºé«˜äºç­‰äºç‰ˆæœ¬eg(^16.0.0)ã€‚<br>è¿™äº›å¤„ç†åšå®Œä¹‹åï¼Œæˆ‘ä»¬çš„ç›®å½•æ˜¯é•¿è¿™æ ·å­çš„ï¼Œé‡Œé¢é™¤äº†å®‰è£…çš„ä¾èµ–å’Œ<code>package.json</code>å¤–æ²¡æœ‰ä»»ä½•ä¸œè¥¿ã€‚æ‰€ä»¥æ¥ä¸‹æ¥çš„æ“ä½œæ˜¯ç”Ÿæˆä¸€äº›webpackçš„é…ç½®å’Œä¸€ä¸ªç®€å•çš„å¯å¯åŠ¨demoã€‚<br><img src="./create-react-app1.png" alt></p><p>é‚£ä¹ˆä»–æ˜¯æ€ä¹ˆå¿«é€Ÿç”Ÿæˆè¿™äº›ä¸œè¥¿çš„å‘¢ï¼Ÿ<br>è¿˜è®°å¾—ä¸€å¼€å§‹è¯´äº†æœ‰ä¸€ä¸ª éšè—çš„å‘½ä»¤è¡Œå‚æ•° <code>--internal-testing-template</code> ç”¨æ¥ç»™å¼€å‘è€…è°ƒè¯•ç”¨çš„å—ï¼Œæ‰€ä»¥å…¶å®create-react-appç”Ÿæˆè¿™äº›çš„æ–¹æ³•å°±æ˜¯ç›´æ¥æŠŠæŸä¸€ä¸ªè·¯å¾„çš„æ¨¡æ¿æ‹·è´åˆ°å¯¹åº”çš„åœ°æ–¹ã€‚æ˜¯ä¸æ˜¯å¾ˆç®€å•ç²—æš´hhhhh</p><figure class="highlight javascript"><figcaption><span>createReactApp.js run</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">run(...) &#123;</span><br><span class="line">  ...</span><br><span class="line">    getPackageName(packageToInstall)</span><br><span class="line">    .then(...)</span><br><span class="line">    .then(<span class="function"><span class="params">info</span> =&gt;</span> install(...).then(<span class="function"><span class="params">()</span>=&gt;</span> packageName))</span><br><span class="line">    <span class="comment">/** install å®‰è£…å®Œä¹‹åçš„é€»è¾‘ **/</span></span><br><span class="line">    <span class="comment">/** ä»è¿™é‡Œå¼€å§‹æ‹·è´æ¨¡æ¿é€»è¾‘ **/</span></span><br><span class="line">    .then(<span class="function"><span class="params">packageName</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// å®‰è£…å®Œ react, react-dom, react-scripts ä¹‹åæ£€æŸ¥å½“å‰ç¯å¢ƒè¿è¡Œçš„nodeç‰ˆæœ¬æ˜¯å¦ç¬¦åˆè¦æ±‚</span></span><br><span class="line">      checkNodeVersion(packageName);</span><br><span class="line">      <span class="comment">// è¯¥é¡¹package.jsoné‡Œreact, react-domçš„ç‰ˆæœ¬èŒƒå›´ï¼Œeg: 16.0.0 =&gt; ^16.0.0</span></span><br><span class="line">      setCaretRangeForRuntimeDeps(packageName);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// åŠ è½½scriptè„šæœ¬ï¼Œå¹¶æ‰§è¡Œinitæ–¹æ³•</span></span><br><span class="line">      <span class="keyword">const</span> scriptsPath = path.resolve(</span><br><span class="line">        process.cwd(),</span><br><span class="line">        <span class="string">'node_modules'</span>,</span><br><span class="line">        packageName,</span><br><span class="line">        <span class="string">'scripts'</span>,</span><br><span class="line">        <span class="string">'init.js'</span></span><br><span class="line">      );</span><br><span class="line">      <span class="keyword">const</span> init = <span class="built_in">require</span>(scriptsPath);</span><br><span class="line">      <span class="comment">// init æ–¹æ³•ä¸»è¦æ‰§è¡Œçš„æ“ä½œæ˜¯</span></span><br><span class="line">      <span class="comment">// å†™å…¥package.json ä¸€äº›è„šæœ¬ã€‚eg: script: &#123;start: 'react-scripts start'&#125;</span></span><br><span class="line">      <span class="comment">// æ”¹å†™README.MD</span></span><br><span class="line">      <span class="comment">// æŠŠé¢„è®¾çš„æ¨¡ç‰ˆæ‹·è´åˆ°é¡¹ç›®ä¸‹</span></span><br><span class="line">      <span class="comment">// è¾“å‡ºæˆåŠŸä¸åç»­æ“ä½œçš„ä¿¡æ¯</span></span><br><span class="line">      init(root, appName, verbose, originalDirectory, template);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (version === <span class="string">'react-scripts@0.9.x'</span>) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœæ˜¯æ—§ç‰ˆæœ¬çš„ react-scripts è¾“å‡ºæç¤º</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="params">reason</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// å‡ºé”™çš„è¯ï¼ŒæŠŠå®‰è£…äº†çš„æ–‡ä»¶å…¨åˆ äº† å¹¶è¾“å‡ºä¸€äº›æ—¥å¿—ä¿¡æ¯ç­‰</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå®‰è£…å®Œä¾èµ–ä¹‹åï¼Œæ‰§è¡Œ<code>checkNodeVersion</code>åˆ¤æ–­nodeç‰ˆæœ¬æ˜¯å¦ä¸ä¾èµ–ç›¸ç¬¦ã€‚<br>ä¹‹åæ‹¼æ¥è·¯å¾„å»è·‘<code>ç›®å½•/node_modules/react-scripts/scripts/init.js</code>ï¼Œä¼ å‚è®©ä»–å»åšä¸€äº›åˆå§‹åŒ–çš„äº‹æƒ…ã€‚<br>ç„¶åå¯¹å‡ºé”™æƒ…å†µåšä¸€äº›ç›¸åº”çš„å¤„ç†</p><h2 id="node-modules-react-scripts-script-init-js"><a href="#node-modules-react-scripts-script-init-js" class="headerlink" title="/node_modules/react-scripts/script/init.js"></a><a href="#/node_modules/react-scripts/script/init.js">/node_modules/react-scripts/script/init.js</a></h2><figure class="highlight javascript"><figcaption><span>ç›®æ ‡æ–‡ä»¶å¤¹/node_modules/react-scripts/script/init.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  appPath,</span></span></span><br><span class="line"><span class="function"><span class="params">  appName,</span></span></span><br><span class="line"><span class="function"><span class="params">  verbose,</span></span></span><br><span class="line"><span class="function"><span class="params">  originalDirectory,</span></span></span><br><span class="line"><span class="function"><span class="params">  template</span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> ownPackageName = <span class="built_in">require</span>(path.join(__dirname, <span class="string">'..'</span>, <span class="string">'package.json'</span>))</span><br><span class="line">    .name;</span><br><span class="line">  <span class="keyword">const</span> ownPath = path.join(appPath, <span class="string">'node_modules'</span>, ownPackageName);</span><br><span class="line">  <span class="keyword">const</span> appPackage = <span class="built_in">require</span>(path.join(appPath, <span class="string">'package.json'</span>));</span><br><span class="line">  <span class="keyword">const</span> useYarn = fs.existsSync(path.join(appPath, <span class="string">'yarn.lock'</span>));</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 1. æŠŠå¯åŠ¨è„šæœ¬å†™å…¥ç›®æ ‡ package.json </span></span><br><span class="line">  appPackage.scripts = &#123;</span><br><span class="line">    start: <span class="string">'react-scripts start'</span>,</span><br><span class="line">    build: <span class="string">'react-scripts build'</span>,</span><br><span class="line">    test: <span class="string">'react-scripts test --env=jsdom'</span>,</span><br><span class="line">    eject: <span class="string">'react-scripts eject'</span>,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  fs.writeFileSync(</span><br><span class="line">    path.join(appPath, <span class="string">'package.json'</span>),</span><br><span class="line">    <span class="built_in">JSON</span>.stringify(appPackage, <span class="literal">null</span>, <span class="number">2</span>)</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2. æ”¹å†™README.MDï¼ŒæŠŠä¸€äº›å¸®åŠ©ä¿¡æ¯å†™è¿›å»</span></span><br><span class="line">  <span class="keyword">const</span> readmeExists = fs.existsSync(path.join(appPath, <span class="string">'README.md'</span>));</span><br><span class="line">  <span class="keyword">if</span> (readmeExists) &#123;</span><br><span class="line">    fs.renameSync(</span><br><span class="line">      path.join(appPath, <span class="string">'README.md'</span>),</span><br><span class="line">      path.join(appPath, <span class="string">'README.old.md'</span>)</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3. æŠŠé¢„è®¾çš„æ¨¡ç‰ˆæ‹·è´åˆ°é¡¹ç›®ä¸‹ï¼Œä¸»è¦æœ‰ public, src/[APP.css, APP.js, index.js,....], .gitignore</span></span><br><span class="line">  <span class="keyword">const</span> templatePath = template</span><br><span class="line">    ? path.resolve(originalDirectory, template)</span><br><span class="line">    : path.join(ownPath, <span class="string">'template'</span>);</span><br><span class="line">  <span class="keyword">if</span> (fs.existsSync(templatePath)) &#123;</span><br><span class="line">    fs.copySync(templatePath, appPath);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  fs.move(</span><br><span class="line">    path.join(appPath, <span class="string">'gitignore'</span>),</span><br><span class="line">    path.join(appPath, <span class="string">'.gitignore'</span>),</span><br><span class="line">    [],</span><br><span class="line">    err =&gt; &#123; <span class="comment">/* é”™è¯¯å¤„ç† */</span>  &#125;</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿™é‡Œå†æ¬¡è¿›è¡Œå‘½ä»¤è¡Œçš„æ‹¼æ¥ï¼Œå¦‚æœåé¢å‘ç°æ²¡æœ‰å®‰è£…reactå’Œreact-dom,é‡æ–°å®‰è£…ä¸€æ¬¡</span></span><br><span class="line">  <span class="keyword">let</span> command;</span><br><span class="line">  <span class="keyword">let</span> args;</span><br><span class="line">  <span class="keyword">if</span> (useYarn) &#123;</span><br><span class="line">    command = <span class="string">'yarnpkg'</span>;</span><br><span class="line">    args = [<span class="string">'add'</span>];</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    command = <span class="string">'npm'</span>;</span><br><span class="line">    args = [<span class="string">'install'</span>, <span class="string">'--save'</span>, verbose &amp;&amp; <span class="string">'--verbose'</span>].filter(<span class="function"><span class="params">e</span> =&gt;</span> e);</span><br><span class="line">  &#125;</span><br><span class="line">  args.push(<span class="string">'react'</span>, <span class="string">'react-dom'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> templateDependenciesPath = path.join(</span><br><span class="line">    appPath,</span><br><span class="line">    <span class="string">'.template.dependencies.json'</span></span><br><span class="line">  );</span><br><span class="line">  <span class="keyword">if</span> (fs.existsSync(templateDependenciesPath)) &#123;</span><br><span class="line">    <span class="keyword">const</span> templateDependencies = <span class="built_in">require</span>(templateDependenciesPath).dependencies;</span><br><span class="line">    args = args.concat(</span><br><span class="line">      <span class="built_in">Object</span>.keys(templateDependencies).map(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;key&#125;</span>@<span class="subst">$&#123;templateDependencies[key]&#125;</span>`</span>;</span><br><span class="line">      &#125;)</span><br><span class="line">    );</span><br><span class="line">    fs.unlinkSync(templateDependenciesPath);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!isReactInstalled(appPackage) || template) &#123;</span><br><span class="line">    <span class="keyword">const</span> proc = spawn.sync(command, args, &#123; <span class="attr">stdio</span>: <span class="string">'inherit'</span> &#125;);</span><br><span class="line">    <span class="keyword">if</span> (proc.status !== <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="built_in">console</span>.error(<span class="string">`\`<span class="subst">$&#123;command&#125;</span> <span class="subst">$&#123;args.join(<span class="string">' '</span>)&#125;</span>\` failed`</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 5. è¾“å‡ºæˆåŠŸçš„æ—¥å¿—</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p><code>init</code>æ–‡ä»¶åˆæ˜¯ä¸€ä¸ªå¤§å¤´ï¼Œå¤„ç†çš„é€»è¾‘ä¸»è¦æœ‰</p><ol><li>ä¿®æ”¹package.jsonï¼Œå†™å…¥ä¸€äº›å¯åŠ¨è„šæœ¬ï¼Œæ¯”å¦‚<code>script: {start: &#39;react-scripts start&#39;}</code>ï¼Œç”¨æ¥å¯åŠ¨å¼€å‘é¡¹ç›®</li><li>æ”¹å†™README.MDï¼ŒæŠŠä¸€äº›å¸®åŠ©ä¿¡æ¯å†™è¿›å»</li><li>æŠŠé¢„è®¾çš„æ¨¡ç‰ˆæ‹·è´åˆ°é¡¹ç›®ä¸‹ï¼Œä¸»è¦æœ‰ <code>public</code>, <code>src/[APP.css, APP.js, index.js,....]</code>, <code>.gitignore</code></li><li>å¯¹æ—§ç‰ˆçš„nodeåšä¸€äº›å…¼å®¹çš„å¤„ç†ï¼Œè¿™é‡Œè¡¥ä¸€å¥ï¼Œåœ¨é€‰æ‹© react-scripts æ—¶å°±æœ‰æ ¹æ®nodeç‰ˆæœ¬å»åˆ¤æ–­é€‰æ‹©æ¯”è¾ƒè€çš„ @0.9.x ç‰ˆã€‚</li><li>å¦‚æœå®Œæˆè¾“å‡ºå¯¹åº”çš„ä¿¡æ¯ï¼Œå¦‚æœå¤±è´¥ï¼Œåšä¸€äº›è¾“å‡ºæ—¥å¿—ç­‰æ“ä½œã€‚</li></ol></blockquote><p>è¿™é‡Œä»£ç æœ‰ç‚¹å¤šï¼Œæ‰€ä»¥åˆ äº†ä¸€å°éƒ¨åˆ†ï¼Œå¦‚æœå¯¹åˆå§‹çš„ä»£ç æ„Ÿå…´è¶£å¯ä»¥è·³è½¬åˆ°è¿™å„¿çœ‹<a href="https://github.com/facebook/create-react-app/blob/v1.1.4/packages/react-scripts/scripts/init.js" target="_blank" rel="noopener">react-scripts/scripts/init.js ä¼ é€é—¨</a></p><h1 id="END"><a href="#END" class="headerlink" title="END~"></a>END~</h1><p>åˆ°è¿™é‡Œ <code>create-react-app</code> é¡¹ç›®æ„å»ºçš„éƒ¨åˆ†å¤§æµç¨‹å·²ç»èµ°å®Œäº†ï¼Œæˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹ï¼š</p><ol><li>åˆ¤æ–­nodeç‰ˆæœ¬å¦‚æœå°äº4å°±é€€å‡ºï¼Œå¦åˆ™æ‰§è¡Œ <code>createReactApp.js</code> æ–‡ä»¶</li><li><code>createReactApp.js</code>å…ˆåšä¸€äº›å‘½ä»¤è¡Œçš„å¤„ç†å“åº”å¤„ç†ï¼Œç„¶ååˆ¤æ–­æ˜¯å¦æœ‰ä¼ å…¥ <code>projectName</code> æ²¡æœ‰å°±æç¤ºå¹¶é€€å‡º</li><li>æ ¹æ®ä¼ å…¥çš„ <code>projectName</code> åˆ›å»ºç›®å½•ï¼Œå¹¶åˆ›å»º<code>package.json</code>ã€‚</li><li>åˆ¤æ–­æ˜¯å¦æœ‰ç‰¹æ®Šè¦æ±‚æŒ‡å®šå®‰è£…æŸä¸ªç‰ˆæœ¬çš„<code>react-scripts</code>ï¼Œç„¶åç”¨<code>cross-spawn</code>å»å¤„ç†è·¨å¹³å°çš„å‘½ä»¤è¡Œé—®é¢˜ï¼Œç”¨<code>yarn</code>æˆ–<code>npm</code>å®‰è£…<code>react</code>, <code>react-dom</code>, <code>react-scripts</code>ã€‚</li><li>å®‰è£…å®Œä¹‹åè·‘ <code>react-scripts/script/init.js</code> ä¿®æ”¹ <code>package.json</code> çš„ä¾èµ–ç‰ˆæœ¬ï¼Œè¿è¡Œè„šæœ¬ï¼Œå¹¶æ‹·è´å¯¹åº”çš„æ¨¡æ¿åˆ°ç›®å½•é‡Œã€‚</li><li>å¤„ç†å®Œè¿™äº›ä¹‹åï¼Œè¾“å‡ºæç¤ºç»™ç”¨æˆ·ã€‚</li></ol><p>æœ¬æ¥æƒ³æŠŠæ•´ä¸ª create-react-app è¯´å®Œï¼Œä½†æ˜¯å‘ç°è¯´ä¸€ä¸ªåˆ›å»ºå°±å†™äº†è¿™ä¹ˆå¤šï¼Œæ‰€ä»¥åé¢å¦‚æœæœ‰æƒ³ç»§ç»­çœ‹ <code>react-scripts</code>çš„è¯ï¼Œä¼šå¦å¤–å¼€ä¸€ç¯‡æ¥è®²ã€‚<br>å¤§å®¶ä¹Ÿå¯ä»¥æ ¹æ®è¿™ä¸ªæ€è·¯è‡ªå·±æ–­ç‚¹å»çœ‹ï¼Œä¸è¿‡ <code>react-scripts</code> ä¸»è¦å¯èƒ½æ˜¯webpacké…ç½®å±…å¤šï¼Œæ–­ç‚¹å¸®åŠ©åº”è¯¥ä¸å¤§ã€‚</p><h1 id="create-react-appç³»åˆ—ç¬¬äºŒç¯‡ä¼ é€é—¨"><a href="#create-react-appç³»åˆ—ç¬¬äºŒç¯‡ä¼ é€é—¨" class="headerlink" title="create-react-appç³»åˆ—ç¬¬äºŒç¯‡ä¼ é€é—¨"></a><a href="https://jsonz1993.github.io/2018/05/create-react-app-t/">create-react-appç³»åˆ—ç¬¬äºŒç¯‡ä¼ é€é—¨</a></h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æœ€è¿‘å·¥ä½œå¼€å§‹ç¨³å®šä¸‹æ¥ï¼Œæ²¡æœ‰é‚£ä¹ˆå¤šåŠ ç­ï¼ŒåŠ ä¸Šè¯´æŠ•ç®€å†æ‰¾é¢è¯•ä¸€ç›´æ²¡æ‹¿åˆ°é¢è¯•æœºä¼šâ€¦æ‰€ä»¥å¼€å§‹æœ‰ç©ºé—²çš„æ—¶é—´&lt;/p&gt;
&lt;p&gt;ä¹‹å‰å…¬å¸æœ‰ä¸ªå¤§ä½¬å†™äº†ä¸ªç±»ä¼¼ create-react-app çš„è„šæ‰‹æ¶ï¼Œç”¨æ¥åˆ›å»ºå…¬å¸çš„é¡¹ç›®ã€‚ä¸€ç›´ä¸çŸ¥é“é‡Œé¢å®ç°çš„åŸç†ï¼Œå€Ÿæ­¤æœºä¼šä¸€æ¢ &lt;code&gt;create-re
      
    
    </summary>
    
      <category term="technology" scheme="https://jsonz1993.github.io/categories/technology/"/>
    
    
      <category term="learn" scheme="https://jsonz1993.github.io/tags/learn/"/>
    
      <category term="github" scheme="https://jsonz1993.github.io/tags/github/"/>
    
      <category term="React" scheme="https://jsonz1993.github.io/tags/React/"/>
    
      <category term="JavaScript" scheme="https://jsonz1993.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>2018-04-29é¢è¯•è®°A</title>
    <link href="https://jsonz1993.github.io/2018/04/2018-04-29/"/>
    <id>https://jsonz1993.github.io/2018/04/2018-04-29/</id>
    <published>2018-04-29T22:17:50.000Z</published>
    <updated>2019-03-13T03:30:36.804Z</updated>
    
    <content type="html"><![CDATA[<p>4.10å· å·²ç»åœ¨ç§Ÿç§Ÿè½¦å‘†äº†ä¸€å‘¨å¹´ï¼Œä¸€ç›´æœ‰ä¸ªè§„å¾‹æ˜¯ å¤§æ¦‚ä¸€å¹´å°±è¦å»å¤–é¢æ‰¾æ‰¾è™ã€‚<br>ä¸€æ–¹é¢æ˜¯ä¸ºäº†ä¸‹å¤–é¢çš„å¸‚åœºï¼Œçœ‹ä¸‹æœ‰æ²¡æœ‰æ›´å¥½çš„æœºä¼š<br>å¦ä¸€æ–¹é¢æ˜¯åœ¨ä¸€ä¸ªåœ°æ–¹å¾…ä¹…äº† å¯èƒ½ä¼šå˜å¾—æ¯”è¾ƒå®‰é€¸ï¼Œæ¯”è¾ƒè€æ²¹æ¡ï¼Œè¿™æ—¶å€™å»å¤–é¢å’Œå…¶ä»–å…¬å¸å‰ç«¯é¢è¯•æ²Ÿé€šï¼Œå¯ä»¥äº†è§£å¤–é¢çš„æŠ€æœ¯<br>è®©è‡ªå·±æ›´æœ‰ç›®çš„æ€§ã€æ›´æœ‰åŠ¨åŠ›å»å­¦ä¹ ã€‚</p><p>ä½†æ˜¯ä»Šå¹´çš„æƒ…å†µæœ‰ç‚¹å‡ºä¹æˆ‘æ„æ–™ï¼Œä¸çŸ¥é“æ˜¯å› ä¸ºé‡‘ä¸‰é“¶å››åŠ ä¸Šä»Šå¹´è¿‡å¹´æ—©çš„åŸå› ï¼Œæ‰€ä»¥åŸºæœ¬ä¼ä¸šå•ä½å‘éƒ½å¡«æ»¡äº†ï¼Œ<br>è¿˜æ˜¯ç°åœ¨é€‰æ‹©å…¬å¸æ¯”è¾ƒæŒ‘å‰”ï¼Œé«˜ä¸æˆä½ä¸å°±ã€‚</p><p>è§„æ¨¡å¤ªå°ä¸æƒ³å»ï¼ŒäºŒä¸‰çº¿äº’è”ç½‘å…¬å¸ï¼ŒåŸºæœ¬åˆè¦æ±‚æœ¬ç§‘â€¦å“ å­¦å†çš„çŸ­æ¿å˜å¾—è¶Šæ¥è¶Šå¤§</p><h1 id="ç®€å†æŠ•é€’æƒ…å†µ"><a href="#ç®€å†æŠ•é€’æƒ…å†µ" class="headerlink" title="ç®€å†æŠ•é€’æƒ…å†µ"></a>ç®€å†æŠ•é€’æƒ…å†µ</h1><p>æ®ä¸å®Œå…¨ç»Ÿè®¡:<br>å†…æ¨ <code>YY</code> ä¸åˆé€‚<br>å†…æ¨ <code>æ±‡æ¡”</code> ç›®å‰åªæ‹›5å¹´çš„<br>å†…æ¨ <code>è·¯å®¢</code> é¢è¯• ä¹Ÿæ˜¯ç›®å‰å”¯ä¸€ä¸€ä¸ªæœ‰é¢è¯•æœºä¼šçš„ï¼ï¼ï¼ ä½†æ˜¯è–ªèµ„æ¶¨å¹…ä¸€èˆ¬~<br>æŠ• <code>å¹¿å·é“¶è¡Œä¿¡ç”¨å¡</code> ä¸åˆé€‚ è¦æ±‚æœ¬ç§‘<br>æŠ• <code>ä¸­å…´</code> ä¸åˆé€‚ è¦æ±‚æœ¬ç§‘ = =åæ§½ä¸€å¥ ä¼°è®¡ä¸­å…´ç°åœ¨ä¹Ÿä¸æ•¢æ‹›äººäº†<br>æŠ• <code>è”æ</code> è¢«æŸ¥çœ‹ï¼Œæ²¡æœ‰è”ç³» ä¹Ÿæ˜¯æ²¡æˆäº†<br>Bossç›´è˜<br>æ²Ÿé€š <code>100æ•™è‚²</code> ç›®å‰åªæ‹›5å¹´çš„<br>æ²Ÿé€š <code>æ‹¼å¤šå¤š</code> æƒ¨é­æ— è§† ä¹Ÿæ˜¯è¦æ±‚æœ¬ç§‘</p><p>ç°åœ¨bossç›´è˜ï¼Œæ‹‰é’©ç–¯ç‹‚æ²Ÿé€š <code>å°šå¾·æœºæ„</code> å¥½åƒä¹Ÿæ²¡ä»€ä¹ˆå›åº”~ è¦æ±‚ä¹Ÿæ˜¯æœ¬ç§‘ï¼Œè™½ç„¶è¯´æ˜äº†ç›®å‰æ­£åœ¨è‡ªè€ƒæœ¬ç§‘ï¼Œä½†æ˜¯è‡ªè€ƒæ—¶é—´æœ€ç†æƒ³ä¹Ÿè¦ä¸¤å¹´â€¦å“å“</p><h1 id="é¢è¯•æƒ…å†µ"><a href="#é¢è¯•æƒ…å†µ" class="headerlink" title="é¢è¯•æƒ…å†µ"></a>é¢è¯•æƒ…å†µ</h1><p>å‰åŒäº‹æ¨çš„ <code>è·¯å®¢</code> æ˜¯å”¯ä¸€çš„é¢è¯•æœºä¼šâ€¦ ä¹‹æ‰€ä»¥æƒ³å»æ˜¯å› ä¸ºï¼Œå½“æ—¶çœ‹äº†ä»–ä»¬çš„app ä½¿ç”¨RNå†™çš„ï¼Œä¸ªäººæ¯”è¾ƒæœ‰å…´è¶£ï¼Œè€Œä¸”ä½“éªŒçš„æ—¶å€™è¿˜è§‰å¾—å¾ˆä¸é”™ã€‚å¾ˆå°‘æœ‰å…¬å¸ä¼šä»é›¶å¼€å§‹ç”¨RNå†™ï¼Œä¸€èˆ¬éƒ½æ˜¯æ¯”è¾ƒè¾¹è§’çš„ è¡¨å•æäº¤å•Š FAQ About ç­‰ç­‰çš„é¡µé¢é‡‡ç”¨åŸç”Ÿå†…åµŒRNå®ç°ã€‚</p><p>é¢è¯•æ²¡æœ‰é—®çš„å¾ˆç»†ï¼ŒåŸºæœ¬å°±æ˜¯ç°åœ¨æ¯”è¾ƒå–œæ¬¢çš„é¢è¯•æ–¹å¼</p><p>é—®é¡¹ç›®ç»éªŒï¼ŒReactç”Ÿå‘½å‘¨æœŸï¼Œdiffç®—æ³•ï¼Œå¾®ä¿¡å¼€æ”¾å¹³å°ï¼Œå¯¹vueæŒæ¡ç¨‹åº¦ï¼Œæœ‰æ²¡æœ‰åšè¿‡RNé¡¹ç›®ï¼Œç¦»èŒåŸå› ç­‰<br>å…¶ä¸­é—®åˆ°ä¸€ä¸ªæ˜¯ <strong>æœ‰æ²¡æœ‰ç³»ç»Ÿå­¦ä¹ 23ç§è®¾è®¡æ¨¡å¼</strong><br>æˆ‘å½“æ—¶çš„å›ç­”æ˜¯ æ²¡æœ‰ç³»ç»Ÿå­¦ä¹ è¿‡ï¼Œä¸è¿‡å¹³æ—¶å·¥ä½œæœ‰ç”¨åˆ° <code>å·¥å‚æ¨¡å¼</code> <code>å•ä¾‹æ¨¡å¼</code> ç­‰æ¯”è¾ƒå¸¸ç”¨çš„è®¾è®¡æ¨¡å¼ã€‚<br>æƒ³èµ·ä¹‹å‰çœ‹å¼ å®¹é“­çš„ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ã€‹</p><h1 id="å­¦ä¹ è®¡åˆ’"><a href="#å­¦ä¹ è®¡åˆ’" class="headerlink" title="å­¦ä¹ è®¡åˆ’"></a>å­¦ä¹ è®¡åˆ’</h1><p>ç°åœ¨å·¥ä½œä¸‰å¹´ï¼Œæ„Ÿè§‰åè€Œæ²¡æœ‰åˆšå¼€å§‹å·¥ä½œé‚£ä¼šåŸºç¡€çŸ¥è¯†ç‰¢å›ºã€‚ä»¥å‰åˆšå…¥è¡Œï¼Œè¿˜ä¸çŸ¥é“<code>jq</code>è¿™ç§ä¸œè¥¿ï¼Œå†™è½®æ’­å›¾ï¼Œå†™æ•ˆæœéƒ½æ˜¯ç”¨åŸç”Ÿjsï¼Œè¿˜å…¼å®¹ie~~~ ä¸èƒ½è¯´ç‰¹åˆ«å¼ï¼Œä½†æ˜¯è‡³å°‘åŸºç¡€å¾ˆç‰¢å›º<br>ç°åœ¨å¥½åƒå„ç±» mv* åº“å¸®æˆ‘ä»¬åšäº†å¾ˆå¤šäº‹æƒ…ï¼Œæ‰€ä»¥æˆ‘ä»¬é™¤äº†ä¸€å¼€å§‹çš„ é¡¹ç›®æ­å»ºï¼Œç»“æ„åˆ’åˆ†ï¼Œè·¯ç”±é…ç½®ç­‰ï¼Œå‰©ä¸‹çš„ä¸»è¦ç²¾åŠ›éƒ½ç”¨æ¥å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œæ›´å¤šçš„æ˜¯æƒ³ç€å¦‚ä½•å»è§£å†³ä¸€ä¸ªé—®é¢˜ï¼Œè€Œä¸æ˜¯æ­»è®°ç€é‚£äº›ä¸œè¥¿ï¼Œä½†æ˜¯è¿™è¾¹æ‹¿ä¸€å— é‚£è¾¹æ‹¿ä¸€å—ä¼šå¯¼è‡´å¾ˆéš¾å½¢æˆå±äºè‡ªå·±çš„ä¸œè¥¿ã€‚<br>ä¹Ÿæ²¡æœ‰å¾ˆç³»ç»Ÿçš„å­¦ä¹ ä¸€äº›ä¸œè¥¿ï¼Œå¤ªè¿‡æµ®èº</p><p>ç›®å‰å­¦ä¹ è®¡åˆ’æ˜¯</p><ul><li><p>çœ‹ <code>create-react-app</code> æºç ï¼Œäº†è§£æ€ä¹ˆå®ç°ï¼Œæ–­ç‚¹è°ƒè¯•ï¼Œè¾“å‡ºæ–‡ç« </p></li><li><p>çœ‹ <code>vue</code> æºç ï¼Œç³»ç»Ÿå­¦ä¹ ä¸€ä¸‹<code>vue</code> ç”¨åˆ°é¡¹ç›®ä¸Šï¼Œè€Œä¸æ˜¯åœç•™åˆ° çœ‹è¿‡apiçš„å±‚æ¬¡<br>emmmm æƒ³èµ·vueåˆšå‡ºçš„æ—¶å€™ï¼Œç”¨äº†ä¸€ä¸ªé¥¿äº†ä¹ˆå‡ºçš„ ç§»åŠ¨ç«¯uiåº“ <a href="https://github.com/ElemeFE/mint-ui" target="_blank" rel="noopener">mint-ui</a> è¿˜è´¡çŒ®è¿‡ä¸€ç‚¹ç‚¹bug-request</p></li><li><p>æœ‰å…³äº node åå°çš„é¡¹ç›®æœºä¼šç§¯æä¸€ç‚¹ï¼Œç¡¬ç€å¤´çš®ä¸Š</p></li></ul><p>ä»¥ä¸Š~ emmmm æœ€åå¤šæŠ•çœ‹çœ‹è¿˜æœ‰ä»€ä¹ˆé¢è¯•æœºä¼šâ€¦ å°šå¾·æ²¡æœ‰å¾—é¢è¯•çœŸæ˜¯æœ‰ç‚¹å¤±è½</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;4.10å· å·²ç»åœ¨ç§Ÿç§Ÿè½¦å‘†äº†ä¸€å‘¨å¹´ï¼Œä¸€ç›´æœ‰ä¸ªè§„å¾‹æ˜¯ å¤§æ¦‚ä¸€å¹´å°±è¦å»å¤–é¢æ‰¾æ‰¾è™ã€‚&lt;br&gt;ä¸€æ–¹é¢æ˜¯ä¸ºäº†ä¸‹å¤–é¢çš„å¸‚åœºï¼Œçœ‹ä¸‹æœ‰æ²¡æœ‰æ›´å¥½çš„æœºä¼š&lt;br&gt;å¦ä¸€æ–¹é¢æ˜¯åœ¨ä¸€ä¸ªåœ°æ–¹å¾…ä¹…äº† å¯èƒ½ä¼šå˜å¾—æ¯”è¾ƒå®‰é€¸ï¼Œæ¯”è¾ƒè€æ²¹æ¡ï¼Œè¿™æ—¶å€™å»å¤–é¢å’Œå…¶ä»–å…¬å¸å‰ç«¯é¢è¯•æ²Ÿé€šï¼Œå¯ä»¥äº†è§£å¤–é¢çš„æŠ€æœ¯&lt;br&gt;è®©è‡ªå·±æ›´æœ‰ç›®
      
    
    </summary>
    
      <category term="blog" scheme="https://jsonz1993.github.io/categories/blog/"/>
    
    
      <category term="blog" scheme="https://jsonz1993.github.io/tags/blog/"/>
    
  </entry>
  
  <entry>
    <title>äº‹ä»¶é‡å¤ç»‘å®šä¸stopImmediatePropagation</title>
    <link href="https://jsonz1993.github.io/2018/04/%E4%BA%8B%E4%BB%B6%E9%87%8D%E5%A4%8D%E7%BB%91%E5%AE%9A%E4%B8%8EstopImmediatePropagation/"/>
    <id>https://jsonz1993.github.io/2018/04/äº‹ä»¶é‡å¤ç»‘å®šä¸stopImmediatePropagation/</id>
    <published>2018-04-17T10:34:53.000Z</published>
    <updated>2019-03-13T03:30:36.804Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨æ—§é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç»‘å®šäº‹ä»¶éƒ½æ˜¯ç”¨ <code>$(&#39;selector&#39;).on(&#39;event&#39;, fn)</code> || <code>document.querySelector(&#39;selector&#39;).addEventListener(&#39;event&#39;, fn)</code>;</p><p>å¦‚æœå¹³æ—¶ä»£ç è§„èŒƒï¼Œè¿™æ ·å†™å®Œå…¨ojbk ç‚¹å‡»<code>.p</code> ä¹‹åè¾“å‡º <code>test1</code><br><figure class="highlight html"><figcaption><span>demo1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"p"</span>&gt;</span>test1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">selector, fn</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.querySelector(selector).addEventListener(<span class="string">'click'</span>,fn);</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="javascript">add(<span class="string">'.p'</span>, e=&gt; <span class="built_in">console</span>.log(e.currentTarget.innerHTML));</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>ä½†æ˜¯å¹³æ—¶å¦‚æœé¡¹ç›®ä¸è§„èŒƒï¼Œä»£ç åˆå†™çš„æ¯”è¾ƒä¹±â€¦.emmmmï¼Œå¾ˆæœ‰å¯èƒ½å‡ºç°ä¸€äº›é€»è¾‘ä¸Šçš„ä½çº§é”™è¯¯ï¼Œæ¯”å¦‚è¿™ç§ï¼Œåœ¨æŸä¸ªå‡½æ•°è°ƒäº†ä¸¤æ¬¡ï¼Œæ‰€ä»¥è¿™é‡Œå°±ç»‘å®šäº†ä¸¤æ¬¡â€¦ç‚¹å‡»ä¹‹åä¼šè¾“å‡ºä¸¤æ¬¡çš„ <code>test</code><br><figure class="highlight html"><figcaption><span>demo2</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"p"</span>&gt;</span>test1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"p1"</span>&gt;</span>test2<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">selector, fn</span>) </span>&#123; <span class="built_in">document</span>.querySelector(selector).addEventListener(<span class="string">'click'</span>,fn); &#125;</span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">fn1</span>(<span class="params"></span>) </span>&#123; add(<span class="string">'.p'</span>, e=&gt; <span class="built_in">console</span>.log(e.currentTarget.innerHTML)); &#125;;</span></span><br><span class="line"><span class="undefined">fn1();</span></span><br><span class="line"><span class="undefined">fn1();</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>è¿™ç§æƒ…å†µå¹³æ—¶å·¥ä½œä¸æ³¨æ„çœŸçš„æœ‰å¯èƒ½å‘ç”Ÿï¼Œè€Œä¸”æ’æŸ¥ä¹Ÿåªèƒ½è¯´å¹³æ—¶åœ¨çœ‹æ¥å£æˆ–æ”¹ä»£ç çš„æ—¶å€™ å‘ç°éšæ‰‹æ”¹<br><img src="./repetition.png" alt="é‡å¤è°ƒæ¥å£æƒ…å†µ"></p><p>ä¸€èˆ¬ä¸ºäº†é¿å…è¿™ç§å¤±è¯¯é‡å¤è°ƒç”¨çš„æ“ä½œï¼Œæœ‰å‡ ç§æ–¹æ³•ï¼š</p><ol><li><p>æŠŠäº‹ä»¶å¤„ç†å‡½æ•°æŠ½å‡ºæ¥,è¿™æ ·å°±ç®—é‡å¤ç»‘å®šï¼Œæµè§ˆå™¨æ£€æµ‹åˆ°æ˜¯åŒä¸ªå‡½æ•°å¼•ç”¨ï¼Œä¼šåšç›¸åº”çš„ä¼˜åŒ–ï¼Œæ‰€ä»¥ä¸ä¼šé‡å¤ç»‘å®šåˆ°äº‹ä»¶ä¸Š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">selector, fn</span>) </span>&#123; <span class="built_in">document</span>.querySelector(selector).addEventListener(<span class="string">'click'</span>,fn); &#125;</span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> evFn= <span class="function"><span class="params">e</span>=&gt;</span> <span class="built_in">console</span>.log(e.currentTarget.innerHTML);</span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">fn1</span>(<span class="params"></span>) </span>&#123; add(<span class="string">'.p'</span>,  evFn)&#125;;</span></span><br><span class="line"><span class="undefined">fn1();</span></span><br><span class="line"><span class="undefined">fn1();</span></span><br><span class="line"><span class="undefined">fn1();</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨ <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Event/stopImmediatePropagation" target="_blank" rel="noopener">event.stopImmediatePropagation</a><br>å®˜æ–¹ç»™å‡ºçš„è¯´æ˜æ˜¯ï¼š<br>å¦‚æœæŸä¸ªå…ƒç´ æœ‰å¤šä¸ªç›¸åŒç±»å‹äº‹ä»¶çš„äº‹ä»¶ç›‘å¬å‡½æ•°,åˆ™å½“è¯¥ç±»å‹çš„äº‹ä»¶è§¦å‘æ—¶,å¤šä¸ªäº‹ä»¶ç›‘å¬å‡½æ•°å°†æŒ‰ç…§é¡ºåºä¾æ¬¡æ‰§è¡Œ.å¦‚æœæŸä¸ªç›‘å¬å‡½æ•°æ‰§è¡Œäº† event.stopImmediatePropagation()æ–¹æ³•,åˆ™é™¤äº†è¯¥äº‹ä»¶çš„å†’æ³¡è¡Œä¸ºè¢«é˜»æ­¢ä¹‹å¤–(event.stopPropagationæ–¹æ³•çš„ä½œç”¨),è¯¥å…ƒç´ ç»‘å®šçš„ååºç›¸åŒç±»å‹äº‹ä»¶çš„ç›‘å¬å‡½æ•°çš„æ‰§è¡Œä¹Ÿå°†è¢«é˜»æ­¢.</p></li></ol><p>ç®€å•æ¥è¯´å°±æ˜¯ï¼Œæ‰§è¡Œäº†<code>event.stopImmediatePropagation()</code> ä¹‹åï¼Œåç»­çš„ç»‘å®šåœ¨è¯¥domä¸Šçš„ç›¸åŒç±»å‹äº‹ä»¶éƒ½ä¸å†è¢«å“åº”ï¼Œä¹Ÿä¸å†’æ³¡ã€‚</p><p><code>demo3</code> ä»£ç ï¼Œç‚¹å‡» test1 ä¹‹åï¼Œåªä¼šåœ¨æ§åˆ¶å°è¾“å‡ºä¸€è¡Œ <code>test1</code>ï¼Œå…¶ä»– è¯¥å…ƒç´ çš„ç‚¹å‡»äº‹ä»¶ï¼Œ#idç‚¹å‡»äº‹ä»¶éƒ½ä¸ä¼šè¢«å“åº”<br><figure class="highlight html"><figcaption><span>demo3</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"p"</span>&gt;</span>test1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">selector, fn</span>) </span>&#123; <span class="built_in">document</span>.querySelector(selector).addEventListener(<span class="string">'click'</span>,fn); &#125;</span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">fn1</span>(<span class="params"></span>) </span>&#123; add(<span class="string">'.p'</span>,  e=&gt; <span class="built_in">console</span>.log(e.currentTarget.innerHTML)|| e.stopImmediatePropagation())&#125;;</span></span><br><span class="line"><span class="javascript">add(<span class="string">'#id'</span>,e=&gt;<span class="built_in">console</span>.log(<span class="number">1</span>));</span></span><br><span class="line"><span class="undefined">fn1();</span></span><br><span class="line"><span class="undefined">fn1();</span></span><br><span class="line"><span class="undefined">fn1();</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œè¿˜æ˜¯æ¯”è¾ƒå»ºè®®æŠŠäº‹ä»¶å¤„ç†é€»è¾‘æŠ½å‡ºæ¥å½“ä¸€ä¸ªå‡½æ•°ï¼Œæ¯•ç«Ÿåœ¨å¤šäººé¡¹ç›®é‡Œé¢ <code>stopImmediatePropagation</code> æ¯”è¾ƒå®¹æ˜“è¯¯ä¼¤é˜Ÿå‹â€¦</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åœ¨æ—§é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç»‘å®šäº‹ä»¶éƒ½æ˜¯ç”¨ &lt;code&gt;$(&amp;#39;selector&amp;#39;).on(&amp;#39;event&amp;#39;, fn)&lt;/code&gt; || &lt;code&gt;document.querySelector(&amp;#39;selector&amp;#39;).addEvent
      
    
    </summary>
    
      <category term="technology" scheme="https://jsonz1993.github.io/categories/technology/"/>
    
    
      <category term="github" scheme="https://jsonz1993.github.io/tags/github/"/>
    
      <category term="JavaScript" scheme="https://jsonz1993.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>è‡ªåŠ¨åŒ–åŠŸèƒ½æµ‹è¯•æµç¨‹æ–¹æ¡ˆ</title>
    <link href="https://jsonz1993.github.io/2018/04/%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95%E6%B5%81%E7%A8%8B%E6%96%B9%E6%A1%88/"/>
    <id>https://jsonz1993.github.io/2018/04/è‡ªåŠ¨åŒ–åŠŸèƒ½æµ‹è¯•æµç¨‹æ–¹æ¡ˆ/</id>
    <published>2018-04-03T14:38:10.000Z</published>
    <updated>2019-03-13T03:30:36.804Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>å¾—ç›Šäºè°·æ­Œå¼€æºäº† <a href="https://github.com/GoogleChrome/puppeteer" target="_blank" rel="noopener">puppeteer</a> æ— ç•Œé¢ç‰ˆçš„ Chrome nodeJs apiã€‚<br>ç°åœ¨å‰ç«¯å¯å¾ˆæ–¹ä¾¿å¿«æ·çš„å¼€å‘ä¸€äº›è„šæœ¬å»è·‘æµè§ˆå™¨ç«¯çš„æ“ä½œï¼ŒåŒ…æ‹¬è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œçˆ¬è™«æˆ–å…¶ä»–æ¯”è¾ƒæœºæ¢°åŒ–çš„æ“ä½œã€‚<br>å¯ä»¥å‚è§æˆ‘ä¸Šä¸€ç¯‡æ–‡<br><strong><a href="https://jsonz1993.github.io/2018/03/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95puppeteer-%E4%B8%8Eqq%E7%A9%BA%E9%97%B4/">è‡ªåŠ¨åŒ–æµ‹è¯• puppeteer ä¸qqç©ºé—´</a></strong></p><p>ps: ğŸ¤¦â€ æ—©çŸ¥é“å½“æ—¶åˆ å¾®åšå°±ç›´æ¥å†™ä¸€ä¸ªè„šæœ¬ï¼Œäººå·¥å»åˆ è¿˜æ¼äº†ä¸€äº›è¢«æ‰¹æ–—äº†ä¸€é¡¿</p><p>æ—¢ç„¶ puppeteer å¯ä»¥æ‹¿æ¥åšè¿™ä¹ˆå¤šäº‹æƒ…ï¼Œé‚£å‰ç«¯æ˜¯ä¸æ˜¯å¯ä»¥æ•´åˆå‡ºä¸€å¥—æµç¨‹æµ‹è¯•çš„æ–¹æ¡ˆï¼Ÿ</p><h2 id="å¤§æ¦‚çš„æµç¨‹æ˜¯ï¼š"><a href="#å¤§æ¦‚çš„æµç¨‹æ˜¯ï¼š" class="headerlink" title="å¤§æ¦‚çš„æµç¨‹æ˜¯ï¼š"></a>å¤§æ¦‚çš„æµç¨‹æ˜¯ï¼š</h2><ul><li>å®šæ—¶è·‘ä¸šåŠ¡æµç¨‹</li><li>æˆåŠŸåˆ™å‘é€ä¸€æ¡æ¶ˆæ¯é€šçŸ¥æœåŠ¡å™¨</li><li>å¤±è´¥åˆ™ æˆªå›¾å‘é€æˆªå›¾ä¸å…¶ä»–ä¿¡æ¯<ul><li>åˆ°è¾¾ä¸€å®šçš„é˜ˆå€¼å°±é€šçŸ¥ç›¸å…³äººå‘˜æ’æŸ¥é—®é¢˜</li></ul></li><li>æä¾›ä¸€ä¸ªå‰ç«¯é¡µé¢å¯ä»¥æŸ¥è¯¢ ä»»åŠ¡æƒ…å†µ</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">                                        +-------------------+</span><br><span class="line">        +-----------------------------&gt; |    è®°å½•æ¶ˆæ¯         |</span><br><span class="line">        |          success              |                   |</span><br><span class="line">        |                               +------+------------+</span><br><span class="line">        |                                      |</span><br><span class="line">+-------+------+                               |</span><br><span class="line">|              |                               v</span><br><span class="line">| å®šæ—¶è·‘æµ‹è¯•ä»»åŠ¡  |                         +-----+-----------+</span><br><span class="line">|              |                         |                 |</span><br><span class="line">|              |                         |                 |</span><br><span class="line">+------+-------+                         |    æŸ¥çœ‹ä»»åŠ¡è®°å½•   |</span><br><span class="line">       |                                 |                 |</span><br><span class="line">       |                                 |                 |</span><br><span class="line">       |                                 +-----+-----------+</span><br><span class="line">       |                                       ^</span><br><span class="line">       |                                       |</span><br><span class="line">       |          error                  +-----+----------+</span><br><span class="line">       |                                 |                |</span><br><span class="line">       +-------------------------------&gt; |    è®°å½•æ¶ˆæ¯      |</span><br><span class="line">                                         |                |</span><br><span class="line">                                         |                |</span><br><span class="line">                                         +-------+--------+</span><br><span class="line">                                                 |</span><br><span class="line">                                                 |</span><br><span class="line">                                                 |  é˜ˆå€¼</span><br><span class="line">                                                 |</span><br><span class="line">                                        +--------v---------+</span><br><span class="line">                                        |                  |</span><br><span class="line">                                        |                  |</span><br><span class="line">                                        |      é€šçŸ¥äººå‘˜      |</span><br><span class="line">                                        |                  |</span><br><span class="line">                                        |                  |</span><br><span class="line">                                        +------------------+</span><br></pre></td></tr></table></figure><h2 id="ç”¨åˆ°çš„æŠ€æœ¯æ ˆ"><a href="#ç”¨åˆ°çš„æŠ€æœ¯æ ˆ" class="headerlink" title="ç”¨åˆ°çš„æŠ€æœ¯æ ˆ"></a>ç”¨åˆ°çš„æŠ€æœ¯æ ˆ</h2><p>è‡ªåŠ¨åŒ–æµ‹è¯•: puppeteer + axios + node-schedule<br>åå°: egg + mongoose<br>å‰ç«¯ç•Œé¢: antd + dva</p><p>å…¶å®ä¸»è¦å°± puppeteer + egg + mongoose å³å¯ï¼Œå‰ç«¯ç•Œé¢åªæ˜¯åˆšå¥½å…¬å¸ä¸€ä¸ªåå°æ˜¯ç”¨ antd-pro å†™çš„ æ‰€ä»¥é¡ºæ‰‹å¸¦ä¸Šå»è€Œå·² = =#</p><p>æœ¬åœ°ä¸€äº›ç¯å¢ƒï¼š<code>node 8.9.4</code>, <code>npm 5.6.0</code>, <code>oxs 10.13.3</code>ï¼Œ ç¼–è¾‘å™¨ <code>vscodeeeeee</code></p><p>ä»¥ä¸‹æ¶‰åŠåˆ°å…¬å¸é¡¹ç›®ä¸šåŠ¡çš„ éƒ½ä¼šç•¥è¿‡è®²ä¸€ä¸‹è¿‡ç¨‹ ä¸ä¼šå‡ºç°å…·ä½“ä»£ç æˆ–æˆªå›¾ç­‰â€¦</p><h1 id="è‡ªåŠ¨åŒ–æµ‹è¯•-auto-test-éƒ¨åˆ†"><a href="#è‡ªåŠ¨åŒ–æµ‹è¯•-auto-test-éƒ¨åˆ†" class="headerlink" title="è‡ªåŠ¨åŒ–æµ‹è¯•(auto_test)éƒ¨åˆ†"></a>è‡ªåŠ¨åŒ–æµ‹è¯•(auto_test)éƒ¨åˆ†</h1><p>ç›®å½•ç»“æ„:<br><img src="./auto_test_project.png" alt="auto_test_project"></p><h2 id="å…¥å£-app-js-ä¸»è¦å¤„ç†ä¸€äº›è·å–è‡ªåŠ¨åŒ–æµ‹è¯•æµè§ˆå™¨çš„å¯¹è±¡ï¼Œ-é¡¹ç›®å¯åŠ¨ï¼Œ-å®šæ—¶ä»»åŠ¡å¯åŠ¨"><a href="#å…¥å£-app-js-ä¸»è¦å¤„ç†ä¸€äº›è·å–è‡ªåŠ¨åŒ–æµ‹è¯•æµè§ˆå™¨çš„å¯¹è±¡ï¼Œ-é¡¹ç›®å¯åŠ¨ï¼Œ-å®šæ—¶ä»»åŠ¡å¯åŠ¨" class="headerlink" title="å…¥å£: app.js ä¸»è¦å¤„ç†ä¸€äº›è·å–è‡ªåŠ¨åŒ–æµ‹è¯•æµè§ˆå™¨çš„å¯¹è±¡ï¼Œ é¡¹ç›®å¯åŠ¨ï¼Œ å®šæ—¶ä»»åŠ¡å¯åŠ¨"></a>å…¥å£: app.js ä¸»è¦å¤„ç†ä¸€äº›è·å–è‡ªåŠ¨åŒ–æµ‹è¯•æµè§ˆå™¨çš„å¯¹è±¡ï¼Œ é¡¹ç›®å¯åŠ¨ï¼Œ å®šæ—¶ä»»åŠ¡å¯åŠ¨</h2><figure class="highlight javascript"><figcaption><span>app.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mMonitor = <span class="built_in">require</span>(<span class="string">'./scripts/m'</span>);  <span class="comment">// mç«¯æµ‹è¯•è„šæœ¬å…¥å£</span></span><br><span class="line"><span class="keyword">const</span> xDate = <span class="built_in">require</span>(<span class="string">'xdate'</span>);</span><br><span class="line"><span class="keyword">const</span> login = <span class="built_in">require</span>(<span class="string">'./scripts/login'</span>); <span class="comment">// ç™»å½•æ“ä½œå¤„ç†</span></span><br><span class="line"><span class="keyword">const</span> &#123; scheduleDelPic &#125; = <span class="built_in">require</span>(<span class="string">'./scripts/schedule'</span>); <span class="comment">// å®šæ—¶ä»»åŠ¡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é¡¹ç›®å…¥å£</span></span><br><span class="line">;<span class="function">(<span class="params"><span class="keyword">async</span>(</span>)=&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// å› ä¸ºå…¬å¸é¡¹ç›®éœ€è¦ä¸€äº›å‰ç½®çš„ æ“ä½œæ‰èƒ½è®¿é—®ï¼Œæ¯”å¦‚ç™»å½•ç®¡ç†åå°ç­‰æ“ä½œï¼Œ</span></span><br><span class="line">  <span class="comment">// æ‰€ä»¥è¿™é‡Œç›´æ¥ç”¨ä¸€ä¸ªæ–‡ä»¶æŠŠè¿™ä¸€å—æŠ½å‡ºæ¥ï¼Œæ–¹ä¾¿åé¢ä¸“å¿ƒå¤„ç†ä¸šåŠ¡ ä¸ç”¨å…³å¿ƒç”¨æˆ·ç™»å½• æƒé™ æµ‹è¯•è´¦å·ç­‰é—®é¢˜</span></span><br><span class="line">  <span class="comment">// å¤„ç†å®Œç›´æ¥è¿”å›ä¸€ä¸ª browser å¯¹è±¡ï¼Œåé¢çš„å…¶ä»–æµ‹è¯•åªéœ€è¦åœ¨å½“å‰çš„ browser æ–°å¼€ä¸€ä¸ªtabå»è·‘å³å¯</span></span><br><span class="line">  <span class="keyword">const</span> browser = <span class="keyword">await</span> login();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// mç«¯é¡¹ç›®</span></span><br><span class="line">  mMonitor(browser); <span class="comment">// ä¼ å…¥browser å¯¹è±¡ å¼€å§‹å¤„ç†è‡ªåŠ¨åŒ–æµ‹è¯•</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 10åˆ†é’Ÿè·‘ä¸€æ¬¡ï¼Œè¿™é‡Œä¹Ÿå¯ä»¥æŠŠé—´éš”æŠ½å‡ºæ¥æ”¾åˆ°configé‡Œ</span></span><br><span class="line">  <span class="comment">// å¤šå˜´è¯´ä¸€å¥ï¼Œç”¨setInterval æœ‰ä¸€ä¸ªå¼Šç«¯å°±æ˜¯ï¼Œå‰é¢æ‰§è¡Œè„šæœ¬å µå¡ï¼Œä¼šé€ æˆ ä¸€ä¸ªä»»åŠ¡è·‘å®Œ ç›´æ¥è·‘ä¸‹ä¸€ä¸ªï¼Œä¸­é—´ä¸æ˜¯é—´éš”10minã€‚ çœ‹å…·ä½“çš„ä¸šåŠ¡éœ€æ±‚ï¼Œä¹Ÿå¯ä»¥ç”¨ setTimeout æˆ–è€…é€’å½’ç­‰å»æ‰§è¡Œ</span></span><br><span class="line">  setInterval(<span class="function"><span class="params">()</span> =&gt;</span> mMonitor(browser), <span class="number">1000</span> * <span class="number">3600</span> * <span class="number">1</span>); </span><br><span class="line"></span><br><span class="line">  <span class="comment">// å…¶ä»–çš„ä»»åŠ¡ å®šæ—¶ä»»åŠ¡ç­‰</span></span><br><span class="line">  <span class="comment">// è¿™é‡Œæ˜¯å†™äº†ä¸ªå®šæ—¶æ¸…ç†å›¾ç‰‡</span></span><br><span class="line">  scheduleDelPic();</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h2 id="å‰ç½®å¤„ç†-login-js-è¿™é‡Œå¯ä»¥å–å…¶ä»–åå­—"><a href="#å‰ç½®å¤„ç†-login-js-è¿™é‡Œå¯ä»¥å–å…¶ä»–åå­—" class="headerlink" title="å‰ç½®å¤„ç†: login.js (è¿™é‡Œå¯ä»¥å–å…¶ä»–åå­—)"></a>å‰ç½®å¤„ç†: login.js (è¿™é‡Œå¯ä»¥å–å…¶ä»–åå­—)</h2><p>å¯¹äºæˆ‘è¿™ä¸ªé¡¹ç›®æ¥è¯´ åœ¨å¼€å§‹è·‘ä¹‹å‰è¦å¤„ç†æµ‹è¯•è´¦å·ç™»å½•ç­‰é—®é¢˜ï¼Œå› ä¸ºè€ƒè™‘åˆ°åé¢ä¼šæœ‰å¤šä¸ªä»»åŠ¡åœ¨è·‘çš„è¯ï¼Œç›´æ¥åœ¨ <code>browser</code> å¯¹è±¡ create new tab å¯ä»¥åŒæ­¥è·‘ï¼Œè€Œä¸ç”¨æ¯æ¬¡éƒ½å»å¤„ç†ç™»å½•é—®é¢˜ã€‚</p><figure class="highlight javascript"><figcaption><span>login.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> puppeteer = <span class="built_in">require</span>(<span class="string">'puppeteer'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> browser = <span class="keyword">await</span> puppeteer.launch(&#123;</span><br><span class="line">    headless: <span class="literal">false</span>,</span><br><span class="line">    devtools: <span class="literal">true</span>,</span><br><span class="line">    slowMo: <span class="number">100</span>,</span><br><span class="line">    ignoreHTTPSErrors: <span class="literal">true</span>,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¤„ç†ä¸€äº›å…¶ä»–çš„é€»è¾‘</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="comment">// æŠŠå¤„ç†å®Œçš„ browser è¿”å›å›å»</span></span><br><span class="line">  <span class="keyword">return</span> browser;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="mMonitor-ç§»åŠ¨ç«¯æµ‹è¯•ä»»åŠ¡"><a href="#mMonitor-ç§»åŠ¨ç«¯æµ‹è¯•ä»»åŠ¡" class="headerlink" title="mMonitor ç§»åŠ¨ç«¯æµ‹è¯•ä»»åŠ¡"></a>mMonitor ç§»åŠ¨ç«¯æµ‹è¯•ä»»åŠ¡</h2><p>ä¸»è¦å¤„ç†çš„äº‹æƒ…æœ‰ï¼š</p><ul><li>è°ƒç”¨å…¶ä»–çš„æµç¨‹æµ‹è¯•ä»»åŠ¡ï¼Œæ¯”å¦‚æˆ‘æ˜¯ï¼š å…¬å¸é¡¹ç›®çš„ä¸»æµç¨‹ä¸‹å•ä»»åŠ¡</li><li>å¤„ç†ä¸€äº›éœ€è¦è®°å½•çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ä»ä»€ä¹ˆæ—¶å€™è·‘ï¼Œä»€ä¹ˆæ—¶å€™ç»“æŸ</li><li>å¤„ç†ä¸æœåŠ¡å™¨çš„äº¤äº’ï¼ŒæˆåŠŸè°ƒæ¥å£</li><li>å¤±è´¥æˆªå›¾ä¿å­˜ç”¨æˆ·ä¿¡æ¯ç­‰ ä¼ é€’ç»™æœåŠ¡ç«¯</li></ul><figure class="highlight javascript"><figcaption><span>m.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">mMonitor</span>(<span class="params">browser</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// å»ºç«‹ä¸€ä¸ª page çš„å¼•ç”¨ï¼Œæ–¹ä¾¿åé¢å¯ä»¥è°ƒç”¨æ–¹æ³•</span></span><br><span class="line">  <span class="keyword">let</span> page;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    startTime = <span class="built_in">Date</span>.now();</span><br><span class="line"></span><br><span class="line">    page = <span class="keyword">await</span> browser.newPage();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŠŠé¡µé¢ä¼ å…¥ä¸»æµç¨‹çš„æµ‹è¯•ä»»åŠ¡</span></span><br><span class="line">    <span class="comment">// è¿™é‡Œé¢å°±æœ‰è¶…çº§æ— æ•Œå¤§é‡çš„ ä¸šåŠ¡ä»£ç ... emmm æ ¹æ®é¡¹ç›®ä¸åŒæ¥å†™ å®Œå…¨æ²¡æœ‰å‚è€ƒæ„ä¹‰å°±ä¸å†™äº†</span></span><br><span class="line">    <span class="keyword">await</span> mainProcess(page);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æµ‹è¯•ä»»åŠ¡æ‰§è¡ŒæˆåŠŸçš„å¤„ç†</span></span><br><span class="line">    <span class="keyword">const</span> params = &#123; </span><br><span class="line">      <span class="comment">// æµ‹è¯•ç»“æœæ•°æ®</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒæ¥å£å­˜æ•°æ®</span></span><br><span class="line">    <span class="keyword">const</span> data = <span class="keyword">await</span> mRequest(params);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'ä¸ŠæŠ¥successæ¥å£æˆåŠŸ'</span>, params);</span><br><span class="line"></span><br><span class="line">  &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">    <span class="comment">// è·‘æµ‹è¯•æµç¨‹ä¸­é”™è¯¯çš„å¯¹åº”å¤„ç†</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> params = &#123;</span><br><span class="line">      <span class="comment">// é”™è¯¯ç»“æœçš„æ•°æ®ï¼Œ æ¯”å¦‚ </span></span><br><span class="line">      <span class="comment">// æˆªå›¾åœ°å€url</span></span><br><span class="line">      <span class="comment">// title</span></span><br><span class="line">      <span class="comment">// url</span></span><br><span class="line">      <span class="comment">// serviceCode ç­‰ç­‰</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> data = <span class="keyword">await</span> mRequest(params);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'ä¸ŠæŠ¥error æ¥å£æˆåŠŸ'</span>, params);</span><br><span class="line">  &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="comment">// å…³é—­å½“å‰é¡µé¢</span></span><br><span class="line">    page.close();</span><br><span class="line">    <span class="comment">// å…¶ä»–æ“ä½œ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="schedule-å®šæ—¶ä»»åŠ¡"><a href="#schedule-å®šæ—¶ä»»åŠ¡" class="headerlink" title="schedule å®šæ—¶ä»»åŠ¡"></a>schedule å®šæ—¶ä»»åŠ¡</h2><p>è¿™é‡Œçš„å®šæ—¶ä»»åŠ¡ç”¨çš„æ˜¯ <a href="https://www.npmjs.com/package/node-schedule" target="_blank" rel="noopener">node-schedule</a> éå¸¸å¥½ç”¨ æ”¯æŒ <code>Cron-style</code>ã€‚</p><p><code>schedule.scheduleJob(cronStyle)</code></p><p>cronStyle å‚æ•° ä¼ å…¥å¯¹åº”çš„æ—¶é—´ï¼Œæ—¢å¯æŒ‰ç…§ä¼ å…¥çš„å‚æ•° å®šæ—¶å»æ‰§è¡Œï¼Œå…·ä½“å¯ä»¥çœ‹ğŸ‘†é“¾æ¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cronStyle: </span><br><span class="line"></span><br><span class="line">*    *    *    *    *    *</span><br><span class="line">â”¬    â”¬    â”¬    â”¬    â”¬    â”¬</span><br><span class="line">â”‚    â”‚    â”‚    â”‚    â”‚    â”‚</span><br><span class="line">â”‚    â”‚    â”‚    â”‚    â”‚    â”” day of week (0 - 7) (0 or 7 is Sun)</span><br><span class="line">â”‚    â”‚    â”‚    â”‚    â””â”€â”€â”€â”€â”€ month (1 - 12)</span><br><span class="line">â”‚    â”‚    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ day of month (1 - 31)</span><br><span class="line">â”‚    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ hour (0 - 23)</span><br><span class="line">â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ minute (0 - 59)</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ second (0 - 59, OPTIONAL)</span><br></pre></td></tr></table></figure><p>ç›®å‰ <code>auto_test</code> ç”¨åˆ°çš„å®šæ—¶ä»»åŠ¡åªæœ‰ä¸€ä¸ª<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> schedule= <span class="built_in">require</span>(<span class="string">'node-schedule'</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ é™¤æŸä¸ªç›®å½•çš„ä¸€å±‚æ–‡ä»¶</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">delPathFile</span>(<span class="params">path</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!fs.existsSync(path)) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">const</span> files = fs.readdirSync(path);</span><br><span class="line">  files.forEach(<span class="function"><span class="params">file</span> =&gt;</span> fs.unlinkSync(<span class="string">`<span class="subst">$&#123;path&#125;</span>/<span class="subst">$&#123;file&#125;</span>`</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šæ—¶åˆ é™¤å›¾ç‰‡ï¼Œæ¯å‘¨ä¸€ä¸€æ¬¡</span></span><br><span class="line">exports.scheduleDelPic = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> initPath = path.join(process.cwd(), <span class="string">'/static/init'</span>);</span><br><span class="line">  <span class="keyword">const</span> errorPath = path.join(process.cwd(), <span class="string">'/static/error'</span>);</span><br><span class="line">  <span class="keyword">const</span> successPath = path.join(process.cwd(), <span class="string">'/static/success'</span>);</span><br><span class="line"></span><br><span class="line">  schedule.scheduleJob(<span class="string">'* * * * * 1'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    delPathFile(initPath);</span><br><span class="line">    delPathFile(errorPath);</span><br><span class="line">    delPathFile(successPath);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ€»çš„æ¥è¯´ <code>auto_test</code> åšçš„äº‹æƒ…å¤§æ¦‚å°±æ˜¯</p><ul><li>å¯åŠ¨ <code>app.js</code>ï¼Œ é¡¹ç›®å°±ä¼š 10åˆ†é’Ÿè‡ªåŠ¨è·‘ä¸€æ¬¡æµ‹è¯•ç¨‹åºã€‚</li><li>æˆåŠŸã€å¤±è´¥ååšå‡ºå¯¹åº”çš„æ“ä½œã€‚</li><li>æ¯å‘¨æ¸…é™¤ä¸€æ¬¡æœ¬åœ°çš„æˆªå›¾æ•°æ®ã€‚</li></ul><p>ä½†æ˜¯å‡ ä¸ªå¼Šç«¯</p><ol><li>puppeteer æ˜¯æ¨¡æ‹Ÿæµè§ˆå™¨ï¼Œæ‰€ä»¥ä½ çš„æ‰€æœ‰è¡Œä¸ºéƒ½æ˜¯æ¨¡æ‹Ÿç”¨æˆ·æ“ä½œï¼šé€‰æ‹©domï¼Œç‚¹å‡»ã€å¡«å†™ã€é€‰æ‹©æ“ä½œã€‚è¿™äº›éƒ½æ˜¯å¾ˆå®¹æ˜“å› ä¸ºé¡µé¢çš„domå˜åŒ–è€Œå¤±æ•ˆï¼Œæ¯”å¦‚æœ¬æ¥æ˜¯é€‰äº†ä¸€ä¸ª <code>#userId</code>çš„æ–‡æœ¬æ¡†ï¼Œåé¢è¿­ä»£æŠŠ <code>#userId</code>æ”¹ä¸º<code>#uuid</code> é‚£ä½ å°±é€‰ä¸åˆ°äº†ã€‚ æ‰€ä»¥ä¸šåŠ¡æµ‹è¯•ä»£ç (<code>__mainProcess__</code>æ¨¡å—) åšå¥½æ¨¡å—æ‹†åˆ†ï¼Œåé¢è·Ÿé¡¹ç›®è¿­ä»£ä¹Ÿæ–¹ä¾¿è°ƒæ•´ã€‚</li><li>å› ä¸ºç½‘ç»œæˆ–domæ“ä½œç»å¸¸è§¦å‘å¼‚æ­¥è¡Œä¸ºï¼Œæ‰€ä»¥ä¸šåŠ¡æµ‹è¯•ä»£ç é‡Œé¢å……æ»¡å„ç§ <code>waitFor</code> <code>waitForSelector</code> <code>waitForNative</code> ç­‰â€¦ä¸æ³¨æ„å¯èƒ½å°±ä¼šæ“ä½œåˆ°æ²¡æœ‰å‡ºç°çš„å…ƒç´ ï¼Œè¿™å—è¦åšå¥½æ§åˆ¶ï¼Œæ¯”å¦‚waitFor æ—¶é—´ä¹…ä¸€ç‚¹ï¼Œæˆ–è€…åœ¨<code>page</code>ä¸Šå°è£…ä¸€ä¸ªæ–¹æ³•ï¼Œæ¯”å¦‚ <code>page._click</code>:<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> _click(selector) &#123;</span><br><span class="line">  <span class="keyword">await</span> page.waitForSelector(selector, &#123; <span class="attr">visible</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">  <span class="keyword">return</span> page.click(selector);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></li></ol><p>åœ¨æ¯æ¬¡ç‚¹å‡»ä¹‹å‰ï¼Œå…ˆç­‰å¾…è¯¥å…ƒç´ å‡ºç°å†ç‚¹å‡»ã€‚è¿™æ ·å¯ä»¥é¿å…å¾ˆå¤šè¿è¡Œæ—¶ æ²¡æœ‰æ‰¾åˆ°å…ƒç´ çš„é”™è¯¯</p><ol start="3"><li>æ¨¡ä»¿ç”¨æˆ·è¡Œä¸ºæµ‹è¯•çš„è¯ï¼Œæ„å‘³ç€ä½ è¦åšä¸€äº›å‰ç½®çš„å¤„ç† å¦‚<code>login.js</code>ï¼Œ è¦æŠŠè´¦å·å¯†ç ç­‰å†™åˆ°ä»£ç é‡Œé¢â€¦è™½ç„¶å¯ä»¥åŠ å¯† ä¸è¿‡è¿˜æ˜¯ä¼šå­˜åœ¨éƒ¨åˆ†æ³„éœ²é£é™©â€¦</li></ol><h1 id="è‡ªåŠ¨åŒ–æµ‹è¯•æœåŠ¡ç«¯-auto-test-backend-éƒ¨åˆ†"><a href="#è‡ªåŠ¨åŒ–æµ‹è¯•æœåŠ¡ç«¯-auto-test-backend-éƒ¨åˆ†" class="headerlink" title="è‡ªåŠ¨åŒ–æµ‹è¯•æœåŠ¡ç«¯(auto_test_backend)éƒ¨åˆ†"></a>è‡ªåŠ¨åŒ–æµ‹è¯•æœåŠ¡ç«¯(auto_test_backend)éƒ¨åˆ†</h1><p>å¯¹æ¯” <code>auto_test</code> éƒ¨åˆ†ï¼Œ <code>auto_test_backend</code>æ‰æ˜¯æˆ‘æœ€å¤´ç–¼çš„åœ°æ–¹ã€‚<br>æ¯•ç«Ÿä¸æ˜¯ç§‘ç­å‡ºèº«çš„å‰ç«¯ï¼Œå¯¹åç«¯æ€æƒ³ ä»¥åŠæ•°æ®åº“æ“ä½œä¹Ÿæ²¡ç¢°è¿‡= =emmm åšèµ·æ¥çœŸçš„æ˜¯è¶…çº§æ— æ•Œçš„è´¹åŠ²<br>ç‰¹åˆ«æ˜¯ è®¾è®¡æ•°æ®æ ¼å¼çš„æ—¶å€™ï¼Œéƒ½æ˜¯æ‹è„‘è¢‹å†³å®šäº†ã€‚ å’¦ æˆ‘åŠ ä¸ªå­—æ®µï¼Œ å’¦ æˆ‘æ”¹ä¸ªå­—æ®µ åˆä¸æ˜¯å¾ˆæ¸…æ¥šæ€ä¹ˆå¿«æ·æ“ä½œâ€¦. ä¼°è®¡æ˜¯ä¸ç†Ÿ <code>mongoose</code> çš„åŸå› â€¦.</p><p>è¿™ä¸ªé¡¹ç›®ç”¨çš„æ˜¯ <a href="eggjs.org/zh-cn/intro/quickstart.html">egg</a> æ¡†æ¶ï¼Œæ‰€ä»¥åŸºæœ¬é¡¹ç›®ç»“æ„éƒ½æ˜¯æŒ‰ç€eggçš„è§„èŒƒæ¥ã€‚</p><p>ç›®å½•ç»“æ„:<br><img src="./auto_test_backend_project.png" alt="auto_test_backend_project"></p><p>egg å¸®æˆ‘ä»¬åšäº†å¾ˆå¤šäº‹æƒ…ï¼Œå¼€å‘çš„æ—¶å€™åªè¦è·‘ä¸€ä¸‹ <code>npm run dev</code>ï¼Œå°±ä¼šå¯åŠ¨ä¸€ä¸ªé»˜è®¤ç«¯å£ä¸º<code>7001</code>çš„æœåŠ¡</p><p>å¯¹æˆ‘ä»¬ç°åœ¨æ¥è¯´ï¼ŒåŸºæœ¬åªæ˜¯æä¾› RESTAPIã€‚<br>å‰©ä¸‹çš„å°±ç®€å•å•¦ï¼Œåœ¨<code>app/router.js</code>å†™å¯¹åº”çš„è·¯ç”± å¦‚:<br><code>router.post(&#39;/api/v1/monitor&#39;, app.controller.monitor.create);</code> è¿™æ ·å¦‚æœæœ‰<code>post</code>è¯·æ±‚<code>:7001/api/v1/monitor</code> å°±ä¼šäº¤ç”± <code>monitor.create</code> è¿™ä¸ª <code>controller</code> å¤„ç†ã€‚</p><h2 id="è·¯ç”±é…ç½®-app-router-js"><a href="#è·¯ç”±é…ç½®-app-router-js" class="headerlink" title="è·¯ç”±é…ç½® app/router.js"></a>è·¯ç”±é…ç½® app/router.js</h2><p>ç›®å‰è·¯ç”±é…ç½®æ¯”è¾ƒç®€å•ï¼Œå°±é…ç½®äº†ä¸¤ä¸ªï¼Œä¸€ä¸ªç”¨æ¥å¤„ç†æ¥æ”¶ <code>auto_test</code>é¡¹ç›®ä¸­æµ‹è¯•ç»“æœï¼›ä¸€ä¸ªç”¨æ¥è¾“å‡ºæµ‹è¯•åˆ—è¡¨ã€‚</p><figure class="highlight javascript"><figcaption><span>app/router.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="params">app</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; router, controller &#125; = app;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// post è¯·æ±‚äº¤ç”±app.controller.monitor.createå¤„ç†</span></span><br><span class="line">  router.post(<span class="string">'/api/v1/monitor'</span>, app.controller.monitor.create);</span><br><span class="line">  <span class="comment">// get è¯·æ±‚äº¤ç”±app.controller.monitor.getå¤„ç†</span></span><br><span class="line">  router.get(<span class="string">'/api/v1/monitor'</span>, app.controller.monitor.get);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="controller-è§£æç”¨æˆ·çš„è¾“å…¥ï¼Œå¤„ç†åè¿”å›ç›¸åº”çš„ç»“æœ"><a href="#controller-è§£æç”¨æˆ·çš„è¾“å…¥ï¼Œå¤„ç†åè¿”å›ç›¸åº”çš„ç»“æœ" class="headerlink" title="controller è§£æç”¨æˆ·çš„è¾“å…¥ï¼Œå¤„ç†åè¿”å›ç›¸åº”çš„ç»“æœ"></a>controller è§£æç”¨æˆ·çš„è¾“å…¥ï¼Œå¤„ç†åè¿”å›ç›¸åº”çš„ç»“æœ</h2><p>eggå¸®æˆ‘ä»¬åšäº†å°è£…ï¼Œç›´æ¥åœ¨controlleræ–‡ä»¶å¤¹ä¸‹èµ·æ–‡ä»¶ï¼Œå†™å¯¹åº”çš„æ•°æ®ï¼Œåé¢å¯ä»¥ä»å…¨å±€å¯¹è±¡<code>app.controller.fileName.mothedName</code>å»è·å–å¯¹åº”çš„æ–¹æ³•ï¼Œæ¯”å¦‚ç°åœ¨æœ‰è¿™ä¸ªæ–‡ä»¶ <code>app/controller/test</code>ï¼Œé‚£ä¹ˆæˆ‘å¯ä»¥åœ¨å…¶ä»–åœ°æ–¹é€šè¿‡ <code>app.controller.test</code>å»è·å–ã€‚</p><p>è¿™é‡Œæ‹¿ <code>app.controller.monitor.get</code> ä¸¾ä¾‹</p><p>monitor.get æ–¹æ³•è¦åšçš„äº‹æƒ…æœ‰</p><ul><li>éªŒè¯ç»“æ„çš„è¯·æ±‚å‚æ•°è§„åˆ™</li><li>å¤„ç†æŸ¥è¯¢å‚æ•°</li><li>å¤„ç†åˆ†é¡µçš„é—®é¢˜</li><li>è°ƒservice è·å–æ•°æ®</li><li>å¤„ç†æ•°æ®</li><li>è°ƒç”¨restä¸­é—´ä»¶å‘é€æ•°æ®</li></ul><p>éªŒè¯å‚æ•°ï¼Œè¿™é‡Œç”¨åˆ°çš„æ˜¯ <a href="https://github.com/eggjs/egg-validate" target="_blank" rel="noopener">egg-validate</a>æ’ä»¶ï¼Œç›´æ¥é…ç½®å°±å¯ä»¥ç”¨äº†</p><figure class="highlight javascript"><figcaption><span>config/plugin.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">exports.validate = &#123;</span><br><span class="line">  enable: <span class="literal">true</span>,</span><br><span class="line">  package: <span class="string">'egg-validate'</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><figcaption><span>app/controller/monitor.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Controller = <span class="built_in">require</span>(<span class="string">'egg'</span>).Controller;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="class"><span class="keyword">class</span> <span class="title">MonitorController</span> <span class="keyword">extends</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> ctx = <span class="keyword">this</span>.ctx;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿™é‡ŒéªŒè¯å¤±è´¥ä¼šæŠ›å‡ºä¸€ä¸ª 422 çš„å¼‚å¸¸</span></span><br><span class="line">  ctx.validate(&#123;</span><br><span class="line">    start: &#123; <span class="attr">type</span>: <span class="string">'number'</span>, <span class="attr">require</span>: <span class="literal">false</span>&#125;,</span><br><span class="line">    <span class="comment">// end, state, paginationç­‰ç­‰å…¶ä»–å‚æ•°éªŒè¯</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è·å–ä¼ è¿‡æ¥çš„å‚æ•°</span></span><br><span class="line">  <span class="keyword">const</span> &#123; start, end, state, <span class="attr">pagination</span>: _pagination&#125; = ctx.query;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ ¹æ®è‡ªèº«ä¸šåŠ¡ å¤„ç†æŸ¥è¯¢å‚æ•°</span></span><br><span class="line">  (<span class="keyword">typeof</span> state !== <span class="string">'undefined'</span>) &amp;&amp; (params.state = state);</span><br><span class="line">  <span class="keyword">if</span> (start &amp;&amp; end) &#123;</span><br><span class="line">    <span class="built_in">Object</span>.assign(params, &#123;</span><br><span class="line">      time: &#123;</span><br><span class="line">        $gte: start,</span><br><span class="line">        $lte: end,</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¤„ç†åˆ†é¡µå‚æ•°</span></span><br><span class="line">  <span class="keyword">const</span> paramsPagination = <span class="built_in">Object</span>.assign(&#123; <span class="attr">size</span>: <span class="number">20</span>, <span class="attr">page</span>: <span class="number">1</span> &#125;, <span class="built_in">JSON</span>.parse(_pagination || <span class="string">'&#123;&#125;'</span>));</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è°ƒ service è·å–æ•°æ®</span></span><br><span class="line">  <span class="comment">// serviceä¹Ÿå’Œ controller ä¸€æ ·ï¼Œeggåšäº†æ–‡ä»¶çš„æ˜ å°„ï¼Œç›´æ¥ ctx.serviceèƒ½å¾ˆæ–¹ä¾¿çš„å»è·å–</span></span><br><span class="line">  <span class="keyword">const</span> &#123; list, pagination &#125; = <span class="keyword">await</span> ctx.service.monitor.find(&#123; params, ...paramsPagination &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¤„ç†æ•°æ®</span></span><br><span class="line">  list.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    item.img_url = <span class="string">`http://localhost:7001<span class="subst">$&#123;item.img_url&#125;</span>`</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è°ƒ restä¸­é—´ä»¶ å¤„ç†è¿”å›æ•°æ®</span></span><br><span class="line">  ctx.rest(&#123;</span><br><span class="line">    list,</span><br><span class="line">    pagination,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="service-å¤„ç†ä¸€äº›å’Œæ•°æ®åº“äº¤äº’çš„é€»è¾‘"><a href="#service-å¤„ç†ä¸€äº›å’Œæ•°æ®åº“äº¤äº’çš„é€»è¾‘" class="headerlink" title="service å¤„ç†ä¸€äº›å’Œæ•°æ®åº“äº¤äº’çš„é€»è¾‘"></a>service å¤„ç†ä¸€äº›å’Œæ•°æ®åº“äº¤äº’çš„é€»è¾‘</h2><p>serviceå’Œcontroller ä¸€æ ·ï¼Œeggå¸®æˆ‘ä»¬åšäº†ä¸€äº›æ–‡ä»¶çš„æ˜ å°„ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯ç›´æ¥åœ¨<code>app/service/monitor.js</code>å†™å¯¹åº”çš„é€»è¾‘å³å¯</p><p>è¿™ä¸€å—åº”è¯¥æ˜¯æœ€éº»çƒ¦çš„ï¼Œ mongoose api ä¸ç†Ÿï¼Œä¹Ÿä¸ç¡®å®šè¿™ä¹ˆå†™ä¼šä¸ä¼šæœ€ä¼˜,åˆä¸åˆç†ç­‰â€¦æœ‰æ—¶é—´æˆ–è€…ä»¥åæœ‰æœºä¼š ä¼šå»çœ‹ã€ŠSQLå¿…çŸ¥å¿…ä¼šã€‹ å­¦å­¦æ•°æ®åº“è¿™ä¸€å—è½¯è‚‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Service = <span class="built_in">require</span>(<span class="string">'egg'</span>).Service;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="class"><span class="keyword">class</span> <span class="title">MoitorService</span> <span class="keyword">extends</span> <span class="title">Service</span> </span>&#123;</span><br><span class="line">  <span class="keyword">async</span> find(&#123;params, size, page&#125;) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æŸ¥å¤åˆæ¡ä»¶çš„é¡µæ•°</span></span><br><span class="line">    <span class="keyword">const</span> count = <span class="keyword">await</span> <span class="keyword">this</span>.app.model.Monitor</span><br><span class="line">      .find(params).count();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¤„ç†åˆ†é¡µ</span></span><br><span class="line">    <span class="keyword">const</span> monitors = <span class="keyword">await</span> <span class="keyword">this</span>.app.model.Monitor</span><br><span class="line">      .find(params).sort(<span class="string">'time'</span>).select(<span class="string">'-__v'</span>)</span><br><span class="line">      .skip(size * (page<span class="number">-1</span>))</span><br><span class="line">      .limit(size).lean();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¤„ç†è¦è¿”å›çš„æ ¼å¼</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      list: monitors,</span><br><span class="line">      pagination: &#123;</span><br><span class="line">        count, size, page,</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">` </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## middleware ä¸­é—´ä»¶</span></span><br><span class="line"><span class="string">egg å…¶å®åŸºäºkoaå®ç°çš„ï¼Œæ‰€ä»¥å¯¹ä¸­é—´ä»¶å½¢å¼å’Œkoaä¸€æ ·æ˜¯æ´‹è‘±åœˆæ¨¡å‹ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">é›†æˆä¸­é—´ä»¶ä¹Ÿå¾ˆç®€å•ï¼Œåœ¨`</span>app/middleware/<span class="string">`ä¸‹å†™å¯¹åº”çš„ä¸­é—´ä»¶ï¼Œå†åœ¨ `</span>config/config.default.js<span class="string">`ä¸‹é…ç½®å³å¯å¯ç”¨ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å†™ä¸­é—´ä»¶</span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>javascript app/middleware/error_handler.js</span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="params">()</span>=&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">errorHandler</span>(<span class="params">ctx, next</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">await</span> next();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">      <span class="comment">// æ‰€æœ‰å¼‚å¸¸éƒ½åœ¨ app ä¸Šè§¦å‘ä¸€ä¸ª error äº‹ä»¶</span></span><br><span class="line">      ctx.app.emit(<span class="string">'error'</span>, err, ctx);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> status = err.status || <span class="number">500</span>;</span><br><span class="line">      <span class="comment">// ç”Ÿäº§ç¯å¢ƒæ—¶ 500 é”™è¯¯çš„è¯¦ç»†é”™è¯¯å†…å®¹ä¸è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯</span></span><br><span class="line">      <span class="keyword">const</span> error = status === <span class="number">500</span> &amp;&amp; ctx.app.config.env === <span class="string">'prod'</span></span><br><span class="line">        ? <span class="string">'Internal Server Error'</span></span><br><span class="line">        : err.message;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// ä» error å¯¹è±¡ä¸Šè¯»å‡ºå„ä¸ªå±æ€§ è®¾ç½®åˆ°å“åº”ä¸­</span></span><br><span class="line">      ctx.body = &#123; error &#125;;</span><br><span class="line">      <span class="keyword">if</span> (status === <span class="number">422</span>) &#123;</span><br><span class="line">        ctx.body.detail = err.errors;</span><br><span class="line">      &#125;</span><br><span class="line">      ctx.status = status;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ·»åŠ é…ç½®<br><figure class="highlight javascript"><figcaption><span>app/config/config.default.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="params">appInfo</span>=&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> config = &#123;</span><br><span class="line">    <span class="comment">// ä¸­é—´ä»¶é…ç½®</span></span><br><span class="line">    middleware: [<span class="string">'errorHandler'</span>],</span><br><span class="line"></span><br><span class="line">    <span class="comment">// errorHandleré…ç½®ï¼Œåªå¯¹ /api å¼€å¤´çš„è·¯ç”±åšå¤„ç†</span></span><br><span class="line">    errorHandler: &#123;</span><br><span class="line">      match: <span class="string">'/api'</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> config;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="é˜ˆå€¼å‘é€é‚®ä»¶åŠŸèƒ½"><a href="#é˜ˆå€¼å‘é€é‚®ä»¶åŠŸèƒ½" class="headerlink" title="é˜ˆå€¼å‘é€é‚®ä»¶åŠŸèƒ½"></a>é˜ˆå€¼å‘é€é‚®ä»¶åŠŸèƒ½</h2><p>è¿™ä¸€å—è¦ç»´æŠ¤ä¸¤ä¸ªä¸´æ—¶å˜é‡æ•°ç»„ï¼Œä¸‰ä¸ªé…ç½®å‚æ•°<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> temp = &#123;&#125;;</span><br><span class="line">temp.errorObj = &#123;</span><br><span class="line">  errorArray: [], <span class="comment">// ç”¨æ¥å­˜æ¯æ¬¡é”™è¯¯ä¸ŠæŠ¥çš„æ—¶é—´æˆ³</span></span><br><span class="line">  sendArray: [], <span class="comment">// ç”¨æ¥å­˜æ¯æ¬¡å‘é€çš„æ—¶é—´æˆ³</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> errorConfig = &#123;</span><br><span class="line">  maxCount: <span class="number">5</span>, <span class="comment">// å•ä½æ—¶é—´è¶…è¿‡næ¬¡å°±æŠ¥è­¦</span></span><br><span class="line">  unitTime: <span class="number">30</span>, <span class="comment">// å•ä½æ—¶é—´ä¸ºï¼šnåˆ†é’Ÿ</span></span><br><span class="line">  maxSend: <span class="number">2</span>, <span class="comment">// å•ä½æ—¶é—´æœ€å¤šå‘nå°é‚®ä»¶</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">å¤§æ¦‚çš„é€»è¾‘æ˜¯ï¼Œ æ¯æ¬¡æŠ¥é”™çš„æ—¶å€™ï¼Œ errorArray å¡å…¥ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œç„¶ååˆ¤æ–­ï¼š</span><br><span class="line"><span class="number">1.</span> åˆ¤æ–­æ˜¯å¦åˆ°è¾¾å‘é€é˜ˆå€¼</span><br><span class="line"><span class="number">2.</span> æ ¹æ®å½“å‰çš„æ—¶é—´æˆ³å’Œé…ç½®æ¥æ¸…ç†è¿‡æœŸçš„æ•°æ®</span><br><span class="line"><span class="number">3.</span> åˆ¤æ–­å•ä½æ—¶é—´å†…æ˜¯å¦è¾¾åˆ°å‘é€é˜ˆå€¼</span><br><span class="line"><span class="number">4.</span> åˆ¤æ–­å•ä½æ—¶é—´å†…æ˜¯å¦è¶…è¿‡å‘é€æ¬¡æ•°</span><br><span class="line"><span class="number">5.</span> æ„å»ºå‘é€å†…å®¹ï¼Œ ğŸš€  å¤„ç†åç»­çš„è®°å½•æ“ä½œ</span><br></pre></td></tr></table></figure></p><p>ç”¨åˆ°çš„å‘é‚®ä»¶æ’ä»¶æ˜¯ <a href="https://www.jianshu.com/p/ee200a67853c" target="_blank" rel="noopener">nodemailer</a> ç®€å•ç²—æš´ ç”¨è¿‡éƒ½è¯´å¥½</p><h2 id="and"><a href="#and" class="headerlink" title="and"></a>and</h2><p>å…¶å® <code>auto_test_project</code> æœ€éº»çƒ¦çš„æ˜¯åœ¨å®šä¹‰æ•°æ®åº“æ ¼å¼çš„æ—¶å€™ï¼Œç»å¸¸å®šä¹‰å°‘ä¸€äº›å…³é”®çš„å­—æ®µï¼ˆç›®å‰è‚¯å®šä¹Ÿè¿˜å­˜åœ¨è¿™ç§æƒ…å†µçš„ï¼‰ã€‚<br>è¿˜æœ‰å°±æ˜¯æœ¬æ¥ä»¥ä¸ºå’Œ <code>angular</code> ä¸€æ ·ï¼Œ<code>controller</code> ä¼šå¡å¤§é‡çš„ä¸šåŠ¡é€»è¾‘ï¼Œ ç­‰åˆ°åé¢æœ‰ä¸€ä¸ªåœºæ™¯æ˜¯è¦åœ¨æŸä¸ª <code>controller</code>è°ƒç”¨å¦ä¸€ä¸ª<code>controller</code> æ—¶æ‰å‘ç°ï¼ŒåŸæ¥ controller ä¸»è¦çš„èŒè´£æ˜¯è´Ÿè´£å¤„ç†è·¯ç”±å’Œä¸€äº›å‚æ•°éªŒè¯è¾“å‡ºç­‰æ¯”è¾ƒå¯¹å¤–çš„å·¥ä½œï¼Œå¯¹å†…çš„åŸºæœ¬éƒ½å†™æˆäº†<code>service</code>ã€‚</p><p>å‰ç«¯çš„å°ä¼™ä¼´å¾ˆå¤šäººæ‡‚node å¯èƒ½ä¹Ÿåªæ˜¯æ‡‚nodeçš„è¯­æ³•å±‚ è¦æƒ³çœŸçš„å†™åå°æˆ–è€…å¾®å…¨æ ˆï¼Œè¿˜æ˜¯æœ‰å¾ˆå¤šä¸œè¥¿è¦å­¦çš„ã€‚</p><h1 id="åˆ—è¡¨å±•ç¤º-admin-é¡¹ç›®"><a href="#åˆ—è¡¨å±•ç¤º-admin-é¡¹ç›®" class="headerlink" title="åˆ—è¡¨å±•ç¤º(admin)é¡¹ç›®"></a>åˆ—è¡¨å±•ç¤º(admin)é¡¹ç›®</h1><p>åˆ—è¡¨å±•ç¤ºç›¸å¯¹ç®€å•ï¼Œæ²¡ä»€ä¹ˆå¥½è®²çš„ã€‚æƒ³ç”¨ä»€ä¹ˆæŠ€æœ¯æ ˆéƒ½æ¯”è¾ƒéšæ„ï¼Œreact,vueç”šè‡³hbsæˆ–è€…ç›´æ¥åœ¨jsé‡Œé¢å†™htmlå­—ç¬¦ä¸²å¾ªç¯éƒ½okã€‚</p><p>è¿™é‡Œæ¨ä¸€ä¸‹ä¸€ç¯‡æ–‡ç« ï¼Œä»‹ç»å·¥ä½œä¸­çš„ä¸€ä¸ªé¡¹ç›® <a href="https://jsonz1993.github.io/2018/02/react%E5%85%A8%E5%AE%B6%E6%A1%B6-dva-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%95%B4%E7%90%86%E6%80%BB%E7%BB%93/">reactå…¨å®¶æ¡¶ &amp;&amp; dvaæœ€ä½³å®è·µ</a></p><h1 id="end"><a href="#end" class="headerlink" title="end"></a>end</h1><p>è·‘è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬(auto_test)çš„log<br><img src="./log.png" alt="log.png"></p><p>è‡ªåŠ¨åŒ–æµ‹è¯•æˆåŠŸåæäº¤æ•°æ®(admin)<br><img src="./success.png" alt="success"></p><p>è‡ªåŠ¨åŒ–æµ‹è¯•å¤±è´¥åå°†æ•°æ®ä¸ŠæŠ¥(admin) åŒ…å«äº†æ ‡é¢˜ï¼ŒæŠ¥é”™ä¿¡æ¯ï¼Œé“¾æ¥ï¼Œæˆªå›¾ï¼Œæ ‡è®°ç­‰<br><img src="./admin.png" alt="admin"></p><p>æ–‡ç« ä½œä¸ºå­¦ä¹ çš„è®°å½•åˆ°æ­¤ç»“æŸï¼Œè¿™ä¸ªé¡¹ç›®ä¸»è¦å­¦ä¹ äº† egg,mongodb,puppeteer ç­‰ è¿˜æ˜¯æŒºæœ‰æ”¶è·çš„.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;å¾—ç›Šäºè°·æ­Œå¼€æºäº† &lt;a href=&quot;https://gith
      
    
    </summary>
    
      <category term="technology" scheme="https://jsonz1993.github.io/categories/technology/"/>
    
    
      <category term="learn" scheme="https://jsonz1993.github.io/tags/learn/"/>
    
      <category term="work" scheme="https://jsonz1993.github.io/tags/work/"/>
    
      <category term="github" scheme="https://jsonz1993.github.io/tags/github/"/>
    
      <category term="JavaScript" scheme="https://jsonz1993.github.io/tags/JavaScript/"/>
    
      <category term="puppeteer" scheme="https://jsonz1993.github.io/tags/puppeteer/"/>
    
      <category term="node" scheme="https://jsonz1993.github.io/tags/node/"/>
    
  </entry>
  
  <entry>
    <title>é¡¹ç›®ä»£ç è§„èŒƒå·¥ä½œæµâ€”â€”editorã€prettierã€eslintã€git-check</title>
    <link href="https://jsonz1993.github.io/2018/03/%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83%E5%B7%A5%E4%BD%9C%E6%B5%81%E2%80%94%E2%80%94editor%E3%80%81prettier%E3%80%81eslint%E3%80%81git-check/"/>
    <id>https://jsonz1993.github.io/2018/03/é¡¹ç›®ä»£ç è§„èŒƒå·¥ä½œæµâ€”â€”editorã€prettierã€eslintã€git-check/</id>
    <published>2018-03-29T10:21:28.000Z</published>
    <updated>2019-03-13T03:30:36.804Z</updated>
    
    <content type="html"><![CDATA[<h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>æœ€è¿‘éƒ¨é—¨è¿›äº†æŒºå¤šæ–°å‰ç«¯ï¼Œæœ‰å®ä¹ ç”Ÿ æœ‰åº”å±Šç”Ÿï¼Œäººä¸€å¤š<br>ä»£ç è§„èŒƒå°±ä¸èƒ½å®Œå…¨ä¾èµ– â€œå£å£ç›¸ä¼ â€ å»çº¦æŸäº†ï¼Œ ç‰¹åˆ«æ˜¯çœ‹åˆ°ä¸€å †çš„ æœ‰åˆ†å·ï¼Œæ— åˆ†å·ï¼Œå››ç¼©è¿›ï¼ŒäºŒç¼©è¿›ç­‰é—®é¢˜</p><p>å¯¹äºæœ‰å°å°ä»£ç æ´ç™–çš„æˆ‘å®åœ¨æ˜¯å—ä¸äº† äºæ˜¯ç»ˆäºåœ¨é¡¹ç›®ä¸­ é›†æˆå„ç§ç”¨æ¥ è§„èŒƒï¼ˆçº¦æŸï¼‰çš„å·¥å…·ã€‚</p><p>ä¸»è¦æœ‰ï¼š</p><ul><li>editorConfig ç¼–è¾‘å™¨é…ç½®æ–‡ä»¶</li><li>Prettier æ‰¹é‡æ ¼å¼åŒ–ä»£ç </li><li>Eslint jsã€jsx æ–‡ä»¶ä»£ç æ£€æŸ¥è§„èŒƒ</li><li>Flow (æš‚æœªé›†æˆ)</li><li>lint-staged æäº¤åˆ°gitä¹‹å‰è·‘ä¸€æ¬¡ä»£ç æ£€æŸ¥</li></ul><p>æœ¬åœ°ä¸€äº›ç¯å¢ƒï¼š<code>node 8.9.4</code>, <code>npm 5.6.0</code>, <code>oxs 10.13.3</code>ï¼Œ ç¼–è¾‘å™¨ <code>vscodeeeeee</code></p><h1 id="EditorConfig"><a href="#EditorConfig" class="headerlink" title="EditorConfig"></a>EditorConfig</h1><p>What is EditorConfig?<br>å®˜ç½‘ç»™å‡ºçš„ç­”æ¡ˆæ˜¯ï¼šeditorconfigå¸®åŠ©å¼€å‘äººå‘˜åœ¨ä¸åŒçš„ç¼–è¾‘å™¨å’Œideä¹‹é—´å®šä¹‰å’Œç»´æŠ¤ä¸€è‡´çš„ç¼–ç é£æ ¼ã€‚<br><strong>ç®€å•æ¥è¯´å°±æ˜¯è·¨ç¼–è¾‘å™¨ä½¿ç”¨åŒä¸€ä»½ä»£ç ç¼©è¿›ç­‰é…ç½®</strong></p><p>EditorConfig é›†æˆèµ·æ¥ååˆ†ç®€å•ï¼Œ å¤§æ¦‚å°±æ˜¯åˆ›å»ºé…ç½®æ–‡ä»¶ï¼Œå®‰è£…ç›¸åº”çš„ç¼–è¾‘å™¨æ’ä»¶å³å¯ã€‚</p><ol><li>åˆ›å»º <a href="http://editorconfig.org/#example-file" target="_blank" rel="noopener"><code>.editorconfig</code></a> æ–‡ä»¶</li><li><a href="http://editorconfig.org/#download" target="_blank" rel="noopener">å®‰è£…å¯¹åº”ç¼–è¾‘å™¨çš„æ’ä»¶</a></li></ol><p>æˆ‘ç”¨çš„æ˜¯ vscode ç›´æ¥å®‰è£…è¿™ä¸ª <code>EditorConfig for vs code</code>ï¼Œå®‰è£…å®Œé‡å¯ï¼Œç¼–è¾‘å™¨å°±ä¼šæ ¹æ®é…ç½®æ–‡ä»¶é‡Œé¢çš„é…ç½®æ¥æ§åˆ¶ä»£ç ç¼©è¿›ç­‰è¡Œä¸º</p><p>é™„ä¸Šé¡¹ç›®çš„é…ç½®æ–‡ä»¶<br><figure class="highlight"><figcaption><span>.editorconfig</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root = true</span><br><span class="line"></span><br><span class="line">[*]</span><br><span class="line">charset = utf-8</span><br><span class="line">end_of_line = lf # mac linux/unix éƒ½ç”¨lfã€‚ window è®¾ç½® cr åœ¨ *nix æœ‰é—®é¢˜</span><br><span class="line">indent_size = 4</span><br><span class="line">indent_style = space</span><br><span class="line">max_line_length = 120</span><br><span class="line">trim_trailing_whitespace = true</span><br><span class="line"></span><br><span class="line">[*.jsx]</span><br><span class="line">indent_size= 2</span><br></pre></td></tr></table></figure></p><h1 id="Prettier"><a href="#Prettier" class="headerlink" title="Prettier"></a>Prettier</h1><p>ç°åœ¨æœ‰äº†ä¸€äº›åŸºæœ¬çš„é…ç½®ï¼Œä»¥åå†™çš„ä»£ç å°±å¯ä»¥æ¯”è¾ƒè§„èŒƒä¸€ç‚¹ç‚¹ç‚¹ï¼Œä½†æ˜¯åŸæ¥çš„æ—§ä»£ç æ€ä¹ˆåŠå‘¢ï¼Ÿ<br>ä¸å¯èƒ½ä¸€ä¸ªæ–‡ä»¶ä¸€ä¸ªæ–‡ä»¶å»æ‰“å¼€å§ï¼Œä¸å®Œå…¨ç»Ÿè®¡ é¡¹ç›®æœ‰ä¸Šåƒä¸ªç¼–è¾‘çš„æ–‡ä»¶â€¦.ä¸€ä¸ªä¸€ä¸ªå»æ‰‹åŠ¨æ‰“å¼€ä¸ç¬¦åˆç¨‹åºå‘˜çš„é£æ ¼</p><p>soâ€¦ <a href="https://prettier.io/" target="_blank" rel="noopener">Prettier</a>å°±æ˜¯ä¸ºæˆ‘ä»¬åšè¿™äº›äº‹æƒ…çš„</p><ol><li>å®‰è£…: <code>npm i --save-dev prettier</code></li><li>åˆ›å»º <a href="https://prettier.io/docs/en/configuration.html" target="_blank" rel="noopener"><code>.prettierrc</code>é…ç½®æ–‡ä»¶</a><br>è¯¥é…ç½®æ–‡ä»¶ä¼šç»§æ‰¿<code>editorConfig</code>çš„é…ç½®</li><li>å‘<code>package.json</code>æ·»åŠ è„šæœ¬: <code>&quot;prettier&quot;: &quot;prettier --write ./*&quot;</code><blockquote><p>æˆ‘é¡¹ç›®é‡Œé¢ç”¨çš„æ˜¯ <code>&quot;prettier&quot;: &quot;prettier --write &#39;./src/**/*.js&#39; &#39;./src/**/*.jsx&#39; &#39;./src/**/*.css&#39; &#39;./src/**/*.scss&#39;&quot;,</code></p></blockquote></li><li>åˆ›å»º <code>.prettierignore</code> æ–‡ä»¶ï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›æ–‡ä»¶ &amp;&amp; ç›®å½•</li><li>ä¸€åˆ‡å‡†å¤‡å°±ç»ªä¹‹å !!!! <code>npm run prettier</code> å‘¼å‘¼ çœ‹åˆ°æç¤ºä¸€åƒä¸ªæ–‡ä»¶æ›´æ”¹è®°å½• å“ˆå“ˆå“ˆ</li></ol><p>é™„ä¸Šé…ç½®æ–‡ä»¶:<br><figure class="highlight javascript"><figcaption><span>.prettierrc.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// https://prettier.io/docs/en/options.html</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    trailingComma: <span class="string">"es5"</span>, <span class="comment">// æ•°ç»„ å¯¹è±¡å°¾éšé€—å· [arr, ] &#123; obj, &#125;</span></span><br><span class="line">    <span class="comment">// bracketSpacing: true, // å¯¹è±¡ç©ºæ ¼ &#123; foo: bar &#125;, false=&gt; &#123;foo:bar&#125;</span></span><br><span class="line"><span class="comment">// jsxBracketSameLine: false, // jsxé—­æ ‡ç­¾æ˜¯å¦å¦èµ·ä¸€è¡Œ &lt;Test&gt;&lt;/Test&gt;</span></span><br><span class="line"><span class="comment">// arrowParens: 'avoid', // ç®­å¤´å‡½æ•°æ˜¯å¦çœç•¥æ‹¬å· a=&gt; a, (a)=&gt; a</span></span><br><span class="line">    singleQuote: <span class="literal">true</span>, <span class="comment">// å•å¼•å·</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight javascript"><figcaption><span>.prettierignore</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/node_modules</span><br><span class="line">/dist</span><br><span class="line">/src/lib/</span><br><span class="line">/src/global/fonts</span><br></pre></td></tr></table></figure><h1 id="Eslint"><a href="#Eslint" class="headerlink" title="Eslint"></a>Eslint</h1><p>æœ‰äº†ä¸Šé¢ä»‹ç»çš„ <code>editor</code>ã€<code>prettier</code>è¿˜æ˜¯è¿œè¿œä¸å¤Ÿçš„ï¼Œå› ä¸º jsè¯­æ³• ä¸æ˜¯å¾ˆä¸¥æ ¼ï¼Œæ¯”å¦‚æœ‰æ²¡æœ‰åˆ†å·å•Š ä¹‹ç±»çš„é—®é¢˜è¿˜æ˜¯è¦ç”¨ eslint æ¥çº¦æŸçš„ã€‚</p><p>åœ¨å¾ˆå¤šå¹´å‰ï¼Œæˆ‘æ˜¯ç‰¹åˆ«åæ„Ÿ Eslint çš„ï¼Œå› ä¸ºç»å¸¸å†™å¾—ä¸€ç‚¹ä¸è§„èŒƒï¼Œç›´æ¥å°±æŠ¥ error æ•´ä¸ªé¡¹ç›®è·‘ä¸èµ·æ¥ã€‚<br>ä½†æ˜¯ å­˜åœ¨å³åˆç†ï¼Œç°åœ¨è§‰å¾—è¿™ä¸œè¥¿è´¼å¥½ç”¨ã€‚</p><ol><li>å®‰è£… eslint: <code>npm i --save-dev eslint</code></li><li>å¯åŠ¨å¼•å¯¼è„šæœ¬: <code>./node_modules/.bin/eslint --init</code> é…ç½® <code>.eslintrc</code>ã€‚<blockquote><p>è¿™é‡Œå¯ä»¥ç›´æ¥é€‰ <code>Use a popular style guide</code> ç„¶åé€‰è¡Œä¸šæ¯”è¾ƒçœ‹å¥½çš„è§„èŒƒ <code>airbnb</code>çš„ï¼ŒåŸå…ˆæ˜¯æ‰“ç®—é€‰è¿™ä¸ªï¼Œä½†æ˜¯åé¢å‘ç°å’Œé¡¹ç›®ç°æœ‰çš„è§„èŒƒå¾ˆä¸ç›¸åŒï¼Œæ‰€ä»¥åé¢å°±èµ°å›ç­”é—®é¢˜é€‰é¡¹ã€‚</p></blockquote></li><li>å‘ <code>package.json</code> æ·»åŠ è„šæœ¬: <code>&quot;eslint&quot;: &quot;eslint --fix ./&quot;</code><blockquote><p>æˆ‘å†™çš„æ˜¯ <code>&quot;eslint&quot;: &quot;eslint --fix &#39;./src/**/*.{jsx, js}&#39;&quot;,</code></p></blockquote></li><li>åˆ›å»º <code>.eslintignore</code> æ–‡ä»¶ï¼Œå¹¶å‘å…¶æ·»åŠ éœ€è¦å¿½ç•¥çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚</li><li>å®‰è£… <a href="https://eslint.org/docs/user-guide/integrations" target="_blank" rel="noopener">ç¼–è¾‘å™¨ eslint æ’ä»¶</a></li><li>é…ç½®ç¼–è¾‘å™¨ï¼Œæˆ‘è¿™é‡Œç”¨çš„æ˜¯ vscode<ul><li>â€œeslint.autoFixOnSaveâ€: true  <code>å¼€å¯eslint æ£€æŸ¥</code></li><li>â€œjavascript.validate.enableâ€: false <code>å…³é—­vscodeè‡ªå¸¦çš„jsæ£€æŸ¥</code></li></ul></li></ol><p>eslintæ’ä»¶ä¼šæ™ºèƒ½æ£€æŸ¥ç¼–è¾‘çŠ¶æ€çš„ JS æ–‡ä»¶ï¼Œå¹¶è‡ªåŠ¨ä¿®å¤ï¼›<code>npm run eslint</code> è„šæœ¬å¯ä»¥æ£€æŸ¥å’Œæ™ºèƒ½ä¿®å¤â€œå¯¹åº”çš„æ–‡ä»¶â€ã€‚ ä¸è¿‡äº²æµ‹ä¿®å¤çš„æ•ˆæœæ¯”è¾ƒä¸€èˆ¬ï¼Œæ›´å¤šçš„æŠ¥é”™éœ€è¦æ‰‹åŠ¨å»å¤„ç†</p><p>åœ¨é…ç½®eslintçš„æ—¶å€™ é‡åˆ°äº†å‡ ä¸ªæ¯”è¾ƒéƒé—·çš„åœ°æ–¹</p><h2 id="å¯ä»¥å…ˆæŠŠä¸€äº›æŠ¥é”™é¡¹æ”¹ä¸º-è­¦å‘Šé¡¹ï¼Œæ…¢æ…¢è¿­ä»£-å…å¾—ä¸€ä¸Šeslint-è¦åœå‡ å¤©æ¥ä¿®æ”¹åŸæ¥çš„æ–‡ä»¶"><a href="#å¯ä»¥å…ˆæŠŠä¸€äº›æŠ¥é”™é¡¹æ”¹ä¸º-è­¦å‘Šé¡¹ï¼Œæ…¢æ…¢è¿­ä»£-å…å¾—ä¸€ä¸Šeslint-è¦åœå‡ å¤©æ¥ä¿®æ”¹åŸæ¥çš„æ–‡ä»¶" class="headerlink" title="å¯ä»¥å…ˆæŠŠä¸€äº›æŠ¥é”™é¡¹æ”¹ä¸º è­¦å‘Šé¡¹ï¼Œæ…¢æ…¢è¿­ä»£ å…å¾—ä¸€ä¸Šeslint è¦åœå‡ å¤©æ¥ä¿®æ”¹åŸæ¥çš„æ–‡ä»¶"></a>å¯ä»¥å…ˆæŠŠä¸€äº›æŠ¥é”™é¡¹æ”¹ä¸º è­¦å‘Šé¡¹ï¼Œæ…¢æ…¢è¿­ä»£ å…å¾—ä¸€ä¸Šeslint è¦åœå‡ å¤©æ¥ä¿®æ”¹åŸæ¥çš„æ–‡ä»¶</h2><h2 id="ä¸€äº›ç®€å•çš„å¤„ç†å¯ä»¥å†™è„šæœ¬å»åš"><a href="#ä¸€äº›ç®€å•çš„å¤„ç†å¯ä»¥å†™è„šæœ¬å»åš" class="headerlink" title="ä¸€äº›ç®€å•çš„å¤„ç†å¯ä»¥å†™è„šæœ¬å»åš"></a>ä¸€äº›ç®€å•çš„å¤„ç†å¯ä»¥å†™è„šæœ¬å»åš</h2><p>æ¯”å¦‚è¯´ä¹‹å‰é¡¹ç›®å†™çš„æ¯”è¾ƒä¸è§„èŒƒï¼Œå‡ºç°äº†å¾ˆå¤šç±»ä¼¼ï¼š<code>export default from &#39;file-path&#39;</code>çš„è¯­å¥ï¼Œä½†æ˜¯eslintä¸è®¤ï¼Œè§‰å¾—è¿™æ˜¯ä¸ç¬¦åˆè§„èŒƒçš„ï¼Œéœ€è¦æ”¹ä¸º <code>export { default } from &#39;file-path&#39;</code></p><p>è¿™ç‚¹æˆ‘ä¹Ÿæ¯”è¾ƒè®¤åŒï¼Œä½†æ˜¯ è¿™ä¹ˆå¤šä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªä¸€ä¸ªæ”¹æ˜¯ä¸å­˜åœ¨çš„ï¼Œæ‰€ä»¥å†™äº†ä¸ªçŸ­è„šæœ¬å»å¤„ç†</p><figure class="highlight javascript"><figcaption><span>fix-export-default</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">scan</span>(<span class="params">&#123;dirPath&#125;</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> isDirectory = fs.statSync(dirPath).isDirectory();</span><br><span class="line">    <span class="keyword">if</span> (isDirectory) &#123;</span><br><span class="line">        <span class="keyword">const</span> childs = fs.readdirSync(dirPath);</span><br><span class="line">        childs.forEach(<span class="function"><span class="params">child</span>=&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> nextPath = path.join(dirPath, child);</span><br><span class="line">            <span class="keyword">const</span> stat = fs.statSync(nextPath);</span><br><span class="line">            <span class="keyword">const</span> isDirectory = stat.isDirectory();</span><br><span class="line">            <span class="keyword">const</span> isFile = stat.isFile();</span><br><span class="line">            <span class="keyword">const</span> extname = isFile &amp;&amp; path.extname(child);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ–‡ä»¶å¤¹ç±»å‹ é€’å½’</span></span><br><span class="line">            <span class="keyword">if</span> (isDirectory) scan(&#123;<span class="attr">dirPath</span>: nextPath&#125;);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ’é™¤ä¸æ˜¯ js jsx çš„æ–‡ä»¶</span></span><br><span class="line">            <span class="keyword">if</span> (![<span class="string">'.js'</span>, <span class="string">'.jsx'</span>].includes(extname)) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å¼€å§‹è¯»æ–‡ä»¶</span></span><br><span class="line">            <span class="keyword">let</span> fileStr = fs.readFileSync(nextPath) +<span class="string">''</span>;</span><br><span class="line">            <span class="keyword">const</span> exg = <span class="regexp">/export default from/gi</span>;</span><br><span class="line">            <span class="keyword">if</span> (exg.exec(fileStr))</span><br><span class="line">                fileStr = fileStr.replace(<span class="string">'export default from'</span>, <span class="string">'export &#123;default&#125; from'</span>);</span><br><span class="line">            fs.writeFileSync(nextPath, fileStr, &#123;<span class="attr">encoding</span>: <span class="string">'utf-8'</span>&#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">scan(&#123;</span><br><span class="line">    dirPath: path.join(process.cwd(), <span class="string">'/src'</span>),</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="webpackåˆ«åå¼•ç”¨-è·¯å¾„æŠ¥é”™é—®é¢˜"><a href="#webpackåˆ«åå¼•ç”¨-è·¯å¾„æŠ¥é”™é—®é¢˜" class="headerlink" title="webpackåˆ«åå¼•ç”¨ è·¯å¾„æŠ¥é”™é—®é¢˜"></a>webpackåˆ«åå¼•ç”¨ è·¯å¾„æŠ¥é”™é—®é¢˜</h2><p>å®‰è£…å¯¹åº”çš„ eslint å¤„ç†æ’ä»¶: <code>npm i --save-dev eslint-import-resolver-webpack eslint-plugin-import</code></p><p>åœ¨ <code>.eslint.js</code> é‡Œé¢åŠ è¿™æ®µé…ç½®</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"settings"</span>: &#123;</span><br><span class="line">  <span class="string">'import/resolver'</span>: &#123;</span><br><span class="line">      webpack: &#123;</span><br><span class="line">          config: getWebpackConfig, <span class="comment">// è¿™é‡Œæ˜¯webpacké…ç½®è·¯å¾„</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h2 id="å…¶ä»–æ³¨æ„é—®é¢˜"><a href="#å…¶ä»–æ³¨æ„é—®é¢˜" class="headerlink" title="å…¶ä»–æ³¨æ„é—®é¢˜"></a>å…¶ä»–æ³¨æ„é—®é¢˜</h2><p>é¡¹ç›®æ˜¯åœ¨ æµè§ˆå™¨è¿è¡Œï¼Œ åˆæ˜¯ es6è¯­æ³•ï¼Œ åˆæœ‰ä¸€äº›nodeè„šæœ¬ï¼Œä¼šæœ‰ä¸€äº›å…¨å±€çš„å˜é‡å¼•ç”¨æç¤ºæŠ¥é”™ï¼Œæ€ä¹ˆåŠï¼Ÿ<br>æ”¹é…ç½®!<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"env"</span>: &#123;</span><br><span class="line">    browser: <span class="literal">true</span>,</span><br><span class="line">    es6: <span class="literal">true</span>,</span><br><span class="line">    node: <span class="literal">true</span>,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p><p>é¡¹ç›®æ˜¯åç«¯æ¨¡ç‰ˆæ¸²æŸ“çš„ï¼Œä¼šæœ‰ä¸€äº›å…¨å±€å˜é‡ï¼ŒeslintæŠ¥é”™æ€ä¹ˆåŠï¼Ÿ<br>æ”¹é…ç½®!<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"globals"</span>: &#123;</span><br><span class="line">    __DEV__: <span class="literal">true</span>,</span><br><span class="line">    __HTTPS__: <span class="literal">true</span>,</span><br><span class="line">    FB: <span class="literal">true</span>,</span><br><span class="line">    ga: <span class="literal">true</span>,</span><br><span class="line">    $: <span class="literal">true</span>,</span><br><span class="line">    ercjs: <span class="literal">true</span>,</span><br><span class="line">    google: <span class="literal">true</span>,</span><br><span class="line">    IS_APP: <span class="literal">true</span>,</span><br><span class="line">    i18n: <span class="literal">true</span>,</span><br><span class="line">    Zepto: <span class="literal">true</span>,</span><br><span class="line">    AdjustEvent: <span class="literal">true</span>,</span><br><span class="line">    Adjust: <span class="literal">true</span>,</span><br><span class="line">    fbq: <span class="literal">true</span>,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p><p>é¡¹ç›®ç”¨äº†å¾ˆå¤šæ–°è¯­æ³• eslint ä¸è¯†åˆ«, ç”¨äº† react æ€ä¹ˆåŠï¼Ÿ<br>æ”¹é…ç½®â€¦å…·ä½“çš„ è°·æ­Œä¸€ä¸‹ ä¸€å †ç­”æ¡ˆ ä¸å†èµ˜è¿°</p><h1 id="Flow"><a href="#Flow" class="headerlink" title="Flow"></a>Flow</h1><p>Flowå¯ä»¥ç†è§£ä¸º å¾ˆè½»é‡å‹ æ— ä¾µå…¥çš„ é™æ€ç±»å‹æ£€æŸ¥<br>é¡¹ç›®æš‚æ—¶æ²¡æœ‰è€ƒè™‘é›†æˆï¼Œæ‰€ä»¥è¿™é‡Œä¸åšè¿‡å¤šä»‹ç»</p><h1 id="git-check"><a href="#git-check" class="headerlink" title="git-check"></a>git-check</h1><p>æ—¢ç„¶æˆ‘ä»¬ æœ‰äº†ç¼–è¾‘å™¨çš„é…ç½®ï¼Œ jsç¼–è¾‘å®æ—¶æ£€æŸ¥ï¼Œ ä½†æ˜¯å¦‚æœæœ‰äº›å°ä¼™ä¼´ä¸éµå®ˆè§„åˆ™ æäº‹æƒ…æ€ä¹ˆåŠå‘¢ï¼Ÿ<br>è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥åœ¨æœ€åä¸€ä¸ªæµç¨‹åŠ ä¸ŠéªŒè¯çš„éƒ¨åˆ†ï¼Œ  åœ¨git æäº¤çš„æ—¶å€™è·‘ä¸€äº›è„šæœ¬å»éªŒè¯ï¼Œå¦‚æœé€šè¿‡å°±ç»™æäº¤ï¼Œä¸é€šè¿‡å°±æç¤ºé”™è¯¯</p><p><a href="https://github.com/okonet/lint-staged" target="_blank" rel="noopener">lint-staged</a> å¯ä»¥å¸®æˆ‘ä»¬åšè¿™äº›äº‹æƒ…</p><ol><li>å®‰è£… lint-staged husky: <code>npm i --save-dev lint-staged husky</code></li><li>å‘ <code>package.json</code> æ·»åŠ è¿è¡Œè„šæœ¬ <code>&quot;precommit&quot;: &quot;lint-staged&quot;</code><blockquote><p>è¿™æ—¶å€™åœ¨git commit ä¹‹å‰ä¼šè·‘ lint-stagedçš„ä¸œè¥¿</p></blockquote></li><li>å†å‘ <code>package.json</code> æ·»åŠ å†…å®¹:  æ³¨æ„ï¼Œè¿™æ—¶å€™ä¸æ˜¯åŠ åœ¨ <code>scripts</code>é‡Œé¢ï¼Œè€Œæ˜¯åŠ åœ¨åŒçº§<br><code>&quot;lint-staged&quot;: { // ä¸Šé¢æä¾›çš„â€œè‡ªåŠ¨åŒ–è„šæœ¬â€ &quot;*.js&quot;: [&quot;eslint --fix&quot;, &quot;git add&quot;], &quot;*.json&quot;: [&quot;prettier --write&quot;, &quot;git add&quot;], &quot;*.css&quot;: [&quot;prettier --write&quot;, &quot;git add&quot;], &quot;*.scss&quot;: [&quot;prettier --write&quot;, &quot;git add&quot;], &quot;*.md&quot;: [&quot;prettier --write&quot;, &quot;git add&quot;]}</code><blockquote><p>å› ä¸ºé¡¹ç›®æ˜¯æœ¬åœ°æ‰“åŒ…å†æ¨è¿œç¨‹ï¼Œæ‰€ä»¥æˆ‘çš„é…ç½®æ˜¯æŒ‡å®šäº† srcä¸‹çš„<br><code>&quot;src/**/*.js&quot;: [&quot;eslint --fix&quot;,&quot;git add&quot;],&quot;src/**/*.jsx&quot;: [&quot;eslint --fix&quot;,&quot;git add&quot;],&quot;src/**/*.css&quot;: [&quot;prettier --write&quot;,&quot;git add&quot;],&quot;src/**/*.scss&quot;: [&quot;prettier --write&quot;,&quot;git add&quot;]</code></p></blockquote></li></ol><p>è¿™æ ·åœ¨æäº¤ä¹‹å‰å°±ä¼šå¯¹ æ–°å¢çš„(git add) .js æ–‡ä»¶æ‰§è¡Œ <code>&quot;eslint --fix&quot;</code> è„šæœ¬ï¼Œ ä»¥æ­¤ç±»æ¨â€¦</p><h1 id="End"><a href="#End" class="headerlink" title="End"></a>End</h1><p>emmmmmmmmmmmmmmmmmmmmmmmmm è™½ç„¶çœ‹èµ·æ¥æŒºç®€å•çš„ï¼Œä½†æ˜¯æ•´å¥—ç»“åˆé¡¹ç›®å»æŠ˜è…¾ä¸‹æ¥ æŒºå¤šå‘çš„ã€‚<br>ç‰¹åˆ«æ˜¯eslintè¿™å—çš„é…ç½®</p><p>ç¬¬ä¸€æ¬¡è·‘ <code>airbnb</code> çš„é¡¹ç›®ï¼š <img src="./error1.png" alt="eror1"><br>ç›®å‰é¡¹ç›®é…ç½®å®˜æ–¹æ¨èçš„ esling ä¹‹å: <img src="./error2.png" alt="eror2"><br>æŠŠerroræ”¹ä¸º warnä¿è¯é¡¹ç›®èƒ½è·‘èµ·æ¥: <img src="./error3.png" alt="eror3"><br>gitæäº¤æ£€æŸ¥å¤±è´¥: <img src="./git-check.png" alt="git-check"></p><p>æœ€åé™„ä¸Šeslinté…ç½®<br><figure class="highlight javascript"><figcaption><span>.eslint.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getWebpackConfig = <span class="built_in">require</span>(<span class="string">'./config/webpack.dev.config'</span>)(process.cwd());</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="string">"parser"</span>: <span class="string">"babel-eslint"</span>,</span><br><span class="line">    <span class="string">"extends"</span>: [<span class="string">'eslint:recommended'</span>, <span class="string">"plugin:react/recommended"</span>, <span class="string">"prettier"</span>],</span><br><span class="line">    <span class="string">"parserOptions"</span>: &#123;</span><br><span class="line">        <span class="string">"ecmaVersion"</span>: <span class="number">8</span>,</span><br><span class="line">        <span class="string">"sourceType"</span>: <span class="string">"module"</span>,</span><br><span class="line">        <span class="string">"ecmaFeatures"</span>: &#123;</span><br><span class="line">            <span class="string">"jsx"</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="string">"modules"</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="string">"experimentalObjectRestSpread"</span>: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"plugins"</span>: [<span class="string">"react"</span>],</span><br><span class="line">    <span class="string">"settings"</span>: &#123;</span><br><span class="line">        <span class="string">'import/resolver'</span>: &#123;</span><br><span class="line">            webpack: &#123;</span><br><span class="line">                config: getWebpackConfig,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"react"</span>: &#123;</span><br><span class="line">            <span class="string">"pragma"</span>: <span class="string">"React"</span>,</span><br><span class="line">            <span class="string">"version"</span>: <span class="string">"16.1.1"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"env"</span>: &#123;</span><br><span class="line">        browser: <span class="literal">true</span>,</span><br><span class="line">        es6: <span class="literal">true</span>,</span><br><span class="line">        node: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="string">"globals"</span>: &#123;</span><br><span class="line">        __DEV__: <span class="literal">true</span>,</span><br><span class="line">        __HTTPS__: <span class="literal">true</span>,</span><br><span class="line">        FB: <span class="literal">true</span>,</span><br><span class="line">        ga: <span class="literal">true</span>,</span><br><span class="line">        $: <span class="literal">true</span>,</span><br><span class="line">        ercjs: <span class="literal">true</span>,</span><br><span class="line">        google: <span class="literal">true</span>,</span><br><span class="line">        IS_APP: <span class="literal">true</span>,</span><br><span class="line">        i18n: <span class="literal">true</span>,</span><br><span class="line">        Zepto: <span class="literal">true</span>,</span><br><span class="line">        AdjustEvent: <span class="literal">true</span>,</span><br><span class="line">        Adjust: <span class="literal">true</span>,</span><br><span class="line">        fbq: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="string">"rules"</span>: &#123;</span><br><span class="line">        <span class="string">"sort-imports"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">"import/first"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">"import/no-named-as-default"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">"import/no-named-as-default-member"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">"import/extensions"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">"prefer-destructuring"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">"no-new"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">"react/jsx-filename-extension"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">"no-plusplus"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">"func-names"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">"no-console"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">"no-useless-escape"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">"semi"</span>: <span class="number">2</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¿™äº›è§„åˆ™åé¢ä¼šæ”¹ä¸ºé”™è¯¯ï¼Œæš‚æ—¶å…ˆè­¦å‘Š</span></span><br><span class="line">        <span class="string">"no-unused-vars"</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">"react/prop-types"</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">"react/no-string-refs"</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">"react/jsx-key"</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">"react/no-unescaped-entities"</span>: <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;æœ€è¿‘éƒ¨é—¨è¿›äº†æŒºå¤šæ–°å‰ç«¯ï¼Œæœ‰å®ä¹ ç”Ÿ æœ‰åº”å±Šç”Ÿï¼Œäººä¸€å¤š&lt;br&gt;ä»£ç è§„èŒƒå°±ä¸èƒ½å®Œå…¨ä¾èµ– â€œå£å£ç›¸ä¼ â€ å»çº¦æŸäº†ï¼Œ ç‰¹åˆ«æ˜¯çœ‹åˆ°ä¸€å †çš„ æœ‰åˆ†å·ï¼Œæ— åˆ†å·
      
    
    </summary>
    
      <category term="technology" scheme="https://jsonz1993.github.io/categories/technology/"/>
    
    
      <category term="work" scheme="https://jsonz1993.github.io/tags/work/"/>
    
  </entry>
  
</feed>
