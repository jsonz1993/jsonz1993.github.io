<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"jsonz1993.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":true,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="æ¢ç´¢create-react-appæ¡†æ¶çš„æºç åŠæ€æƒ³ï¼ˆä¸€ï¼‰">
<meta property="og:type" content="article">
<meta property="og:title" content="create-react-app æºç è§£æ">
<meta property="og:url" content="http://jsonz1993.github.io/create-react-app-o/index.html">
<meta property="og:site_name" content="Jsonz bug-log">
<meta property="og:description" content="æ¢ç´¢create-react-appæ¡†æ¶çš„æºç åŠæ€æƒ³ï¼ˆä¸€ï¼‰">
<meta property="og:locale">
<meta property="og:image" content="http://jsonz1993.github.io/create-react-app-o/create-react-app-file.png">
<meta property="og:image" content="http://jsonz1993.github.io/create-react-app-o/debug1.png">
<meta property="og:image" content="http://jsonz1993.github.io/create-react-app-o/debug2.png">
<meta property="og:image" content="http://jsonz1993.github.io/create-react-app-o/debug3.png">
<meta property="og:image" content="http://jsonz1993.github.io/create-react-app-o/debug4.png">
<meta property="og:image" content="http://jsonz1993.github.io/create-react-app-o/debug5.png">
<meta property="og:image" content="http://jsonz1993.github.io/create-react-app-o/create-react-app_index.png">
<meta property="og:image" content="http://jsonz1993.github.io/create-react-app-o/create-react-app1.png">
<meta property="article:published_time" content="2018-05-05T17:44:23.000Z">
<meta property="article:modified_time" content="2022-01-02T02:55:20.340Z">
<meta property="article:author" content="Jsonz">
<meta property="article:tag" content="JavaScript">
<meta property="article:tag" content="React">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://jsonz1993.github.io/create-react-app-o/create-react-app-file.png">

<link rel="canonical" href="http://jsonz1993.github.io/create-react-app-o/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-Hans'
  };
</script>

  <title>create-react-app æºç è§£æ | Jsonz bug-log</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?c8a069a38f5fa73f5b6bcff8d176157f";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Jsonz bug-log" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Jsonz bug-log</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">åç»­æ›´æ–°ä¼šæ”¾åœ¨ github.com/jsonz1993/blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">32</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">2</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">49</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://jsonz1993.github.io/create-react-app-o/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Jsonz">
      <meta itemprop="description" content="å‰ç«¯ğŸ‘´ğŸ¥¬ğŸ£/JavaScript/React">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jsonz bug-log">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          create-react-app æºç è§£æ
        </h1>
        <div class="post-meta ">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-05-05 17:44:23" itemprop="dateCreated datePublished" datetime="2018-05-05T17:44:23+00:00">2018-05-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-01-02 02:55:20" itemprop="dateModified" datetime="2022-01-02T02:55:20+00:00">2022-01-02</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index"><span itemprop="name">technology</span></a>
                </span>
            </span>

          
            <div class="post-description">æ¢ç´¢create-react-appæ¡†æ¶çš„æºç åŠæ€æƒ³ï¼ˆä¸€ï¼‰</div>

        </div>

      </header>

    
    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>æœ€è¿‘å·¥ä½œå¼€å§‹ç¨³å®šä¸‹æ¥ï¼Œæ²¡æœ‰é‚£ä¹ˆå¤šåŠ ç­ï¼ŒåŠ ä¸Šè¯´æŠ•ç®€å†æ‰¾é¢è¯•ä¸€ç›´æ²¡æ‹¿åˆ°é¢è¯•æœºä¼šâ€¦æ‰€ä»¥å¼€å§‹æœ‰ç©ºé—²çš„æ—¶é—´</p>
<p>ä¹‹å‰å…¬å¸æœ‰ä¸ªå¤§ä½¬å†™äº†ä¸ªç±»ä¼¼ create-react-app çš„è„šæ‰‹æ¶ï¼Œç”¨æ¥åˆ›å»ºå…¬å¸çš„é¡¹ç›®ã€‚ä¸€ç›´ä¸çŸ¥é“é‡Œé¢å®ç°çš„åŸç†ï¼Œå€Ÿæ­¤æœºä¼šä¸€æ¢ <code>create-react-app</code> æºç ï¼Œäº†è§£ä¸‹é‡Œé¢è¿è¡Œçš„æœºåˆ¶ã€‚</p>
<p>æˆäººä»¥é±¼ä¸å¦‚æˆäººä»¥æ¸”ï¼Œå¸Œæœ›é€šè¿‡è¿™ç¯‡æ–‡ç« ä¹‹åï¼Œå¯¹å¤§å®¶ä»¥åçœ‹æºç å¯ä»¥æœ‰æ‰€å¸®åŠ©ã€‚<br>å¤§å®¶ä¹Ÿä¸è¦ä¸€çœ‹åˆ°æºç å°±å®³æ€•ä¸æ•¢å»çœ‹ï¼Œç°åœ¨è¿™ä¹ˆä¼˜ç§€é¡¹ç›®éƒ½å¼€æºäº†ï¼ŒåŠ ä¸Šå„ç§IDEæ”¯æŒå¾ˆå¥½ï¼Œç›´æ¥æ‰“ä¸ªæ–­ç‚¹è¿›å»è°ƒè¯•ï¼Œå¾ˆå®¹æ˜“çœ‹å‡ºä¸ªå¤§æ¦‚ã€‚<br>ä¹Ÿå¯ä»¥ç”¨è¿™ç§æ€è·¯å»äº†è§£å…¶ä»–çš„å¼€æºé¡¹ç›®</p>
<h1 id="å¿«é€Ÿäº†è§£"><a href="#å¿«é€Ÿäº†è§£" class="headerlink" title="å¿«é€Ÿäº†è§£"></a><a href="#%E5%BF%AB%E9%80%9F%E4%BA%86%E8%A7%A3">å¿«é€Ÿäº†è§£</a></h1><p>å¯¹äºæƒ³å¿«é€Ÿäº†è§£çš„ç›´æ¥æµè§ˆè¿™ä¸€å—å³å¯<br>create-react-app å…¶å®å°±æ˜¯ç”¨nodeå»è·‘ä¸€äº›åŒ…å®‰è£…æµç¨‹ï¼Œå¹¶ä¸”æŠŠæ–‡ä»¶æ¨¡æ¿demoè€ƒåˆ°å¯¹äºçš„ç›®å½•ä¸‹ã€‚<br>å¯ä»¥ç®€å•åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤:</p>
<ul>
<li>åˆ¤æ–­Nodeç‰ˆæœ¬</li>
<li>åšä¸€äº›å‘½ä»¤è¡Œå¤„ç†çš„åˆå§‹åŒ–ï¼Œæ¯”å¦‚è¾“å…¥ <code>-help</code> åˆ™è¾“å‡ºå¸®åŠ©å†…å®¹</li>
<li>åˆ¤æ–­æ˜¯å¦æœ‰è¾“å…¥é¡¹ç›®åï¼Œæœ‰åˆ™æ ¹æ®å‚æ•°å»è·‘åŒ…å®‰è£…ï¼Œé»˜è®¤æ˜¯yarnå®‰è£…æ–¹å¼ï¼Œeg: <code>yarn add react react-dom react-scripts</code></li>
<li>ä¿®æ”¹package.jsoné‡Œé¢å·²å®‰è£…çš„ä¾èµ–ç‰ˆæœ¬ï¼Œä»ç²¾ç¡®ç‰ˆæœ¬<code>16.0.0</code>æ”¹ä¸º^å‘ä¸Šå…¼å®¹ç‰ˆæœ¬<code>^16.0.0</code> å¹¶åŠ å…¥ <code>start</code>,<code>build</code>ç­‰å¯åŠ¨è„šæœ¬</li>
<li>æ‹·è´ <code>react-scripts</code>ä¸‹çš„ <code>template</code> åˆ°ç›®æ ‡æ–‡ä»¶ï¼Œé‡Œé¢æœ‰<code>public</code>,<code>src</code>ç­‰æ–‡ä»¶å¤¹ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªç®€å•çš„å¯è¿è¡Œdemo</li>
<li>END~</li>
</ul>
<p>ç»§ç»­å¾€ä¸‹çœ‹çš„å°ä¼™ä¼´å¯ä»¥è·Ÿç€ä¸€æ­¥ä¸€æ­¥äº†è§£é‡Œé¢çš„å®ç°é€»è¾‘ï¼Œå…ˆä¾‹è¡Œäº¤ä»£ä¸‹ç¯å¢ƒç‰ˆæœ¬:<br><strong>create-react-app v1.1.4</strong><br>macOS 10.13.4<br>node v8.9.4<br>npm 6.0.0<br>yarn 1.6.0<br>vsCode 1.22.2</p>
<h1 id="é¡¹ç›®åˆå§‹åŒ–"><a href="#é¡¹ç›®åˆå§‹åŒ–" class="headerlink" title="é¡¹ç›®åˆå§‹åŒ–"></a><a href="#%E9%A1%B9%E7%9B%AE%E5%88%9D%E5%A7%8B%E5%8C%96">é¡¹ç›®åˆå§‹åŒ–</a></h1><p>å…ˆä¸Šgithub æ‹‰é¡¹ç›®ä»£ç ï¼Œæ‹‰ä¸‹æ¥ä¹‹ååˆ‡æ¢åˆ°æŒ‡å®šçš„ <code>tag</code></p>
<ul>
<li><code>git clone https://github.com/facebook/create-react-app.git</code></li>
<li><code>git checkout v1.1.4</code></li>
<li><code>yarn</code> //å¦‚æœä¸éœ€è¦æ–­ç‚¹è°ƒè¯•ï¼Œè¿™ä¸€æ­¥å¯ä»¥è·³è¿‡</li>
</ul>
<blockquote>
<p>è¿™é‡Œå¯èƒ½yarn ç‰ˆæœ¬å¤ªä½çš„è¯ï¼Œä¼šæŠ¥ä¸€ç³»åˆ—é”™è¯¯ï¼Œä¹‹å‰ç”¨çš„æ˜¯ 0.xç‰ˆæœ¬çš„ï¼Œå‡çº§åˆ°1.xå°±æ²¡é—®é¢˜äº†</p>
</blockquote>
<p>ä¸‹é¢æˆ‘ä»¬ç”¨ <code>root</code> ä»£æ›¿é¡¹ç›®çš„æ ¹ç›®å½•ï¼Œæ–¹ä¾¿ç†è§£</p>
<p>é¦–å…ˆæˆ‘ä»¬æ‰“å¼€é¡¹ç›®èƒ½çœ‹åˆ°ä¸€å †çš„é…ç½®æ–‡ä»¶å’Œä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼šeslinté…ç½®æ–‡ä»¶ã€traviséƒ¨ç½²é…ç½®ã€yarné…ç½®ã€æ›´æ–°æ—¥å¿—ã€å¼€æºå£°æ˜ç­‰ç­‰â€¦è¿™äº›æˆ‘ä»¬å…¨éƒ½å¯ä»¥ä¸ç”¨å»çœ‹ï¼Œé‚£æˆ‘ä»¬è¦çœ‹çš„æ ¸å¿ƒæºç æ”¾åœ¨å“ªé‡Œå‘¢<br><img data-src="/create-react-app-o/create-react-app-file.png"></p>
<p>åˆ’é‡ç‚¹: <strong>å¦‚æœé¡¹ç›®ä¸çŸ¥é“ä»å“ªé‡Œå…¥æ‰‹çš„è¯ï¼Œé¦–å…ˆä»package.jsonæ–‡ä»¶å¼€å§‹</strong></p>
<figure class="highlight json"><figcaption><span>root/package.json</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;private&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;workspaces&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;packages/*&quot;</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;start&quot;</span>: <span class="string">&quot;cd packages/react-scripts &amp;&amp; node scripts/start.js&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;devDependencies&quot;</span>: &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;lint-staged&quot;</span>: &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æ‰“å¼€æ ¹ç›®å½• package.json æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é‡Œé¢å¾ˆç®€æ´~ npmè„šæœ¬å‘½ä»¤ï¼Œå¼€å‘ä¾èµ–ï¼Œè¿˜æœ‰æäº¤é’©å­ï¼Œå‰©ä¸‹çš„å°±æ˜¯æˆ‘ä»¬è¦å…³æ³¨çš„ <strong>workspaces</strong> è¿™é‡ŒæŒ‡å‘çš„æ˜¯ <code>&quot;packages/*&quot;</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬ç°åœ¨çš„é‡ç‚¹å°±æ”¾åœ¨ <strong>packages</strong> æ–‡ä»¶å¤¹</p>
<p>packages æ–‡ä»¶å¤¹ä¸‹é¢ä¹Ÿæœ‰å‡ ä¸ªæ–‡ä»¶å¤¹ï¼Œè¿™é‡Œæ–‡ä»¶å¤¹å‘½åå¾ˆè§„èŒƒï¼Œä¸€çœ‹å°±çŸ¥é“åŠŸèƒ½åˆ’åˆ†ï¼Œæ‰€ä»¥è¿˜æ˜¯è€å¥—è·¯ç›´æ¥çœ‹ <code>root/packages/create-react-app/package.json</code></p>
<figure class="highlight json"><figcaption><span>packages/create-react-app/package.json</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;create-react-app&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;1.5.2&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;license&quot;</span>: <span class="string">&quot;MIT&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;engines&quot;</span>: &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;bugs&quot;</span>: &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;files&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;index.js&quot;</span>,</span><br><span class="line">    <span class="string">&quot;createReactApp.js&quot;</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">&quot;bin&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;create-react-app&quot;</span>: <span class="string">&quot;./index.js&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™æ—¶å€™æ²¡æœ‰ <code>workspaces</code>é¡¹ï¼Œ æˆ‘ä»¬å¯ä»¥çœ‹ <code>bin</code> binçš„åŠŸèƒ½æ˜¯æŠŠå‘½ä»¤å¯¹åº”åˆ°å¯æ‰§è¡Œçš„æ–‡ä»¶ï¼Œå…·ä½“çš„ä»‹ç»å¯ä»¥çœ‹<a target="_blank" rel="noopener" href="https://docs.npmjs.com/files/package.json#bin">package Document</a></p>
<p>è¿™é‡Œå¯ä»¥ç®€å•ç†è§£æˆï¼Œå½“æˆ‘ä»¬å…¨å±€å®‰è£…äº† <code>create-react-app</code> ä¹‹åï¼Œè·‘ <code>create-react-app my-react-app</code> ç³»ç»Ÿä¼šå¸®æˆ‘ä»¬å»è·‘ <code>packages/create-react-app/index.js my-react-app</code></p>
<p>ç»ˆäºæ‰¾åˆ°æºç çš„å…¥å£äº†ï¼Œå¯¹äºç®€å•çš„æºç æˆ‘ä»¬å¯ä»¥ç›´æ¥çœ‹ï¼Œå¯¹äºæ¯”è¾ƒå¤æ‚çš„ æˆ–è€…æƒ³è¦çœ‹åˆ°æ‰§è¡Œåˆ°æ¯ä¸€è¡Œä»£ç æ—¶é‚£äº›å˜é‡æ˜¯ä»€ä¹ˆå€¼çš„æƒ…å†µï¼Œæˆ‘ä»¬å°±è¦ç”¨IDEæˆ–å…¶ä»–å·¥å…·æ¥æ–­ç‚¹è°ƒè¯•ä»£ç äº†ã€‚</p>
<h1 id="é…ç½®æ–­ç‚¹è°ƒè¯•"><a href="#é…ç½®æ–­ç‚¹è°ƒè¯•" class="headerlink" title="é…ç½®æ–­ç‚¹è°ƒè¯•"></a><a href="#%E9%85%8D%E7%BD%AE%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95">é…ç½®æ–­ç‚¹è°ƒè¯•</a></h1><p>å¯¹äºvscodeæˆ–nodeè°ƒè¯• æ¯”è¾ƒç†Ÿæ‚‰çš„å¯ä»¥è·³è¿‡ç›´æ¥çœ‹ <a href="#%E5%BC%80%E5%A7%8B%E6%96%AD%E7%82%B9%E9%98%85%E8%AF%BB%E6%BA%90%E7%A0%81">å¼€å§‹æ–­ç‚¹é˜…è¯»æºç </a></p>
<h2 id="vscode-debug"><a href="#vscode-debug" class="headerlink" title="vscode debug"></a><a href="#vscode_debug">vscode debug</a></h2><p>å¯¹äºvscodeç”¨æˆ·æ¥è¯´ï¼Œè°ƒè¯•éå¸¸ç®€å•ï¼Œç‚¹å‡»ä¾§è¾¹æ çš„å°ç”²è™«å›¾æ ‡ï¼Œç‚¹å‡»è®¾ç½®<br>ç„¶åç›´æ¥ä¿®æ”¹ â€œprogramâ€çš„å€¼ï¼Œä¿®æ”¹å®Œç‚¹å‡»å·¦ä¸Šè§’çš„ç»¿è‰²ç®­å¤´å°±å¯ä»¥è·‘èµ·æ¥äº†ï¼Œå¦‚æœè¦åœ¨æŸä¸€å¤„æ–­ç‚¹ï¼Œæ¯”å¦‚ <code>create-react-app/index.js</code> line39 æ–­ç‚¹ï¼Œç›´æ¥åœ¨è¡Œå·çš„å·¦è¾¹ç‚¹ä¸€ä¸‹é¼ æ ‡å°±å¯ä»¥äº†<br><img data-src="/create-react-app-o/debug1.png"><br><img data-src="/create-react-app-o/debug2.png"></p>
<figure class="highlight json"><figcaption><span>launch.json é…ç½®</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;0.2.0&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;configurations&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;node&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;request&quot;</span>: <span class="string">&quot;launch&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;å¯åŠ¨ç¨‹åº&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;program&quot;</span>: <span class="string">&quot;$&#123;workspaceFolder&#125;/packages/create-react-app/index.js&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="node-è°ƒè¯•"><a href="#node-è°ƒè¯•" class="headerlink" title="node è°ƒè¯•"></a>node è°ƒè¯•</h2><p>å¦‚æœå¹³æ—¶æ²¡æœ‰ç”¨vscodeå¼€å‘æˆ–è€…ä¹ æƒ¯chrome-devtoolçš„ï¼Œå¯ä»¥ç›´æ¥ç”¨nodeå‘½ä»¤è·‘ï¼Œç„¶ååœ¨chromeé‡Œé¢è°ƒè¯•<br>é¦–å…ˆä¿è¯nodeçš„ç‰ˆæœ¬çš„ 6 ä»¥ä¸Š<br>ç„¶ååœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œ <code>node --inspect-brk packages/create-react-app/index.js</code><br>åœ¨chromeåœ°å€æ è¾“å…¥ chrome://inspect/#devices ç„¶åå°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è¦è°ƒè¯•çš„è„šæœ¬äº†<br>å…³äºnode chrome-devtool è°ƒè¯•è¯¦ç»†å¯ä»¥çœ‹è¿™é‡Œ <a target="_blank" rel="noopener" href="https://medium.com/@paul_irish/debugging-node-js-nightlies-with-chrome-devtools-7c4a1b95ae27">ä¼ é€é—¨</a></p>
<p><img data-src="/create-react-app-o/debug3.png"><br><img data-src="/create-react-app-o/debug4.png"><br><img data-src="/create-react-app-o/debug5.png"><br>(psï¼šè¿™é‡Œå¯ä»¥çœ‹å‡ºæ¥nodeåœ¨æ¨¡å—åŒ–çš„å®ç°æ˜¯é€šè¿‡ç”¨ä¸€ä¸ªå‡½æ•°åŒ…è£¹èµ·æ¥ï¼Œç„¶åæŠŠ exports, requestdç­‰å‚æ•°ä¼ è¿›æ¥ä»¥ä¾›ä½¿ç”¨)</p>
<h1 id="å¼€å§‹æ–­ç‚¹é˜…è¯»æºç "><a href="#å¼€å§‹æ–­ç‚¹é˜…è¯»æºç " class="headerlink" title="å¼€å§‹æ–­ç‚¹é˜…è¯»æºç "></a><a href="#%E5%BC%80%E5%A7%8B%E6%96%AD%E7%82%B9%E9%98%85%E8%AF%BB%E6%BA%90%E7%A0%81">å¼€å§‹æ–­ç‚¹é˜…è¯»æºç </a></h1><h2 id="packages-create-react-app-index-js-githubæ–‡ä»¶ä¼ é€é—¨"><a href="#packages-create-react-app-index-js-githubæ–‡ä»¶ä¼ é€é—¨" class="headerlink" title="packages/create-react-app/index.js githubæ–‡ä»¶ä¼ é€é—¨"></a><a href="#packages/create-react-app/index.js">packages/create-react-app/index.js</a> <a target="_blank" rel="noopener" href="https://github.com/facebook/create-react-app/blob/v1.1.4/packages/create-react-app/index.js">githubæ–‡ä»¶ä¼ é€é—¨</a></h2><p><img data-src="/create-react-app-o/create-react-app_index.png"><br>è¿™ä¸ªæ–‡ä»¶ååˆ†ç®€å•ï¼Œåªæ˜¯åšä¸ºä¸€ä¸ªå…¥å£æ–‡ä»¶åˆ¤æ–­ä¸€ä¸‹ nodeç‰ˆæœ¬ï¼Œå°äº 4.xçš„æç¤ºå¹¶ç»ˆæ­¢ç¨‹åºï¼Œ å¦‚æœæ­£å¸¸åˆ™åŠ è½½ <code>./createReactApp</code> è¿™ä¸ªæ–‡ä»¶ï¼Œä¸»è¦çš„é€»è¾‘åœ¨è¯¥æ–‡ä»¶å®ç°ã€‚</p>
<h2 id="packages-create-react-app-createReactApp-js-githubæ–‡ä»¶ä¼ é€é—¨"><a href="#packages-create-react-app-createReactApp-js-githubæ–‡ä»¶ä¼ é€é—¨" class="headerlink" title="packages/create-react-app/createReactApp.js githubæ–‡ä»¶ä¼ é€é—¨"></a><a href="#packages/create-react-app/createReactApp.js">packages/create-react-app/createReactApp.js</a> <a target="_blank" rel="noopener" href="https://github.com/facebook/create-react-app/blob/v1.1.4/packages/create-react-app/createReactApp.js">githubæ–‡ä»¶ä¼ é€é—¨</a></h2><p>é¡ºç€æˆ‘ä»¬çš„æ–­ç‚¹è¿›å…¥åˆ° <code>createReactApp.js</code> è¿™ä¸ªæ–‡ä»¶æœ‰750è¡Œä¹ä¸€çœ‹å¾ˆå¤šï¼Œæ–‡ä»¶å¤´åˆæœ‰åå‡ ä¸ªä¾èµ–å¼•å…¥ï¼Œä½†æ˜¯ä¸è¦è¢«å“åˆ°ï¼Œä¸€èˆ¬è¿™ç§é«˜è´¨é‡çš„å¼€æºé¡¹ç›®ï¼Œé‡Œé¢æœ‰ä¸€å¤§åŠæ˜¯æ³¨é‡Šå’Œé”™è¯¯å‹å¥½ä¿¡æ¯ã€‚</p>
<blockquote>
<p>è¿™é‡Œå»ºè®®æ²¡æœ‰æ‰“æ–­ç‚¹è°ƒè¯•çš„å°ä¼™ä¼´è¯•ä¸€ä¸‹æŠŠä»£ç å¤åˆ¶åˆ°å¦ä¸€ä¸ªjsæ–‡ä»¶ï¼Œç„¶åå…ˆä¸çœ‹å‰é¢çš„ä¾èµ–ï¼Œä¸‹é¢ç”¨åˆ°å†å» npmæŸ¥ä¸€ä¸‹æ˜¯ä»€ä¹ˆä½œç”¨çš„ã€‚ä¸è¦è¢«ç»•è¿›å»çœ‹äº†ä¸€ä¸ªåˆä¸€ä¸ªçš„ä¾èµ–ï¼Œæ ¸å¿ƒä»£ç åè€Œæ²¡æœ‰çœ‹åˆ°ã€‚ ç„¶åçœ‹ä¸€éƒ¨åˆ†ä¹‹åå°±æŠŠé‚£éƒ¨åˆ†çš„ä»£ç åˆ æ‰ï¼Œæ¯”å¦‚æˆ‘çœ‹äº†200è¡Œï¼Œå°±æŠŠå‰é¢200è¡Œåˆ äº†ï¼Œè¿™æ ·å‰©ä¸‹500è¡Œçœ‹ç€å°±æ²¡æœ‰é‚£ä¹ˆå¿ƒè™šäº†ã€‚å½“ç„¶è¿˜æ˜¯å»ºè®®ç”¨æ–­ç‚¹è°ƒè¯•é˜…è¯»ï¼Œé€»è¾‘ä¼šæ¯”è¾ƒæ¸…æ™°ã€‚</p>
</blockquote>
<p>é¦–å…ˆæ–‡ä»¶å¤´éƒ¨è¿™ä¸€å¤§ä¸²çš„ä¾èµ–ï¼Œæˆ‘ä»¬æš‚æ—¶ä¸å»å…³æ³¨ä»–ä»¬ï¼Œç­‰åé¢ç”¨åˆ°å†å»æŸ¥</p>
<figure class="highlight javascript"><figcaption><span>createReactApp.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> validateProjectName = <span class="built_in">require</span>(<span class="string">&#x27;validate-npm-package-name&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> chalk = <span class="built_in">require</span>(<span class="string">&#x27;chalk&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> commander = <span class="built_in">require</span>(<span class="string">&#x27;commander&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs-extra&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> execSync = <span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>).execSync;</span><br><span class="line"><span class="keyword">const</span> spawn = <span class="built_in">require</span>(<span class="string">&#x27;cross-spawn&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> semver = <span class="built_in">require</span>(<span class="string">&#x27;semver&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> dns = <span class="built_in">require</span>(<span class="string">&#x27;dns&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> tmp = <span class="built_in">require</span>(<span class="string">&#x27;tmp&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> unpack = <span class="built_in">require</span>(<span class="string">&#x27;tar-pack&#x27;</span>).unpack;</span><br><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">&#x27;url&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> hyperquest = <span class="built_in">require</span>(<span class="string">&#x27;hyperquest&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> envinfo = <span class="built_in">require</span>(<span class="string">&#x27;envinfo&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="commander-å‘½ä»¤è¡Œå¤„ç†ç¨‹åº"><a href="#commander-å‘½ä»¤è¡Œå¤„ç†ç¨‹åº" class="headerlink" title="commander å‘½ä»¤è¡Œå¤„ç†ç¨‹åº"></a><a href="#commander">commander å‘½ä»¤è¡Œå¤„ç†ç¨‹åº</a></h3><p>æ¥ä¸‹æ¥é¡ºç€æˆ‘ä»¬çš„æ–­ç‚¹ï¼Œç¬¬ä¸€è¡Œè¢«æ‰§è¡Œçš„ä»£ç æ˜¯ <a target="_blank" rel="noopener" href="https://github.com/facebook/create-react-app/blob/v1.1.4/packages/create-react-app/createReactApp.js#L56">L56</a></p>
<figure class="highlight javascript"><figcaption><span>createReactApp.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> program = <span class="keyword">new</span> commander.Command(packageJson.name)</span><br><span class="line">  .version(packageJson.version) <span class="comment">// create-react-app -v æ—¶è¾“å‡º $&#123;packageJson.version&#125;</span></span><br><span class="line">  .arguments(<span class="string">&#x27;&lt;project-directory&gt;&#x27;</span>) <span class="comment">// è¿™é‡Œç”¨&lt;&gt; åŒ…ç€project-directory è¡¨ç¤º project-directoryä¸ºå¿…å¡«é¡¹</span></span><br><span class="line">  .usage(<span class="string">`<span class="subst">$&#123;chalk.green(<span class="string">&#x27;&lt;project-directory&gt;&#x27;</span>)&#125;</span> [options]`</span>) <span class="comment">// ç”¨ç»¿è‰²å­—ä½“è¾“å‡º &lt;project-directory&gt;</span></span><br><span class="line">  .action(<span class="function"><span class="params">name</span> =&gt;</span> &#123;</span><br><span class="line">    projectName = name;</span><br><span class="line">  &#125;) <span class="comment">// è·å–ç”¨æˆ·ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸º projectName **ä¸‹é¢å°±ä¼šç”¨åˆ°**</span></span><br><span class="line">  .option(<span class="string">&#x27;--verbose&#x27;</span>, <span class="string">&#x27;print additional logs&#x27;</span>) <span class="comment">// optionç”¨äºé…ç½®`create-react-app -[option]`çš„é€‰é¡¹ï¼Œæ¯”å¦‚è¿™é‡Œå¦‚æœç”¨æˆ·å‚æ•°å¸¦äº† --verboseï¼Œ ä¼šè‡ªåŠ¨è®¾ç½®program.verbose = true;</span></span><br><span class="line">  .option(<span class="string">&#x27;--info&#x27;</span>, <span class="string">&#x27;print environment debug info&#x27;</span>) <span class="comment">// åé¢ä¼šç”¨åˆ°è¿™ä¸ªå‚æ•°ï¼Œç”¨äºæ‰“å°å‡ºç¯å¢ƒè°ƒè¯•çš„ç‰ˆæœ¬ä¿¡æ¯</span></span><br><span class="line">  .option(</span><br><span class="line">    <span class="string">&#x27;--scripts-version &lt;alternative-package&gt;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;use a non-standard version of react-scripts&#x27;</span></span><br><span class="line">  )</span><br><span class="line">  .option(<span class="string">&#x27;--use-npm&#x27;</span>)</span><br><span class="line">  .allowUnknownOption()</span><br><span class="line">   <span class="comment">// on(&#x27;option&#x27;, cb) è¾“å…¥ create-react-app --help è‡ªåŠ¨æ‰§è¡Œåé¢çš„æ“ä½œè¾“å‡ºå¸®åŠ©</span></span><br><span class="line">  .on(<span class="string">&#x27;--help&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`    Only <span class="subst">$&#123;chalk.green(<span class="string">&#x27;&lt;project-directory&gt;&#x27;</span>)&#125;</span> is required.`</span>);</span><br><span class="line">    <span class="built_in">console</span>.log();</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">`    A custom <span class="subst">$&#123;chalk.cyan(<span class="string">&#x27;--scripts-version&#x27;</span>)&#125;</span> can be one of:`</span></span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`      - a specific npm version: <span class="subst">$&#123;chalk.green(<span class="string">&#x27;0.8.2&#x27;</span>)&#125;</span>`</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">`      - a custom fork published on npm: <span class="subst">$&#123;chalk.green(</span></span></span><br><span class="line"><span class="subst"><span class="string">        <span class="string">&#x27;my-react-scripts&#x27;</span></span></span></span><br><span class="line"><span class="subst"><span class="string">      )&#125;</span>`</span></span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">`      - a .tgz archive: <span class="subst">$&#123;chalk.green(</span></span></span><br><span class="line"><span class="subst"><span class="string">        <span class="string">&#x27;https://mysite.com/my-react-scripts-0.8.2.tgz&#x27;</span></span></span></span><br><span class="line"><span class="subst"><span class="string">      )&#125;</span>`</span></span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">`      - a .tar.gz archive: <span class="subst">$&#123;chalk.green(</span></span></span><br><span class="line"><span class="subst"><span class="string">        <span class="string">&#x27;https://mysite.com/my-react-scripts-0.8.2.tar.gz&#x27;</span></span></span></span><br><span class="line"><span class="subst"><span class="string">      )&#125;</span>`</span></span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">`    It is not needed unless you specifically want to use a fork.`</span></span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">console</span>.log();</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">`    If you have any problems, do not hesitate to file an issue:`</span></span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">`      <span class="subst">$&#123;chalk.cyan(</span></span></span><br><span class="line"><span class="subst"><span class="string">        <span class="string">&#x27;https://github.com/facebookincubator/create-react-app/issues/new&#x27;</span></span></span></span><br><span class="line"><span class="subst"><span class="string">      )&#125;</span>`</span></span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">console</span>.log();</span><br><span class="line">  &#125;)</span><br><span class="line">  .parse(process.argv); <span class="comment">// è§£æä¼ å…¥çš„å‚æ•° å¯ä»¥ä¸ç”¨ç†ä¼š</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œç”¨åˆ°äº†ä¸€ä¸ª commander çš„ä¾èµ–ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å»npm æœä¸€ä¸‹ä»–çš„ä½œç”¨äº†ã€‚å®˜ç½‘çš„æè¿°æ˜¯ <code>The complete solution for node.js command-line interfaces, inspired by Ruby&#39;s commander.API documentation</code> ç¿»è¯‘è¿‡æ¥æ˜¯ node.js å‘½ä»¤è¡Œæ¥å£çš„å®Œæ•´è§£å†³æ–¹æ¡ˆï¼ŒåŸºæœ¬çš„åŠŸèƒ½çœ‹æ³¨é‡Šå³å¯ï¼Œå¤§æ¦‚äº†è§£ä¸€ä¸‹æœ‰è¿™ä¹ˆä¸€ä¸ªä¸œè¥¿ï¼Œåé¢è‡ªå·±è¦åšçš„æ—¶å€™æœ‰é—¨è·¯å³å¯ã€‚<a target="_blank" rel="noopener" href="https://github.com/tj/commander.js">githubä¼ é€é—¨</a>ã€‚</p>
<h3 id="åˆ¤æ–­æ˜¯å¦æœ‰ä¼ projectName"><a href="#åˆ¤æ–­æ˜¯å¦æœ‰ä¼ projectName" class="headerlink" title="åˆ¤æ–­æ˜¯å¦æœ‰ä¼ projectName"></a><a href="#projectName">åˆ¤æ–­æ˜¯å¦æœ‰ä¼ projectName</a></h3><figure class="highlight javascript"><figcaption><span>createReactApp.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> projectName === <span class="string">&#x27;undefined&#x27;</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (program.info) &#123; <span class="comment">// å¦‚æœå‘½ä»¤è¡Œæœ‰å¸¦ --info å‚æ•°ï¼Œè¾“å‡º react,react-dom,react-scriptsç‰ˆæœ¬ ç„¶åé€€å‡º</span></span><br><span class="line">    envinfo.print(&#123;</span><br><span class="line">      <span class="attr">packages</span>: [<span class="string">&#x27;react&#x27;</span>, <span class="string">&#x27;react-dom&#x27;</span>, <span class="string">&#x27;react-scripts&#x27;</span>],</span><br><span class="line">      <span class="attr">noNativeIDE</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">duplicates</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    process.exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">  è¿™é‡Œè¾“å‡ºäº†ä¸€äº›é”™è¯¯æç¤ºä¿¡æ¯</span><br><span class="line">  ...</span><br><span class="line">  process.exit(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¾€ä¸‹çœ‹æ˜¯ä¸€ä¸ªåˆ¤æ–­å¿…é¡»ä¼ å…¥çš„å‚æ•° <code>projectName</code>ï¼Œè¿™é‡Œçš„ <code>projectName</code> å°±æ˜¯ä¸Šé¢é€šè¿‡ <code>.action(name =&gt; &#123; projectName = name;&#125;)</code> è·å–çš„ã€‚<br>åˆ¤æ–­å¦‚æœæ²¡æœ‰è¾“å…¥çš„è¯ï¼Œç›´æ¥åšä¸€äº›ä¿¡æ¯æç¤ºï¼Œç„¶åç»ˆæ­¢ç¨‹åºã€‚<br>è¿™é‡Œå‚æ•°å¦‚æœä¼ å…¥äº† <code>--info</code> çš„è¯ï¼Œ ä¼šæ‰§è¡Œåˆ°<code>envinfo.print</code>ã€‚ æ—¥å¸¸npm æœä¸€ä¸‹ envinfo è¿™æ˜¯ä¸€ä¸ªç”¨æ¥è¾“å‡ºå½“å‰ç¯å¢ƒç³»ç»Ÿçš„ä¸€äº›ç³»ç»Ÿä¿¡æ¯ï¼Œæ¯”å¦‚ç³»ç»Ÿç‰ˆæœ¬ï¼Œnpmç­‰ç­‰è¿˜æœ‰react,react-dom,react-scriptsè¿™äº›åŒ…çš„ç‰ˆæœ¬ï¼Œéå¸¸å¥½ç”¨ã€‚è¿™ä¸ªåŒ…ç°åœ¨çš„ç‰ˆæœ¬å’Œcreate-react-appçš„ç‰ˆæœ¬å·®å¼‚æ¯”è¾ƒå¤§ï¼Œä½†æ˜¯ä¸å½±å“æˆ‘ä»¬ä½¿ç”¨~ <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/envinfo">envinfo npmä¼ é€é—¨</a></p>
<p>å¦‚æœæ˜¯ç”¨æˆ‘ä¸Šé¢æä¾›çš„ vscode debugé…ç½®çš„è¯ï¼Œåˆ°è¿™é‡Œç¨‹åºåº”è¯¥å°±è¿è¡Œç»“æŸäº†ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨å¯åŠ¨è°ƒè¯•æœåŠ¡çš„æ—¶å€™ï¼Œæ²¡æœ‰ç»™è„šæœ¬ä¼ å…¥å‚æ•°ä½œä¸º <code>projectName</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹ vscode <code>launch.json</code> åŠ å¤šä¸ªå­—æ®µ <code>&quot;args&quot;: [&quot;test-create-react-app&quot;]</code> <a href="#vscode_debug">å¿˜è®°æ€ä¹ˆè®¾ç½®çš„ç‚¹è¿™é‡Œ</a>~ ä¼ å…¥äº† <code>projectName</code> å‚æ•° ç„¶åé‡æ–°å¯åŠ¨è°ƒè¯•æœåŠ¡</p>
<figure class="highlight json"><figcaption><span>åŠ å…¥projectName åçš„ launch.json</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;0.2.0&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;configurations&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;node&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;request&quot;</span>: <span class="string">&quot;launch&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;å¯åŠ¨ç¨‹åº&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;program&quot;</span>: <span class="string">&quot;$&#123;workspaceFolder&#125;/packages/create-react-app/index.js&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;args&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;test-create-react-app&quot;</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="éšè—çš„-commander-å‚æ•°"><a href="#éšè—çš„-commander-å‚æ•°" class="headerlink" title="éšè—çš„ commander å‚æ•°"></a><a href="#dev_commander">éšè—çš„ commander å‚æ•°</a></h3><p>æ¥ç€èµ°åˆ¤æ–­å®Œ projectName ä¹‹åï¼Œæ¥åˆ° <a target="_blank" rel="noopener" href="https://github.com/facebook/create-react-app/blob/v1.1.4/packages/create-react-app/createReactApp.js#L140">Line140</a></p>
<figure class="highlight javascript"><figcaption><span>createReactApp.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> hiddenProgram = <span class="keyword">new</span> commander.Command()</span><br><span class="line">  .option(</span><br><span class="line">    <span class="string">&#x27;--internal-testing-template &lt;path-to-template&gt;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;(internal usage only, DO NOT RELY ON THIS) &#x27;</span> +</span><br><span class="line">      <span class="string">&#x27;use a non-standard application template&#x27;</span></span><br><span class="line">  )</span><br><span class="line">  .parse(process.argv);</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ˜¯ä¸€ä¸ªéšè—çš„è°ƒè¯•é€‰é¡¹ï¼Œç»™å‡ºä¸€ä¸ªå‚æ•°ç”¨äºä¼ å…¥æ¨¡ç‰ˆè·¯å¾„ï¼Œç»™å¼€å‘äººå‘˜è°ƒè¯•ç”¨çš„â€¦æ²¡äº‹ä¸æŠ˜è…¾ä»–</p>
<h3 id="createApp"><a href="#createApp" class="headerlink" title="createApp"></a><a href="#createApp">createApp</a></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">createApp(</span><br><span class="line">  projectName,</span><br><span class="line">  program.verbose,</span><br><span class="line">  program.scriptsVersion,</span><br><span class="line">  program.useNpm,</span><br><span class="line">  hiddenProgram.internalTestingTemplate</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>æ¥ç€å¾€ä¸‹å°±æ˜¯è°ƒç”¨äº† <code>createApp</code>, ä¼ å…¥çš„å‚æ•°å¯¹äºçš„å«ä¹‰æ˜¯ï¼š<code>é¡¹ç›®å</code>ï¼Œ<code>æ˜¯å¦è¾“å‡ºé¢å¤–ä¿¡æ¯</code>ï¼Œ<code>ä¼ å…¥çš„è„šæœ¬ç‰ˆæœ¬</code>ï¼Œ<code>æ˜¯å¦ä½¿ç”¨npm</code>ï¼Œ<code>è°ƒè¯•çš„æ¨¡æ¿è·¯å¾„</code>ã€‚æ¥ä¸‹æ¥å•æ­¥è¿›å…¥å‡½æ•°ä½“çœ‹ä¸€ä¸‹ <code>createApp</code> åˆ°åº•åšäº†ä»€ä¹ˆäº‹æƒ…ã€‚</p>
<figure class="highlight javascript"><figcaption><span>createReactApp.js createApp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createApp</span>(<span class="params">name, verbose, version, useNpm, template</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> root = path.resolve(name);</span><br><span class="line">  <span class="keyword">const</span> appName = path.basename(root);</span><br><span class="line"></span><br><span class="line">  checkAppName(appName); <span class="comment">// æ£€æŸ¥ä¼ å…¥çš„é¡¹ç›®ååˆæ³•æ€§</span></span><br><span class="line">  fs.ensureDirSync(name); <span class="comment">// è¿™é‡Œçš„fsç”¨çš„æ˜¯ fs-extraï¼Œ å¯¹nodeçš„fsæä¾›ä¸€äº›æ‰©å±•æ–¹æ³•</span></span><br><span class="line">  <span class="comment">// åˆ¤æ–­æ–°å»ºè¿™ä¸ªæ–‡ä»¶å¤¹æ˜¯å¦æ˜¯å®‰å…¨çš„ ä¸å®‰å…¨ç›´æ¥é€€å‡º</span></span><br><span class="line">  <span class="keyword">if</span> (!isSafeToCreateProjectIn(root, name)) &#123;</span><br><span class="line">    process.exit(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åœ¨æ–°å»ºçš„æ–‡ä»¶å¤¹ä¸‹å†™å…¥ package.json æ–‡ä»¶</span></span><br><span class="line">  <span class="keyword">const</span> packageJson = &#123;</span><br><span class="line">    <span class="attr">name</span>: appName,</span><br><span class="line">    <span class="attr">version</span>: <span class="string">&#x27;0.1.0&#x27;</span>,</span><br><span class="line">    <span class="attr">private</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">  fs.writeFileSync(</span><br><span class="line">    path.join(root, <span class="string">&#x27;package.json&#x27;</span>),</span><br><span class="line">    <span class="built_in">JSON</span>.stringify(packageJson, <span class="literal">null</span>, <span class="number">2</span>)</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> useYarn = useNpm ? <span class="literal">false</span> : shouldUseYarn();</span><br><span class="line">  <span class="keyword">const</span> originalDirectory = process.cwd();</span><br><span class="line">  process.chdir(root);</span><br><span class="line">  <span class="comment">// å¦‚æœæ˜¯ä½¿ç”¨npmï¼Œæ£€æµ‹npmæ˜¯å¦åœ¨æ­£ç¡®ç›®å½•ä¸‹æ‰§è¡Œ</span></span><br><span class="line">  <span class="keyword">if</span> (!useYarn &amp;&amp; !checkThatNpmCanReadCwd()) &#123;</span><br><span class="line">    process.exit(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ¤æ–­nodeç¯å¢ƒï¼Œè¾“å‡ºä¸€äº›æç¤ºä¿¡æ¯, å¹¶é‡‡ç”¨æ—§ç‰ˆæœ¬çš„ react-scripts</span></span><br><span class="line">  <span class="keyword">if</span> (!semver.satisfies(process.version, <span class="string">&#x27;&gt;=6.0.0&#x27;</span>)) &#123;</span><br><span class="line">    <span class="comment">// è¾“å‡ºä¸€äº›æç¤ºæ›´æ–°ä¿¡æ¯</span></span><br><span class="line">    version = <span class="string">&#x27;react-scripts@0.9.x&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!useYarn) &#123;</span><br><span class="line">    <span class="comment">// æ£€æµ‹npmç‰ˆæœ¬ åˆ¤æ–­npmç‰ˆæœ¬ï¼Œå¦‚æœä½äº3.xï¼Œä½¿ç”¨æ—§ç‰ˆçš„ react-scriptsæ—§ç‰ˆæœ¬</span></span><br><span class="line">    <span class="keyword">const</span> npmInfo = checkNpmVersion();</span><br><span class="line">    <span class="keyword">if</span> (!npmInfo.hasMinNpm) &#123;</span><br><span class="line">      version = <span class="string">&#x27;react-scripts@0.9.x&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ¤æ–­ç»“æŸä¹‹åï¼Œè·‘run æ–¹æ³•</span></span><br><span class="line">  <span class="comment">// ä¼ å…¥ é¡¹ç›®è·¯å¾„ï¼Œé¡¹ç›®åï¼Œ reactScriptsç‰ˆæœ¬ï¼Œ æ˜¯å¦è¾“å…¥é¢å¤–ä¿¡æ¯ï¼Œ è¿è¡Œçš„è·¯å¾„ï¼Œ æ¨¡æ¿ï¼ˆå¼€å‘è°ƒè¯•ç”¨çš„ï¼‰, æ˜¯å¦ä½¿ç”¨yarn</span></span><br><span class="line">  run(root, appName, version, verbose, originalDirectory, template, useYarn);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://github.com/facebook/create-react-app/blob/v1.1.4/packages/create-react-app/createReactApp.js#L156">createReactApp.js createApp ä¼ é€é—¨</a><br>è¿™é‡Œæˆ‘ç²¾ç®€äº†ä¸€äº›ä¸œè¥¿ï¼Œåˆ é™¤ä¸€äº›è¾“å‡ºä¿¡æ¯ï¼ŒåŠ äº†ä¸€äº›æ³¨é‡Š<br><code>createApp</code> ä¸»è¦åšçš„äº‹æƒ…å°±æ˜¯åšä¸€äº›å®‰å…¨åˆ¤æ–­æ¯”å¦‚ï¼šæ£€æŸ¥é¡¹ç›®åæ˜¯å¦åˆæ³•ï¼Œæ£€æŸ¥æ–°å»ºçš„è¯æ˜¯å¦å®‰å…¨ï¼Œæ£€æŸ¥npmç‰ˆæœ¬ï¼Œå¤„ç†<code>react-script</code>çš„ç‰ˆæœ¬å…¼å®¹<br>å…·ä½“çš„æ‰§è¡Œé€»è¾‘å†™åœ¨æ³¨é‡Šé‡Œäº†ï¼Œä¸€ç³»åˆ—çš„æ£€æŸ¥å¤„ç†ä¹‹åï¼Œè°ƒç”¨ run æ–¹æ³•ï¼Œä¼ å…¥å‚æ•°ä¸º <code>é¡¹ç›®è·¯å¾„</code>ï¼Œ<code>é¡¹ç›®å</code>ï¼Œ <code>reactScriptsç‰ˆæœ¬</code>ï¼Œ <code>æ˜¯å¦è¾“å…¥é¢å¤–ä¿¡æ¯</code>ï¼Œ <code>è¿è¡Œçš„è·¯å¾„</code>ï¼Œ <code>æ¨¡æ¿ï¼ˆå¼€å‘è°ƒè¯•ç”¨çš„ï¼‰</code>, <code>æ˜¯å¦ä½¿ç”¨yarn</code>ã€‚<br>äº†è§£å¤§æ¦‚çš„æµç¨‹ä¹‹åï¼Œå†ä¸€ä¸ªå‡½æ•°ä¸€ä¸ªå‡½æ•°è¿›å»çœ‹ã€‚</p>
<blockquote>
<p>checkAppName()  // æ£€æŸ¥ä¼ å…¥çš„é¡¹ç›®ååˆæ³•æ€§<br>isSafeToCreateProjectIn(root, name) // åˆ¤æ–­æ–°å»ºè¿™ä¸ªæ–‡ä»¶å¤¹æ˜¯å¦æ˜¯å®‰å…¨çš„<br>shouldUseYarn() // æ£€æŸ¥yarn<br>checkThatNpmCanReadCwd() // æ£€æŸ¥npm<br>run() // æ£€æŸ¥å®Œä¹‹åè°ƒç”¨runæ‰§è¡Œå®‰è£…ç­‰æ“ä½œ</p>
</blockquote>
<h3 id="checkAppName-æ£€æŸ¥projectNameæ˜¯å¦åˆæ³•"><a href="#checkAppName-æ£€æŸ¥projectNameæ˜¯å¦åˆæ³•" class="headerlink" title="checkAppName  æ£€æŸ¥projectNameæ˜¯å¦åˆæ³•"></a><a href="#checkAppName">checkAppName</a>  æ£€æŸ¥projectNameæ˜¯å¦åˆæ³•</h3><figure class="highlight javascript"><figcaption><span>createReactApp.js checkAppName</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkAppName</span>(<span class="params">appName</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> validationResult = validateProjectName(appName);</span><br><span class="line">  <span class="keyword">if</span> (!validationResult.validForNewPackages) &#123;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­æ˜¯å¦ç¬¦åˆnpmè§„èŒƒå¦‚æœä¸ç¬¦åˆï¼Œè¾“å‡ºæç¤ºå¹¶ç»“æŸä»»åŠ¡</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> dependencies = [<span class="string">&#x27;react&#x27;</span>, <span class="string">&#x27;react-dom&#x27;</span>, <span class="string">&#x27;react-scripts&#x27;</span>].sort();</span><br><span class="line">  <span class="keyword">if</span> (dependencies.indexOf(appName) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­æ˜¯å¦é‡åï¼Œå¦‚æœé‡ååˆ™è¾“å‡ºæç¤ºå¹¶ç»“æŸä»»åŠ¡</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>checkAppName</code> ç”¨äºåˆ¤æ–­å½“å‰çš„é¡¹ç›®åæ˜¯å¦ç¬¦åˆnpmè§„èŒƒï¼Œæ¯”å¦‚ä¸èƒ½å¤§å†™ç­‰ï¼Œç”¨çš„æ˜¯ä¸€ä¸ª<a href="validate-npm-package-name">validate-npm-package-name</a>çš„npmåŒ…ã€‚è¿™é‡Œç®€åŒ–äº†å¤§éƒ¨åˆ†çš„é”™è¯¯æç¤ºä»£ç ï¼Œä½†æ˜¯ä¸å½±å“å£æ„Ÿã€‚</p>
<h3 id="shouldUseYarn-åˆ¤æ–­æ˜¯å¦æœ‰è£…yarn-åŒç†çš„æœ‰-checkThatNpmCanReadCwd-ç”¨æ¥åˆ¤æ–­npm"><a href="#shouldUseYarn-åˆ¤æ–­æ˜¯å¦æœ‰è£…yarn-åŒç†çš„æœ‰-checkThatNpmCanReadCwd-ç”¨æ¥åˆ¤æ–­npm" class="headerlink" title="shouldUseYarn åˆ¤æ–­æ˜¯å¦æœ‰è£…yarn åŒç†çš„æœ‰ checkThatNpmCanReadCwd ç”¨æ¥åˆ¤æ–­npm"></a><a href="#shouldUseYarn">shouldUseYarn</a> åˆ¤æ–­æ˜¯å¦æœ‰è£…yarn åŒç†çš„æœ‰ <code>checkThatNpmCanReadCwd</code> ç”¨æ¥åˆ¤æ–­npm</h3><figure class="highlight javascript"><figcaption><span>createReactApp.js shouldUseYarn</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shouldUseYarn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    execSync(<span class="string">&#x27;yarnpkg --version&#x27;</span>, &#123; <span class="attr">stdio</span>: <span class="string">&#x27;ignore&#x27;</span> &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="run"><a href="#run" class="headerlink" title="run"></a><a href="#run">run</a></h3><p>å‰é¢çš„é‚£äº›æ“ä½œå¯ä»¥è¯´éƒ½æ˜¯å¤„ç†ä¸€äº›åˆ¤æ–­ä¸å…¼å®¹é€»è¾‘ï¼Œåˆ°<code>run</code>è¿™é‡Œæ‰æ˜¯ çœŸæ­£çš„æ ¸å¿ƒå®‰è£…é€»è¾‘ï¼Œ__å¼€å§‹å®‰è£…ä¾èµ–ï¼Œæ‹·è´æ¨¡ç‰ˆ__ç­‰ã€‚</p>
<figure class="highlight javascript"><figcaption><span>createReactApp.js run</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params">...</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// è¿™é‡Œè·å–è¦å®‰è£…çš„packageï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯ `react-scripts`ã€‚ ä¹Ÿå¯èƒ½æ˜¯æ ¹æ®ä¼ å‚å»æ‹¿å¯¹åº”çš„åŒ…</span></span><br><span class="line">  <span class="keyword">const</span> packageToInstall = getInstallPackage(version, originalDirectory);</span><br><span class="line">  <span class="comment">// éœ€è¦å®‰è£…æ‰€æœ‰çš„ä¾èµ–ï¼Œ react, react-dom, react-script</span></span><br><span class="line">  <span class="keyword">const</span> allDependencies = [<span class="string">&#x27;react&#x27;</span>, <span class="string">&#x27;react-dom&#x27;</span>, packageToInstall];</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>run</code> åšçš„äº‹æƒ…ä¸»è¦æœ‰è¿™ä¹ˆå‡ ä¸ªï¼Œå…ˆæ ¹æ®ä¼ å…¥çš„ç‰ˆæœ¬<code>version</code> å’ŒåŸå§‹ç›®å½•<code>originalDirectory</code> å»è·å–è¦å®‰è£…çš„æŸä¸ª packageã€‚<br>é»˜è®¤çš„ version ä¸ºç©º,è·å–åˆ°çš„ packageToInstall å€¼æ˜¯ <code>react-scripts</code>, ç„¶åå°†<code>packageToInstall</code>æ‹¼æ¥åˆ° <code>allDependencies</code>æ„ä¸ºæ‰€æœ‰éœ€è¦å®‰è£…çš„ä¾èµ–ã€‚<br>è¿™é‡Œè¯´ä¸€ä¸‹<code>react-scripts</code>å…¶å®å°±æ˜¯ä¸€ç³»åˆ—çš„webpacké…ç½®ä¸æ¨¡ç‰ˆï¼Œå±äº <code>create-react-app</code> å¦ä¸€ä¸ªæ ¸å¿ƒçš„ä¸€ä¸ªå¤§æ¨¡å—ã€‚<a target="_blank" rel="noopener" href="https://www.npmjs.com/package/react-scripts">ä¼ é€é—¨</a></p>
<figure class="highlight javascript"><figcaption><span>createReactApp.js run</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params">...</span>) </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="comment">// è·å–åŒ…åï¼Œæ”¯æŒ taz|taræ ¼å¼ã€gitä»“åº“ã€ç‰ˆæœ¬å·ã€æ–‡ä»¶è·¯å¾„ç­‰ç­‰</span></span><br><span class="line">  getPackageName(packageToInstall)</span><br><span class="line">    .then(<span class="function"><span class="params">packageName</span> =&gt;</span></span><br><span class="line">      <span class="comment">// å¦‚æœæ˜¯yarn,åˆ¤æ–­æ˜¯å¦åœ¨çº¿æ¨¡å¼ï¼ˆå¯¹åº”çš„å°±æ˜¯ç¦»çº¿æ¨¡å¼ï¼‰ï¼Œå¤„ç†å®Œåˆ¤æ–­å°±è¿”å›ç»™ä¸‹ä¸€ä¸ªthenå¤„ç†</span></span><br><span class="line">      checkIfOnline(useYarn).then(<span class="function"><span class="params">isOnline</span> =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">isOnline</span>: isOnline,</span><br><span class="line">        <span class="attr">packageName</span>: packageName,</span><br><span class="line">      &#125;))</span><br><span class="line">    )</span><br><span class="line">    .then(<span class="function"><span class="params">info</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> isOnline = info.isOnline;</span><br><span class="line">      <span class="keyword">const</span> packageName = info.packageName;</span><br><span class="line">      <span class="comment">/** å¼€å§‹æ ¸å¿ƒçš„å®‰è£…éƒ¨åˆ† ä¼ å…¥`å®‰è£…è·¯å¾„`ï¼Œ`æ˜¯å¦ä½¿ç”¨yarn`,`æ‰€æœ‰ä¾èµ–`ï¼Œ`æ˜¯å¦è¾“å‡ºé¢å¤–ä¿¡æ¯`ï¼Œ`åœ¨çº¿çŠ¶æ€` **/</span></span><br><span class="line">      <span class="comment">/** è¿™é‡Œä¸»è¦çš„æ“ä½œæ˜¯ æ ¹æ®ä¼ å…¥çš„å‚æ•°ï¼Œå¼€å§‹è·‘ npm || yarn å®‰è£…react react-domç­‰ä¾èµ– **/</span></span><br><span class="line">      <span class="comment">/** è¿™é‡Œå¦‚æœç½‘ç»œä¸å¥½ï¼Œå¯èƒ½ä¼šæŒ‚ **/</span></span><br><span class="line">      <span class="keyword">return</span> install(root, useYarn, allDependencies, verbose, isOnline).then(</span><br><span class="line">        <span class="function">() =&gt;</span> packageName</span><br><span class="line">      );</span><br><span class="line">    &#125;)</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åå¦‚æœå½“å‰æ˜¯é‡‡ç”¨yarnå®‰è£…æ–¹å¼çš„è¯ï¼Œå°±åˆ¤æ–­æ˜¯å¦å¤„äºç¦»çº¿çŠ¶æ€ã€‚åˆ¤æ–­å®Œè¿ç€å‰é¢çš„ <code>packageToInstall</code> å’Œ <code>allDependencies</code> ä¸€èµ·ä¸¢ç»™ <code>install</code> æ–¹æ³•ï¼Œå†ç”±<code>install</code>æ–¹æ³•å»è·‘å®‰è£…ã€‚</p>
<blockquote>
<p>runæ–¹æ³•<br>getInstallPackage(); // è·å–è¦å®‰è£…çš„æ¨¡ç‰ˆåŒ… é»˜è®¤æ˜¯ react-scripts<br>install(); // ä¼ å‚æ•°ç»™install è´Ÿè´£å®‰è£… allDependencies<br>init(); // è°ƒç”¨å®‰è£…äº†çš„ react-scripts/script/init å»æ‹·è´æ¨¡ç‰ˆ<br>.catch(); // é”™è¯¯å¤„ç†</p>
</blockquote>
<h3 id="install"><a href="#install" class="headerlink" title="install"></a><a href="#install">install</a></h3><figure class="highlight javascript"><figcaption><span>createReactApp.js install</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">install</span>(<span class="params">root, useYarn, dependencies, verbose, isOnline</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ä¸»è¦æ ¹æ®å‚æ•°æ‹¼è£…å‘½ä»¤è¡Œï¼Œç„¶åç”¨nodeå»è·‘å®‰è£…è„šæœ¬ å¦‚ `npm install react react-dom --save` æˆ–è€… `yarn add react react-dom`</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> command;</span><br><span class="line">    <span class="keyword">let</span> args;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼€å§‹æ‹¼è£… yarn å‘½ä»¤è¡Œ</span></span><br><span class="line">    <span class="keyword">if</span> (useYarn) &#123;</span><br><span class="line">      command = <span class="string">&#x27;yarnpkg&#x27;</span>;</span><br><span class="line">      args = [<span class="string">&#x27;add&#x27;</span>, <span class="string">&#x27;--exact&#x27;</span>]; <span class="comment">// ä½¿ç”¨ç¡®åˆ‡ç‰ˆæœ¬æ¨¡å¼</span></span><br><span class="line">      <span class="comment">// åˆ¤æ–­æ˜¯å¦æ˜¯ç¦»çº¿çŠ¶æ€ åŠ ä¸ªçŠ¶æ€</span></span><br><span class="line">      <span class="keyword">if</span> (!isOnline) &#123;</span><br><span class="line">        args.push(<span class="string">&#x27;--offline&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      [].push.apply(args, dependencies);</span><br><span class="line">      <span class="comment">// å°†cwdè®¾ç½®ä¸ºæˆ‘ä»¬è¦å®‰è£…çš„ç›®å½•è·¯å¾„</span></span><br><span class="line">      args.push(<span class="string">&#x27;--cwd&#x27;</span>);</span><br><span class="line">      args.push(root);</span><br><span class="line">      <span class="comment">// å¦‚æœæ˜¯ç¦»çº¿çš„è¯è¾“å‡ºä¸€äº›æç¤ºä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// npm å®‰è£…æ¨¡å¼ï¼Œä¸yarnåŒç†</span></span><br><span class="line">      command = <span class="string">&#x27;npm&#x27;</span>;</span><br><span class="line">      args = [</span><br><span class="line">        <span class="string">&#x27;install&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;--save&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;--save-exact&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;--loglevel&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;error&#x27;</span>,</span><br><span class="line">      ].concat(dependencies);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæœ‰ä¼ verboseï¼Œ åˆ™åŠ è¯¥å‚æ•° è¾“å‡ºé¢å¤–çš„ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">if</span> (verbose) &#123;</span><br><span class="line">      args.push(<span class="string">&#x27;--verbose&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”¨ cross-spawn è·¨å¹³å°æ‰§è¡Œå‘½ä»¤è¡Œ</span></span><br><span class="line">    <span class="keyword">const</span> child = spawn(command, args, &#123; <span class="attr">stdio</span>: <span class="string">&#x27;inherit&#x27;</span> &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  å…³é—­çš„å¤„ç†</span></span><br><span class="line">    child.on(<span class="string">&#x27;close&#x27;</span>, <span class="function"><span class="params">code</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (code !== <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> reject(&#123; <span class="attr">command</span>: <span class="string">`<span class="subst">$&#123;command&#125;</span> <span class="subst">$&#123;args.join(<span class="string">&#x27; &#x27;</span>)&#125;</span>`</span>, &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      resolve();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬é¡ºç€æ–­ç‚¹ä»<code>run</code>è·‘åˆ°<code>install</code>æ–¹æ³•ï¼Œèƒ½çœ‹åˆ°ä»£ç é‡Œæ ¹æ®æ˜¯å¦ä½¿ç”¨yarnåˆ†æˆä¸¤ç§å¤„ç†æ–¹æ³•ã€‚<br><code>if (useYarn) &#123; yarn å®‰è£…é€»è¾‘ &#125; else &#123; npm å®‰è£…é€»è¾‘ &#125;</code><br>å¤„ç†æ–¹æ³•éƒ½æ˜¯åŒä¸ªé€»è¾‘ï¼Œæ ¹æ®ä¼ å…¥çš„ <code>dependencies</code> å»æ‹¼æ¥éœ€è¦å®‰è£…çš„ä¾èµ–ï¼Œä¸»è¦æœ‰ <code>react</code>,<code>react-dom</code>,<code>react-script</code> ã€‚å†åˆ¤æ–­<code>verbose</code>å’Œ<code>isOnline</code> åŠ ä¸€äº›å‘½ä»¤è¡Œçš„å‚æ•°ã€‚<br>æœ€åå†ç”¨nodeè·‘å‘½ä»¤ï¼Œå¹³å°å·®å¼‚çš„è¯æ˜¯å€ŸåŠ©<a target="_blank" rel="noopener" href="https://www.npmjs.com/package/cross-spawn">cross-spawn</a>å»å¤„ç†çš„ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚<br>å…·ä½“é€»è¾‘è§ä¸Šé¢ä»£ç ï¼Œå»æ‰ä¸é‡è¦çš„ä¿¡æ¯è¾“å‡ºï¼Œä»£ç è¿˜æ˜¯æ¯”è¾ƒæ˜“æ‡‚ã€‚</p>
<blockquote>
<p>install<br>æ ¹æ®ä¼ è¿›æ¥çš„å‚æ•°åˆ¤æ–­ç”¨yarnè¿˜æ˜¯npm<br>æ‹¼è£…éœ€è¦çš„ä¾èµ–<br>ç”¨cross-spawnè·‘å‘½ä»¤å®‰è£…</p>
</blockquote>
<p>åœ¨<code>install</code>ä¼šè¿”å›ä¸€ä¸ª<code>Promise</code>åœ¨å®‰è£…å®Œä¹‹åï¼Œæ–­ç‚¹åˆå›åˆ°æˆ‘ä»¬çš„<code>run</code>å‡½æ•°ç»§ç»­èµ°æ¥ä¸‹æ¥çš„é€»è¾‘ã€‚</p>
<figure class="highlight javascript"><figcaption><span>createReactApp.js run</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  getPackageName()</span><br><span class="line">    .then(<span class="function">()=&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> install(root, useYarn, allDependencies, verbose, isOnline).then(</span><br><span class="line">            <span class="function">() =&gt;</span> packageName</span><br><span class="line">      );</span><br><span class="line">    &#125;)</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ—¢ç„¶æˆ‘ä»¬çš„<code>install</code>å·²ç»æŠŠå¼€å‘éœ€è¦çš„ä¾èµ–å®‰è£…å®Œäº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥å¼€åˆ¤æ–­å½“å‰è¿è¡Œçš„<code>node</code>æ˜¯å¦ç¬¦åˆæˆ‘ä»¬å·²ç»å®‰è£…çš„<code>react-scripts</code>é‡Œé¢çš„<code>packages.json</code>è¦æ±‚çš„nodeç‰ˆæœ¬ã€‚<br>è¿™å¥è¯æœ‰ç‚¹ç»•ï¼Œç®€å•æ¥è¯´å°±æ˜¯åˆ¤æ–­å½“å‰è¿è¡Œçš„nodeç‰ˆæœ¬æ˜¯å¦<code>react-scripts</code>è¿™ä¸ªä¾èµ–æ‰€éœ€ã€‚</p>
<p>ç„¶åå°±æŠŠå¼€å§‹ä¿®æ”¹<code>package.json</code>æˆ‘ä»¬å·²ç»å®‰è£…çš„ä¾èµ–(react, react-dom, react-scripts)ç‰ˆæœ¬ä»åŸæœ¬çš„ç²¾ç¡®ç‰ˆæœ¬eg(16.0.0)ä¿®æ”¹ä¸ºé«˜äºç­‰äºç‰ˆæœ¬eg(^16.0.0)ã€‚<br>è¿™äº›å¤„ç†åšå®Œä¹‹åï¼Œæˆ‘ä»¬çš„ç›®å½•æ˜¯é•¿è¿™æ ·å­çš„ï¼Œé‡Œé¢é™¤äº†å®‰è£…çš„ä¾èµ–å’Œ<code>package.json</code>å¤–æ²¡æœ‰ä»»ä½•ä¸œè¥¿ã€‚æ‰€ä»¥æ¥ä¸‹æ¥çš„æ“ä½œæ˜¯ç”Ÿæˆä¸€äº›webpackçš„é…ç½®å’Œä¸€ä¸ªç®€å•çš„å¯å¯åŠ¨demoã€‚<br><img data-src="/create-react-app-o/create-react-app1.png"></p>
<p>é‚£ä¹ˆä»–æ˜¯æ€ä¹ˆå¿«é€Ÿç”Ÿæˆè¿™äº›ä¸œè¥¿çš„å‘¢ï¼Ÿ<br>è¿˜è®°å¾—ä¸€å¼€å§‹è¯´äº†æœ‰ä¸€ä¸ª éšè—çš„å‘½ä»¤è¡Œå‚æ•° <code>--internal-testing-template</code> ç”¨æ¥ç»™å¼€å‘è€…è°ƒè¯•ç”¨çš„å—ï¼Œæ‰€ä»¥å…¶å®create-react-appç”Ÿæˆè¿™äº›çš„æ–¹æ³•å°±æ˜¯ç›´æ¥æŠŠæŸä¸€ä¸ªè·¯å¾„çš„æ¨¡æ¿æ‹·è´åˆ°å¯¹åº”çš„åœ°æ–¹ã€‚æ˜¯ä¸æ˜¯å¾ˆç®€å•ç²—æš´hhhhh</p>
<figure class="highlight javascript"><figcaption><span>createReactApp.js run</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">run</span>(<span class="params">...</span>)</span> &#123;</span><br><span class="line">  ...</span><br><span class="line">    getPackageName(packageToInstall)</span><br><span class="line">    .then(...)</span><br><span class="line">    .then(<span class="function"><span class="params">info</span> =&gt;</span> install(...).then(<span class="function">()=&gt;</span> packageName))</span><br><span class="line">    <span class="comment">/** install å®‰è£…å®Œä¹‹åçš„é€»è¾‘ **/</span></span><br><span class="line">    <span class="comment">/** ä»è¿™é‡Œå¼€å§‹æ‹·è´æ¨¡æ¿é€»è¾‘ **/</span></span><br><span class="line">    .then(<span class="function"><span class="params">packageName</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// å®‰è£…å®Œ react, react-dom, react-scripts ä¹‹åæ£€æŸ¥å½“å‰ç¯å¢ƒè¿è¡Œçš„nodeç‰ˆæœ¬æ˜¯å¦ç¬¦åˆè¦æ±‚</span></span><br><span class="line">      checkNodeVersion(packageName);</span><br><span class="line">      <span class="comment">// è¯¥é¡¹package.jsoné‡Œreact, react-domçš„ç‰ˆæœ¬èŒƒå›´ï¼Œeg: 16.0.0 =&gt; ^16.0.0</span></span><br><span class="line">      setCaretRangeForRuntimeDeps(packageName);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// åŠ è½½scriptè„šæœ¬ï¼Œå¹¶æ‰§è¡Œinitæ–¹æ³•</span></span><br><span class="line">      <span class="keyword">const</span> scriptsPath = path.resolve(</span><br><span class="line">        process.cwd(),</span><br><span class="line">        <span class="string">&#x27;node_modules&#x27;</span>,</span><br><span class="line">        packageName,</span><br><span class="line">        <span class="string">&#x27;scripts&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;init.js&#x27;</span></span><br><span class="line">      );</span><br><span class="line">      <span class="keyword">const</span> init = <span class="built_in">require</span>(scriptsPath);</span><br><span class="line">      <span class="comment">// init æ–¹æ³•ä¸»è¦æ‰§è¡Œçš„æ“ä½œæ˜¯</span></span><br><span class="line">      <span class="comment">// å†™å…¥package.json ä¸€äº›è„šæœ¬ã€‚eg: script: &#123;start: &#x27;react-scripts start&#x27;&#125;</span></span><br><span class="line">      <span class="comment">// æ”¹å†™README.MD</span></span><br><span class="line">      <span class="comment">// æŠŠé¢„è®¾çš„æ¨¡ç‰ˆæ‹·è´åˆ°é¡¹ç›®ä¸‹</span></span><br><span class="line">      <span class="comment">// è¾“å‡ºæˆåŠŸä¸åç»­æ“ä½œçš„ä¿¡æ¯</span></span><br><span class="line">      init(root, appName, verbose, originalDirectory, template);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (version === <span class="string">&#x27;react-scripts@0.9.x&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœæ˜¯æ—§ç‰ˆæœ¬çš„ react-scripts è¾“å‡ºæç¤º</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="params">reason</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// å‡ºé”™çš„è¯ï¼ŒæŠŠå®‰è£…äº†çš„æ–‡ä»¶å…¨åˆ äº† å¹¶è¾“å‡ºä¸€äº›æ—¥å¿—ä¿¡æ¯ç­‰</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œå®‰è£…å®Œä¾èµ–ä¹‹åï¼Œæ‰§è¡Œ<code>checkNodeVersion</code>åˆ¤æ–­nodeç‰ˆæœ¬æ˜¯å¦ä¸ä¾èµ–ç›¸ç¬¦ã€‚<br>ä¹‹åæ‹¼æ¥è·¯å¾„å»è·‘<code>ç›®å½•/node_modules/react-scripts/scripts/init.js</code>ï¼Œä¼ å‚è®©ä»–å»åšä¸€äº›åˆå§‹åŒ–çš„äº‹æƒ…ã€‚<br>ç„¶åå¯¹å‡ºé”™æƒ…å†µåšä¸€äº›ç›¸åº”çš„å¤„ç†</p>
<h2 id="node-modules-react-scripts-script-init-js"><a href="#node-modules-react-scripts-script-init-js" class="headerlink" title="/node_modules/react-scripts/script/init.js"></a><a href="#/node_modules/react-scripts/script/init.js">/node_modules/react-scripts/script/init.js</a></h2><figure class="highlight javascript"><figcaption><span>ç›®æ ‡æ–‡ä»¶å¤¹/node_modules/react-scripts/script/init.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">  appPath,</span></span></span><br><span class="line"><span class="params"><span class="function">  appName,</span></span></span><br><span class="line"><span class="params"><span class="function">  verbose,</span></span></span><br><span class="line"><span class="params"><span class="function">  originalDirectory,</span></span></span><br><span class="line"><span class="params"><span class="function">  template</span></span></span><br><span class="line"><span class="params"><span class="function"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> ownPackageName = <span class="built_in">require</span>(path.join(__dirname, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;package.json&#x27;</span>))</span><br><span class="line">    .name;</span><br><span class="line">  <span class="keyword">const</span> ownPath = path.join(appPath, <span class="string">&#x27;node_modules&#x27;</span>, ownPackageName);</span><br><span class="line">  <span class="keyword">const</span> appPackage = <span class="built_in">require</span>(path.join(appPath, <span class="string">&#x27;package.json&#x27;</span>));</span><br><span class="line">  <span class="keyword">const</span> useYarn = fs.existsSync(path.join(appPath, <span class="string">&#x27;yarn.lock&#x27;</span>));</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 1. æŠŠå¯åŠ¨è„šæœ¬å†™å…¥ç›®æ ‡ package.json </span></span><br><span class="line">  appPackage.scripts = &#123;</span><br><span class="line">    <span class="attr">start</span>: <span class="string">&#x27;react-scripts start&#x27;</span>,</span><br><span class="line">    <span class="attr">build</span>: <span class="string">&#x27;react-scripts build&#x27;</span>,</span><br><span class="line">    <span class="attr">test</span>: <span class="string">&#x27;react-scripts test --env=jsdom&#x27;</span>,</span><br><span class="line">    <span class="attr">eject</span>: <span class="string">&#x27;react-scripts eject&#x27;</span>,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  fs.writeFileSync(</span><br><span class="line">    path.join(appPath, <span class="string">&#x27;package.json&#x27;</span>),</span><br><span class="line">    <span class="built_in">JSON</span>.stringify(appPackage, <span class="literal">null</span>, <span class="number">2</span>)</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2. æ”¹å†™README.MDï¼ŒæŠŠä¸€äº›å¸®åŠ©ä¿¡æ¯å†™è¿›å»</span></span><br><span class="line">  <span class="keyword">const</span> readmeExists = fs.existsSync(path.join(appPath, <span class="string">&#x27;README.md&#x27;</span>));</span><br><span class="line">  <span class="keyword">if</span> (readmeExists) &#123;</span><br><span class="line">    fs.renameSync(</span><br><span class="line">      path.join(appPath, <span class="string">&#x27;README.md&#x27;</span>),</span><br><span class="line">      path.join(appPath, <span class="string">&#x27;README.old.md&#x27;</span>)</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3. æŠŠé¢„è®¾çš„æ¨¡ç‰ˆæ‹·è´åˆ°é¡¹ç›®ä¸‹ï¼Œä¸»è¦æœ‰ public, src/[APP.css, APP.js, index.js,....], .gitignore</span></span><br><span class="line">  <span class="keyword">const</span> templatePath = template</span><br><span class="line">    ? path.resolve(originalDirectory, template)</span><br><span class="line">    : path.join(ownPath, <span class="string">&#x27;template&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> (fs.existsSync(templatePath)) &#123;</span><br><span class="line">    fs.copySync(templatePath, appPath);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  fs.move(</span><br><span class="line">    path.join(appPath, <span class="string">&#x27;gitignore&#x27;</span>),</span><br><span class="line">    path.join(appPath, <span class="string">&#x27;.gitignore&#x27;</span>),</span><br><span class="line">    [],</span><br><span class="line">    <span class="function"><span class="params">err</span> =&gt;</span> &#123; <span class="comment">/* é”™è¯¯å¤„ç† */</span>  &#125;</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿™é‡Œå†æ¬¡è¿›è¡Œå‘½ä»¤è¡Œçš„æ‹¼æ¥ï¼Œå¦‚æœåé¢å‘ç°æ²¡æœ‰å®‰è£…reactå’Œreact-dom,é‡æ–°å®‰è£…ä¸€æ¬¡</span></span><br><span class="line">  <span class="keyword">let</span> command;</span><br><span class="line">  <span class="keyword">let</span> args;</span><br><span class="line">  <span class="keyword">if</span> (useYarn) &#123;</span><br><span class="line">    command = <span class="string">&#x27;yarnpkg&#x27;</span>;</span><br><span class="line">    args = [<span class="string">&#x27;add&#x27;</span>];</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    command = <span class="string">&#x27;npm&#x27;</span>;</span><br><span class="line">    args = [<span class="string">&#x27;install&#x27;</span>, <span class="string">&#x27;--save&#x27;</span>, verbose &amp;&amp; <span class="string">&#x27;--verbose&#x27;</span>].filter(<span class="function"><span class="params">e</span> =&gt;</span> e);</span><br><span class="line">  &#125;</span><br><span class="line">  args.push(<span class="string">&#x27;react&#x27;</span>, <span class="string">&#x27;react-dom&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> templateDependenciesPath = path.join(</span><br><span class="line">    appPath,</span><br><span class="line">    <span class="string">&#x27;.template.dependencies.json&#x27;</span></span><br><span class="line">  );</span><br><span class="line">  <span class="keyword">if</span> (fs.existsSync(templateDependenciesPath)) &#123;</span><br><span class="line">    <span class="keyword">const</span> templateDependencies = <span class="built_in">require</span>(templateDependenciesPath).dependencies;</span><br><span class="line">    args = args.concat(</span><br><span class="line">      <span class="built_in">Object</span>.keys(templateDependencies).map(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;key&#125;</span>@<span class="subst">$&#123;templateDependencies[key]&#125;</span>`</span>;</span><br><span class="line">      &#125;)</span><br><span class="line">    );</span><br><span class="line">    fs.unlinkSync(templateDependenciesPath);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!isReactInstalled(appPackage) || template) &#123;</span><br><span class="line">    <span class="keyword">const</span> proc = spawn.sync(command, args, &#123; <span class="attr">stdio</span>: <span class="string">&#x27;inherit&#x27;</span> &#125;);</span><br><span class="line">    <span class="keyword">if</span> (proc.status !== <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="built_in">console</span>.error(<span class="string">`\`<span class="subst">$&#123;command&#125;</span> <span class="subst">$&#123;args.join(<span class="string">&#x27; &#x27;</span>)&#125;</span>\` failed`</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 5. è¾“å‡ºæˆåŠŸçš„æ—¥å¿—</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>init</code>æ–‡ä»¶åˆæ˜¯ä¸€ä¸ªå¤§å¤´ï¼Œå¤„ç†çš„é€»è¾‘ä¸»è¦æœ‰</p>
</blockquote>
<ol>
<li>ä¿®æ”¹package.jsonï¼Œå†™å…¥ä¸€äº›å¯åŠ¨è„šæœ¬ï¼Œæ¯”å¦‚<code>script: &#123;start: &#39;react-scripts start&#39;&#125;</code>ï¼Œç”¨æ¥å¯åŠ¨å¼€å‘é¡¹ç›®</li>
<li>æ”¹å†™README.MDï¼ŒæŠŠä¸€äº›å¸®åŠ©ä¿¡æ¯å†™è¿›å»</li>
<li>æŠŠé¢„è®¾çš„æ¨¡ç‰ˆæ‹·è´åˆ°é¡¹ç›®ä¸‹ï¼Œä¸»è¦æœ‰ <code>public</code>, <code>src/[APP.css, APP.js, index.js,....]</code>, <code>.gitignore</code></li>
<li>å¯¹æ—§ç‰ˆçš„nodeåšä¸€äº›å…¼å®¹çš„å¤„ç†ï¼Œè¿™é‡Œè¡¥ä¸€å¥ï¼Œåœ¨é€‰æ‹© react-scripts æ—¶å°±æœ‰æ ¹æ®nodeç‰ˆæœ¬å»åˆ¤æ–­é€‰æ‹©æ¯”è¾ƒè€çš„ @0.9.x ç‰ˆã€‚</li>
<li>å¦‚æœå®Œæˆè¾“å‡ºå¯¹åº”çš„ä¿¡æ¯ï¼Œå¦‚æœå¤±è´¥ï¼Œåšä¸€äº›è¾“å‡ºæ—¥å¿—ç­‰æ“ä½œã€‚</li>
</ol>
<p>è¿™é‡Œä»£ç æœ‰ç‚¹å¤šï¼Œæ‰€ä»¥åˆ äº†ä¸€å°éƒ¨åˆ†ï¼Œå¦‚æœå¯¹åˆå§‹çš„ä»£ç æ„Ÿå…´è¶£å¯ä»¥è·³è½¬åˆ°è¿™å„¿çœ‹<a target="_blank" rel="noopener" href="https://github.com/facebook/create-react-app/blob/v1.1.4/packages/react-scripts/scripts/init.js">react-scripts/scripts/init.js ä¼ é€é—¨</a></p>
<h1 id="END"><a href="#END" class="headerlink" title="END~"></a>END~</h1><p>åˆ°è¿™é‡Œ <code>create-react-app</code> é¡¹ç›®æ„å»ºçš„éƒ¨åˆ†å¤§æµç¨‹å·²ç»èµ°å®Œäº†ï¼Œæˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹ï¼š</p>
<ol>
<li>åˆ¤æ–­nodeç‰ˆæœ¬å¦‚æœå°äº4å°±é€€å‡ºï¼Œå¦åˆ™æ‰§è¡Œ <code>createReactApp.js</code> æ–‡ä»¶</li>
<li><code>createReactApp.js</code>å…ˆåšä¸€äº›å‘½ä»¤è¡Œçš„å¤„ç†å“åº”å¤„ç†ï¼Œç„¶ååˆ¤æ–­æ˜¯å¦æœ‰ä¼ å…¥ <code>projectName</code> æ²¡æœ‰å°±æç¤ºå¹¶é€€å‡º</li>
<li>æ ¹æ®ä¼ å…¥çš„ <code>projectName</code> åˆ›å»ºç›®å½•ï¼Œå¹¶åˆ›å»º<code>package.json</code>ã€‚</li>
<li>åˆ¤æ–­æ˜¯å¦æœ‰ç‰¹æ®Šè¦æ±‚æŒ‡å®šå®‰è£…æŸä¸ªç‰ˆæœ¬çš„<code>react-scripts</code>ï¼Œç„¶åç”¨<code>cross-spawn</code>å»å¤„ç†è·¨å¹³å°çš„å‘½ä»¤è¡Œé—®é¢˜ï¼Œç”¨<code>yarn</code>æˆ–<code>npm</code>å®‰è£…<code>react</code>, <code>react-dom</code>, <code>react-scripts</code>ã€‚</li>
<li>å®‰è£…å®Œä¹‹åè·‘ <code>react-scripts/script/init.js</code> ä¿®æ”¹ <code>package.json</code> çš„ä¾èµ–ç‰ˆæœ¬ï¼Œè¿è¡Œè„šæœ¬ï¼Œå¹¶æ‹·è´å¯¹åº”çš„æ¨¡æ¿åˆ°ç›®å½•é‡Œã€‚</li>
<li>å¤„ç†å®Œè¿™äº›ä¹‹åï¼Œè¾“å‡ºæç¤ºç»™ç”¨æˆ·ã€‚</li>
</ol>
<p>æœ¬æ¥æƒ³æŠŠæ•´ä¸ª create-react-app è¯´å®Œï¼Œä½†æ˜¯å‘ç°è¯´ä¸€ä¸ªåˆ›å»ºå°±å†™äº†è¿™ä¹ˆå¤šï¼Œæ‰€ä»¥åé¢å¦‚æœæœ‰æƒ³ç»§ç»­çœ‹ <code>react-scripts</code>çš„è¯ï¼Œä¼šå¦å¤–å¼€ä¸€ç¯‡æ¥è®²ã€‚<br>å¤§å®¶ä¹Ÿå¯ä»¥æ ¹æ®è¿™ä¸ªæ€è·¯è‡ªå·±æ–­ç‚¹å»çœ‹ï¼Œä¸è¿‡ <code>react-scripts</code> ä¸»è¦å¯èƒ½æ˜¯webpacké…ç½®å±…å¤šï¼Œæ–­ç‚¹å¸®åŠ©åº”è¯¥ä¸å¤§ã€‚</p>
<h1 id="create-react-appç³»åˆ—ç¬¬äºŒç¯‡ä¼ é€é—¨"><a href="#create-react-appç³»åˆ—ç¬¬äºŒç¯‡ä¼ é€é—¨" class="headerlink" title="create-react-appç³»åˆ—ç¬¬äºŒç¯‡ä¼ é€é—¨"></a><a href="https://jsonz1993.github.io/2018/05/create-react-app-t/">create-react-appç³»åˆ—ç¬¬äºŒç¯‡ä¼ é€é—¨</a></h1>
    </div>

    
    
    
        <div class="reward-container">
  <div></div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    Donate
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechat_pay.jpeg" alt="Jsonz WeChat Pay">
        <p>WeChat Pay</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/ali_pay.jpeg" alt="Jsonz Alipay">
        <p>Alipay</p>
      </div>

  </div>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/JavaScript/" rel="tag"># JavaScript</a>
              <a href="/tags/React/" rel="tag"># React</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2018-04-29/" rel="prev" title="2018-04-29é¢è¯•è®°A">
      <i class="fa fa-chevron-left"></i> 2018-04-29é¢è¯•è®°A
    </a></div>
      <div class="post-nav-item">
    <a href="/2018-05-08/" rel="next" title="2018-05-08é¢è¯•è®°B">
      2018-05-08é¢è¯•è®°B <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BF%AB%E9%80%9F%E4%BA%86%E8%A7%A3"><span class="nav-number">1.</span> <span class="nav-text">å¿«é€Ÿäº†è§£</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="nav-number">2.</span> <span class="nav-text">é¡¹ç›®åˆå§‹åŒ–</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95"><span class="nav-number">3.</span> <span class="nav-text">é…ç½®æ–­ç‚¹è°ƒè¯•</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#vscode-debug"><span class="nav-number">3.1.</span> <span class="nav-text">vscode debug</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#node-%E8%B0%83%E8%AF%95"><span class="nav-number">3.2.</span> <span class="nav-text">node è°ƒè¯•</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BC%80%E5%A7%8B%E6%96%AD%E7%82%B9%E9%98%85%E8%AF%BB%E6%BA%90%E7%A0%81"><span class="nav-number">4.</span> <span class="nav-text">å¼€å§‹æ–­ç‚¹é˜…è¯»æºç </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#packages-create-react-app-index-js-github%E6%96%87%E4%BB%B6%E4%BC%A0%E9%80%81%E9%97%A8"><span class="nav-number">4.1.</span> <span class="nav-text">packages&#x2F;create-react-app&#x2F;index.js githubæ–‡ä»¶ä¼ é€é—¨</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#packages-create-react-app-createReactApp-js-github%E6%96%87%E4%BB%B6%E4%BC%A0%E9%80%81%E9%97%A8"><span class="nav-number">4.2.</span> <span class="nav-text">packages&#x2F;create-react-app&#x2F;createReactApp.js githubæ–‡ä»¶ä¼ é€é—¨</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#commander-%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F"><span class="nav-number">4.2.1.</span> <span class="nav-text">commander å‘½ä»¤è¡Œå¤„ç†ç¨‹åº</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E6%9C%89%E4%BC%A0projectName"><span class="nav-number">4.2.2.</span> <span class="nav-text">åˆ¤æ–­æ˜¯å¦æœ‰ä¼ projectName</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9A%90%E8%97%8F%E7%9A%84-commander-%E5%8F%82%E6%95%B0"><span class="nav-number">4.2.3.</span> <span class="nav-text">éšè—çš„ commander å‚æ•°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#createApp"><span class="nav-number">4.2.4.</span> <span class="nav-text">createApp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#checkAppName-%E6%A3%80%E6%9F%A5projectName%E6%98%AF%E5%90%A6%E5%90%88%E6%B3%95"><span class="nav-number">4.2.5.</span> <span class="nav-text">checkAppName  æ£€æŸ¥projectNameæ˜¯å¦åˆæ³•</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#shouldUseYarn-%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E6%9C%89%E8%A3%85yarn-%E5%90%8C%E7%90%86%E7%9A%84%E6%9C%89-checkThatNpmCanReadCwd-%E7%94%A8%E6%9D%A5%E5%88%A4%E6%96%ADnpm"><span class="nav-number">4.2.6.</span> <span class="nav-text">shouldUseYarn åˆ¤æ–­æ˜¯å¦æœ‰è£…yarn åŒç†çš„æœ‰ checkThatNpmCanReadCwd ç”¨æ¥åˆ¤æ–­npm</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#run"><span class="nav-number">4.2.7.</span> <span class="nav-text">run</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#install"><span class="nav-number">4.2.8.</span> <span class="nav-text">install</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#node-modules-react-scripts-script-init-js"><span class="nav-number">4.3.</span> <span class="nav-text">&#x2F;node_modules&#x2F;react-scripts&#x2F;script&#x2F;init.js</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#END"><span class="nav-number">5.</span> <span class="nav-text">END~</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#create-react-app%E7%B3%BB%E5%88%97%E7%AC%AC%E4%BA%8C%E7%AF%87%E4%BC%A0%E9%80%81%E9%97%A8"><span class="nav-number">6.</span> <span class="nav-text">create-react-appç³»åˆ—ç¬¬äºŒç¯‡ä¼ é€é—¨</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Jsonz"
      src="/images/avatar.jpeg">
  <p class="site-author-name" itemprop="name">Jsonz</p>
  <div class="site-description" itemprop="description">å‰ç«¯ğŸ‘´ğŸ¥¬ğŸ£/JavaScript/React</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">49</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">32</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/jsonz1993/blog" title="Blog â†’ https:&#x2F;&#x2F;github.com&#x2F;jsonz1993&#x2F;blog" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>Blog</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:jsonz@qq.com" title="E-Mail â†’ mailto:jsonz@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://juejin.im/user/58dbb0b844d904006954ca8e" title="æ˜é‡‘ â†’ https:&#x2F;&#x2F;juejin.im&#x2F;user&#x2F;58dbb0b844d904006954ca8e" rel="noopener" target="_blank"><i class="fa fa-bullseye fa-fw"></i>æ˜é‡‘</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.hhking.cn/" title="hhking â†’ https:&#x2F;&#x2F;blog.hhking.cn" rel="noopener" target="_blank"><i class="fa fa-user-friends fa-fw"></i>hhking</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">ç²¤ICPå¤‡18066881å· </a>
  </div>

<div class="copyright">
  
  &copy; 2017 â€“ 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jsonz</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>











<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  
  <script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri === 'http://jsonz1993.github.io/create-react-app-o/',]
      });
      });
  </script>

</body>
</html>
