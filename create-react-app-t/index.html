<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"jsonz1993.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":true,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="æ¢ç´¢create-react-appæ¡†æ¶çš„æºç åŠæ€æƒ³ï¼ˆäºŒï¼‰">
<meta property="og:type" content="article">
<meta property="og:title" content="create-react-app æºç è§£æä¹‹react-scripts">
<meta property="og:url" content="http://jsonz1993.github.io/create-react-app-t/index.html">
<meta property="og:site_name" content="Jsonz bug-log">
<meta property="og:description" content="æ¢ç´¢create-react-appæ¡†æ¶çš„æºç åŠæ€æƒ³ï¼ˆäºŒï¼‰">
<meta property="og:locale">
<meta property="og:image" content="http://jsonz1993.github.io/create-react-app-t/tty_choose_port.png">
<meta property="og:image" content="http://jsonz1993.github.io/create-react-app-t/webpackDevServer_error.png">
<meta property="article:published_time" content="2018-05-14T20:44:48.000Z">
<meta property="article:modified_time" content="2021-07-20T11:40:04.554Z">
<meta property="article:author" content="Jsonz">
<meta property="article:tag" content="JavaScript">
<meta property="article:tag" content="React">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://jsonz1993.github.io/create-react-app-t/tty_choose_port.png">

<link rel="canonical" href="http://jsonz1993.github.io/create-react-app-t/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-Hans'
  };
</script>

  <title>create-react-app æºç è§£æä¹‹react-scripts | Jsonz bug-log</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?c8a069a38f5fa73f5b6bcff8d176157f";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Jsonz bug-log" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Jsonz bug-log</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">åç»­æ›´æ–°ä¼šæ”¾åœ¨ github.com/jsonz1993/blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">32</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">2</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">49</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://jsonz1993.github.io/create-react-app-t/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Jsonz">
      <meta itemprop="description" content="å‰ç«¯ğŸ‘´ğŸ¥¬ğŸ£/JavaScript/React">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jsonz bug-log">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          create-react-app æºç è§£æä¹‹react-scripts
        </h1>
        <div class="post-meta ">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-05-14 20:44:48" itemprop="dateCreated datePublished" datetime="2018-05-14T20:44:48+00:00">2018-05-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-07-20 11:40:04" itemprop="dateModified" datetime="2021-07-20T11:40:04+00:00">2021-07-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index"><span itemprop="name">technology</span></a>
                </span>
            </span>

          
            <div class="post-description">æ¢ç´¢create-react-appæ¡†æ¶çš„æºç åŠæ€æƒ³ï¼ˆäºŒï¼‰</div>

        </div>

      </header>

    
    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>ä¸Šä¸€ç¯‡æˆ‘ä»¬å·²ç»è®²äº† <code>create-react-app</code>é‡Œé¢åˆ›å»º<code>package.json</code>å®‰è£…ä¾èµ–å¹¶ä¸”æ‹·è´å¯è¿è¡Œçš„demoç­‰æ­¥éª¤ã€‚<a href="https://jsonz1993.github.io/2018/05/create-react-app-o/">ä¼ é€é—¨</a></p>
<p>è¿™ä¸€ç¯‡æˆ‘ä»¬æ¥è®²ä¸€ä¸‹ <code>create-react-app</code>é‡Œé¢çš„å¯åŠ¨æœåŠ¡ç­‰éƒ¨åˆ†ï¼Œå°±æ˜¯å¹³æ—¶æˆ‘ä»¬å®‰è£…å®Œä¾èµ–ä¹‹åï¼Œå¯åŠ¨å¼€å‘æœåŠ¡:<code>npm start</code>ã€‚è¿™ä¸€å—æ¶‰åŠåˆ°å¤ªå¤šå…³äºwebpackä¸é…ç½®çš„ä¸œè¥¿ï¼ŒåŠ ä¸Šç¬¬ä¸€ç¯‡è§‰å¾—æè¿°çš„å¤ªè¿‡å†—ä½™~æ‰€ä»¥è¿™ç¯‡ä¸ä¼šè®²å¾—å¾ˆç»†ï¼Œåªæ˜¯å¤§æ¦‚æŠŠä»–è¿è½¬çš„é€»è¾‘æ€è·¯å†™å‡ºæ¥ï¼Œå…·ä½“æºç ä¼šæä¾›ä¼ é€é—¨ã€‚</p>
<p>æ¨èå¤§å®¶çœ‹ç¬¬ä¸€ç¯‡çš„ <strong>é¡¹ç›®åˆå§‹åŒ–</strong> å’Œ <strong>æ–­ç‚¹è°ƒè¯•</strong> éƒ¨åˆ†ï¼Œè¿™é‡Œå°±ä¸åœ¨èµ˜è¿°ã€‚<a href="https://jsonz1993.github.io/2018/05/create-react-app-o/#%E9%A1%B9%E7%9B%AE%E5%88%9D%E5%A7%8B%E5%8C%96">ä¼ é€é—¨ é¡¹ç›®åˆå§‹åŒ–æ–­ç‚¹è°ƒè¯•éƒ¨åˆ†</a></p>
<h1 id="å‡†å¤‡é˜¶æ®µ"><a href="#å‡†å¤‡é˜¶æ®µ" class="headerlink" title="å‡†å¤‡é˜¶æ®µ"></a><a href="#%E5%87%86%E5%A4%87%E9%98%B6%E6%AE%B5">å‡†å¤‡é˜¶æ®µ</a></h1><p><strong>è¿™é‡Œæˆ‘ä»¬è®¨è®ºçš„create-react-appç‰ˆæœ¬ä¾æ—§æ˜¯<code>v1.1.4</code></strong></p>
<p>æ—¢ç„¶è¿™ç¯‡æˆ‘ä»¬ä¸»è¦è®²çš„æ˜¯ <code>create-react-app</code>é‡Œé¢çš„webpackæœåŠ¡ï¼Œé‚£æˆ‘ä»¬è‚¯å®šè¦å…ˆæ–°å»ºä¸€ä¸ªé¡¹ç›®ã€‚</p>
<ul>
<li><code>npm install create-react-app -g</code> å…¨å±€å®‰è£…create-react-app</li>
<li><code>create-react-app my-react-project</code> ç”¨create-react-appæ–°å»ºä¸€ä¸ªé¡¹ç›®</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd my-react-project</span><br><span class="line">yarn start</span><br></pre></td></tr></table></figure>
<p>æ–°å»ºå®Œä¹‹åï¼Œç»ˆç«¯æç¤ºäº†æˆ‘ä»¬ç›´æ¥è¿›å…¥é¡¹ç›®ï¼Œè·‘ yarn(npm) start å°±å¯ä»¥å¼€å‘äº†ã€‚æˆ‘ä»¬æ‰“å¼€ <code>package.json</code>å°±å¯ä»¥çœ‹åˆ° yarn start è·‘çš„å‘½ä»¤æ˜¯ <code>&quot;react-scripts start&quot;</code></p>
<p>é‚£ä¹ˆè¿™ä¸ª react-scripts å‘½ä»¤åˆ°åº•æ˜¯å“ªä¸€ä¸ªå‘¢ï¼Ÿ</p>
<p>ä¸€èˆ¬å†™åœ¨ <code>package.json=&gt; scripts</code> çš„å‘½ä»¤ï¼Œéƒ½ä¼šå…ˆå» <code>project_path(é¡¹ç›®ç›®å½•ï¼‰/node_modules/.bin</code> æŸ¥æ‰¾ï¼Œæ‰¾ä¸åˆ°å†æ‰¾å…¨å±€å®‰è£…çš„åŒ…ã€‚</p>
<p>é‚£ä¹ˆ node_modules/.bin é‡Œé¢çš„æ–‡ä»¶åˆæ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿ<br>æˆ‘ä»¬å¦‚æœåœ¨åŒ…çš„ package.json åŠ ä¸Š <code>bin</code> å­—æ®µï¼Œnpmå°±ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬æ˜ å°„åˆ° node_modules/.bin é‡Œé¢ <a target="_blank" rel="noopener" href="https://docs.npmjs.com/files/package.json#bin">npm binæ–‡æ¡£ä¼ é€é—¨</a></p>
<p>æˆ‘ä»¬ç›´æ¥æ‰“å¼€ <code>node_modules/react-scripts/package.json</code> èƒ½çœ‹åˆ°è¿™ä¹ˆä¸€è¡Œ<code>&quot;react-scripts&quot;: &quot;./bin/react-scripts.js&quot;</code>,ç›´æ¥æŠŠå‘½ä»¤æŒ‡å‘<code>node_modules/react-scripts/.bin/react-scripts.js</code>ï¼Œä¹ŸéªŒè¯äº†æˆ‘ä»¬çš„è§‚ç‚¹ã€‚</p>
<p>è¿˜è®°å¾—ä¸Šä¸€ç¯‡ï¼Œæˆ‘ä»¬åœ¨ <code>create-react-app/packages</code> é‡Œé¢å‘ç°äº†æœ‰ä¸€ä¸ª <code>react-scripts</code>ã€‚å…¶å®æ˜¯åŒä¸€ä¸ªä¸œè¥¿æ¥çš„ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥çš„æ­¥éª¤å°±å¾ˆæ˜ç¡®äº†ï¼Œç›´æ¥ç”¨è€åŠæ³•ï¼Œæ”¹ä¸‹é…ç½®ï¼Œç„¶åç”¨vscodeè·‘æ–­ç‚¹è°ƒè¯•é˜…è¯»<code>project_path/node_modules/react-scripts/.bin/react-scripts.js</code>çš„æºç  ä¸€æ¢ç©¶ç«Ÿã€‚</p>
<h3 id="vscode-launch-json"><a href="#vscode-launch-json" class="headerlink" title="vscode launch.json"></a><a href="#vscode_launch.json">vscode launch.json</a></h3><p>è¿™é‡Œæˆ‘ä»¬ä¼ å…¥ start ä½œä¸ºå‚æ•°,æ¨¡æ‹Ÿåœ¨é¡¹ç›®é‡Œè·‘ <code>yarn start</code> çš„æ•ˆæœã€‚</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;0.2.0&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;configurations&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;node&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;request&quot;</span>: <span class="string">&quot;launch&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;å¯åŠ¨ç¨‹åº&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;program&quot;</span>: <span class="string">&quot;$&#123;workspaceFolder&#125;/node_modules/react-scripts/bin/react-scripts.js&quot;</span>, <span class="comment">//è°ƒè¯•çš„æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">      <span class="attr">&quot;args&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;start&quot;</span> <span class="comment">// ä¼ å…¥ start åšä¸ºå‚æ•°</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em><strong>ps:ä¸‹é¢çš„<code>react-scripts</code>æ²¡æœ‰ç‰¹æ®Šè¯´æ˜ï¼Œéƒ½ä»£è¡¨<code>project_path/node_modules/react-scripts</code>ç›®å½•æ–¹ä¾¿é˜…è¯»</strong></em></p>
<h1 id="react-scripts-bin-react-scripts-js"><a href="#react-scripts-bin-react-scripts-js" class="headerlink" title="react-scripts/.bin/react-scripts.js"></a><a href="#react-scripts-bin-react-scripts-js">react-scripts/.bin/react-scripts.js</a></h1><p><a target="_blank" rel="noopener" href="https://github.com/facebook/create-react-app/blob/v1.1.4/packages/react-scripts/bin/react-scripts.js">æ–‡ä»¶ä¼ é€é—¨</a><br>è¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯è€åŠæ³•ï¼Œå…ˆä¸çœ‹ä¾èµ– çœ‹ä¸»æµç¨‹ç†è§£å…ˆï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶ä¹Ÿæ˜¯ä¸€ä¸ªå…¥å£æ–‡ä»¶ï¼Œéå¸¸ç®€çŸ­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> args = process.argv.slice(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> scriptIndex = args.findIndex(</span><br><span class="line">  <span class="function"><span class="params">x</span> =&gt;</span> x === <span class="string">&#x27;build&#x27;</span> || x === <span class="string">&#x27;eject&#x27;</span> || x === <span class="string">&#x27;start&#x27;</span> || x === <span class="string">&#x27;test&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">const</span> script = scriptIndex === -<span class="number">1</span> ? args[<span class="number">0</span>] : args[scriptIndex];</span><br><span class="line"><span class="keyword">const</span> nodeArgs = scriptIndex &gt; <span class="number">0</span> ? args.slice(<span class="number">0</span>, scriptIndex) : [];</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆå¤„ç†ä¼ è¿›æ¥çš„å‚æ•°ï¼Œç”¨<code>script</code>å˜é‡æ¥è·å–æˆ‘ä»¬è·‘çš„å‘½ä»¤æ˜¯å“ªä¸€ä¸ªï¼Œæœ‰[â€˜buildâ€™, â€˜ejectâ€™, â€˜startâ€™, â€˜testâ€™]è¿™ä¹ˆå‡ ç§ï¼Œåˆ†åˆ«å¯¹åº” æ„å»ºã€æš´éœ²é…ç½®ã€å¼€å‘ã€æµ‹è¯•å‘½ä»¤ã€‚<br>ç„¶åå†è·å–ä¸€èµ·ä¼ å…¥çš„å…¶ä»–çš„å‚æ•°ï¼Œæ¯”å¦‚<code>npm test</code>å‘½ä»¤å°±ä¼šå¸¦ä¸€ä¸ªé¢å¤–çš„å‚æ•°<code>--env=jsdom</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (script) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&#x27;build&#x27;</span>:</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&#x27;eject&#x27;</span>:</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&#x27;start&#x27;</span>:</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&#x27;test&#x27;</span>: &#123;</span><br><span class="line">    <span class="comment">// ç”¨ cross-spawn å»è·‘ä¸€ä¸ªåŒæ­¥çš„å‘½ä»¤</span></span><br><span class="line">    <span class="comment">// æ ¹æ®ä¼ å…¥çš„å‘½ä»¤æ¥æ‹¼æ¥å¯¹åº”çš„è·¯å¾„ ç”¨nodeå»è·‘</span></span><br><span class="line">    <span class="keyword">const</span> result = spawn.sync(</span><br><span class="line">      <span class="string">&#x27;node&#x27;</span>,</span><br><span class="line">      nodeArgs</span><br><span class="line">        .concat(<span class="built_in">require</span>.resolve(<span class="string">&#x27;../scripts/&#x27;</span> + script))</span><br><span class="line">        .concat(args.slice(scriptIndex + <span class="number">1</span>)),</span><br><span class="line">      &#123; <span class="attr">stdio</span>: <span class="string">&#x27;inherit&#x27;</span> &#125;</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">if</span> (result.signal) &#123;</span><br><span class="line">      <span class="keyword">if</span> (result.signal === <span class="string">&#x27;SIGKILL&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">// è¾“å‡ºé”™è¯¯æé†’æ—¥å¿—</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (result.signal === <span class="string">&#x27;SIGTERM&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">// è¾“å‡ºé”™è¯¯æé†’æ—¥å¿—</span></span><br><span class="line">      &#125;</span><br><span class="line">      process.exit(<span class="number">1</span>); <span class="comment">// é€€å‡ºè¿›ç¨‹ï¼Œ ä¼ 1ä»£è¡¨æœ‰é”™è¯¯</span></span><br><span class="line">    &#125;</span><br><span class="line">    process.exit(result.status);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="attr">default</span>:</span><br><span class="line">    <span class="comment">// è¿™é‡Œè¾“å‡ºåŒ¹é…ä¸åˆ°å¯¹åº”çš„å‘½ä»¤</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ ¹æ®è·å–åˆ°çš„å‘½ä»¤ï¼Œå¯¹åº”åˆ°<code>react-scripts/scripts</code>ä¸‹é¢çš„æ–‡ä»¶å»è·‘ï¼Œæ¯”å¦‚ <code>react-scripts start</code> å°±ä¼šå»è·‘ <code>react-scripts/scripts/start.js</code>ã€‚</p>
<p>è¿™é‡Œæ’å‡ å¥è®²ä¸€ä¸‹ä¸€ä¸ªé¡¹ç›®ä¸Šæ¯”è¾ƒå¸¸è§çš„ç±»åº“è§£è€¦æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„ <code>spawn</code>å¼•ç”¨çš„æ˜¯<code>react-dev-utils/crossSpawn</code>ã€‚è€Œåœ¨<code>react-dev-utils/corssSpawn</code>é‡Œé¢ä¹Ÿåªæ˜¯ç®€ç®€å•å•çš„å‡ å¥ï¼Œå¼•å…¥<code>cross-spawn</code>å†æŠŠ<code>cross-spawn</code>æš´éœ²å‡ºå»ã€‚<br>ä½†æ˜¯è¿™ä¹ˆå†™å°±å¯ä»¥èµ·åˆ°ç±»åº“è§£è€¦çš„ä½œç”¨ï¼Œæ¯”å¦‚ä»¥åè¿™ä¸ªåº“è¢«çˆ†å‡ºæœ‰é‡å¤§çš„bugæˆ–è€…åœæ­¢ç»´æŠ¤äº†ï¼Œç›´æ¥ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶å¼•å…¥å…¶ä»–çš„ç±»åº“ï¼Œå…¶ä»–å¼•ç”¨è¯¥æ–‡ä»¶çš„ä»£ç å°±ä¸éœ€è¦æ”¹åŠ¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// react-dev-utils/corssSpawn</span></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> crossSpawn = <span class="built_in">require</span>(<span class="string">&#x27;cross-spawn&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = crossSpawn;</span><br></pre></td></tr></table></figure>

<h1 id="react-scripts-scripts-start-js"><a href="#react-scripts-scripts-start-js" class="headerlink" title="react-scripts/scripts/start.js"></a><a href="#react-scripts-scripts-start-js">react-scripts/scripts/start.js</a></h1><p><a target="_blank" rel="noopener" href="https://github.com/facebook/create-react-app/blob/v1.1.4/packages/react-scripts/scripts/start.js">æ–‡ä»¶ä¼ é€é—¨</a></p>
<p>çœ‹è¿‡ç¬¬ä¸€ç¯‡çš„äººå¯¹è¿™ä¸ªæ–‡ä»¶å¤¹åº”è¯¥ä¸é™Œç”Ÿï¼Œ<code>create-react-app</code> åœ¨å®‰è£…å®Œ <code>react</code> ç­‰ä¾èµ–ä¹‹åï¼Œå°±ä¼šè·‘è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹é¢çš„<code>init.js</code>æ¥æ‹·è´æ¨¡ç‰ˆæ–‡ä»¶ï¼Œä¿®æ”¹<code>package.json</code>ç­‰æ“ä½œã€‚</p>
<p>æ—¢ç„¶æˆ‘ä»¬å·²ç»çŸ¥é“ä»–è¦æ‰§è¡Œ start.js, æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠvscodeè°ƒè¯•æ–‡ä»¶ä¿®æ”¹ä¸º start.js æ–‡ä»¶<code>&quot;program&quot;: &quot;$&#123;workspaceFolder&#125;/node_modules/react-scripts/scripts/start.js&quot;,</code> ä¹‹æ‰€ä»¥è¦ä¿®æ”¹æ˜¯å› ä¸ºä»–è¿™é‡Œä¸æ˜¯å¼•ç”¨jsæ–‡ä»¶æ¥è¿è¡Œï¼Œè€Œæ˜¯ç”¨ç»ˆç«¯æ¥è·‘ï¼Œæ‰€ä»¥ä¸å±äºæˆ‘ä»¬çš„é¡¹ç›®è°ƒè¯•èŒƒå›´~</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">process.env.BABEL_ENV = <span class="string">&#x27;development&#x27;</span>;</span><br><span class="line">process.env.NODE_ENV = <span class="string">&#x27;development&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Makes the script crash on unhandled rejections instead of silently</span></span><br><span class="line"><span class="comment">// ignoring them. In the future, promise rejections that are not handled will</span></span><br><span class="line"><span class="comment">// terminate the Node.js process with a non-zero exit code.</span></span><br><span class="line">process.on(<span class="string">&#x27;unhandledRejection&#x27;</span>, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> err;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>æ–‡ä»¶çš„æœ€å¼€å¤´è®¾ç½®äº†ä¸¤ä¸ªç¯å¢ƒå˜é‡ï¼Œå› ä¸º start æ˜¯ç”¨æ¥è·‘å¼€å‘çš„ï¼Œæ‰€ä»¥è¿™é‡Œçš„ç¯å¢ƒå˜é‡éƒ½æ˜¯ <code>development</code>ï¼Œç„¶åå†ç»™ <code>process</code> ç»‘å®šä¸€ä¸ªé”™è¯¯ç›‘å¬å‡½æ•°ï¼Œè¿™ä¸ªé”™è¯¯ç›‘å¬å®è´¨ä¸Šæ˜¯ç”¨æ¥ç›‘å¬ _ä¸€äº›æ²¡æœ‰è¢«.catchçš„Promise_ã€‚ <a target="_blank" rel="noopener" href="https://nodejs.org/dist/latest-v8.x/docs/api/process.html#process_event_unhandledrejection">å…·ä½“å¯ä»¥çœ‹nodeçš„æ–‡æ¡£</a>, å…³äº Promiseå¯ä»¥çœ‹ä¸€ä¸‹ä¹‹å‰å†™è¿‡çš„ä¸€ç¯‡<a href="https://jsonz1993.github.io/2017/12/%E6%B5%85%E6%9E%90Promise/">ä»‹ç»Promiseçš„æ–‡ç« ä»ç”¨æ³•å’Œå®ç°åŸç†éƒ½æœ‰æ‰€æ¶‰åŠ</a></p>
<p>æ¥ç€å¼•è¿›ä¸€ä¸ª <code>../config/env</code>ï¼Œ çœ‹æ–‡ä»¶åçŒœåº”è¯¥æ˜¯åšä¸€äº›å…³äºç¯å¢ƒé…ç½®çš„äº‹æƒ…ï¼Œæ‰¾åˆ°æ–‡ä»¶æ–­ç‚¹è¿›æ¥</p>
<h1 id="react-scripts-config-env-js"><a href="#react-scripts-config-env-js" class="headerlink" title="react-scripts/config/env.js"></a><a href="#react-scripts-config-env-js">react-scripts/config/env.js</a></h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> paths = <span class="built_in">require</span>(<span class="string">&#x27;./paths&#x27;</span>);</span><br><span class="line"><span class="comment">// Make sure that including paths.js after env.js will read .env variables.</span></span><br><span class="line"><span class="keyword">delete</span> <span class="built_in">require</span>.cache[<span class="built_in">require</span>.resolve(<span class="string">&#x27;./paths&#x27;</span>)];</span><br></pre></td></tr></table></figure>
<p><code>env.js</code> æ–‡ä»¶åœ¨å¼•å…¥ <code>./paths.js</code> ä¹‹åï¼Œç«‹å³æŠŠä»–ä»cacheä¸­åˆ é™¤æ‰ï¼Œè¿™æ ·ä¸‹æ¬¡å¦‚æœæœ‰å…¶ä»–çš„æ¨¡å—å¼•å…¥<code>paths.js</code>ï¼Œå°±ä¸ä¼šä»ç¼“å­˜é‡Œé¢å»è·å–ï¼Œä¿è¯äº†<code>paths.js</code>é‡Œé¢æ‰§è¡Œé€»è¾‘éƒ½ä¼šç”¨åˆ°æœ€æ–°çš„ç¯å¢ƒå˜é‡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> dotenvFiles = [</span><br><span class="line">  <span class="comment">// ä¸¾ä¸ªä¾‹å­ï¼šç¬¬ä¸€ä¸ªå…ƒç´ åœ¨æˆ‘çš„ç”µè„‘è·¯å¾„æ˜¯è¿™æ ·çš„ Users/jsonz/Documents/my-react-project/.env.development.local.js</span></span><br><span class="line">  <span class="string">`<span class="subst">$&#123;paths.dotenv&#125;</span>.<span class="subst">$&#123;NODE_ENV&#125;</span>.local`</span>,</span><br><span class="line">  <span class="string">`<span class="subst">$&#123;paths.dotenv&#125;</span>.<span class="subst">$&#123;NODE_ENV&#125;</span>`</span>,</span><br><span class="line">  NODE_ENV !== <span class="string">&#x27;test&#x27;</span> &amp;&amp; <span class="string">`<span class="subst">$&#123;paths.dotenv&#125;</span>.local`</span>,</span><br><span class="line">  paths.dotenv,</span><br><span class="line">].filter(<span class="built_in">Boolean</span>);</span><br></pre></td></tr></table></figure>
<p>ç„¶åå†æ ¹æ®pathsç»™å‡ºçš„åœ°å€å»æ‹¿å…¶ä»–çš„ç¯å¢ƒå˜é‡ï¼Œè¿™é‡Œ<code>paths.js</code>ä¼šæ ¹æ®ä¸åŒçš„æƒ…å†µç»™å‡ºä¸åŒçš„è·¯å¾„ï¼Œæˆ‘ä»¬è®¨è®ºçš„æ˜¯æ­£å¸¸çš„åˆ›å»ºé¡¹ç›®æƒ…å†µã€‚<br>å…¶ä»–çš„å‡ ç§æƒ…å†µæœ‰ï¼š</p>
<ol>
<li>æˆ‘ä»¬åœ¨å·²ç»åˆ›å»ºçš„é¡¹ç›®è·‘äº† <code>npm(yarn) eject</code>ï¼Œè¿™æ—¶å€™ <code>react-scripts</code>ä¼šæŠŠé…ç½®éƒ½æš´éœ²åˆ° <code>project_path/config</code> æ–¹ä¾¿æˆ‘ä»¬å»æ ¹æ®é¡¹ç›®ä¿®æ”¹é…ç½®ï¼Œè¿™ä¸ªæ“ä½œæ˜¯ä¸å¯é€†çš„ã€‚</li>
<li>æˆ‘ä»¬æ­£å¸¸åˆ›å»ºé¡¹ç›®ï¼Œç›´æ¥è·‘é¡¹ç›®ï¼Œè¿™æ—¶å€™é…ç½®å°±å­˜æ”¾åœ¨<code>project/node_modules/react-scripts</code>ã€‚</li>
<li>å¼€å‘äººå‘˜è‡ªå·±è°ƒè¯•ç”¨çš„ï¼Œè¿™æ—¶å€™é…ç½®å­˜æ”¾åœ¨<code>create-react/packages/react-scripts/config</code>ã€‚</li>
</ol>
<p>æ‹¼è£…å®Œè·¯å¾„ä¹‹åï¼Œç”¨<a target="_blank" rel="noopener" href="https://www.npmjs.com/package/dotenv-expand">dotenv-expand</a>å’Œ<a target="_blank" rel="noopener" href="https://www.npmjs.com/package/dotenv">dotenv</a>æ¥æŠŠæ–‡ä»¶é‡Œé¢çš„ç¯å¢ƒå˜é‡åŠ è½½è¿›æ¥ï¼Œè¿™ä¸€å—ä¸€èˆ¬åœºæ™¯ç”¨ä¸ä¸Šã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getClientEnvironment</span>(<span class="params">publicUrl</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> raw = <span class="built_in">Object</span>.keys(process.env)</span><br><span class="line">    .filter(<span class="function"><span class="params">key</span> =&gt;</span> REACT_APP.test(key))</span><br><span class="line">    .reduce(</span><br><span class="line">      <span class="function">(<span class="params">env, key</span>) =&gt;</span> &#123;</span><br><span class="line">        env[key] = process.env[key];</span><br><span class="line">        <span class="keyword">return</span> env;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">NODE_ENV</span>: process.env.NODE_ENV || <span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  <span class="keyword">const</span> stringified = &#123;</span><br><span class="line">    <span class="string">&#x27;process.env&#x27;</span>: <span class="built_in">Object</span>.keys(raw).reduce(<span class="function">(<span class="params">env, key</span>) =&gt;</span> &#123;</span><br><span class="line">      env[key] = <span class="built_in">JSON</span>.stringify(raw[key]);</span><br><span class="line">      <span class="keyword">return</span> env;</span><br><span class="line">    &#125;, &#123;&#125;),</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> &#123; raw, stringified &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åè¿”å›ä¸€ä¸ª <code>getClientEnvironment</code>å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ‰§è¡Œåä¼šè¿”å›å®¢æˆ·ç«¯çš„ç¯å¢ƒå˜é‡ã€‚</p>
<h1 id="react-scripts-scripts-start-js-2"><a href="#react-scripts-scripts-start-js-2" class="headerlink" title="react-scripts/scripts/start.js(2)"></a><a href="#react-scripts-scripts-start-js-2">react-scripts/scripts/start.js(2)</a></h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> chalk = <span class="built_in">require</span>(<span class="string">&#x27;chalk&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> WebpackDevServer = <span class="built_in">require</span>(<span class="string">&#x27;webpack-dev-server&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> clearConsole = <span class="built_in">require</span>(<span class="string">&#x27;react-dev-utils/clearConsole&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> checkRequiredFiles = <span class="built_in">require</span>(<span class="string">&#x27;react-dev-utils/checkRequiredFiles&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;</span><br><span class="line">  choosePort,</span><br><span class="line">  createCompiler,</span><br><span class="line">  prepareProxy,</span><br><span class="line">  prepareUrls,</span><br><span class="line">&#125; = <span class="built_in">require</span>(<span class="string">&#x27;react-dev-utils/WebpackDevServerUtils&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> openBrowser = <span class="built_in">require</span>(<span class="string">&#x27;react-dev-utils/openBrowser&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> paths = <span class="built_in">require</span>(<span class="string">&#x27;../config/paths&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">&#x27;../config/webpack.config.dev&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> createDevServerConfig = <span class="built_in">require</span>(<span class="string">&#x27;../config/webpackDevServer.config&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> useYarn = fs.existsSync(paths.yarnLockFile);</span><br><span class="line"><span class="keyword">const</span> isInteractive = process.stdout.isTTY;</span><br></pre></td></tr></table></figure>
<p>åŠ è½½å®Œå„ç§ç¯å¢ƒå˜é‡ä¹‹åï¼Œæˆ‘ä»¬å›åˆ°<code>react-scripts/scripts/start.js</code>ï¼Œè€è§„çŸ©ï¼Œä¸€ç³»åˆ—çš„ä¾èµ–å…ˆè·³è¿‡ä¸çœ‹ï¼Œåé¢ç”¨åˆ°å†æ¥çœ‹ã€‚<br>è¿˜è®°å¾—æˆ‘ä»¬åœ¨<code>env.js</code>é‡Œé¢deletæ‰node.catchå—ï¼Œè¿™é‡Œ<code>conts paths = require(&#39;../config/paths)</code>å°±ä¸ä¼šä»ç¼“å­˜é‡Œé¢å»æ‹¿è€Œæ˜¯é‡æ–°å»åŠ è½½ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!checkRequiredFiles([paths.appHtml, paths.appIndexJs])) &#123;</span><br><span class="line">  process.exit(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…ˆåˆ¤æ–­ä¸€ä¸‹æˆ‘ä»¬ä¸¤ä¸ªå…¥å£æ–‡ä»¶æœ‰æ²¡æœ‰å­˜åœ¨ï¼Œåˆ†åˆ«æ˜¯<code>project_path/public/index.html</code>å’Œ<code>project_path/src/index.js</code>ï¼Œå¦‚æœä¸å­˜åœ¨ç»™å‡ºæç¤ºç»“æŸç¨‹åºã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> DEFAULT_PORT = <span class="built_in">parseInt</span>(process.env.PORT, <span class="number">10</span>) || <span class="number">3000</span>;</span><br><span class="line"><span class="keyword">const</span> HOST = process.env.HOST || <span class="string">&#x27;0.0.0.0&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>ç„¶åè®¾ç½®é»˜è®¤çš„ç«¯å£å’Œhostï¼Œå¦‚æœæœ‰ç‰¹æ®Šçš„éœ€æ±‚ï¼Œå¯ä»¥ä»ç¯å¢ƒå˜é‡ä¼ è¿›å»æ”¹å˜ï¼Œæ²¡æœ‰å°±ä¼šç”¨é»˜è®¤çš„<code>3000</code>ç«¯å£ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">choosePort(HOST, DEFAULT_PORT).then(...) <span class="comment">// @return Promise</span></span><br></pre></td></tr></table></figure>
<p>è®¾ç½®å®Œé»˜è®¤çš„ç«¯å£ä¸hostä¹‹åï¼Œå¼€å§‹åˆ¤æ–­è¿™ä¸ªç«¯å£æœ‰æ²¡æœ‰è¢«å…¶ä»–çš„è¿›ç¨‹å ç”¨ï¼Œæœ‰çš„è¯ä¼šæä¾›ä¸‹ä¸€ä¸ªå¯ç”¨çš„ç«¯å£ï¼Œæˆ‘ä»¬é¡ºç€<code>choosePort</code>å»æ–‡ä»¶å¤´æ‰¾ä¾èµ–ï¼Œæ‰¾åˆ°è¯¥æ–¹æ³•ä½äºä¾èµ–<code>react-dev-utils/WebpackDevServerUtils</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">choosePort</span>(<span class="params">host, defaultPort</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> detect(defaultPort, host).then(</span><br><span class="line">    <span class="function"><span class="params">port</span> =&gt;</span></span><br><span class="line">      <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (port === defaultPort) &#123;</span><br><span class="line">          <span class="keyword">return</span> resolve(port);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> message =</span><br><span class="line">          process.platform !== <span class="string">&#x27;win32&#x27;</span> &amp;&amp; defaultPort &lt; <span class="number">1024</span> &amp;&amp; !isRoot()</span><br><span class="line">            ? <span class="string">`Admin permissions are required to run a server on a port below 1024.`</span></span><br><span class="line">            : <span class="string">`Something is already running on port <span class="subst">$&#123;defaultPort&#125;</span>.`</span>;</span><br><span class="line">        <span class="keyword">if</span> (isInteractive) &#123;</span><br><span class="line">          clearConsole();</span><br><span class="line">          <span class="keyword">const</span> existingProcess = getProcessForPort(defaultPort);</span><br><span class="line">          <span class="keyword">const</span> question = &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&#x27;confirm&#x27;</span>,</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;shouldChangePort&#x27;</span>,</span><br><span class="line">            <span class="attr">message</span>:</span><br><span class="line">              chalk.yellow(</span><br><span class="line">                message +</span><br><span class="line">                  <span class="string">`<span class="subst">$&#123;existingProcess ? <span class="string">` Probably:\n  <span class="subst">$&#123;existingProcess&#125;</span>`</span> : <span class="string">&#x27;&#x27;</span>&#125;</span>`</span></span><br><span class="line">              ) + <span class="string">&#x27;\n\nWould you like to run the app on another port instead?&#x27;</span>,</span><br><span class="line">            <span class="attr">default</span>: <span class="literal">true</span>,</span><br><span class="line">          &#125;;</span><br><span class="line">          inquirer.prompt(question).then(<span class="function"><span class="params">answer</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (answer.shouldChangePort) &#123;</span><br><span class="line">              resolve(port);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              resolve(<span class="literal">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(chalk.red(message));</span><br><span class="line">          resolve(<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;),</span><br><span class="line">    <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// è¾“å‡ºé”™è¯¯æ—¥å¿—</span></span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>choosePort</code> é‡Œé¢ç”¨åˆ°<a target="_blank" rel="noopener" href="https://www.npmjs.com/package/detect-port-alt">detect-port-alt</a>å»æ£€æµ‹ç«¯å£å ç”¨ï¼Œå¦‚æœè¢«å ç”¨äº†è¿”å›ä¸€ä¸ªæœ€æ¥è¿‘çš„é€’å¢æ–¹å‘å¯ç”¨çš„ç«¯å£ï¼Œæ¯”å¦‚3000ç«¯å£è¢«å ç”¨,3001æ²¡è¢«å ç”¨å°±è¿”å›å›æ¥ã€‚<br>å¦‚æœå‘ç°è¿”å›çš„å¯ç”¨ç«¯å£ä¸æ˜¯é»˜è®¤çš„ç«¯å£ï¼Œç»™å‡ºä¸€ä¸ªäº¤äº’å¼çš„å‘½ä»¤è¯¢é—®ç”¨æˆ·æ˜¯å¦è¦æ¢ä¸€ä¸ªç«¯å£å»è®¿é—®ï¼Œäº¤äº’å¼å‘½ä»¤ç”¨çš„æ˜¯<a target="_blank" rel="noopener" href="https://www.npmjs.com/package/inquirer">inquirer</a>è¿™ä¸ªåŒ…ã€‚<br>è¿™é‡Œå¦‚æœç”¨vsCodeæ¥è°ƒè¯•ï¼Œ<code>process.stdout.isTTY</code> è¿”å›çš„å€¼æ˜¯<code>undefined</code>ã€‚æ‰€ä»¥å¦‚æœè¦æµ‹è¯•è¿™ä¸€å—äº¤äº’å¼å‘½ä»¤ï¼Œåªèƒ½åˆ‡å›ç³»ç»Ÿçš„ç»ˆç«¯å»è°ƒè¯•~</p>
<p><img data-src="/create-react-app-t/tty_choose_port.png" alt="äº¤äº’å¼å‘½ä»¤è¯¢é—®æ˜¯å¦åˆ‡æ¢ç«¯å£"></p>
<p><a target="_blank" rel="noopener" href="https://github.com/facebook/create-react-app/blob/v1.1.4/packages/react-scripts/scripts/start.js#L71">æ–‡ä»¶ä¼ é€é—¨</a><br>æ£€æµ‹å®Œå¯ç”¨ç«¯å£ä¹‹åï¼Œå›åˆ°<code>start.js</code>ã€‚</p>
<p>å‰ç«¯å¤„ç†ä¸€å †ç¯å¢ƒå˜é‡ï¼Œè¿˜æœ‰åŠ è½½ä¸€å †é…ç½®ï¼Œå…¨éƒ½ç”¨åœ¨è¿™ä¸€å—ã€‚è¿™é‡Œä¸»è¦åšçš„å°±æ˜¯æŠŠç¯å¢ƒå˜é‡å’Œé…ç½®ç»„è£…èµ·æ¥ï¼Œå¼€ä¸ªwebpackæœ¬åœ°è°ƒè¯•æœåŠ¡ã€‚ä¸»è¦åšçš„äº‹æƒ…æœ‰:</p>
<ol>
<li>å¦‚æœæ²¡æœ‰æ‰¾åˆ°å¯ç”¨çš„ç«¯å£ç›´æ¥è¿”å›ä¸ç»§ç»­æ‰§è¡Œä¸‹å»</li>
<li>æ ¹æ®ç¯å¢ƒå˜é‡åˆ¤æ–­æ˜¯å¦å¯ç”¨<code>https</code>ï¼Œé»˜è®¤æ˜¯<code>http</code>ã€‚</li>
<li>æ ¹æ® host, protocol, port æ‹¼è£…ä¸€ç³»åˆ—çš„urlï¼ŒåŒ…æ‹¬<code>Browser</code>çš„urlä¸<code>Terminal</code>çš„urlã€‚</li>
<li>è°ƒç”¨<code>createCompiler</code> ä¼ å…¥webpackï¼Œwebpacké…ç½®ï¼ŒappNameï¼Œç¬¬ä¸‰æ­¥è·å–çš„urlï¼Œè¿˜æœ‰æ˜¯å¦ä½¿ç”¨Yarnç­‰å‚æ•°ï¼Œç”Ÿæˆä¸€ä¸ª webpackCompilerã€‚createCompilerè´Ÿè´£çš„ä¸œè¥¿æœ‰:</li>
<li>1 æ ¹æ®ç¯å¢ƒå˜é‡åˆ¤æ–­æ˜¯å¦æœ‰å†’çƒŸæµ‹è¯•çš„éœ€æ±‚ï¼Œå¦‚æœæœ‰åŠ ä¸€ä¸ª <code>handleCompile</code>ï¼Œä¸€æœ‰é”™è¯¯å°±ä¸­æ–­ç¨‹åºã€‚</li>
<li>2 ç”¨ä¼ è¿›æ¥çš„é…ç½®å’ŒhandleCompileç”Ÿæˆä¸€ä¸ªwebpackCompiler</li>
<li>2 å¢åŠ <code>invalid</code>é’©å­ï¼Œä¸€æ£€æµ‹åˆ°æ›´æ”¹æ–‡ä»¶ï¼Œè€Œä¸”æ˜¯äº¤äº’å¼ç»ˆç«¯çš„è¯ï¼Œå…ˆæ¸…ç©ºæ§åˆ¶å°ï¼Œå†è¾“å‡ºæ—¥å¿—</li>
<li>3 å¢åŠ <code>done</code>é’©å­ï¼Œå¯¹webpackçš„è¾“å‡ºæ—¥å¿—æ•´ç†ç»Ÿä¸€è¾“å‡º</li>
<li>åˆ›å»ºå¼€å‘æœåŠ¡é…ç½® å…·ä½“çš„é…ç½®ä»£ç æ”¾åœ¨<code>webpackDevServer.config.js</code></li>
<li>æŠŠ4å’Œ5ä¸¢ç»™ <code>WebpackDevServer</code>ï¼Œç”Ÿæˆä¸€ä¸ª webpack æœ¬åœ°å¼€å‘æœåŠ¡</li>
<li>å¤§åŠŸå‘Šæˆï¼Œæ¸…é™¤å±å¹•ï¼Œæ‰“å¼€è°ƒè¯•è¿æ¥</li>
</ol>
<p>ç›¸å…³çš„ä»£ç æ‰§è¡Œå†™åˆ°æ³¨é‡Šé‡Œé¢å»äº†ï¼Œæ²¡åŠæ³•æ¯ä¸ªæ–¹æ³•é…ç½®éƒ½æ‹å‡ºæ¥è®²â€¦ä¸ç„¶ç¯‡å¹…ä¼šå¾ˆé•¿ï¼Œè¿™é‡Œé¢å¾ˆå¤šç‚¹ä¸€è®²éƒ½å¯ä»¥æ˜¯ä¸€ä¸ªçŸ¥è¯†ç‚¹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">choosePort(HOST, DEFAULT_PORT)</span><br><span class="line">  .then(<span class="function"><span class="params">port</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// æ²¡æœ‰æ‰¾åˆ°å¯ç”¨ç«¯å£ï¼Œç›´æ¥return</span></span><br><span class="line">    <span class="keyword">if</span> (port == <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ ¹æ®ç¯å¢ƒå˜é‡åˆ¤æ–­æ˜¯å¦è¦ç”¨https</span></span><br><span class="line">    <span class="keyword">const</span> protocol = process.env.HTTPS === <span class="string">&#x27;true&#x27;</span> ? <span class="string">&#x27;https&#x27;</span> : <span class="string">&#x27;http&#x27;</span>;</span><br><span class="line">    <span class="keyword">const</span> appName = <span class="built_in">require</span>(paths.appPackageJson).name;</span><br><span class="line">    <span class="comment">// è·å–å½“å‰çš„ host, port, protocol ç”Ÿæˆä¸€ç³»åˆ—url</span></span><br><span class="line">    <span class="keyword">const</span> urls = prepareUrls(protocol, HOST, port);</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªwebpack compiler</span></span><br><span class="line">    <span class="keyword">const</span> compiler = createCompiler(webpack, config, appName, urls, useYarn);</span><br><span class="line">    <span class="comment">// åŠ è½½ä»£ç†çš„é…ç½®ï¼Œåœ¨ project_path/package.json é‡Œé¢åŠ è½½é…ç½®</span></span><br><span class="line">    <span class="keyword">const</span> proxySetting = <span class="built_in">require</span>(paths.appPackageJson).proxy;</span><br><span class="line">    <span class="keyword">const</span> proxyConfig = prepareProxy(proxySetting, paths.appPublic);</span><br><span class="line">    <span class="comment">// ç”Ÿæˆ webpack dev server çš„é…ç½®</span></span><br><span class="line">    <span class="keyword">const</span> serverConfig = createDevServerConfig(</span><br><span class="line">      proxyConfig,</span><br><span class="line">      urls.lanUrlForConfig</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">const</span> devServer = <span class="keyword">new</span> WebpackDevServer(compiler, serverConfig);</span><br><span class="line">    <span class="comment">// ç›‘å¬ devServer</span></span><br><span class="line">    devServer.listen(port, HOST, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// ä¸€äº›æ—¥å¿—è¾“å‡º</span></span><br><span class="line">      <span class="comment">// è‡ªåŠ¨ç”¨é»˜è®¤æµè§ˆå™¨æ‰“å¼€è°ƒè¯•é“¾æ¥</span></span><br><span class="line">      openBrowser(urls.localUrlForBrowser);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// é”™è¯¯å¤„ç†</span></span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<p><code>react-dev-utils/WebpackDevServerUtils.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createCompiler</span>(<span class="params">webpack, config, appName, urls, useYarn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> compiler;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    compiler = webpack(config, handleCompile); <span class="comment">// handleCompileä¸ºå†’çƒŸæµ‹è¯•çš„å¯¹åº”å¤„ç†</span></span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="comment">// é”™è¯¯æç¤º</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  compiler.plugin(<span class="string">&#x27;invalid&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// invalid é’©å­ï¼Œå¦‚æœå½“å‰å¤„äºTTYç»ˆç«¯ï¼Œé‚£ä¹ˆå…ˆæ¸…é™¤æ§åˆ¶å°å†è¾“å‡º Compiling...</span></span><br><span class="line">    <span class="keyword">if</span> (isInteractive) &#123;</span><br><span class="line">      clearConsole();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;Compiling...&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> isFirstCompile = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">  compiler.plugin(<span class="string">&#x27;done&#x27;</span>, <span class="function"><span class="params">stats</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ç›‘å¬äº† done äº‹ä»¶ï¼Œå¯¹è¾“å‡ºçš„æ—¥å¿—åšäº†æ ¼å¼åŒ–è¾“å‡º</span></span><br><span class="line">    <span class="comment">// æ­£å¸¸æƒ…å†µä¸‹ä¼šç›´æ¥è¾“å‡º `Compiled successfully!`</span></span><br><span class="line">    <span class="comment">// å¦‚æœæœ‰é”™è¯¯åˆ™è¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼Œè¿™é‡Œå¯¹é”™è¯¯ä¿¡æ¯åšä¸€äº›å¤„ç†ï¼Œè®©å…¶è¾“å‡ºæ¯”è¾ƒå‹å¥½</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> compiler;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img data-src="/create-react-app-t/webpackDevServer_error.png" alt="è¾“å‡ºæ—¥å¿—æ ¼å¼åŒ–å¤„ç†"></p>
<h1 id="æœ€åè®²ä¸¤å¥"><a href="#æœ€åè®²ä¸¤å¥" class="headerlink" title="æœ€åè®²ä¸¤å¥"></a>æœ€åè®²ä¸¤å¥</h1><p>ä¹‹å‰å°±ä¸€ç›´å¥½å¥‡ï¼Œè¿™äº›è„šæ‰‹æ¶æ˜¯æ€ä¹ˆæ¸…ç©ºæˆ‘ä»¬çš„ç»ˆç«¯å±å¹•çš„ã€‚åœ¨çœ‹<code>create-react-app</code>çš„æ—¶å€™ï¼Œç„åˆ°æœ‰è¿™ä¹ˆä¸€ä¸ªæ–‡ä»¶<a target="_blank" rel="noopener" href="https://github.com/facebook/create-react-app/blob/v1.1.4/packages/react-dev-utils/clearConsole.js">react-dev-utils/clearConsole.js</a>ã€‚è¿™ä¸ªæ–‡ä»¶ååˆ†å‰ªçŸ­ï¼Œæ ¸å¿ƒä»£ç å°±é‚£ä¹ˆä¸€å¥:</p>
<h2 id="react-dev-utils-clearConsole-js"><a href="#react-dev-utils-clearConsole-js" class="headerlink" title="react-dev-utils/clearConsole.js"></a><a href="#react-dev-utils-clearConsole-js">react-dev-utils/clearConsole.js</a></h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">process.stdout.write(process.platform === <span class="string">&#x27;win32&#x27;</span> ? <span class="string">&#x27;\x1B[2J\x1B[0f&#x27;</span> : <span class="string">&#x27;\x1B[2J\x1B[3J\x1B[H&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>ç„¶åå¥½å¥‡å¿ƒç‰¹åˆ«é‡ï¼Œä¸çŸ¥é“åé¢ä¸¤ä¸²æ˜¯ä»€ä¹ˆæ„æ€ï¼Œä¸€ç›´æœæ²¡æœ‰æ‰¾åˆ°æƒ³è¦çš„ç­”æ¡ˆã€‚é—®äº†èº«è¾¹çš„åŒäº‹ï¼Œè¯´æ˜¯åå…­è¿›åˆ¶ï¼Œè€Œåœ¨æˆ‘ç‹­éš˜çš„è®¤çŸ¥é‡Œé¢ä¸€ç›´ä»¥ä¸ºåå…­è¿›åˆ¶åªèƒ½è½¬æˆæ•°å­—â€¦.ä½†æ˜¯å®šç›ä¸€çœ‹ï¼Œè¿™æœ‰ä¸ª<code>J</code> æ˜æ˜¾ä¸æ˜¯åå…­è¿›åˆ¶ã€‚ä¸€ä¸ªå¥³è£…å¤§ä½¬å’Œæˆ‘è¯´è¿™æ˜¯ASCIIç ï¼Œç™¾åº¦äº†ä¸€ä¸‹ASCIIç ï¼Œçœ‹äº† <code>\x1B</code> ASCIIå¯¹åº”åˆ° <code>ESC</code>ã€‚ ä½†æ˜¯åé¢çš„ <code>[2J</code> <code>[3J</code> <code>[H</code> æ˜¯ä»€ä¹ˆæ„æ€è¿˜æ˜¯ä¸æ¸…æ¥šâ€¦<br>åé¢å¤§ä½¬åˆå’Œæˆ‘è¯´æ‰¾åˆ°å¯èƒ½æ˜¯ <strong>Linux ANSI æ§åˆ¶ç </strong> æ‰¾æ¥æ‰¾å»æŠ˜è…¾äº†æŒºä¹…çš„åé¢æ‰æ­å¼€ç¥ç§˜é¢çº±~<br>è¿™å‡ ä¸ªå‘½ä»¤å¤§æ¦‚çš„æ„æ€æ˜¯:<br><code>[2J</code> æ¸…é™¤æ§åˆ¶å°<br><code>[H</code> å°†å…‰æ ‡ç§»è‡³æœ€é¡¶éƒ¨<br><code>[3J</code>è¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°ï¼Œåº”è¯¥æ˜¯æ›´é«˜çº§çš„ç³»ç»Ÿå±‚çº§çš„æ¸…é™¤æ§åˆ¶å°<br>ç»™å‡ºå‡ ä¸ª Linux ANSI æ§åˆ¶ç èµ„æ–™ç½‘ç«™<br><a target="_blank" rel="noopener" href="http://manpages.ubuntu.com/manpages/bionic/zh_CN/man4/console_codes.4.html">Ubuntu Manpage: æ§åˆ¶ç»ˆç«¯ä»£ç  - Linux æ§åˆ¶ç»ˆç«¯è½¬ä¹‰å’Œæ§åˆ¶åºåˆ—</a><br><a href="www.cnblogs.com/mugua/archive/2009/11/25/1610118.html">æ§åˆ¶ç»ˆç«¯ä»£ç  - Linux æ§åˆ¶ç»ˆç«¯è½¬ä¹‰å’Œæ§åˆ¶åºåˆ—(è½¬) - æœ¨ç“œè„‘è¢‹ - åšå®¢å›­</a></p>
<p>æœ€åå‰ç«¯çš„å°ä¼™ä¼´å¾ˆå¤šå’Œæˆ‘ä¸€æ ·ä¸æ˜¯ç§‘ç­å‡ºèº«çš„ï¼ŒçœŸçš„å¾—åŠ æŠŠåŠ²è¡¥è¡¥ä¸€äº›è®¡ç®—æœºæ¯”è¾ƒåŸç†æ€§æˆ–æ¯”è¾ƒæ¥è¿‘ç³»ç»Ÿå±‚çº§çš„çŸ¥è¯†~</p>

    </div>

    
    
    
        <div class="reward-container">
  <div></div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    Donate
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechat_pay.jpeg" alt="Jsonz WeChat Pay">
        <p>WeChat Pay</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/ali_pay.jpeg" alt="Jsonz Alipay">
        <p>Alipay</p>
      </div>

  </div>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/JavaScript/" rel="tag"># JavaScript</a>
              <a href="/tags/React/" rel="tag"># React</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2018-05-08/" rel="prev" title="2018-05-08é¢è¯•è®°B">
      <i class="fa fa-chevron-left"></i> 2018-05-08é¢è¯•è®°B
    </a></div>
      <div class="post-nav-item">
    <a href="/history-scroll-restoration/" rel="next" title="æµè§ˆå™¨æ¢å¤æ»šåŠ¨è¡Œä¸º â€”â€” history.scrollRestoration">
      æµè§ˆå™¨æ¢å¤æ»šåŠ¨è¡Œä¸º â€”â€” history.scrollRestoration <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%87%86%E5%A4%87%E9%98%B6%E6%AE%B5"><span class="nav-number">1.</span> <span class="nav-text">å‡†å¤‡é˜¶æ®µ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#vscode-launch-json"><span class="nav-number">1.0.1.</span> <span class="nav-text">vscode launch.json</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#react-scripts-bin-react-scripts-js"><span class="nav-number">2.</span> <span class="nav-text">react-scripts&#x2F;.bin&#x2F;react-scripts.js</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#react-scripts-scripts-start-js"><span class="nav-number">3.</span> <span class="nav-text">react-scripts&#x2F;scripts&#x2F;start.js</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#react-scripts-config-env-js"><span class="nav-number">4.</span> <span class="nav-text">react-scripts&#x2F;config&#x2F;env.js</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#react-scripts-scripts-start-js-2"><span class="nav-number">5.</span> <span class="nav-text">react-scripts&#x2F;scripts&#x2F;start.js(2)</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9C%80%E5%90%8E%E8%AE%B2%E4%B8%A4%E5%8F%A5"><span class="nav-number">6.</span> <span class="nav-text">æœ€åè®²ä¸¤å¥</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#react-dev-utils-clearConsole-js"><span class="nav-number">6.1.</span> <span class="nav-text">react-dev-utils&#x2F;clearConsole.js</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Jsonz"
      src="/images/avatar.jpeg">
  <p class="site-author-name" itemprop="name">Jsonz</p>
  <div class="site-description" itemprop="description">å‰ç«¯ğŸ‘´ğŸ¥¬ğŸ£/JavaScript/React</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">49</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">32</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/jsonz1993/blog" title="Blog â†’ https:&#x2F;&#x2F;github.com&#x2F;jsonz1993&#x2F;blog" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>Blog</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:jsonz@qq.com" title="E-Mail â†’ mailto:jsonz@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://juejin.im/user/58dbb0b844d904006954ca8e" title="æ˜é‡‘ â†’ https:&#x2F;&#x2F;juejin.im&#x2F;user&#x2F;58dbb0b844d904006954ca8e" rel="noopener" target="_blank"><i class="fa fa-bullseye fa-fw"></i>æ˜é‡‘</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.hhking.cn/" title="hhking â†’ https:&#x2F;&#x2F;blog.hhking.cn" rel="noopener" target="_blank"><i class="fa fa-user-friends fa-fw"></i>hhking</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">ç²¤ICPå¤‡18066881å· </a>
  </div>

<div class="copyright">
  
  &copy; 2017 â€“ 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jsonz</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>











<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  
  <script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri === 'http://jsonz1993.github.io/create-react-app-t/',]
      });
      });
  </script>

</body>
</html>
